/*! For license information please see deferred.js.LICENSE.txt */
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred"],Array(1933).concat([function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return o});var a=n(1203),i=n(8),r=n(1378),o=new i.t({name:"".concat("IsDetailsPaneExpanded",".isDetailsPaneExpanded"),factory:{dependencies:{detailsPaneId:r.e,observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return i});var a=n(1203),i=new(n(8).t)({name:"".concat("IsFiltersPaneExpanded",".isFiltersPaneExpanded"),factory:{dependencies:{observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})}],Array(49),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return T});var a=n(0),i=n(1203),r=n(1340),o=n(3573),s=n(2693),c=n(253),d=n(2238),l=n(1331),u=n(54),f=n(7),p=n(79),m=n(101),_=n(40),h=n(590),b=n(52),g=n(142),v=n(5160),y=n(2409),S=n(14),D=n(126),I=n(423),x=n(148),C=n(313),O=n(37),w=n(72),E=n(90),A=n(3),L="CurrentWebDataSource_CurrentWeb",k="CurrentWebDataSource_SubWebs",M=["Title","Path","Filename","Created","LastModifiedTime","LinkingUrl","ParentLink","SiteID","WebId","UniqueID","ViewsLifeTime","ViewsLifeTimeUniqueUsers","ViewsRecent","ViewsRecentUniqueUsers","ViewsLastMonths1","ViewsLastMonths1Unique","ViewsLast7Days","ViewsLast6Days","ViewsLast5Days","ViewsLast4Days","ViewsLast3Days","ViewsLast2Days","ViewsLast1Days","ViewsLast7DaysUniqueUsers","ViewsLast6DaysUniqueUsers","ViewsLast5DaysUniqueUsers","ViewsLast4DaysUniqueUsers","ViewsLast3DaysUniqueUsers","ViewsLast2DaysUniqueUsers","ViewsLast1DaysUniqueUsers"],P=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageContext=n.pageContext,a._itemsStore=n.itemsStore,a._urlDataSourceLite=n.urlDataSourceLite,a._identityDataSource=n.identityDataSource,a._apiUrlHelper=n.apiUrlHelper,a._itemUrlHelper=n.itemUrlHelper,a._dataRequestor=new(a.scope.attached(n.dataRequestorType))({qosName:"CurrentWebDataSource"}),a}return Object(a.__extends)(t,e),t.prototype.getCurrentWeb=function(){var e=this,t=this._itemsStore.getValue(L);if(t)return u.n.wrap(t);var n=this._apiUrlHelper.build().segments("search","query").parameters({querytext:"*",querytemplate:'SiteId:"'.concat(b.e.normalizeLower(this._pageContext.siteId,!1),'" ')+'AND WebId:"'.concat(b.e.normalizeLower(this._pageContext.webId,!1),'" ')+"AND (contentclass:STS_Site OR contentclass:STS_Web)",rowlimit:1,bypassresulttypes:!1,selectproperties:M.join(","),SourceId:"8413cd39-2156-4e00-b54d-11efd9abdb89"});return this._pageContext.groupType===v.e.private&&(n=n.parameter("Properties","EnableDynamicGroups:true")),this._dataRequestor.getData({url:n.toString(),qosName:"GetCurrentWeb",method:"POST"}).then(function(t){if(t&&t.d){var n=e._processData(t);for(var a in n)return e._itemsStore.setValue(L,n[a]),n[a]}return null})},t.prototype.getSubWebs=function(){var e=this,t=this._itemsStore.getValue(k);if(t)return u.n.wrap(t);var n=this._pageContext.webAbsoluteUrl,a=this._apiUrlHelper.build().segments("search","query").parameters({querytext:"*",querytemplate:'ParentLink:"'.concat(n,'" AND contentclass:STS_Web'),rowlimit:100,bypassresulttypes:!1,selectproperties:M.join(",")});return this._dataRequestor.getData({url:a.toString(),qosName:"GetSubWebs",method:"GET"}).then(function(t){if(t&&t.d){var n=e._processData(t);return e._itemsStore.setValue(k,n),n}return null})},t.prototype.getMyOneDriveUrl=function(){var e;if(Number(this._pageContext.webTemplate)===w.t.mySite&&(Object(A.Jr)(A.Da)?this._pageContext.isMySiteOwner:this._pageContext.isSiteOwner))e=u.n.resolve(this._pageContext.webAbsoluteUrl);else{if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser)return u.n.resolve(void 0);var t=this._apiUrlHelper.build().segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");e=this._dataRequestor.getData({url:t.toString(),qosName:"GetMyOneDriveUrl",noRedirect:!0,method:"POST"}).then(function(e){if(e&&e.d){var t=e.d.mySite;return t&&t.replace(/\/$/,"")}})}return this.getMyOneDriveUrl=function(){return e},e},t.prototype.getDefaultOneDriveLibrary=function(e){var t=this._apiUrlHelper.build().method("SP.Web.DefaultDocumentLibraryUrl",e);return this._dataRequestor.getData({url:t.toString(),qosName:"GetDefaultDocumentLibrary"}).then(function(t){var n=t&&t.d&&t.d.DefaultDocumentLibraryUrl;if(n){var a=[],i=new p.t(e),r={title:y.c,target:n.ServerRelativeUrl,customSettingsUrl:i.getScheme()+"://"+i.getHost()+n.ServerRelativeUrl,remote:n.FromCrossFarm};return a.push(r),a}return null})},t.prototype.getLists=function(e,t){var n=this,a=new D.e(e);return this._getTokenIfNecessary(e).then(function(t){var a;return a=t?new I.t({webAbsoluteUrl:e}).build().segment("Web").segment("AppTiles"):n._apiUrlHelper.build().method("SP.RemoteWeb",e).segment("Web").segment("AppTiles"),n._dataRequestor.getData({url:a.toString(),qosName:"GetLists",noRedirect:!0,authToken:t})}).then(function(e){return e&&e.d?e.d.results.filter(function(e){return t?(1===e.AppType||5===e.AppType||0===e.AppType)&&n._isSupportedBaseTemplate(e.BaseTemplate,!0):(1===e.AppType||5===e.AppType)&&n._isSupportedBaseTemplate(e.BaseTemplate)}).map(function(e){return{title:e.Title,thumbnail:e.Thumbnail,lastModified:e.LastModified,appType:e.AppType,appStatus:e.AppStatus,target:a.authority+e.Target,childCount:e.ChildCount,appId:e.AppId,appSource:e.AppSource,assetId:e.AssetId,productId:e.ProductId,contentMarket:e.ContentMarket,customSettingsUrl:e.CustomSettingsUrl,baseTemplate:e.BaseTemplate,appPrincipalId:e.AppPrincipalId}}):null})},t.prototype.getDocumentLibraries=function(e,t){var n=this;void 0===t&&(t={});var a=t.includeMediaLibraries,i=void 0!==a&&a,r=t.includePageLibraries,o=void 0!==r&&r,s=i?"GetDocumentAndMediaLibraries":"GetDocumentLibraries",c=this._apiUrlHelper.build().segment("SP.Web.".concat(s)).parameter("webFullUrl",e);return i&&(c=c.parameter("includePageLibraries",o.toString())),this._dataRequestor.getData({url:c.toString(),qosName:"GetDocumentLibraries",noRedirect:!0}).then(function(e){return e&&e.d?n._processDocLibData(e,s):null})},t.prototype.doesListWithTitleExist=function(e,t,n){var a=this,i=n||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(i).then(function(n){var r;return r=n?new I.t({webAbsoluteUrl:i}).build().segment("web").segment("lists").method("GetByTitle",e):a._apiUrlHelper.build().method("SP.RemoteWeb",i).segment("web").segment("lists").method("GetByTitle",e),a._dataRequestor.getData({url:r.toString(),qosName:"GetListByTitle",noRedirect:!0,additionalHeaders:t,authToken:n}).then(function(){return!0},function(){return!1})})},t.prototype.deleteList=function(e,t,n){var i=this,r=Object(a.__assign)({"X-HTTP-Method":"DELETE","If-Match":"*"},n),o=t||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(o).then(function(t){var n;return n=t?new I.t({webAbsoluteUrl:o}).build().segment("web").segment("lists").method("GetByTitle",e):i._apiUrlHelper.build().method("SP.RemoteWeb",o).segment("web").segment("lists").method("GetByTitle",e),i._dataRequestor.getData({url:n.toString(),qosName:"DeleteListByTitle",noRedirect:!0,additionalHeaders:r,authToken:t})})},t.prototype.recycleListById=function(e,t,n){var a=this,i=n||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(i).then(function(n){var r;return r=n?new I.t({webAbsoluteUrl:i}).build().segment("web").method("lists",e).segment("recycle"):a._apiUrlHelper.build().method("SP.RemoteWeb",i).segment("web").method("lists",e).segment("recycle"),a._dataRequestor.getData({url:r.toString(),qosName:"RecycleListById",noRedirect:!0,additionalHeaders:t,authToken:n,method:"POST"})})},t.prototype.checkEffectivePermissions=function(e,t,n){var a=this._apiUrlHelper.build().segment("web").method("GetList",e).segment("EffectiveBasePermissions");return this._dataRequestor.getData({url:a.toString(),qosName:"checkEffectivePermissions",noRedirect:!0,additionalHeaders:n}).then(function(e){return O.e.hasItemPermission({permissions:e.d.EffectiveBasePermissions},t)})},t.prototype.checkWebEffectivePermissions=function(e,t,n){var a=this,i=t||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(i).then(function(t){var r;return r=t?new I.t({webAbsoluteUrl:i}).build().segment("web").segment("EffectiveBasePermissions"):a._apiUrlHelper.build().method("SP.RemoteWeb",i).segment("web").segment("EffectiveBasePermissions"),a._dataRequestor.getData({url:r.toString(),qosName:"checkWebEffectivePermissions",noRedirect:!0,additionalHeaders:n,authToken:t}).then(function(t){return O.e.hasItemPermission({permissions:t.d.EffectiveBasePermissions},e)})}).catch(function(){return!1})},t.prototype.ensureSiteAssetsAndPermissions=function(e,t){var n=this._apiUrlHelper.build().segment("web").segment("lists").segment("EnsureSiteAssetsLibrary").rawParameter("$expand=EffectiveBasePermissions");return this._dataRequestor.getData({url:n.toString(),qosName:"EnsureSiteAssetsAndPermissions",noRedirect:!0,additionalHeaders:t}).then(function(t){return O.e.hasItemPermission({permissions:t.d.EffectiveBasePermissions},e)})},t.prototype.getListDefaultViewUrlByTitle=function(e,t){var n=this._apiUrlHelper.build().segment("web").segment("lists").method("GetByTitle",e).segment("DefaultView");return this._dataRequestor.getData({url:n.toString(),qosName:"GetListDefaultViewUrlByTitle",noRedirect:!0,additionalHeaders:t}).then(function(e){return e.d.ServerRelativeUrl})},t.prototype.getListIdByTitle=function(e,t){var n=this._apiUrlHelper.build().segment("web").segment("lists").method("GetByTitle",e);return this._dataRequestor.getData({url:n.toString(),qosName:"GetListIdByTitle",noRedirect:!0,additionalHeaders:t}).then(function(e){return e.d.Id})},t.prototype.makeHomePage=function(e){var t={__metadata:{type:"SP.Folder"},WelcomePage:e},n=this._apiUrlHelper.build().segments("web","RootFolder");return this._dataRequestor.getData({url:n.toString(),qosName:"MakeHomepage",additionalPostData:JSON.stringify(t),method:"POST",additionalHeaders:{"x-http-method":"MERGE"}})},t.prototype.setSchedulingFeature=function(e){var t=e?"add":"remove",n=this._apiUrlHelper.build().segments("web","Features","".concat(t,"(guid'E87CA965-5E07-4A23-B007-DDD4B5AFB9C7')"));return this._dataRequestor.getData({url:n.toString(),qosName:"SchedulingFeature",noRedirect:!0}).then(function(t){return{isFeatureActivated:e}})},t.prototype.listPowerPlatformUserDetails=function(){var e=this,t=this._apiUrlHelper.build().segments("web","ListPowerPlatformUserDetails");return this._dataRequestor.getData({url:t.toString(),qosName:"ListPowerPlatformUserDetails",method:"POST",parseResponse:function(t){return e._processPowerPlatformSyncResult(t)}})},t.prototype.consentToPowerPlatform=function(){var e=this,t=this._apiUrlHelper.build().segments("web","ConsentToPowerPlatform");return this._dataRequestor.getData({url:t.toString(),qosName:"ConsentToPowerPlatform",method:"POST",parseResponse:function(t){return e._processPowerPlatformSyncResult(t)}})},t.prototype._processDocLibData=function(e,t){var n=e.d[t],a=[];return n&&n.results&&(a=n.results.map(function(e){return{title:e.Title,target:e.ServerRelativeUrl,customSettingsUrl:e.AbsoluteUrl,remote:e.FromCrossFarm,id:e.Id}})),a},t.prototype._processData=function(e){for(var t,n={},a=0,i=e.d.query.PrimaryQueryResult.RelevantResults.Table.Rows.results;a<i.length;a++){var r=i[a],d=o.getProperties(r.Cells),u=new p.t(d.Path),m=this._urlDataSourceLite.getKey(((t={})[f.n.idParamKey]=u.getPath(),t[f.n.uniqueParamKey]="search".concat(d.UniqueID||""),t)),_=new s.e(m);_.id=b.e.normalizeUpper(d.WebId,!1),_.name=d.Filename,_.parentLink=d.ParentLink,_.displayName=d.Title,_.isPlaceholder=!1,_.type=c.e.Unknown,_.dateModified=Object(l.r)(new Date(d.LastModifiedTime)),_.openUrl=d.LinkingUrl||d.Path,_.statistics=o.getItemStatistics(d),_.itemFromServer=d,n[_.id]=_}return n},t.prototype._processPowerPlatformSyncResult=function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;try{var n=JSON.parse(e);t.synchronizationDataObject=n.d.SynchronizationData,t.synchronizationStatus=n.d.SynchronizationStatus}catch(e){E.e.logError(e,{eventName:"PowerPlatformResponseParsingFailure",feature:"BizAppsForListTemplates"})}return t},t.prototype._isSupportedBaseTemplate=function(e,t){var n=e===S.t.genericList||e===S.t.survey||e===S.t.links||e===S.t.announcements||e===S.t.contacts||e===S.t.tasks||e===S.t.customGrid||e===S.t.issueTracking;return t?n||e===S.t.documentLibrary:n},t.prototype._getTokenIfNecessary=function(e){return this._itemUrlHelper.getUrlParts({webUrl:e,path:e}).isCrossDomain?this._identityDataSource.getSharePointToken(new D.e(e).authority).then(function(e){return e.accessToken}):u.n.resolve("")},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{pageContext:_.f,itemsStore:d.t,apiUrlHelper:h.e,itemUrlHelper:x.c,dataRequestorType:r.t,urlDataSourceLite:m.fe,identityDataSource:C.a}),t}(i.default);t.default=P;var T=Object(g.r)("WebDataSource",P)},,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return r});var a=n(5478),i=n(388),r=new(n(8).t)({name:"GroupsProvider",factory:{dependencies:{pageContext:i.e},create:function(e){return{instance:new a.t({pageContext:e.pageContext})}}}})}],Array(19),[function(e,t,n){"use strict";n.r(t),n.d(t,"ShowInfoPaneAction",function(){return r});var a=n(311),i=n(2408),r=Object(i.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(a.e);return new(e.injected(t.ShowPropertiesAction))({useToggleBehavior:!1})},{isToggleable:!1})},function(e,t,n){"use strict";n.r(t),n.d(t,"CopyFieldAction",function(){return h}),n.d(t,"EditItemAction",function(){return g}),n.d(t,"ViewItemAction",function(){return v});var a=n(0),i=n(311),r=n(2408),o=n(12),s=n(80),c=n(45),d=n(14),l=n(31),u=n(121),f=n(1),p=n(37),m=n(5),_=n(11),h=Object(r.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(i.e);return new(e.injected(t.CopyFieldAction))});function b(e,t){var n=Object(c.e)(e,t),a=e.demandItemFacet(l.e,t),i=a&&u.e.serialize(a),r=i&&e.demandItemFacet(f.We,i),o=r&&r.templateType===d.n.mySiteDocumentLibrary;return{isAvailable:!!n&&!n.isAnonymousGuestUser&&!o,pageContext:n,listContext:r}}var g=Object(o.r)()(Object(s.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("deferred"),n.e("deferred.odsp-common"),n.e(788)]).then(n.bind(null,2023))];case 1:return[2,e.sent().EditItemAction]}})})},function(e,t){var n=t.itemKeys;if(!n||n.length<1)return!1;var a=b(e,n[0]),i=a.isAvailable,r=a.listContext;if(!i)return!1;if(r&&r.isDocumentLibrary&&n.length<=1)return!1;if(!_.e.isActivated("0F378815-7F92-48A5-B9E3-A127BEB75AC6","11/9/2020","disable bulk edit when list disableGridEditing is true")&&r&&!0===r.disableGridEditing&&n.length>1)return!1;for(var o=0,s=n;o<s.length;o++){var c=s[o],d=e.demandItemFacet(f.St,c);if(!(i=p.t.hasItemPermission({permissions:d},p.t.editListItems)))break}return!!i})),v=Object(o.r)()(Object(o.a)()(Object(s.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return _.e.isActivated("f96c87d5-d38d-4ca4-b2e7-a1ef3b171359","2/1/2022","Re-expose pagecontext to ViewItemAction")?[4,Promise.all([n.e("deferred.resx-deferred"),n.e(194)]).then(n.bind(null,4991))]:[3,2];case 1:return[2,e.sent().ViewItemAction];case 2:return[4,Promise.all([n.e("deferred.resx-deferred"),n.e(194)]).then(n.bind(null,4991))];case 3:return[2,e.sent().ViewItemActionWithResourceScope]}})})},function(e,t){var n=t.itemKey,a=t.preferredSection;if(!n)return!1;var i=b(e,n),r=i.isAvailable,o=i.listContext;return"comments"===a?r&&(null==o?void 0:o.templateType)===d.n.genericList&&!e.demandItemFacet(m.h,n):r})))}],Array(157),[function(e,t,n){"use strict";n.d(t,"n",function(){return m}),n.d(t,"e",function(){return _});var a=n(0),i=(n(4418),n(2175)),r=n(8);n.d(t,"t",function(){return r.t});var o=n(2418),s=n(54),c=n(4803),d=n(358),l=n(90),u=n("knockout-lib"),f=n(3849);n.d(t,"i",function(){return f.e});var p=function(){function e(e){var t=e.viewModelType;this.dependencies=Object(a.__assign)(Object(a.__assign)({},t.dependencies||{}),e.dependencies||{}),this._automationName=e.automationName,this._viewModelType=e.viewModelType,this._template=e.template}return e.prototype.create=function(e){var t=this,n=e.resources,i=function(t){function i(i){return t.call(this,i,Object(a.__assign)(Object(a.__assign)({},e||{}),{resources:new r.n(n)}))||this}return Object(a.__extends)(i,t),i}(this._viewModelType),o=function(){return t._getTemplateNodes()},s=this._automationName;return{instance:new(function(){function e(){}return e.prototype.toSpecification=function(e){return{automationName:s,viewModelType:i,getTemplateNodes:o,params:e}},e}())}},e.prototype._getTemplateNodes=function(){var e=u.utils.parseHtmlFragment(this._template);return this._getTemplateNodes=function(){return e},e},e}();function m(e){return new r.t({name:e.name,factory:new p({template:e.template,automationName:e.automationName,viewModelType:e.viewModelType,dependencies:e.dependencies})})}var _=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.controlsDescendantBindings=!0;var i=a.element;return a._transcludedTemplateNodes=Array.prototype.slice.call(u.virtualElements.childNodes(i)),u.virtualElements.emptyNode(i),a._resolvedSpecification=a._getResolvedSpecification(),a._initializeRenderComponent(),a}return Object(a.__extends)(t,e),t.prototype._getResolvedSpecification=function(){var e=this,t=this.resources,n=this.observables,i=n.create();i.equalityComparer=h;var r=new o.e;return n.compute(function(){var o,c,d,u=e.valueAccessor();b(u)?(o=n.unwrap(u.specification),c=u.placeholder,d=u.error):o=n.unwrap(u),e.observables.ignore(function(){var n;if(o)if(g(o)){var u=o.params,f=o.definitionKey.local,p=t.consume(f.optional);if(p)i(p.toSpecification(u));else{if(c)if(g(c)){var m=t.consume(c.definitionKey.optional.local);m&&i(Object(a.__assign)(Object(a.__assign)({},m.toSpecification(c.params)),{isPlaceholder:!0}))}else i(Object(a.__assign)(Object(a.__assign)({},c),{isPlaceholder:!0}));n=s.n.resolve(t.consumeAsync(f)).then(function(e){return e.toSpecification(u)})}}else i(o);else i(void 0);r.debounce(n?e.trackPromise(n.then(function(e){i(e)},function(e){if(!s.n.isCanceled(e)&&(l.e.log(e),d))if(g(d)){var n=t.consume(d.definitionKey.optional.local);n&&i(Object(a.__assign)(Object(a.__assign)({},n.toSpecification(Object(a.__assign)(Object(a.__assign)({},d.params),{error:e}))),{isError:!0}))}else i(Object(a.__assign)(Object(a.__assign)({},d),{params:Object(a.__assign)(Object(a.__assign)({},d.params),{error:e}),isError:!0}))})):s.n.wrap())})}),i},t.prototype._initializeRenderComponent=function(){var e,t=this,n=this.element,a=this.observables,i=this._transcludedTemplateNodes;a.compute(function(){var a=t._resolvedSpecification();t.observables.ignore(function(){if(e&&(e.dispose(),u.virtualElements.emptyNode(n)),a){var r=a.getTemplateNodes().map(function(e){return e.cloneNode(!0)}),o=(e=t.scope.attach(new d.e)).attach(new a.viewModelType(a.params));e.attach(new c.e({viewModel:o,element:n,bindingContext:t.bindingContext,name:a.automationName}));for(var s=t.bindingContext.createChildContext(o,void 0,function(e){e.$component=o,e.$componentTemplateNodes=i}),l=document.createDocumentFragment(),f=0,p=r;f<p.length;f++){var m=p[f];l.appendChild(m)}u.virtualElements.setDomNodeChildren(n,[l]),u.applyBindingsToDescendants(s,n);var _=t.valueAccessor();if(b(_)){var h=_.afterRender;!h||a.isPlaceholder||a.isError||h()}}})})},t.supportsVirtualElements=!0,t}(i.t);function h(e,t){return!e&&!t||e===t||!(!e||!t)&&e.getTemplateNodes===t.getTemplateNodes&&e.viewModelType===t.viewModelType&&e.params===t.params}function b(e){return!!e&&"object"==typeof e&&"specification"in e}function g(e){return!!e.definitionKey}t.a=_},,,,,,function(e,t,n){"use strict";var a=n(0),i=n(1477),r=n(874),o=n(1203),s=n(101),c=n(54),d=n(90),l=n(91),u=n(38),f=n(70),p=n(421),m=n(535),_=n(29),h=n(1975),b=n(98),g=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="BaseAction";var i=a,r=i.resources,o=i.observables,c=n.urlDataSource,d=void 0===c?r.consume(s.ue.optional):c,l=n.instrumentationProvider,u=void 0===l?r.consume(p.r.optional):l;a._BaseAction_urlDataSource=d,a._BaseAction_instrumentationProvider=u,a.isQosLogged=!0,a.logStartEnd=!1,a.enableCustomerPromiseLogging=!1,a._executingInstanceCount=o.create(0);var f={deferEvaluation:!0};return a.isAvailable=o.pureCompute(a._computeIsAvailable,f),a.isToggled=o.pureCompute(a._computeIsToggled,f),a.isExecuting=o.pureCompute(a._computeIsExecuting,f),a}return Object(a.__extends)(t,e),t.prototype.execute=function(e){var t,n,a=this,i=this.isQosLogged?this.onCreateQosEvent(e):void 0,r=i?this.getEngagement():void 0;try{if(i&&(this._logEngagementEvent(i.data.extraData,r),this.trackUserAction(this.name)),!(t=this.instrumentOnExecutionWithCustomerPromise(this.onExecute(e,i))))throw new Error("Action did not return a promise")}catch(e){d.e.log(e),n=e}return t?(this._executingInstanceCount(this._executingInstanceCount.peek()+1),t.then(function(e){a._executingInstanceCount(a._executingInstanceCount.peek()-1),i&&i.end(e)},function(t){a._executingInstanceCount(a._executingInstanceCount.peek()-1),t&&!c.n.isCanceled(t)&&d.e.log(t),i&&i.end(a.onCreateErrorEventArg(e,t,!1))})):(i&&i.end(this.onCreateErrorEventArg(e,n,!0)),t=c.n.reject(n)),t},t.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new i.e({name:this.name,pageType:t&&l.e[t.getPageType()]||"",queryType:t&&u.e[t.getQueryType()]||"",logStartEnd:this.logStartEnd})},t.prototype.onCreateErrorEventArg=function(e,t,n){return t&&c.n.isCanceled(t)?{resultType:f.e.ExpectedFailure,resultCode:"Canceled"}:t instanceof _.e?{resultType:t.isExpected?f.e.ExpectedFailure:f.e.Failure,resultCode:t.code,error:t.message,extraData:{CorrelationId:t.correlationId}}:{resultType:f.e.Failure,resultCode:n?"NoPromiseReturned":"PromiseFailed",error:t?"".concat(t.message||""):void 0}},t.prototype.onExecute=function(e,t){var n={resultType:f.e.Failure};return c.n.resolve(n)},t.prototype.instrumentOnExecutionWithCustomerPromise=function(e){var t=e;if(this.enableCustomerPromiseLogging){var n=this._BaseAction_urlDataSource,i=new h.e({scenario:this.name,extraData:{pageType:n&&l.e[n.getPageType()]||"",queryType:n&&u.e[n.getQueryType()]||""}});t=e.then(function(e){var t=e.resultCode,n=e.resultType,r=e.error,o=e.extraData;return i.end({resultType:n,errorCode:t,extraData:Object(a.__assign)(Object(a.__assign)({},o),{error:r})}),e}).catch(function(e){var t;if(c.n.isCanceled(e))t={resultType:f.e.ExpectedFailure,errorCode:"Canceled"};else{var n=Object(b.e)(e),r=n.resultType,o=n.resultCode,s=n.error,d=n.extraData;t={resultType:r,errorCode:o,extraData:Object(a.__assign)(Object(a.__assign)({},d),{error:s})}}throw i.end(t),e})}return t},t.prototype.onIsAvailable=function(){return!0},t.prototype.onIsToggled=function(){return!1},t.prototype.getEngagement=function(){return this.resources.consume(m.e)},t.prototype.trackUserAction=function(e){var t=this._BaseAction_instrumentationProvider;if(t){var n=this.getEngagement();t.userExecuteAction({name:e,engagement:n})}},t.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()},t.prototype._computeIsToggled=function(){return!!this.onIsToggled()},t.prototype._computeIsExecuting=function(){return this._executingInstanceCount()>0},t.prototype._logEngagementEvent=function(e,t){if(void 0===t&&(t=this.isQosLogged?this.getEngagement():void 0),t){var n=this._BaseAction_instrumentationProvider;t.logData({name:this.name,isIntentional:this.isExecutionIntentional,location:"NA",usageType:r.e[r.e.Click],currentPage:n&&n.currentPageName()||"NA",previousPage:n&&n.previousPageName()||"NA",extraData:Object(a.__assign)(Object(a.__assign)({},e||{}),n&&n.getEngagementData()||{})})}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},o.default.dependencies),{urlDataSource:s.ue,instrumentationProvider:p.r.optional}),t}(o.default);t.e=g},,,,,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(a.__extends)(t,e),t}(n(4424).e);t.e=i},,function(e,t,n){"use strict";n.d(t,"t",function(){return u});var a=n(0),i=n(1203),r=n(8),o=n(142),s={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},c={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},d=new r.t({name:"".concat("ResponsiveUI",".breakpoints"),factory:new r.e(c)}),l=function(e){function t(t,n){var a=e.call(this,t,n)||this;a._containerElement=t.containerElement||window;var i=a.observables;return a._breakpoints=i.wrap(n.breakpoints),a.events.on(a._containerElement,"resize, orientationchange",a._onContainerResize),a.windowWidth=i.create(0),a.windowHeight=i.create(0),a.formFactorSize=i.pureCompute(a._computeFormFactorSize),a.isHamburgerVisible=i.pureCompute(a._computeIsHamburgerVisible),a.showLabels=i.pureCompute(a._computeShowLabels),a.cssClass=i.pureCompute(a._computeCssClass),a._onContainerResize(),a}return Object(a.__extends)(t,e),t.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}},t.determineWindowSize=function(e,t){if(void 0===t&&(t=c),0===e)return"Medium";for(var n in c)if(e<t[n])return n},t.determineCssClass=function(e){return s[e]},t.getScrollbarWidth=function(){var e=document.createElement("div"),t=e.style;t.visibility="hidden",t.width="100px",t.msOverflowStyle="scrollbar",document.body.appendChild(e);var n=e.offsetWidth;t.overflow="scroll";var a=document.createElement("div");a.style.width="100%",e.appendChild(a);var i=a.offsetWidth;e.parentNode.removeChild(e);var r=n-i;return this.getScrollbarWidth=function(){return r},r},t.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]},t.prototype._onContainerResize=function(e){var t=this._containerElement,n=document.body,a=document.documentElement,i=t.clientWidth||a.clientWidth||t.innerWidth||n.clientWidth,r=t.clientHeight||a.clientHeight||t.innerHeight||n.clientHeight;this.windowWidth(i),this.windowHeight(r)},t.prototype._computeFormFactorSize=function(){var e=this._breakpoints(),n=this.windowWidth();return this._containerElement===window?t.determineWindowSize(n,e):"Medium"},t.prototype._computeCssClass=function(){return t.determineCssClass(this.formFactorSize())},t.prototype._computeShowLabels=function(){return this.compareSize(this.formFactorSize(),"Medium")>0},t.prototype._computeIsHamburgerVisible=function(){return this.windowWidth()<c.Large},t.dependencies={breakpoints:d},t.DEFAULT_BREAKPOINTS=c,t.MAC_SCROLL_BAR_WIDTH=8,t}(i.default);t.e=l;var u=Object(o.r)("ResponsiveUI",l)},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(2238),i=n(142),r=function(){function e(e,t){this._itemsStore=t.itemsStore}return e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),a=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return a?this._itemsStore.getItem(a):void 0}},e.prototype.getFacetedAncestorOrSelf=function(e,t,n){return void 0===n&&(n=""),this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})},e.prototype.getAncestorOrSelf=function(e,t){for(var n,a=e&&e.key;a;){var i=this._itemsStore.getItem(a),r=i&&i.peek();if(!r)break;if(t(r)){n=i;break}a=r&&(r.parentKey||r.UNSAFE_parent&&r.UNSAFE_parent.key)}return n},e.dependencies={itemsStore:a.t},e}(),o=Object(i.r)("ItemParentHelper",r)},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(54),r=n(1203),o=n(311),s=n(2650),c=n(142),d=n(2693),l=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=a,r=i.resources,c=i.observables,l=n.getCurrentItem,u=void 0===l?r.consume(o.o.lazy.optional):l,f=n.getItemSetSelectionModel,p=void 0===f?r.consume(o.I.lazy.optional):f,m=n.getSelectionHelper,_=void 0===m?r.consume(s.t.lazy.optional):m,h=t.allowMultiSelect,b=void 0!==h&&h,g=t.canFallback,v=void 0!==g&&g,y=t.ignoreSelection,S=void 0!==y&&y,D=t.overrideItem,I=t.useCurrentSelectionGroup,x=void 0!==I&&I;return a._allowMultiSelect=b,a._overrideItem=D,a._ignoreSelection=S,a._useCurrentSelectionGroup=x,a._placeholder=a.observables.create(new d.e),a._getSelectionModel=p,D||(a._selectionHelper=_&&_()),v&&u&&(a._fallback=u()),a.selection=c.pureCompute(a._computeSelection),a.firstItem=c.pureCompute(a._computeFirstItem),a.currentItem=c.pureCompute(function(){return(u&&u()||a._placeholder)()}),a}return Object(a.__extends)(t,e),t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=this.observables,a=0,i=t;a<i.length;a++){var r=i[a],o=n.unwrap(r);if(!o)return!0;if(!e(o))return!1}return!0},t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._fallback){var n=e._fallback.peek();if(n)return[n]}return[]})},t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._fallback?e._fallback.peek():void 0})},t.prototype.selectItems=function(e){var t=this._getSelectionModel();t&&t.setSelectedKeys(e.map(function(e){return e.key}))},t.prototype.clearSelection=function(){var e=this._getSelectionModel();e&&e.clear()},t.prototype.selectAll=function(){var e=this._getSelectionModel();e&&e.selectAll()},t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]},t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()},t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e,t=this._getSelectionModel();if(t){if(this._useCurrentSelectionGroup&&t.getSelectionModelGroup()){var n=t.getSelectionModelGroup().currentSelection();n&&(t=n)}e=t.selection()}else e=[];return(0===e.length||this._ignoreSelection)&&this._fallback&&(e=[this._fallback]),e},t.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return i.n.resolve([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});if(this._ignoreSelection||!t.length)return i.n.resolve([]);var n=this._selectionHelper;return n?n.resolveSelection():i.n.reject(new Error("Unable to resolve selection."))},t}(r.default),u=Object(c.o)("ItemSelectionHelper",l,Object(a.__assign)(Object(a.__assign)({},r.default.dependencies),{currentItem:o.o.lazy.optional,itemSetSelectionModel:o.I.lazy.optional,selectionHelper:s.t.lazy.optional}))},,,,,function(e,t,n){"use strict";var a=n(0),i=n(2175),r=n(188),o=n(2261),s=n(357),c=n(2813),d={Left:"Right",Right:"Left"},l={Esc:!0},u=function(e){function t(n){var a,i=e.call(this,n)||this,r=i.valueAccessor();if(r instanceof Array)for(var s=function(e){return function(){return e}},c=0,d=r;c<d.length;c++)a=d[c],new(i.managed(t))({element:i.element,valueAccessor:s(a),bindingContext:i.bindingContext,allBindingsAccessor:i.allBindingsAccessor});else{if("object"!=typeof r)throw new Error("KeyboardBinding only accepts an object for input. See documentation.");var l=r.mappings&&r||{mappings:r},u=l.target||i.element,f=l.useCapture,p=void 0!==f&&f;i._options=l,i.events.on(u,"keydown",i._onKeyDown,p),i._isActive=l.isActive||i.observables.create(!1),new(i.managed(o.t))({element:i.element,bindingContext:i.bindingContext,allBindingsAccessor:i.allBindingsAccessor,valueAccessor:function(){return{isActive:i._isActive}}})}return i}return Object(a.__extends)(t,e),t.prototype._onKeyDown=function(e){var t=this._options,n=t.allowInputEvents,a=t.allowButtonEvents,i=t.context,o=void 0===i?this.bindingContext.$data:i,u=t.preventDefault,f=t.eventFilter,p=e.target,m=function(e){var t;return t=function(e){var t;if(e>=65&&e<=91)t=String.fromCharCode(e);else switch(e){case 8:t="Backspace";break;case 9:t="Tab";break;case 13:t="Enter";break;case 27:t="Esc";break;case 32:t="Space";break;case 37:t="Left";break;case 38:t="Up";break;case 39:t="Right";break;case 40:t="Down";break;case 46:t="Delete";break;case 113:t="F2";break;case 117:t="F6";break;case 191:t="/";break;case 121:t="F10";break;default:t=""}return t}(e.keyCode),e.metaKey&&(t="Meta"+t),e.ctrlKey&&(t="Ctrl"+t),e.altKey&&(t="Alt"+t),e.shiftKey&&(t="Shift"+t),t}(e),_=!a&&p!==this.element&&c.e(p),h=!l[m]&&!n&&p!==this.element&&c.t(p),b=t.target===document&&!this._isActive.peek(),g=function(e,t){for(;e!==t&&t;){if(t.hasAttribute("data-suppresskeyboardbinding"))return!0;t=t.parentElement}return!1}(this.element,p);if(_||h||b||g)return!0;var v=function(e,t){var n=!!e.useRtlMappings&&s.t.isRightToLeft&&d[t]||t;return e.mappings[n]}(t,m);if(v){if(u&&e.preventDefault&&e.preventDefault(),f&&!f(m,o,e))return!0;for(var y=0,S=v instanceof Array?v:[v];y<S.length;y++)if(!1===S[y].call(o,o,e))return r.t.stopPropagation(e),!1}return!0},t}(i.t);t.e=u},,function(e,t,n){"use strict";var a=function(){function e(){}return e.init=function(e,t,n,a,i){t()(e)},e}();t.e=a},,function(e,t,n){"use strict";n.r(t),n.d(t,"encodeItemSetParentKeyKey",function(){return M}),n.d(t,"resourceKey",function(){return T});var a=n(0),i=(n(1838),n(1203)),r=n(2258),o=n(2693),s=n(2238),c=n(54),d=n(311),l=n(101),u=n(856),f=n(2236),p=n(2507),m=n(2229),_=n(2393),h=n(2995);function b(e,t){for(var n=t.start,a=Math.min(t.end,e.length),i=n;i<a;i++)if(!e[i])return!1;return!0}var g=n(1724),v=n(8),y=n(142),S=n(2274),D=n(383),I=n(2763),x=n("knockout-lib"),C="__next__",O=function(){function e(e,t,n,a){this._context=e,this._store=t,this._isTokenBaseApi=n,this._tokenBasedExtraItemCount=a}return e.prototype.initialize=function(e,t){if(this._skipDataFetch=!1,!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,a=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,a)}e&&e.isExpired&&(this._context.group=null),this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&this._context.group.groupingId!==C&&!this._context.groupReplace,this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&this._context.group.groupingId===C;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup},e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;return n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&b(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length)),n},e.prototype.computeNewChildren=function(e,t,n,a,i){var r,o=!1;if(this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken),r=i&&!n.isExpired?n.content.peek().items:[],e.nextRequestToken?(!t.requestToken&&r.length>e.totalChildren&&(r[e.totalChildren]=null),e.totalChildren+=this._tokenBasedExtraItemCount,this._store.setNextRequestToken(t.parentKey,a,e.nextRequestToken),o=!0,n&&(n.isTokenBasedApi=o)):this._store.setNextRequestToken(t.parentKey,a,"end"),t.requestToken&&(t.startIndex=r.length-this._tokenBasedExtraItemCount,e.totalChildren+=r.length-this._tokenBasedExtraItemCount),this._isFetchingNextGroup||this._isAllCollapsedQuery){var s=e.children.length,c=e.startIndex+s;e.nextRequestToken&&(c+=this._tokenBasedExtraItemCount),e.totalChildren=Math.max(e.totalChildren,Math.max(r.length,c))}if(e.item&&e.totalChildren>=0){var d;this._isExpandingGroup||(r.length>0&&0===e.totalChildren?r=[]:r.length=e.totalChildren),d=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,u=0;l<r.length;l++)l>=d&&u<e.children.length&&(r[l]=this._store.getItem(e.children[u].key),(t.remoteItem||t.isMountPointFolder)&&(r[l].peek().isMountPointFolder=!0,r[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl),u++)}return{allChildren:r,hasNextRequestToken:o}},e.prototype.computeNewGroupings=function(e,t,n,a,i){var r=this._isExpandingGroup?a.group:null,o=a.itemsPerGroup,s=e&&e.length>0?e[0].itemGroups:null,c=null;s&&s.length>0&&s[s.length-1].isPlaceholder&&(c=s.pop());var d=this._mergeGroupings(e,t,i,n);if(r&&d&&(d[0].isAllCollapsed(!1),r.state({isCollapsed:!1})),n&&n.length>0&&!n[n.length-1]&&(s=d&&d.length>0?d[0].itemGroups:null)&&s.length>0){var l=s[s.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var u=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),f=d[0].isAllCollapsed.peek();if(u||this._isFetchingNextGroup||f){var p=l.startIndex+l.count;c?c.startIndex=p:c={groupingId:C,startIndex:p,count:1,isPlaceholder:!0,state:x.observable({isCollapsed:!1})},n.length<p&&(n.length=p+1),s.push(c)}}return d},e.prototype._mergeGroupings=function(e,t,n,a){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var r=0;r<t.length;r++){var o=i[r].isAllCollapsed.peek();i[r].itemGroups=n?this._retainItemGroupState(i[r].itemGroups,t[r].itemGroups):this._mergeItemGroups(i[r].itemGroups,t[r].itemGroups,o,null,a)}}else i=t;return i},e.prototype._mergeItemGroups=function(e,t,n,a,i){var r=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=r[i];if(e.groupingId===o.groupingId){if(s._context.noIndexBasedDataFetch||!s._context.isTokenBasedApi)if(s._context.groupReplace?(o.count+=e.count,o.hasMoreData&&i<r.length-1&&(o.hasMoreData=!1)):o.count=e.count,o.children=s._mergeItemGroups(o.children,e.children,n,o),0===i)o.startIndex=a?a.startIndex:0;else{var c=r[i-1],d=c.startIndex+c.count-o.startIndex;o.startIndex+=d,o.children&&o.children.forEach(function(e){e.startIndex+=d})}else{var l=e.startIndex+s._context.startIndex,u=e.startIndex+s._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l),o.count=Math.max(u,o.startIndex+o.count)-o.startIndex}return t=!0,"break"}},c=0;c<r.length&&"break"!==o(c);c++);if(!t){var d=r[r.length-1],l=d.startIndex+d.count-e.startIndex;e.startIndex+=l,e.children&&e.children.forEach(function(e){e.startIndex+=l});var u=Math.min(e.count,30),f=0;if(i)for(var p=e.startIndex;p<e.startIndex+u;p++)i[p]||f++;f&&(e.emptyItemCount=f),r.push(e)}},s=this,c=0,d=t;c<d.length;c++)o(d[c])}else r=t;return r},e.prototype._retainItemGroupState=function(e,t,n){var a=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},r=0,o=e;r<o.length;r++){var s=o[r];i[s.groupingId]=s}for(var c=0,d=a;c<d.length;c++){var l=d[c],u=i[l.groupingId];u&&(l.state(u.state.peek()),l.children=this._retainItemGroupState(u.children,l.children,u))}}return a},e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var a=t[n];if(!(a&&a.startIndex<=e))break;var i=a.startIndex+a.count-1;if(a.children){if(i>=e)return this._getGroupStartingOnIndex(e,a.children)}else{if(a.startIndex===e)return a.state.peek().isCollapsed?null:a;if(i>=e){var r=n<t.length-1?t[n+1]:null;if(r&&!r.state.peek().isCollapsed)return this._skipDataFetch=!0,null}}}return null},e}(),w=n(85),E=n(3),A=n(1602),L=n(16),k=100,M=new v.t({name:"".concat("ItemProvider",".encodeItemSetParentKey"),factory:new v.e(Object(E.Jr)(E.Mr))}),P=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._registeredProjections={},a._pendingGetItemRequests={},a._store=n.itemsStore,a._operationProvider=n.operationProvider,a._schemaDataSource=n.schemaDataSource,a._updateQuota=n.updateQuota,a._groupThrottle=n.groupThrottle,a._encodeItemSetParentKey=n.encodeItemSetParentKey||!1,a._smartFiltersStore=n.smartFiltersStore,a}return Object(a.__extends)(t,e),t.prototype.getItem=function(e){return this._getItem(e)},t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function a(e,t){t&&(n+="&".concat(e,"=").concat(t))}a("ownerId",e.ownerId),a("groupingType",e.groupingType),n+="&sortField="+(e.sortField||""),n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var r in i)n+="&"+r+"="+i[r];a("groupBy",e.groupBy),a("viewId",e.baseViewId),a("viewXml",e.viewXml),a("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var s="";for(var c in o)s+=c+"_"+o[c];n+="&projection="+s}return e.supportsNestedGroups&&(n+="&ng=1"),n},t.prototype.getSpecifiedItems=function(e){return e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey),this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})},t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,a=this._store.getItem(n),i=this._getItemSet(t,e);if(!a){var r=new o.e(n),s=e.queryType,c=void 0===s?r.queryType:s;r.queryType=c,this._store.setItem(r),a=this._store.getItem(n)}if(!i){var d=a.peek(),l=d&&d.folder,u=l&&l.childCount||0;(i=new h.e(t,e,u)).item=a;var f=e.needSchema;if(void 0===f||f){var p=this._schemaDataSource,m=p&&p.getColumns(d);m&&m.length>0&&i.schema(m)}this._store.setItemSet(t,i)}return i},t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,r=void 0!==i&&i,o=n.emptyAllOtherSets,s=void 0!==o&&o,c=n.refreshSchema,d=void 0!==c&&c,l=n.updateGrouping,u=void 0!==l&&l,f=n.purgeCache,p=void 0!==f&&f;if(s&&this._store.emptyAllOtherSets([e]),d&&(m=this._store.getItemSetFromItemKey(e))&&m.schema([]),u||this._store.invalidateItem(e,{purgeCache:p}),this._smartFiltersStore&&this._smartFiltersStore.invalidate(e),r){var m=this._store.getItemSetFromItemKey(e);this._getItem(Object(a.__assign)(Object(a.__assign)({parentKey:e},m&&m.context||{}),{skipCache:!0,updateGrouping:u}))}},t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return c.n.wrapError(e)})},t.prototype.createDocument=function(e,t,n,a,i){var r=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,a).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),a=n&&n[1];return a?o.updateContentType(e,a,i).then(function(){return r.invalidateItem(e),r._updateQuota(!0),t}):t}return r.invalidateItem(e),r._updateQuota(!0),t})})},t.prototype.createCustomDocument=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.createCustomDocument(e,t,n)}).then(function(t){return t?(a.invalidateItem(e),a._updateQuota(!0),a.getItem({parentKey:e}).then(function(e){return a.peekUnwrapObservable(a._store.getItem(t))})):c.n.wrapError()})},t.prototype.updateBundle=function(e,t){var n=this,a=[new S.e(e.item.key,e.item)];return t.update(a),this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key),a=a.map(function(e){return e.succeed()}),t.update(a)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var r=new Error(i);return a=a.map(function(e){return e.fail(r)}),t.update(a),c.n.wrapError(r)})},t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){return t.invalidateItem(e.parentKey),t.resources.consume(A.e)&&t.resources.consumeAsync(l.k).then(function(t){t.invalidateItems(e.parentKey)}),n})},t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})},t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:m.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),a=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});return n.state(f.e.started),n.progress.maximum(1),a.then(function(e){return n.state(f.e.completed),n.progress.current(1),e},function(e){return n.state(f.e.failed),n.error(new _.e({message:e})),c.n.wrapError(e)})},t.prototype.requestReview=function(e){for(var t=this,n=new p.e,a=e.items.map(function(e){var a=t._operationProvider.register({name:e.name||"",type:m.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});return a.progress.maximum(1),a.progress.current(0),a}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),r=0,o=a;r<o.length;r++)o[r].state(f.e.started);return i.then(function(n){for(var i=0,r=a;i<r.length;i++){var o=r[i];o.progress.current(1),o.state(f.e.completed)}var s=e.items[0].UNSAFE_parent;return s&&t.invalidateItem(s.key),n},function(e){for(var t=0,n=a;t<n.length;t++){var i=n[t];i.error(new _.e({message:e})),i.state(f.e.failed)}return c.n.wrapError(e)})},t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})},t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.addCoverPhotos,this._addCoverPhotos)},t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.removeCoverPhotos,this._removeCoverPhotos)},t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})},t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})},t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})},t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})},t.prototype.updateItemOcrInfo=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.updateItemOcrInfo(e,t,n)}).then(function(t){return a.invalidateItem(e.key,{triggerFetch:!0}),t},function(e){return e})},t.prototype.rotateItems=function(e,t){var n=this,a={},i=e.items.map(function(e){return a[e.key]=new S.e(e.key,e)});return t.update(i),this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()}),t.update(i)},function(e){var r=e.data||[];i=[];for(var o=0,s=r;o<s.length;o++){var c=s[o],d=a[c.key];n._store.setItem(d.input),delete a[c.key],i.push(d.fail(c.error))}for(var l in a)d=a[l],delete a[l],i.push(d.succeed());t.update(i)})},t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t},t.prototype.computeProjectedItemSet=function(e,t,n,a){var i=n.itemSetProjections,r=a?null:this._store.getItemSet(e),o=!r||r.isPlaceholder||r.isExpired||r.version!==t.version;if(!r||o){for(var s in r||((r=new h.e(e,n)).item=t.item,r.isTokenBasedApi=t.isTokenBasedApi,r.isPlaceholder=t.isPlaceholder,r.isExpired=t.isExpired,r.version=t.version),i){var c=this._registeredProjections[s];c&&c.projectItemSet(r,t,i[s])}a||this._store.setItemSet(e,r)}return r},t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})},t.prototype._getItem=function(e){var n,i=this,r=g.e(e),o=this._store;e.keyAlias?(n=this.getItemSync({parentKey:e.keyAlias}).item,e.parentKey=n.peek().key):n=this.getItemSync(e).item;var s=e.skipCache,d=void 0!==s&&s,u=this.getItemSetKey(e),f=e.itemSetProjections?this.getItemSetKey(e,!0):u,p=this._getItemSet(u,e),m=p&&p.content.peek().items,_=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,v=!d&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||b(m,{start:0,end:m.length})),y=e.startIndex,S=void 0===y?0:y,I=e.pageSize,x=void 0===I?k:I,C=e.endIndex||S+x;C=m&&m.length>0&&!_?Math.min(m.length,C):C,S=Math.max(0,Math.min(C,S));var E=L.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")||p&&!p.isExpired?o.getNextRequestToken(f):void 0;e.requestToken="end"===E?"":E;var A=new O(e,o,_,t.TOKEN_BASED_API_EXTRA_ITEMS);A.initialize(p,S);var M=!1,P=p&&p.content.peek();if(!P||1!==P.partialResultStatus&&2!==P.partialResultStatus||(M=!0,1===P.partialResultStatus&&p.content({items:P.items,groupings:P.groupings,partialResultRequestCount:0,partialResultStatus:2})),v&&!M&&A.isResultSetValid(m,{start:S,end:C}))return c.n.wrap(p);if(n&&n.peek().isStub){var T=e.startKey;if(T&&o.getItem(T)){p.content.peek().items=[o.getItem(T)],p.isPlaceholder=!0,p.isExpired=!1;var U=this._schemaDataSource,F=U&&U.getColumns(n.peek());F&&F.length>0&&p.schema(F),p.content.valueHasMutated&&p.content.valueHasMutated()}return c.n.wrap(p)}var H=p&&!p.isExpired&&p.content.peek().groupings;H&&H.length>0&&(e.isGrouped=!0),this._normalizeContext(e,m,S,C,!v);var R=this._getRequestKey(e),N=this._pendingGetItemRequests[R];return N?e.itemSetProjections?N.getPromise().then(function(t){return i.computeProjectedItemSet(u,t,e)}):N.getPromise():(_&&!E&&(e.startIndex=0),this._pendingGetItemRequests[R]=N=new D.e,this.resources.consumeAsync(l.v.bypass).then(function(t){return t.getItem(Object(a.__assign)(Object(a.__assign)({},e),{itemSetKey:u}))}).then(function(t){r.updateContextBasedOnResult&&e.updateContextBasedOnResult&&(r.updateContextBasedOnResult(r,t),e.updateContextBasedOnResult(e,t),u=i.getItemSetKey(r));var a=e.itemSetProjections?i.getItemSetKey(e,!0):u;n=o.getItem(e.parentKey);var s=o.getItemSet(a);v=!(!n||!s);var c=A.computeNewChildren(t,e,s,a,!!v),d=c.allChildren,l=c.hasNextRequestToken;if(l&&(_=l),t.item&&!e.ignoreChildren&&!e.skipStoreResults){v||((s=new h.e(a,e)).item=o.getItem(e.parentKey),s.isTokenBasedApi=_,o.setItemSet(a,s));var f=!!s.isExpired;s.sortField=t.sortField,s.isAscending=t.isAscending,s.isPlaceholder=!1,s.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var m=t.schema;s.schema(m&&m.length>0&&m||[]),t.customViewRenderer?s.customViewRenderer=i.observables.create(t.customViewRenderer):s.customViewRenderer=i.observables.create(void 0)}var y=t.groupings;_&&e.mergeGroupings&&(y=A.computeNewGroupings(s.content.peek().groupings,t.groupings,d,e,f)),t.contentTypes&&s.contentTypes&&s.contentTypes(t.contentTypes);var S=s.content.peek(),D=S.partialResultStatus,I=S.partialResultRequestCount,x=void 0===I?0:I;if(!(y&&y.length&&y[0]))if(l&&(t.children&&t.children.length<30||!t.children)){var C=x+1;C<=5?x=C:D=1}else void 0===D||0===D||l?2===D&&t.children&&30===t.children.length&&(D=0):D=3;s.content({items:d,groupings:y,partialResultRequestCount:x,partialResultStatus:D});var O=s.version,w=void 0===O?0:O;s.version=w+1}if(delete i._pendingGetItemRequests[R],e.requestAllChildren&&!b(d,{start:0,end:t.totalChildren})){var E=g.e(e),L=E.startIndex,M=void 0===L?0:L;return E.startIndex=M+k,i._getItem(E)}return t.isFromBrowserCache?(r.skipCache=!0,i._getItem(r)):(e.itemSetProjections&&(s=i.computeProjectedItemSet(u,s,e)),s)},function(e){return delete i._pendingGetItemRequests[R],c.n.wrapError(e)}).then(function(e){N.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(w.t.queryThrottled)&&!e.noGroupReplace?i._groupThrottle(!0):N.error(t)}),N.getPromise())},t.prototype._normalizeContext=function(e,t,n,a,i){var r=e.pageSize||k;if(!e.avoidSeamSnapping){if(!i&&n-n%r!=a-a%r&&t)for(;n<a&&t[n];)n++;e.startIndex=n-n%r}"number"!=typeof e.pageSize&&(e.pageSize=k);for(var o=e.startIndex,s=void 0===o?0:o;a-s>e.pageSize;)e.pageSize+=k},t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);return e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex,t+"&pageSize="+e.pageSize},t.prototype._getItemSet=function(e,t){var n=this._store,a=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),r=n.getItemSet(i);r&&(a=this.computeProjectedItemSet(e,r,t))}return a},t.prototype._updateCoverPhotos=function(e,t,n){for(var a=this,i=new p.e,r=e.target,o=e.items.map(function(e){var n=a._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:r,item:e}},iconName:e.iconName,batch:i});return n.progress.maximum(1),n.progress.current(0),n}),s=n.call(this,e),c=0,d=o;c<d.length;c++)d[c].state(f.e.started);return s.then(function(t){a.invalidateItem(r.key),(null==e?void 0:e.itemsScopeInvalidate)&&a.resources.consumeAsync(l.k).then(function(e){e.invalidateItems(null==r?void 0:r.key)});for(var n=0,i=o;n<i.length;n++){var s=i[n];s.progress.current(1),s.state(f.e.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++)t[e].state(f.e.failed)})},t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})},t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})},t.prototype._getItemDataSource=function(){return c.n.resolve(this.resources.consumeAsync(l.T))},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{groupThrottle:d.h.optional,schemaDataSource:l.Y.optional,itemsStore:s.t,operationProvider:r.resourceKey,smartFiltersStore:u.e.optional,updateQuota:I.e,encodeItemSetParentKey:M.optional}),t.TOKEN_BASED_API_EXTRA_ITEMS=2,t}(i.default),T=(t.default=P,Object(y.r)("ItemProvider",P))},function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(1203),r=n(142),o=n("knockout-lib"),s=n(54),c=n(383),d=n(136),l=n(2859),u=function(){this.icon=null,this.isAvailable=o.observable(!0),this.isVisible=o.observable(!0),this.isDefault=!1,this.automationId="",this.instrumentationId="",this.isExecuting=o.observable(!1),this.isLink=!1,this.execute=function(){return s.n.wrap(1)}},f=function(e){function t(t){var n=e.call(this,t)||this;n.state=o.observable(1);var a=t.title,i=t.titleAction,r=t.titleIcon,s=t.titleIconAriaLabel,d=t.customCssClasses,f=t.actions,p=void 0===f?[]:f,m=t.component,_=t.control,h=t.isDismissable,b=void 0===h||h,g=t.isSoftDismissable,v=void 0===g||g,y=t.isDismissableOnResize,S=void 0!==y&&y,D=t.isDismissableOnScroll,I=void 0!==D&&D,x=t.size,C=void 0===x?"Small":x,O=t.automationId,w=t.executeDefaultAction,E=void 0===w||w,A=t.isCallout,L=t.isOverlayHidden,k=void 0!==L&&L,M=t.overlayColor,P=void 0===M?"rgba(255,255,255,.4)":M,T=t.invokerEvent,U=t.calloutHeight,F=t.instrumentationId,H=void 0===F?"":F,R=t.shouldPreserveFocus,N=void 0===R||R,B=t.stayAsPopup,j=void 0!==B&&B,V=t.template,z=void 0===V?1:V,G=t.style,K=void 0===G?l.e.normal:G,W=t.focusOnPrimaryAction,q=void 0!==W&&W,Q=t.dismissOnEsc,Y=void 0!==Q&&Q;n.title=o.isObservable(a)?a:o.observable(a),n.titleAction=i,n.titleIcon=r,n.titleIconAriaLabel=s,n.customCssClasses=d,n.actions=p,n.component=m,n.control=_,n.isDismissable=b,n.isSoftDismissable=v,n.isDismissableOnResize=S,n.isDismissableOnScroll=I,n.size=C,n.automationId=O||"",n.executeDefaultAction=E,n.isCallout=!!A&&!!T,n.isOverlayHidden=k,n.overlayColor=P,n.invokerEvent=T,n.calloutHeight=U,n.instrumentationId=H,n.shouldPreserveFocus=o.isObservable(N)?N:o.observable(N),n.stayAsPopup=j,n.template=z,n.style=K,n.focusOnPrimaryAction=q,n.dismissOnEsc=Y,n.actions=n.actions.map(function(e){return o.utils.extend(new u,e)}),n.actionsVisible=n.createComputed(function(){for(var e=!1,t=0,a=n.actions;t<a.length;t++)a[t].isVisible()&&(e=!0);return e},{disposeWhen:function(){return 1!==n.state()}});var J=new c.e;return n.createComputed(function(){var e=n.state();1!==e&&(2===e?J.complete():J.cancel())}),n._promise=J.getPromise(),n.events.on(document,"keydown",n._keyDownEvent),n}return Object(a.__extends)(t,e),t.prototype.complete=function(){this.state(2)},t.prototype.dismiss=function(){this.state(3)},t.prototype.wait=function(){return this._promise},t.prototype._keyDownEvent=function(e){e.keyCode===d.e.escape&&this.dismissOnEsc&&this.state(3)},t}(i.default),p=n(2435),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._dialogs=[],a.currentDialog=a.observables.create(),a._needsOverlayContent=n.needsOverlayContent,a}return Object(a.__extends)(t,e),t.prototype.requestDialog=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=this._dialogs;if(e.maxOneDialog&&t.length>0)return t[0];var n=this.currentDialog,a=new f(e);e.queueDialog?(t.push(a),1===t.length&&n(a)):(t.unshift(a),n(a));var i=function(){var e=t.indexOf(a);e>=0&&(t.splice(e,1),n(t[0])),a.dispose()};return a.wait().then(i,i),a},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{needsOverlayContent:p.e}),t}(i.default),_=Object(r.r)("DialogProvider",m)},,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return!1!==t.valueAccessor()&&n.element.setAttribute("data-is-scrollable","true"),n}return Object(a.__extends)(t,e),t}(n(2175).t);function r(e){for(var t=e;t&&t!==document.body;){if(t.getAttribute&&"true"===t.getAttribute("data-is-scrollable"))return t;t=t.parentElement}return t&&t!==document.body||(t=window),t}t.e=i}],Array(18),[function(e,t,n){"use strict";var a;!function(e){e[e.multiple=0]="multiple",e[e.renameItems=1]="renameItems",e[e.deleteItems=2]="deleteItems",e[e.pointInTimeRestore=3]="pointInTimeRestore",e[e.restoreItems=4]="restoreItems",e[e.uploadItems=5]="uploadItems",e[e.moveItems=6]="moveItems",e[e.copyItems=7]="copyItems",e[e.rotateItems=8]="rotateItems",e[e.addItemsToAlbum=9]="addItemsToAlbum",e[e.addCoverPhotos=10]="addCoverPhotos",e[e.removeCoverPhotos=11]="removeCoverPhotos",e[e.createAlbumFromFolder=12]="createAlbumFromFolder",e[e.createColumn=13]="createColumn",e[e.editColumn=14]="editColumn",e[e.deleteColumn=15]="deleteColumn",e[e.checkInItem=16]="checkInItem",e[e.checkOutItem=17]="checkOutItem",e[e.undoCheckOutItem=18]="undoCheckOutItem",e[e.createFolder=19]="createFolder",e[e.updateBundle=20]="updateBundle",e[e.shareItem=21]="shareItem",e[e.reportAbuse=22]="reportAbuse",e[e.requestReview=23]="requestReview",e[e.setAlbumCoverPhoto=24]="setAlbumCoverPhoto",e[e.createAlbum=25]="createAlbum",e[e.uploadVideos=26]="uploadVideos",e[e.saveItem=27]="saveItem",e[e.createItem=28]="createItem",e[e.publishItem=29]="publishItem",e[e.unPublishItem=30]="unPublishItem",e[e.applyOfficeLens=31]="applyOfficeLens",e[e.removeOfficeLens=32]="removeOfficeLens",e[e.updateMetadata=33]="updateMetadata",e[e.makeHomepage=34]="makeHomepage",e[e.triggerFlow=35]="triggerFlow",e[e.downloadAsZip=36]="downloadAsZip",e[e.saveAutoAlbum=37]="saveAutoAlbum",e[e.discardAutoAlbum=38]="discardAutoAlbum",e[e.addToOneDrive=39]="addToOneDrive",e[e.removeFromSharedList=40]="removeFromSharedList",e[e.setupApprovalFlow=41]="setupApprovalFlow",e[e.setupReminderFlow=42]="setupReminderFlow",e[e.sharepointPointInTimeRestore=43]="sharepointPointInTimeRestore",e[e.sharingReport=44]="sharingReport",e[e.editViewColumns=45]="editViewColumns",e[e.runModelOnItems=46]="runModelOnItems",e[e.importModel=47]="importModel",e[e.downloadItem=48]="downloadItem",e[e.deleteSmartTemplate=49]="deleteSmartTemplate",e[e.publishSmartTemplate=50]="publishSmartTemplate",e[e.unpublishSmartTemplate=51]="unpublishSmartTemplate",e[e.universalAnnotationSync=52]="universalAnnotationSync"}(a||(a={})),t.e=a},function(e,t,n){"use strict";var a=n(0),i=n(2175),r=n(4808),o=n("knockout-lib"),s=function(e){function t(t){var n=e.call(this,t)||this;new(n.managed(r.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return n._onReceiveComponentParentContext.bind(n)}});var a=n._componentParentContent,i=n.valueAccessor(),s=function(e){return"object"==typeof e}(i)?i:{},c=s.data,d=void 0===c?n.bindingContext.$data:c,l=s.afterRender;return o.applyBindingsToNode(n.element,{template:{nodes:a.templateNodes,afterRender:l}},a.bindingContext.extend({$host:d,$hostContext:n.bindingContext})),n.controlsDescendantBindings=!0,n}return Object(a.__extends)(t,e),t.prototype._onReceiveComponentParentContext=function(e){this._componentParentContent=e},t.supportsVirtualElements=!0,t}(i.t);t.e=s},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(0),i=n(2175),r=n(54),o=n(383),s=n(1103),c=n(1206),d=n("react-lib"),l=n("react-dom-lib"),u=n(63),f=n("knockout-lib"),p=n(316),m=n(2418),_=n(62),h=n(3258),b=n(90),g=n(818),v=n(551),y=n(3040),S=n(4426),D=new(function(){function e(){this._promises={}}return e.prototype.load=function(e){var t=e.path,n=e.getModule,a=window.require.toUrl("".concat(t,"_unmapped")),i=this._promises,c=i[a];c||(c=i[a]=r.n.as(Object(s.e)({path:t,getModule:n}))).done(void 0,function(e){delete i[a]});var d=new o.e;return c.done(function(e){return d.complete(e)},function(e){return d.error(e)}),d.getPromise()},e.prototype._loadSync=function(e,t){var n;if(t.defined&&t.defined(e)){var a=t(e);if(a)if("object"==typeof a){if(Object.keys(a).length>0){var i=Object(c.e)(a);i&&(n=i)}}else n=a}return n},e}());function I(e){var t=e.applyBindings,n=e.bindingContext,i=e.children,r=Object(a.__rest)(e,["applyBindings","bindingContext","children"]),o=d.useRef(null),s=Object(S.e)(),c=s[0],l=s[1],u=Object(y.t)({children:i}),p=d.useCallback(function(e){return d.createElement(d.Fragment,null,e.children)},[]),m=d.useRef(),_=d.useRef(!1);d.useEffect(function(){if(o.current&&t&&!_.current){if(i){var e=document.createElement("div");e.setAttribute("data-bind","react: Children"),o.current.appendChild(e)}var r=n||function(){var e=document.createElement("div");f.applyBindings({},e);var t=f.contextFor(e);return f.removeNode(e),t}(),s=t(o.current,r.extend(Object(a.__assign)({$react:c},i?{$data:{bindingHandlers:{react:x},Children:{componentType:p,props:u}}}:{})));m.current=function(){s&&s.dispose(),o.current&&f.cleanNode(o.current)}}},[]),d.useLayoutEffect(function(){return function(){_.current=!0;var e=m.current;e&&e()}},[]);var h=Object(v.e)(function(){return d.createElement("div",Object(a.__assign)({key:"root",ref:o,role:"presentation","data-is-ko-react-root":"true"},r))},r);return d.createElement(d.Fragment,null,h,l)}var x=function(e){function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var a,i=n.observables;if(n._value=i.pureCompute(function(){return i.unwrap(n.valueAccessor())}),n._value.peek().useDOMContext){var o=Object(g.e)(n.element,function(e){return"true"===e.getAttribute("data-is-ko-react-root")});o&&(a=f.contextFor(o))}else a=n.bindingContext;n._context=a&&a.$react,n._transcludedTemplateNodes=Array.prototype.slice.call(f.virtualElements.childNodes(n.element)),f.virtualElements.emptyNode(n.element),n._renderDependencies=n.createObservable(),n._componentProps=i.pureCompute(function(){return i.unwrap(n._value().props)}),n._componentProps.equalityComparer=p.t,n._rootProps=i.pureCompute(function(){return i.unwrap(n._value().rootProps)}),n._rootProps.equalityComparer=p.t;var s=n.scope.attach(new m.e);return n.createComputed(function(){var e,t=n._value();if(function(e){return!!e.componentType}(t)){var a=n.observables.unwrap(t.componentType);n._componentNameForLogging=a.displayName||"",u.n.mark("EUPL.ReactBinding.LoadStart.".concat(n._componentNameForLogging)),e=r.n.wrap(a)}else t.getModule||console.error("ReactBinding instantiated with componentPath ".concat(t.componentPath," but missing getModule")),n._componentNameForLogging=t.componentPath,u.n.mark("EUPL.ReactBinding.LoadStart.".concat(n._componentNameForLogging)),e=D.load({path:t.componentPath,getModule:t.getModule});n.trackPromise(s.debounce(r.n.all({componentType:e}).then(function(e){u.n.mark("EUPL.ReactBinding.Loaded.".concat(n._componentNameForLogging));var t=n._context;n.addDisposable({dispose:t?function(){t.unmount(n.element)}:function(){l.unmountComponentAtNode(n.element)}}),n._renderDependencies(e)})))}),n.createComputed(n._computeRenderComponent),n}return Object(a.__extends)(t,e),t.prototype._computeRenderComponent=function(){var e=this,t=this._renderDependencies();if(t){var n=t.componentType,i=this._componentProps(),r=this._rootProps(),o=this._transcludedTemplateNodes;u.n.mark("EUPL.ReactBinding.AsyncRender.".concat(this._componentNameForLogging));try{this.observables.ignore(function(){var t=o.length>0?function(e,t){f.applyBindingsToNode(e,{template:{nodes:o}},t)}:void 0,s=d.createElement(_.e,{resources:e.resources},d.createElement(h.e,{onError:function(t){var n=e._value.peek().error;n&&n(t)},componentName:e._componentNameForLogging},d.createElement(n,Object(a.__assign)({},Object(a.__assign)(Object(a.__assign)({},i),t?{children:d.createElement(I,Object(a.__assign)({bindingContext:e.bindingContext,applyBindings:t},r||{}))}:{})))));e._context?e._context.render(s,e.element):l.render(s,e.element)})}catch(e){b.e.logError(e)}}},t}(i.t);t.t=x},,function(e,t,n){"use strict";var a;!function(e){e[e.created=0]="created",e[e.started=1]="started",e[e.completed=2]="completed",e[e.failed=3]="failed",e[e.canceled=4]="canceled",e[e.expired=5]="expired"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(2173),r=n(2234),o=function(e){function t(t,n){var i=e.call(this,t)||this,o=Object(a.__assign)(Object(a.__assign)({},t.props||{}),{hostViewModel:i});return i.addBindingHandlers({react:r.t}),i.reactBindingParams=Object(a.__assign)({props:o,error:t.error},function(e){return"string"==typeof e.component}(t)?{componentPath:t.component,getModule:t.getComponentModule}:{componentType:t.component}),i}return Object(a.__extends)(t,e),t}(i.e);function s(e,t,n,i){return{tagName:e,template:'<div data-bind="react:reactBindingParams"></div>',viewModel:{createViewModel:function(e,r){return new(e.resources.injected(o))(Object(a.__assign)(Object(a.__assign)({},"string"==typeof t?{component:t,getComponentModule:n}:{component:t}),{error:e.reactRenderError,props:Object(a.__assign)(Object(a.__assign)({},i||{}),e)}),r)}},synchronous:!0}}},function(e,t,n){"use strict";n.d(t,"t",function(){return I});var a=n(0),i=n(2693),r=n(226),o=n(655),s=n(8),c=n(142),d=n(489),l=n(971),u=n(253),f=n(4212),p=n(1334),m=n(43),_=Object(m.isFeatureEnabled)(m.ReadOnlyItemsStore),h="token=",b="result=",g="item_write=",v="item=";function y(e){return e&&e.item&&e.item.peek().key}function S(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null,n.items=[],t.valueHasMutated()}var D=function(e){function t(){var t=e.call(this,"ItemsStore")||this;return t._itemSetsKeys={},t._observables=new o.e({owner:t}),t._vaultItemsToPurge=[],window.odstore=t,t}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this._observables.dispose()},t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(a.__spreadArray)([e],t,!1))},t.prototype.getItem=function(e){return this.getValue(v+e)},t.prototype.setItemSet=function(e,t){var n=b+e;this.setValue(n,t),this._itemSetsKeys[n]=1},t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var a=(t=this.getValue(n)).content&&t.content.peek(),i=a&&a.items;if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r];if(s&&s.peek().parentKey===e)return t}}},t.prototype.getItemSet=function(e){return this.getValue(b+e)},t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice(b.length));return e},t.prototype.setNextRequestToken=function(e,t,n){var a=h+t;n?this.setValue(a,n):this.remove(a)},t.prototype.getNextRequestToken=function(e){return this.getValue(h+e)},t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,a=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),a)},t.prototype.invalidateItemSet=function(e){var t=this.getValue(b+e);t&&S(t)},t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&S(t)},t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a),r=i&&i.locationFilter;r&&r.indexOf(e)>=0&&(t.isExpired=!0)}}},t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a);i&&i.tagFilter===e&&(t.isExpired=!0)}}},t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();n&&n.key&&n.key.indexOf("allmyphotos")>=0&&(e.isExpired=!0,this._invalidateItem(n))}},t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(a.__spreadArray)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],r=void 0;n.vault&&n.vault.root&&((r=new i.e(n.key)).name=n.name,r.displayName=n.displayName,r.dateModified=" ",r.folder={},r.vault={isLocked:!0,root:{}}),this._purgeItem(n,r)}this._vaultItemsToPurge=[]},t.prototype._handleItemInvalidation=function(e,t,n){var a=this;if(t){var i=t.peek(),r=!1,o=[];if(i)switch(o.push(i),i.type){case u.e.Folder:case u.e.Media:r=!0}for(var s in this._itemSetsKeys){var c=this.getValue(s),d=c.item&&c.item.peek(),l=d&&d.key;l&&(l===e||r&&l.indexOf("allmyphotos")>-1)&&(l===e?this.setNextRequestToken(e,c.key,""):o.push(d),c.isExpired=!0)}o.forEach(n?function(e){return a._purgeItem(e)}:function(e){return a._invalidateItem(e)})}},t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)},t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e),Object(p.default)(t,{revision:e.revision+1}),this.setItem(t)},t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];_&&!Object.isFrozen(e)&&Object.freeze(e),e.vault&&this._vaultItemsToPurge.push(e);for(var r=function(t){var n="".concat(v).concat(t),a=_?"".concat(g).concat(t):n,r=o.getValue(n),s=o.getValue(a);s?s(e):((s=o._observables.create(e)).equalityComparer=l.n,o.setValue(a,s),r=_?o._observables.pureCompute(function(){return s()}):s,o.setValue(n,r)),i.push(r)},o=this,s=0,c=Object(f.e)(Object(a.__spreadArray)([e.key],t,!0));s<c.length;s++){var d=c[s];r(d)}return i[0]},t}(r.e),I=new s.t({name:"ItemsStore",factory:new c.i(D)});t.e=D},function(e,t,n){"use strict";n.d(t,"t",function(){return c});var a=n(0),i=n(1203),r=n(3859),o=n(142),s=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.itemCommandProvider,o=void 0===i?a.resources.consume(r.e):i;return a._itemCommandProvider=o,a}return Object(a.__extends)(t,e),t.prototype.isCommandSupported=function(e,t){var n=this._itemCommandProvider;return!n||!!n.getCommand(e,t)},t.prototype.getCommandBehavior=function(e,t){var n=this._itemCommandProvider,a=n&&n.getCommand(e,t);return a&&a.behavior},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{itemCommandProvider:r.e}),t}(i.default);t.e=s;var c=Object(o.r)("ItemCommandHelper",s)},,,,,,function(e,t,n){"use strict";var a=n(3025),i=n(2174),r=n(0),o=n(2173),s=n(2860),c=n(2200),d=n(2230),l=n(1203),u=n("knockout-lib"),f=function(e){function t(t){var n=e.call(this,{})||this,a=t.topTab,i=t.bottomTab,r=t.animation,o=void 0===r?{}:r,s=t.alignToParent,c=void 0===s?u.observable(!0):s,d=t.parentElement,l=t.isOpen;return n.topTab=a,n.bottomTab=i,n.animation=o,n.alignToParent=c,n.parentElement=d,n.isOpen=l,n}return Object(r.__extends)(t,e),t}(l.default),p=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var i=e.call(this,t,n)||this;i.transclusionContentTagName=a.e.tagName;var r=n.overlayProvider,o=void 0===r?i.resources.consume(s.e):r,l=t.animation,u=t.alignToParent,p=void 0!==u&&u,m=t.parentElement,_=t.virtualParentElement;return i.addBindingHandlers({host:d.e,element:c.e}),i.overlayProvider=o,i.topTab=i.createObservable(null),i.bottomTab=i.createObservable(null),i.isOpen=i.createObservable(!1),i.virtualParentElement=_,i.overlay=new f({alignToParent:i.wrapObservable(p),parentElement:m,animation:l,topTab:i.topTab,bottomTab:i.bottomTab,isOpen:i.isOpen}),i}return Object(r.__extends)(t,e),t}(o.e),m=i.e({tagName:"od-overlay",template:'<a href="javascript:;" class="ms-accessible" role="presentation" data-bind="element:topTab"></a><div class="od-Overlay ms-accessible" role="presentation" data-bind="component:{name:transclusionContentTagName,params:{provider:overlayProvider,parentElement:virtualParentElement||$element.parentElement,options:overlay}}">\x3c!--ko host:{}--\x3e\x3c!--/ko--\x3e</div><a href="javascript:;" class="ms-accessible" role="presentation" data-bind="element:bottomTab"></a>',viewModel:p,synchronous:!0});t.e=m},,,,,,,,,function(e,t,n){"use strict";var a=n(0),i=n(2184),r=n(2192),o=n(2193),s=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.item,s=n.getItemSelectionHelperType,c=void 0===s?a.resources.consume(o.e.lazy):s,d=n.itemParentHelper,l=void 0===d?a.resources.consume(r.e):d;return a.isItemSpecified=!!i,a.item=i||new(a.scope.attached(c()))({canFallback:!0,ignoreSelection:!0}).currentItem,a.itemParentHelper=l,a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!!this.item()},t.prototype.getParent=function(e,t,n){var a=this.itemParentHelper.getFacetedAncestorOrSelf(e,t);return n?this.peekUnwrapObservable(a):this.unwrapObservable(a)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.e.dependencies),{getItemSelectionHelperType:o.e.lazy,itemParentHelper:r.e}),t}(i.e);t.e=s},,,,function(e,t,n){"use strict";n.r(t),n.d(t,"OperationProvider",function(){return p}),n.d(t,"resourceKey",function(){return m});var a=n(0),i=n(1203),r=n(2236),o=n(2507),s=n(2229),c=n(4422),d=function(e){function t(t){var n=e.call(this,{})||this,i=n.observables;n.name=t.name,n.iconName=t.iconName,n.state=i.create(r.e.created),n.warning=i.create(""),n.error=i.create(),n.count=i.create(1);var c=Object(a.__assign)({minimum:0,maximum:0,current:0},t.progress||{});return n.progress={minimum:i.create(c.minimum),maximum:i.create(c.maximum),current:i.create(c.current)},n.type=i.create(t.type||s.e.multiple),n.batch=t.batch||new o.e,n._initializeActions(t.actions),n.payloads=i.create(t.payloads||{}),n.visibility=i.create(t.visibility||0),n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this.actions({}),this.payloads({}),e.prototype.dispose.call(this)},t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var a=e[n];t[n]=this.scope.attach(new c.e({key:n,operation:this,isAvailable:a.isAvailable,onExecute:a.execute}))}this.actions=this.observables.create(t)},t}(i.default),l=n(4807),u=n(4423),f=n(142),p=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this,i=a.observables,r=new o.e;a._observers=i.createArray();var s=a.operations=i.createArray(),c=a.scope.attached(l.e),d=a.groups=a.addDisposable(u.e.group(s,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new c({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));return a.overall=new(a.managed(l.e))({batch:r,operations:d}),a.isLocked=a.createPureComputed(a._computeIsLocked),a.createBackgroundComputed(a._computeRemoveAllWhenUnlocked).extend({deferred:!0}),a}return Object(a.__extends)(t,e),t.prototype.lock=function(){var e=this,t={};return this._observers.push(t),{dispose:function(){e._observers.remove(t)}}},t.prototype.register=function(e){var t=new d(e);return 2!==t.visibility.peek()&&this.operations.push(t),t},t.prototype.deleteGroupOperation=function(e){var t=Object(a.__spreadArray)([],e.operations.peek(),!0);this.operations.removeAll(t),t.forEach(function(e){e.dispose()})},t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,a=this.groups.peek();n<a.length;n++){var i=a[n],o=i.state.peek();if(o===r.e.completed||!e&&(o===r.e.expired||o===r.e.canceled||o===r.e.failed))for(var s=i.operations.peek(),c=void 0,d=0;d<s.length;d++){c=!0;var l=s[d];if(o===r.e.failed&&l.actions)for(var u=l.actions.peek(),f=Object.keys(u),p=0;p<f.length;p++)if("cancel"!==f[p]&&u[f[p]].isAvailable.peek()){c=!1;break}c&&t.push(s[d])}}this.operations.removeAll(t),t.forEach(function(e){e.dispose()})},t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()},t.prototype._computeIsLocked=function(){return this._observers().length>0},t}(i.default),m=Object(f.r)("OperationProvider",p);t.default=p},,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(2175),r=n(2394),o=n("knockout-lib"),s=n(238),c="InteractionScopeBinding_scope",d=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t)||this;a._parentScope=function(e){for(var t,n=e;!(t=o.utils.domData.get(n,c))&&n!==document.body&&Object(s.e)(n);)n=Object(s.e)(n);return n!==document.body&&t||void 0}(a.element);var i=a.valueAccessor(),d=i.isScope,l=void 0!==d&&d,u=i.isRoot,f=void 0!==u&&u;if(l){a._childScopes=o.observableArray(),a._hasFocus=o.observable(!1),a._isRoot=f,a._isActive=a.createPureComputed(a._computeIsActive,{deferEvaluation:!0}),a._isDescendantActive=a.createPureComputed(a._computeIsDescendantActive,{deferEvaluation:!0}),a._scope={isActive:a._isActive,isDescendantActive:a._isDescendantActive,isDescendantOrSelfActive:a.createComputed(a._computeIsDescendantOrSelfActive),register:function(e){return a._registerScope(e)},_owner:a},o.utils.domData.set(a.element,c,a._scope);var p=n.ChildFocusBinding,m=void 0===p?r.e:p;new(a.managed(m))({element:a.element,bindingContext:a.bindingContext,allBindingsAccessor:a.allBindingsAccessor,valueAccessor:function(){return a._hasFocus}}),a._parentScope&&a.addDisposable(a._parentScope.register(a._scope))}else a._parentScope?(a._isActive=a._parentScope.isActive,a._isDescendantActive=a._parentScope.isDescendantActive):(a._isActive=o.observable(!0),a._isDescendantActive=o.observable(!1));return i.isActive&&a.createComputed(function(){return i.isActive(a._isActive())}),i.isDescendantActive&&a.createComputed(function(){return i.isDescendantActive(a._isDescendantActive())}),a}return Object(a.__extends)(t,e),t.prototype._registerScope=function(e){var t=this;return this._childScopes.push(e),{dispose:function(){t._childScopes.remove(e)}}},t.prototype._computeIsDescendantOrSelfActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return e||t},t.prototype._computeIsActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return(this._isRoot||e)&&!t},t.prototype._computeIsDescendantActive=function(){for(var e=!1,t=0,n=this._childScopes();t<n.length;t++)n[t].isDescendantOrSelfActive()&&(e=!0);return e},t}(i.t);t.t=d},,,,,,,,,,,,,function(e,t,n){"use strict";var a=function(){function e(e,t){!function(e){return!!e&&"object"==typeof e}(e)?(this.key=e,this.input=t,this.status=0):(this.key=e.key,this.input=e.input,this.output=e.output,this.status=e.status,this.error=e.error)}return e.prototype.succeed=function(t){var n=new e(this);return n.output=t,n.status=1,delete n.error,n},e.prototype.fail=function(t){var n=new e(this);return n.error=t,n.status=2,n},e.prototype.cancel=function(){var t=new e(this);return delete t.error,t.status=3,t},e.prototype.restart=function(){return new e(this.key,this.input)},e.prototype.changeInput=function(t){var n=t(this.input),a=new e(this.key,n);return a.output=this.output,a.status=this.status,a.error=this.error,a},e.prototype.changeOutput=function(t){var n=t(this.output),a=new e(this.key,this.input);return a.output=n,a.status=this.status,a.error=this.error,a},e.prototype.compare=function(e){return e&&this.input===e.input&&this.output===e.output&&this.error===e.error&&this.status===e.status?null:{previous:e,current:this}},e}();t.e=a},,,,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"a",function(){return u});var a,i=n(972),r=n(923),o=n(177),s=n(4215);function c(e,t,n){var a=r.e[t]&&r.e[t].iconType||"png",i=e&&"png"===a;return"".concat(s.t).concat(n).concat(i?"_2x":"","/").concat(t,".").concat(a)}function d(e,t,n){return c(e.consume(o.e).isRetinaSupported,t,n)}function l(e,t,n){return d(e,i.n(t),n)}function u(e,t,n){return n&&n.vault&&n.vault.root?d(e,n.vault.isLocked?a.vaultClosed:a.vaultOpen,t):n&&n.folder&&"SamsungGallery"===n.specialFolderCanonicalName?d(e,"samsunggallery",t):void 0}!function(e){e.vaultOpen="vaultopen",e.vaultClosed="vaultclosed"}(a||(a={}))},,,,,,,,,,,,,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.text=t.text,n}return Object(a.__extends)(t,e),t}(n(2173).e),r=n(2174).e({tagName:"ms-text-container",template:'<div class="TextContainer" data-bind="text:text"></div>',viewModel:i});t.e=r},,,,,function(e,t,n){"use strict";var a=n(85);t.e=a.a}],Array(19),[function(e,t,n){"use strict";n.d(t,"t",function(){return p});var a='\x3c!--ko if:areCSS3TransitionsSupported--\x3e<div class="ProgressSpinnerFlat" role="progressbar"><div aria-hidden="true"></div><div aria-hidden="true"></div><div aria-hidden="true"></div><div aria-hidden="true"></div><div aria-hidden="true"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:!areCSS3TransitionsSupported--\x3e<img data-bind="attr:{src:loadingUrl,alt:loadingString}">\x3c!--/ko--\x3e',i=n(0),r=n(2173),o=n(101),s=n(2497),c=n(177),d=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.platformDetection,r=void 0===i?a.resources.consume(c.e):i;return a.areCSS3TransitionsSupported=r.areCSS3TransitionsSupported,a.loadingUrl=window.require.toUrl("odsp-media/images/loading/loadingdots.gif"),a.loadingString=s.e,a}return Object(i.__extends)(t,e),t.resources=Object(i.__assign)(Object(i.__assign)({},r.e.dependencies),{platformDetection:c.e,settingsDataSource:o.X}),t}(r.e),l=n(2174),u=n(2178),f=Object(l.e)({tagName:"ms-progressSpinnerFlat",template:a,viewModel:d,synchronous:!0}),p=Object(u.n)({automationName:"ms-progressSpinnerFlat",name:"ProgressSpinnerFlat",template:a,viewModelType:d});t.e=f}],Array(24),[function(e,t,n){"use strict";n.r(t),n.d(t,"ItemTaskObserver",function(){return u}),n.d(t,"resourceKey",function(){return f});var a=n(0),i=n(1203),r=n(2274);n.d(t,"Task",function(){return r.e});var o=n(2693),s=n(2238),c=n(1334);n.d(t,"Graft",function(){return c});var d=n(8),l=n(142),u=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.itemsStore,r=void 0===i?a.resources.consume(s.t):i;return a._itemsStore=r,a._itemUpdatesByKey={},a}return Object(a.__extends)(t,e),t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,a=e;n<a.length;n++){var i=a[n];this._processTask(i)}},t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,n=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,r=n;i<r.length;i++){var s=r[i],d=t[s],l=new o.e(s),u=this._getStoreItem(s);if(u){u.UNSAFE_parent;var f=Object(a.__rest)(u,["UNSAFE_parent"]);Object(c.default)(l,f)}Object(c.default)(l,{revision:0});for(var p=0,m=d.item;p<m.length;p++){var _=m[p];Object(c.default)(l,_)}e[s]=l}for(var h=0,b=n;h<b.length;h++){var g=(l=e[s=b[h]]).parentKey;if(g){var v=e[g]||this._getStoreItem(g)||new o.e(g);e[g]=v,l.UNSAFE_parent=v}else delete l.UNSAFE_parent}this._pushItemsToStore(e);for(var y=0,S=n;y<S.length;y++)s=S[y],delete(d=t[s]).item},t.prototype.reset=function(){this._itemUpdatesByKey={}},t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)},t.prototype.getChildren=function(e){var t,n,a,i=e.parentKey,r=e.startIndex,o=e.endIndex,s=[],c=this._itemUpdatesByKey[i];if(c){var d=c.set;if(d)if(d.childrenByIndex){r=void 0===(n=(t={startIndex:r,endIndex:o}).startIndex)?d.startIndex:n,o=void 0===(a=t.endIndex)?d.endIndex:a;for(var l=r;l<o;l++){var u=d.childrenByIndex[l],f=this._getStoreItem(u);s.push(f)}}else if(d.childrenBySibling)for(var p={},m="";m=d.childrenBySibling[m];){if(p[m])throw new Error("Circular reference encountered enumerating the children of '".concat(i,"'."));p[m]=!0,f=this._getStoreItem(m),s.push(f)}}return s},t.prototype._processTask=function(e){var t=e.key,n=e.output,a=n.item,i=n.set,r=this._itemUpdatesByKey,o=r[t];if(o||(o=r[t]={}),a&&(o.item||(o.item=[]),o.item.push(a)),i){var s=r[i.parent.key];s||(s=r[i.parent.key]={}),s.set||(s.set={});var c=s.set;if(void 0!==i.index){c.childrenByIndex||(c.childrenByIndex=[]),void 0===c.startIndex?c.startIndex=i.index:c.startIndex=Math.min(c.startIndex,i.index);var d=c.childrenByIndex.length;c.childrenByIndex[i.index]=t,void 0===c.endIndex?c.endIndex=i.index+1:c.endIndex>i.index+1?c.endIndex+=c.childrenByIndex.length-d:c.endIndex=Math.max(c.endIndex,i.index+1)}else i.after&&(c.childrenBySibling||(c.childrenBySibling={}),c.childrenBySibling[i.after.key]=t)}},t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)},t.prototype._pushItemsToStore=function(e){var t={};for(var n in e)(r=t[i=e[(c=e[n]).parentKey]&&c.parentKey||""]||(t[i]=[])).push(n);for(var a=[""];a.length;){var i,r;if(r=t[i=a.shift()]){for(var o=0,s=r;o<s.length;o++){var c;if(!(c=e[n=s[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(c,n)}a.push.apply(a,r)}}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{itemsStore:s.t}),t}(i.default),f=new d.t({name:"ItemTaskObserver",factory:new l.a(u)});t.default=u}],Array(15),[function(e,t,n){"use strict";n.d(t,"e",function(){return S});var a=n(0),i=n(1203),r=n(226),o=n(113),s=n(142),c=n(101),d=n(90),l=n(2621),u=n(43),f=n(1866),p=n(16),m=n(54);function _(e,t){return e.preferences[(t||"").toLowerCase()]}function h(e){return!!(e=e&&e.toLowerCase().replace(".",""))&&!l.e[e]||"pdf"===e}function b(e,t,n,i){var r=_(e,t);if(r)for(var o=0,s=Object(a.__spreadArray)(Object(a.__spreadArray)([],r.preview,!0),r.open,!0).filter(g);o<s.length;o++){var c=s[o],d=n&&c[n]||i&&c.handler[i];if(d)return d}}function g(e){return!e.handler.isPromoted}function v(e){return e.filter(g)[0]}var y=function(e){function t(t,n){var a,i=e.call(this,t,n)||this,s=Object(u.isFeatureEnabled)(u.FileHandlersV2),l="data",_=new r.e("FileHandlers",o.e.session);if(s)try{var h=_.getValue(l);a=h&&JSON.parse(h)}catch(e){}var b=i.observables,g=i.data=b.create(a);return g.equalityComparer=f.e,a&&4===a.version&&s||(g({actions:{custom:[],create:[],open:[],preview:[]},preferences:{},version:4}),_.setValue(l,JSON.stringify(g.peek()))),s&&b.backgroundCompute(function(){i.trackPromise(m.n.resolve(i.resources.consumeAsync(c.m.optional)).then(function(e){if(e)return e.getFileHandlerData({includePromotedApp:!0})}).then(function(e){return e||i.resources.consumeAsync(c.p.optional).then(function(e){if(e)return p.t.isActivated("a9c8b4cd-bc43-466c-aeeb-106eec05d057","07/07/2021","Will try to use cookie to get filehandler instead of tokens.")?e.getFileHandlerData({includePromotedApp:!0}):e.getFileHandlerData({includePromotedApp:!0,allowCookies:!0})})}).then(function(e){e&&(_.setValue(l,JSON.stringify(e)),g(e))},function(e){d.e.logError(e)}))}),i}return Object(a.__extends)(t,e),t.prototype.getFileTypeIconUrl=function(e,t){return h(e)?this.getIconUrl(b(this._getData(t),e||"","icon","fileTypeIcon")):void 0},t.prototype.getFileTypeName=function(e,t){return h(e)?b(this._getData(t),e||"",void 0,"fileTypeDisplayName"):void 0},t.prototype.getIconUrl=function(e){var t=window.devicePixelRatio||1;return e&&(e.svg||t>=1.75&&e.png2x||t>=1.25&&e.png1_5x||e.png1x)},t.prototype.getDefaultOpenHandler=function(e,t){var n=_(this._getData(t),e||"");return n&&v(n.open)},t.prototype.getDefaultPreviewHandler=function(e,t){var n=_(this._getData(t),e||"");return n&&v(n.preview)},t.prototype.isActionForExtension=function(e,t){var n=e.availableOn.file,a=n&&n.extensions;return!!n&&(!a||a.indexOf(t.toLowerCase())>=0||a.indexOf(".*")>=0)},t.prototype._getData=function(e){return e?this.data.peek():this.data()},t}(i.default),S=Object(s.r)("FileHandlerProvider",y)}],Array(18),[function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(0),i=n(2184),r=n(70),o=n(1203),s=n(54),c=n(383),d=n(1103),l=n(4222),u=function(e){function t(t){var n=e.call(this,t)||this,a=t.state,i=t.source,r=t.useToggleBehavior,o=t.useGlobalResources,c=t.getParams;if(function(e){return!!e.moduleDefinition}(i)){var u=i.moduleDefinition;n._getComponentDefinition=function(){return Object(d.e)(u)}}else{var f=i.component;n._getComponentDefinition=function(){return s.n.wrap(f)}}return n._useToggleBehavior=r,n._state=a,n._getParams=c,n._action=n.createObservable(),n._hiddenDomProvider=n.resources.consume(l.e),n._useGlobalResources=o,n.isAvailable=n.createPureComputed(n._computeIsAvailable),n.isToggled=n.createPureComputed(n._computeIsToggled),n}return Object(a.__extends)(t,e),t.prototype.execute=function(e){var t,n=this;if(this._useToggleBehavior){var i=this._action.peek();if(i)return i.cancel(),s.n.wrap()}var r=new c.e,o={complete:function(){r.complete()},fail:function(e){r.error(e)},cancel:function(){r.cancel()}};return this._useToggleBehavior&&this._action(o),s.n.as(this._getParams()).then(function(i){return n._getComponentDefinition().then(function(s){return t=n._hiddenDomProvider.requestControl({name:s.tagName,params:Object(a.__assign)(Object(a.__assign)({action:o,event:e},i||{}),n._useGlobalResources?{}:{resources:n.resources})}),r.getPromise()})}).then(function(){t&&n._hiddenDomProvider.disposeControl(t),n._action.peek()===o&&n._action(void 0)},function(e){return t&&n._hiddenDomProvider.disposeControl(t),n._action.peek()===o&&n._action(void 0),s.n.wrapError(e)})},t.prototype._computeIsAvailable=function(){return this._state().isAvailable},t.prototype._computeIsToggled=function(){var e=this._state().isToggled;return void 0!==e&&e||this._useToggleBehavior&&!!this._action()},t}(o.default),f=function(e){function t(t){var n=e.call(this,t)||this,a=t.name,i=t.source,r=t.handlerType,o=t.actionParams,s=t.useToggleBehavior,c=void 0!==s&&s,d=t.useGlobalResources;n.name=a;var l=r?new(n.managed(r))(o):void 0,f=l&&l.state||n.createObservable({isAvailable:!0}),p=l&&l.getParams?function(){return l.getParams()}:function(){};return n._controlExecutorLoader=new(n.managed(u))({source:i,state:f,useToggleBehavior:c,useGlobalResources:d,getParams:p}),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._controlExecutorLoader.isAvailable()},t.prototype.onIsToggled=function(){return this._controlExecutorLoader.isToggled()},t.prototype.onExecute=function(e){return this._controlExecutorLoader.execute(e).then(function(){return{resultType:r.e.Success}})},t}(i.e);function p(e){var t=e.name,n=e.source,i=e.useToggleBehavior,r=e.handlerType,o=e.useGlobalResources,s=void 0!==o&&o;return function(e){function o(a){return e.call(this,{name:t,source:n,useToggleBehavior:i,actionParams:a,handlerType:r,useGlobalResources:s})||this}return Object(a.__extends)(o,e),o}(f)}},,,,function(e,t,n){"use strict";var a=n(4216);t.e=a.e},,,,,,,,,,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.errorType=t.errorType||0,n.payloads=t.payloads||{},n}return Object(a.__extends)(t,e),t}(n(29).e);t.e=i},function(e,t,n){"use strict";var a=n(0),i=n(419),r=n(2175),o=n(2448),s=function(e){function t(t){var n,a,i,r=e.call(this,t)||this,s=t.valueAccessor();!function(e){return"object"==typeof e}(s)?i=s:(n=s.isBodyActive,a=s.activeElement,i=s.isDescendantOrSelfActive),r._focusTracker=r.resources.consume(o.e);var c=r.observables;if(i){var d=c.pureCompute(r._computeIsDescendantOrSelfActive);c.compute(function(){i(d())}).extend({deferred:!0})}if(n){var l=c.pureCompute(r._computeIsBodyActive);c.compute(function(){n(l())}).extend({deferred:!0})}if(a){var u=c.pureCompute(r._computeActiveElement);c.compute(function(){a(u())}).extend({deferred:!0})}return r}return Object(a.__extends)(t,e),t.prototype._computeIsDescendantOrSelfActive=function(){var e=this.element,t=this._focusTracker.activeElement();return!!t&&(e===t||Object(i.e)(e,t))},t.prototype._computeIsBodyActive=function(){var e=this._focusTracker.activeElement();return!e||e===document.body},t.prototype._computeActiveElement=function(){return this._focusTracker.activeElement()},t}(r.t);t.e=s}],Array(13),[function(e,t,n){"use strict";n.r(t),n.d(t,"createItemsScopeActionFromKnockout",function(){return l});var a=n(0),i=(n(4418),n("react-lib")),r=n(22),o=n(62),s=n(3040),c=n(4419),d=n(1242);function l(e,t){return void 0===t&&(t={}),function(n){var a=n.itemKey;return i.createElement(c.e,{itemKey:a},i.createElement(u,{createKnockoutAction:e,options:t,actionProps:n}))}}function u(e){var t=this,n=e.createKnockoutAction,c=e.options,l=e.actionProps,u=c.isToggleable,f=void 0!==u&&u,p=c.isExecutorOnly,m=void 0!==p&&p,_=Object(o.n)(),h=Object(d.e)(function(){return n(_,l)},[]),b=Object(s.n)(!!m||h.isAvailable),g=Object(s.n)(f?h.isToggled:void 0);return i.createElement(r.e,{isAvailable:b,onExecute:function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,h.execute(e.event)];case 1:return t.sent(),[2]}})})},isToggled:g})}},,,,,,function(e,t,n){"use strict";var a,i=n(0),r=n(2175),o=n(1203),s=n(383),c=n(142),d=n(1434),l=n(2784),u=n(812),f=n(34),p=n(138);!function(e){e[e.none=0]="none",e[e.queue=1]="queue",e[e.server=2]="server"}(a||(a={}));var m=a,_=Object(u.e)({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:a,type:f.e.Enum}},p.e),h=n(70),b=n(4425),g=n(29),v=!n(16).t.isActivated("C123FC1B-1706-4C97-AFF3-45C077654F1A","08/11/2022","Enable not pre-auth vroom style image preview"),y=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._semaphore=new l.e(16),a._thumbnailCache=n.thumbnailCache,a}return Object(i.__extends)(t,e),t.prototype.loadImage=function(e){var t=this,n=e.url,a=e.imageElement,i=void 0===a?document.createElement("img"):a,r=e.scenarioName,o=e.getContents,s={url:n,width:0,height:0},c=this._thumbnailCache,l=c.isLoaded(s),u=function(e){return d.e.authenticate(e).then(function(){return t._waitForImageLoad(i,e,r)}).then(function(e){if(c.record(s),i.complete&&!e)return t._waitForTimeout(300)}).then(function(){var t=i.naturalWidth||i.width,n=i.naturalHeight||i.height;return{url:e,width:t,height:n}})};return v&&o?this.trackPromise(o(void 0,n).then(function(e){var n=URL.createObjectURL(e);return l?u(n):t._semaphore.enqueue(function(){return u(n)})})):l?u(n):this._semaphore.enqueue(function(){return u(n)})},t.prototype._waitForImageLoad=function(e,t,n){var a,i,r,o=this.async,c=this.events,d=function(){r&&o.clearTimeout(r),c.off(e)},l=new s.e(function(){d(),e.setAttribute("src",""),t&&/^blob:/.test(t)&&URL.revokeObjectURL(t)}),u=t&&t.indexOf("&encodeFailures=1")>=0;return c.onAll(e,{load:function(){if(d(),u&&1===e.naturalWidth&&e.naturalHeight>6e4){var t=e.naturalHeight-6e4,n=406===t||412===t;i&&i.end({resultType:n?h.e.ExpectedFailure:h.e.Failure,resultCode:"".concat(t),error:"Encoded failure"}),l.error(new g.e({code:"".concat(t),isExpected:n,message:"Server returned encoded failure ".concat(t)}))}else i&&i.end({resultType:h.e.Success}),l.complete(a)},error:function(){d(),i&&i.end({resultType:h.e.Failure}),l.error(new Error("Image '".concat(t,"' failed to load")))}}),r=o.setTimeout(function(){l.cancel()},3e4),n&&(i=new _({name:n,loadType:m.server})),e.setAttribute("src",t),a=!!e.complete,this.trackPromise(l.getPromise())},t.prototype._waitForTimeout=function(e){var t,n=this.async,a=new s.e(function(){t&&n.clearTimeout(t)});return t=n.setTimeout(function(){a.complete()},e),a.getPromise()},t.dependencies=Object(i.__assign)(Object(i.__assign)({},o.default.dependencies),{thumbnailCache:b.e}),t}(o.default),S=Object(c.r)("ImageLoader",y),D=n(2418),I=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t)||this;a._debouncer=new D.e,a._imageLoader=a.resources.consume(S);var i=a.valueAccessor(),r=i.src,o=i.image,s=i.error,c=i.isLoaded,d=i.isError,l=i.actualSize,u=i.scenarioName,f=i.getContents;a._src=a.wrapObservable(r),a._image=a.wrapObservable(o),a._error=a.wrapObservable(s),a._scenarioName=u,a._getContents=f;var p=n.outputExtenders,m=void 0===p?{deferred:!0}:p;return a.createComputed(a._computeLoadImage),a.createBackgroundComputed(function(){var e=a._image();if(c&&c(!!e),l){var t=void 0;e&&(t={width:e.width,height:e.height}),l(t)}o&&o(e)}).extend(m),a.createBackgroundComputed(function(){var e=a._error();s&&s(e),d&&d(!!e)}).extend(m),a}return Object(i.__extends)(t,e),t.prototype._computeLoadImage=function(){var e,t=this,n=this.unwrapObservable(this._src),a=this.unwrapObservable(this._getContents);this._image(void 0),this._scenarioName&&(e=new _({name:this._scenarioName,loadType:m.queue})),this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:n,imageElement:this.element,scenarioName:this._scenarioName,getContents:a}))).then(function(n){t._image(n),t._error(void 0),e&&e.end({resultType:h.e.Success})},function(n){t._error(n),e&&e.end({resultType:n.isExpected?h.e.ExpectedFailure:h.e.Failure})})},t}(r.t);t.e=I}],Array(14),[function(e,t,n){"use strict";var a;!function(e){e[e.Public=0]="Public",e[e.PublicUnlisted=2]="PublicUnlisted",e[e.Shared=3]="Shared",e[e.Private=4]="Private",e[e.Unknown=5]="Unknown"}(a||(a={})),t.e=a},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(1428),r=new a.t({name:"NeedsOverlayContent.key",factory:{dependencies:{},create:function(){return{instance:{needsOverlayContent:new i.e(!1)}}}}})},function(e,t,n){"use strict";var a=n(0),i=n(421),r=n(2175),o=n(3336),s=n(3259),c=function(e){function t(t){var n=e.call(this,t)||this,a=n.resources.consume(i.D.optional);return a?(n.teachingBubbleProvider=a,n._value=n.valueAccessor(),n._firstRunExperienceStatus=n.resources.consume(o.e),n._firstRunExperienceStatusKO=n.observables.create(n._firstRunExperienceStatus.get()),n._firstRunExperienceStatus.subscribe(function(){n._firstRunExperienceStatusKO(n._firstRunExperienceStatus.get())}),n.createBackgroundComputed(n._computeAddTeachingBubble),n):n}return Object(a.__extends)(t,e),t.prototype._computeAddTeachingBubble=function(){var e=this.unwrapObservable(this._value);if(e){var t=this.unwrapObservable(e.campaign);this._firstRunExperienceStatusKO()===s.e.notVisible&&t&&(this._campaign&&t.campaignGuid!==this._campaign.campaignGuid&&this.teachingBubbleProvider.currentBubble.get()&&this.teachingBubbleProvider.currentBubble.get().campaign===this._campaign&&this.teachingBubbleProvider.clearCurrentBubble(),this._campaign=t,this.teachingBubbleProvider.addBubble({bubble:t,element:this.element}))}},t}(r.t);t.e=c},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(1203),r=n(971),o=n(142),s=n(177),c=n(16),d=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=a.observables;a._activeElement=i.create({}),a.activeElement=i.pureCompute(a._computeActiveElement),a.activeElement.equalityComparer=r.n,a.isWindowActive=i.create(!0),a._isWithinWindowBlur=!1,a._platform=n.platFormDetection;var o=a.async.throttle(function(){a._activeElement({})},350),s=a._platform&&a._platform.isEdge,c=a._platform&&a._platform.isIE;if(s||c){var d=new MutationObserver(o);d.observe(document.body,{childList:!0,subtree:!0}),a.scope.attach({dispose:function(){d&&d.disconnect()}})}return a.events.onAll(window,{focus:a._onWindowFocus,blur:a._onWindowBlur},!1),a.events.onAll(document.body,{focus:a._onDocumentFocus,blur:a._onDocumentBlur},!0),a}return Object(a.__extends)(t,e),t.prototype._computeActiveElement=function(){return this._activeElement(),document.activeElement},t.prototype._onWindowFocus=function(e){this.async.clearTimeout(this._windowBlurTimeout),this._isWithinWindowBlur=!1,this.isWindowActive(!0)},t.prototype._onDocumentFocus=function(e){if(!this._isWithinWindowBlur){this.isWindowActive(!0);var t=document.activeElement;this.async.clearTimeout(this._blurTimeout),window.__debugFocus&&console.log("[focus] active:",t),this._activeElement({})}},t.prototype._onWindowBlur=function(e){var t=this;this._isWithinWindowBlur=!0,this.isWindowActive(!1),this._windowBlurTimeout=this.async.setTimeout(function(){t._isWithinWindowBlur=!1},10)},t.prototype._onDocumentBlur=function(e){var t=this;if(!this._isWithinWindowBlur){this.isWindowActive(!0);var n=document.activeElement;this.async.clearTimeout(this._blurTimeout),n&&n!==document.body?(window.__debugFocus&&console.log("[focus] blur:",n),this._activeElement({})):(window.__debugFocus&&console.log("[focus] wait:",n),this._blurTimeout=this.async.setTimeout(function(){window.__debugFocus&&console.log("[focus] then blur:",document.activeElement,"from",n),t._activeElement({})},c.e.isActivated("759ADC51-E16E-4AA6-9DBD-E84CF7AACBA5","10/24/2022","Add grace period for detecting body focus")?0:10))}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{platFormDetection:s.e}),t}(i.default),l=Object(o.r)("FocusTracker",d,Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{platFormDetection:s.e}))},function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c});var a=n(0),i=n("knockout-lib"),r=n(40),o=n(1203),s=function(){function e(){}return e.Search="Search",e}(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getBuckets=function(){return t.getBuckets(this.resources)},t.getBuckets=function(e){return e&&e.isExposed(r.d)?e.consume(r.d):i.observable([])},t.prototype.getLoggingContextData=function(){return t.getLoggingContextData(this.resources)},t.getLoggingContextData=function(e){var n=null;return e&&e.isExposed(r.c)&&(n=e.consume(r.c)),n?n.get(t.getBuckets(e).peek()):{}},t.prototype.addBuckets=function(e){return t.addBuckets(this.resources,e)},t.addBuckets=function(e,t){if(e){var n=[];e.isExposed(r.d)&&(n=e.consume(r.d).peek()),t.forEach(function(e){n.indexOf(e)<0&&n.push(e)}),e.isExposed(r.d)||e.expose(r.d,i.observable(n))}},t}(o.default)},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"r",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"s",function(){return u}),n.d(t,"l",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"p",function(){return m}),n.d(t,"o",function(){return _}),n.d(t,"d",function(){return h}),n.d(t,"u",function(){return b}),n.d(t,"c",function(){return g}),n.d(t,"m",function(){return v});var a=n(43),i=n(4445),r="ms-albums-list",o=Object(a.isFeatureEnabled)(a.UseTilesListForAllPhotos)?"od-tiles-list":"ms-all-photos-list",s="ms-grid-customlist",c="ms-details-customlist",d="ms-details-list",l="ms-compact-details-list",u=Object(a.isFeatureEnabled)(a.UseTilesList)?"od-tiles-list":"ms-grid-list",f="ms-single-album-list",p="od-tag-grid",m="od-tags-list",_="od-doccard-grid",h="od-shared-grid-list",b="od-sites-grid-list",g={"ms-albums-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-common"),n.e(390)]).then(n.bind(null,5469))}),"od-tiles-list":Object(i.e)(function(){return n.e(403).then(n.bind(null,5475))}),"ms-all-photos-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-common"),n.e(391)]).then(n.bind(null,5470))}),"ms-grid-customlist":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-common"),n.e(393)]).then(n.bind(null,5465))}),"ms-details-customlist":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-common"),n.e(394)]).then(n.bind(null,5312))}),"ms-details-list":Object(i.e)(function(){return n.e(395).then(n.bind(null,3652))}),"ms-compact-details-list":Object(i.e)(function(){return n.e(392).then(n.bind(null,3991))}),"ms-grid-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-common"),n.e(397)]).then(n.bind(null,4179))}),"ms-single-album-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-common"),n.e(399)]).then(n.bind(null,5483))}),"od-tag-grid":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-common"),n.e(401)]).then(n.bind(null,5471))}),"od-tags-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-common"),n.e(402)]).then(n.bind(null,5460))}),"od-doccard-grid":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-common"),n.e(396)]).then(n.bind(null,5484))}),"od-shared-grid-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-common"),n.e(398)]).then(n.bind(null,5485))}),"od-sites-grid-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-common"),n.e(400)]).then(n.bind(null,5466))})};function v(e,t){var n=t&&t.isCustomList,a=t&&t.isPlaceholder;switch(e){case r:return r;case o:return o;case s:case"ms-grid-list":case"od-tiles-list":case u:return a?e:n?s:u;case c:case d:return a?e:n?c:d;case l:return l;case f:return f;case p:return p;case m:return m;case _:return _;case h:return h;case b:return b;default:return n?c:d}}}],Array(14),[function(e,t,n){"use strict";var a=n(2174),i=n(0),r=n(2173),o=n(2832),s=n(20),c=n(4425),d=n(2663),l=n(1866);function u(e,t){return e===t||!e&&!t||!(!e||!t)&&e.url===t.url}n(1838);var f=n(1203),p=n(4144),m=function(e){function t(t){var n=e.call(this,t)||this,a=t.hasAnimated,i=t.fadeIn,r=t.image,o=t.referenceImage,s=t.referenceRotation;return n._fadeIn=i,n._image=r,n._referenceImage=o,n._referenceRotation=s,n.isLoaded=n.createObservable(!1),n._hasAnimated=n._getHasAnimated(),n.rotation=n.createPureComputed(n._computeRotation),n.createBackgroundComputed(function(){return a(n._hasAnimated())}),n}return Object(i.__extends)(t,e),t.prototype._getHasAnimated=function(){var e=this,t=this.createObservable(!1);return this.createPureComputed(function(){var n;return e.isLoaded.peek()?(n=t())||e.async.setTimeout(function(){return t(!0)},e._fadeIn.peek()?2e3:50):(e.isLoaded(),n=!1),n})},t.prototype._computeRotation=function(){var e=this.rotation.peek();return(u(this._image,this._referenceImage())||void 0===e)&&(e=this._referenceRotation()),e},t}(f.default),_=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.imageTileTagName=p.e.tagName;var i=t.image,r=t.rotation,o=t.desiredSize,s=t.scale,c=void 0===s?1:s,d=t.fadeIn,f=void 0===d||d,_=t.allowLoading,h=void 0===_||_,b=t.isLoaded,g=t.isCurrent,v=t.alignment,y=t.position,S=t.loadedImage,D=t.error,I=t.loadImageScenarioName,x=n.outputExtenders,C=void 0===x?{deferred:!0}:x,O=n.AnimationTracker,w=void 0===O?m:O;return a._animationTrackerType=w,a._image=a.wrapObservable(i),a._rotation=a.wrapObservable(r),a._desiredSize=o,a._scale=c,a.fadeIn=a.wrapObservable(f),a._allowLoading=a.wrapObservable(h),a._alignment=v,a._scenarioName=I,a._tileDefinitions=a.createPureComputed(a._computeTileDefinitions),a._position=a.createPureComputed(a._computePosition),a._position.equalityComparer=l.e,a._loadedImage=a.createPureComputed(a._computeLoadedImage),a._loadedImage.equalityComparer=u,a._error=a.createPureComputed(a._computeError),a._error.equalityComparer=l.e,a.tiles=a._getTiles(),y&&a.createBackgroundComputed(function(){return y(a._position())}).extend(C),S&&a.createBackgroundComputed(function(){return S(a._loadedImage())}).extend(C),b&&a.createBackgroundComputed(function(){return b(!!a._loadedImage())}).extend(C),g&&a.createBackgroundComputed(function(){return g(u(a._loadedImage(),a._image()))}).extend(C),D&&a.createBackgroundComputed(function(){return D(a._error())}).extend(C),a}return Object(i.__extends)(t,e),t.prototype._computeError=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.error;if(i())break;if(r()){e=r();break}}return e},t.prototype._computePosition=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.position;if(i()){e=r();break}}return e},t.prototype._computeLoadedImage=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.image;if(i()){e=this.unwrapObservable(r);break}}return e},t.prototype._computeTileDefinitions=function(){var e=this._image(),t=this._tileDefinitions.peek(),n=void 0===t?[]:t;if(e){if(this._allowLoading()){var a=void 0,r=void 0,o=void 0,s=n[n.length-1];s?(a=u(s.image,e),r=s.hasAnimated.peek(),o=!!s.error.peek()):(a=!1,r=!1),a?r?n=[s]:s.hasAnimated():((!s||r||o)&&(s={image:e,error:this.createObservable(),hasAnimated:this.createObservable(!1)},n=Object(i.__spreadArray)(Object(i.__spreadArray)([],n,!0),[s],!1)),s.hasAnimated(),s.error())}}else n=[];return n},t.prototype._getTiles=function(){var e=this,t=this.observables.createArray(),n=this.addDisposable(t.map({mappingWithDisposeCallback:function(t){var n=t.image,a=t.error,i=t.hasAnimated,r=new(e.managed(e._animationTrackerType))({hasAnimated:i,image:n,referenceRotation:e._rotation,referenceImage:e._image,fadeIn:e.fadeIn});return{mappedValue:{image:n,rotation:r.rotation,isLoaded:r.isLoaded,error:a,scale:e._scale,desiredSize:e._desiredSize,alignment:e._alignment,position:e.createObservable(),loadImageScenarioName:e._scenarioName},dispose:function(){r.dispose()}}}}));return this.createBackgroundComputed(function(){t.splice.apply(t,Object(i.__spreadArray)([0,t.peek().length],e._tileDefinitions(),!1))}),n},t}(r.e),h=Object(a.e)({tagName:"od-image-stack",template:'<span class="od-ImageStack" data-bind="css:{\'od-ImageStack--fade\':fadeIn},template:{foreach:tiles}"><span class="od-ImageStack-tile" data-bind="css:{\'od-ImageStack-tile--isLoaded\':$data.isLoaded},component:{name:$component.imageTileTagName,params:$data}"></span></span>',viewModel:_,synchronous:!0}),b=n(16),g=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.imageStackTagName=h.tagName;var i=t.image,r=t.rotation,s=void 0===r?o.e.none:r,f=t.alignment,p=t.desiredSize,m=t.isLoaded,_=t.isCurrent,b=t.error,g=t.coverage,v=void 0===g?{minimum:1,maximum:1}:g,y=t.scale,S=t.fadeIn,D=t.allowLoading,I=t.position,x=t.loadImageScenarioName,C=n.thumbnailCache,O=void 0===C?a.resources.consume(c.e):C,w=n.outputExtenders,E=void 0===w?{deferred:!0}:w;return a._thumbnailCache=O,a._image=a.wrapObservable(i),a._rotation=a.wrapObservable(s),a._alignment=d.n(f),a._desiredSize=a.wrapObservable(p),a._isLoaded=m,a._coverage=a.wrapObservable(v),a._loadedImage=a.createObservable(),a._effectiveDesiredSize=a.createPureComputed(a._computeEffectiveDesiredSize),a._effectiveDesiredSize.equalityComparer=l.e,a._idealSize=a.createPureComputed(a._computeIdealSize),a._idealSize.equalityComparer=l.e,a._idealImage=a.createPureComputed(a._computeIdealImage),a._idealImage.equalityComparer=u,a._fallbackImage=a.createPureComputed(a._computeFallbackImage),a._fallbackImage.equalityComparer=u,a._cachedImage=a.createPureComputed(a._computeCachedImage),a._cachedImage.equalityComparer=u,a._currentImage=a.createPureComputed(a._computeCurrentImage),a._currentImage.equalityComparer=u,a._isCurrent=a.createPureComputed(a._computeIsCurrent),a.imageStackParams={image:a._currentImage,rotation:a._rotation,desiredSize:a._desiredSize,loadedImage:a._loadedImage,isLoaded:a._isLoaded,error:b,scale:y,alignment:a._alignment,fadeIn:S,allowLoading:D,position:I,loadImageScenarioName:x},_&&a.createBackgroundComputed(function(){return _(a._isCurrent())}).extend(E),a}return Object(i.__extends)(t,e),t.prototype._computeIsCurrent=function(){return u(this._loadedImage(),this._idealImage())},t.prototype._computeCurrentImage=function(){var e=this._loadedImage(),t=this._idealImage(),n=this._cachedImage(),a=this._fallbackImage();return e?u(e,t)?this._currentImage.peek():t:n||a||t},t.prototype._computeEffectiveDesiredSize=function(){var e,t=this._desiredSize(),n=window.devicePixelRatio||1;return t&&(e={width:t.width*n,height:t.height*n}),e},t.prototype._computeIdealSize=function(){var e,t=this._image();if(t){var n=t.width,a=t.height,i=this._effectiveDesiredSize();if(i&&i.width&&i.height){if(n&&a){var r=this._alignment.getTransform(t,i);e={width:r.scale*t.width,height:r.scale*t.height}}}else e={width:n,height:a}}return e},t.prototype._computeIdealImage=function(){var e,t=this._image(),n=this._idealSize();return t&&(n?(e=this._getDerivedImage(t,n))!==this._idealImage.peek()&&this._thumbnailCache.register(t,e,n,!1):e=t.getAligned?t.getAligned(this._effectiveDesiredSize(),this._alignment):t,b.t.isActivated("0ECA92CE-9CE8-41A7-8AEA-ED7D0D862836","10/08/2022","fix secure thumbnail link and meta throttling issue")||(e=Object(i.__assign)(Object(i.__assign)({},t),e))),e},t.prototype._computeFallbackImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var a=(this._coverage()||{}).fallback,i=void 0===a?0:a;if(i){var r={width:n.width*i,height:n.height*i};(e=this._getDerivedImage(t,r))!==this._fallbackImage.peek()&&this._thumbnailCache.register(t,e,r,!1)}}return e},t.prototype._computeCachedImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var a=this._thumbnailCache.getCoveragePercent(t,n),i=this._coverage()||{},r=i.minimum,o=void 0===r?1:r,s=i.maximum,c=o*a,d=(void 0===s?1:s)*a;e=this._thumbnailCache.retrieve(t,d,c)}return e},t.prototype._getDerivedImage=function(e,t){return{url:e.getAligned?e.getAligned(t,this._alignment).url:s.format(e.url,Math.ceil(t.width),Math.ceil(t.height)),width:e.width,height:e.height}},t}(r.e),v=Object(a.e)({tagName:"od-image-frame",template:'<span class="od-ImageFrame" data-bind="component:{name:$component.imageStackTagName,params:$component.imageStackParams}"></span>',viewModel:g,synchronous:!0});t.e=v},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(263),i=n(142),r=n(1203),o=n(840),s=n(358),c=n(971),d=n(698),l={itemCacheStore:o.e,observablesFactoryType:r.observablesFactoryTypeResourceKey,asyncType:r.asyncTypeResourceKey},u=function(){function e(e,t){void 0===e&&(e={});var n=this._scope=new s.e,i=t.itemCacheStore;this._observables=n.attach(new t.observablesFactoryType({owner:this})),this._async=n.attach(new t.asyncType(this)),this._itemCacheEvaluator=i.dispatch(a.t)}return e.prototype.dispose=function(){this._scope.dispose()},e.prototype.pureCompute=function(e,t){void 0===t&&(t={});var n=t.suppressGetItems,a=void 0!==n&&n,i=t.evaluationContext,r=this._observables,o=this._itemCacheEvaluator,l=this._scope.attach(new s.e),u=l.attach(r.create()),f=!0,p=function(t){return f?r.ignore(function(){return e(t,{})}):e(t,{})};p.selector=e;var m=o.createItemCacheSelector(p,{suppressGetItems:a,evaluationContext:i}),_=l.attach(r.pureCompute(function(){m.markAsChanged(),f=!1;var e=m.get();return f=!0,e}));_.equalityComparer=c.n,u(m.get()),m.subscribe(function(){u(m.get()),m.registerDemands()});var h=l.attach(r.pureCompute(function(){return _(),u(),m.get()}));return h.equalityComparer=c.n,this._async.setImmediate(function(){m.registerDemands()}),l.attach({dispose:function(){m.dispose()}}),Object(d.e)(h,function(){l.dispose()})},e}(),f=Object(i.r)("ItemCacheObservable.new",u,l)}],Array(20),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(2697),i=new a.e("Item",a.t.subject)},,,,,,function(e,t,n){"use strict";var a=n("knockout-lib"),i=n(3337),r=function(){function e(){this.handlers=[]}return e.prototype.register=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length-1;n++)this.handlers.push({pattern:e[n],callback:e[e.length-1]})},e.prototype.match=function(e,t){for(var n=0;n<this.handlers.length;n++)if(this._compare(this.handlers[n].pattern,e)){var a=this.handlers[n].callback.call(this,e,t);return"boolean"!=typeof a||a}return!1},e.prototype._compare=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0},e}(),o=r,s=n(188),c=n(136),d=function(){function e(){}return e.init=function(t,n,r,o,c){var d,l=a.utils.unwrapObservable(n()),u=r(),f=new s.t(null),p={mode:"multi",direction:"custom",properties:{selected:"selected",focused:"focused",activeClass:"selection-active"}},m=l.selectionModel||new i.e;d=l.data?l.data:u.foreach&&u.foreach.data||u.foreach||u.template&&u.template.foreach,m.items=a.isObservable(d)?d:a.observableArray(d),m.rootElement=a.observable(t),l?(m.focused=l.focused||a.observable(null),m.anchor=l.anchor||a.observable(null),m.layout=l.layout||a.observable(null),m.toggleClass=m.layout()?m.layout().getToggleClass():l.toggleClass||null,m.clearSelectionOnRemoval=l.clearSelectionOnRemoval,m.selectFirstItemOnActivate="boolean"!=typeof l.selectFirstItemOnActivate||l.selectFirstItemOnActivate,a.isObservable(l.mode)?m.mode=l.mode:m.mode=a.observable(l.mode||p.mode),a.isObservable(l.direction)?m.direction=l.direction:m.direction=a.observable(l.direction||p.direction),a.utils.extend(p.properties,l.properties)):(m.selection=a.observableArray(l.data),m.focused=a.observable(null),m.anchor=a.observable(null),m.mode=a.observable(p.mode),m.direction=a.observable(p.direction),m.layout=null),m.init(p);var _=e.getMode(m.mode())(m,l.isReadyToBeSelected);e._registerEventHandlers(f,t,m,_,l.alwaysSelectFirst,l.isActive,l.allowInputEvents),a.utils.domNodeDisposal.addDisposeCallback(t,function(){m.clearSelectionOnRemoval&&m.clear(),f.dispose()})},e.getMode=function(t){var n=e.modes[t];if(!n)throw new Error('Unknown mode: "'+t+'"');return n},e._registerEventHandlers=function(e,t,n,a,i,r,o){function s(e){var t=e.target,i=t&&"A"===t.tagName,r=n.findItemData(e.target);e.hasItem=!!r,e.isClickOnToggleElement=n.isClickOnToggleElement(this,e.target),i||a.match(e,r)}e.on(t,"touchstart",s),e.on(t,"touchend",s),e.on(t,"touchmove",s),e.on(t,"click",s),e.on(t,"focusin",function(e){if(!(e.relatedTarget&&t.contains(e.relatedTarget)||n.isActive.peek())){if(i){var a=n.firstItem();n.focused(a),n.anchor(a)}else if(e.target===t){var r=n.focused.peek();0===n.selection.peek().length&&!r&&n.selectFirstItemOnActivate?(a=n.firstItem(),n.focused(a),n.anchor(a),n.selectItem(a)):r&&(n.selectItem(r),n.anchor(r))}n.activate()}}),e.on(t,"focusout",function(e){e.relatedTarget&&!t.contains(e.relatedTarget)&&n.deactivate()}),e.on(t,"keydown",function(e){var i=e.target,s=i&&("INPUT"===i.tagName||"TEXTAREA"===i.tagName);if(!o&&s||r&&!r())return!0;var d=n.focused.peek();e.hasItem=!!d,e.keyCode===c.e.tab&&e.shiftKey&&!e.ctrlKey&&t.focus(),a.match(e,d)&&(e.stopPropagation(),e.preventDefault())})},e._isItemReadyToBeSelected=function(e,t){var n=!1;return!e||t&&!t(e)||(n=!0),n},e._getSingleMatchers=function(t,n){t.focused()?t.selection([t.focused()]):t.selection.splice(1);var a=new o;return a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!1},function(e,n){t.selectItem(n),t.anchor(n)}),a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!0},function(e,n){t.selectItem(n),t.anchor(n)}),a.register({type:"keydown",which:c.e.end},function(e,n){var a=t.lastItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.home},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.space,hasItem:!0},function(e,t){}),(t.hasVertical()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.up,hasItem:!1},{type:"keydown",which:c.e.down,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.up,hasItem:!0},function(a,i){var r=t.aboveItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.down,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),(t.hasHorizontal()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.left,hasItem:!1},{type:"keydown",which:c.e.right,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.left,hasItem:!0},{type:"keydown",which:c.e.tab,shiftKey:!0,hasItem:!0},function(a,i){var r=t.leftItem(i);if(i===t.firstItem())return!1;e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.right,hasItem:!0},{type:"keydown",which:c.e.tab,hasItem:!0},function(a,i){var r=t.rightItem(i);if(i===t.lastItem())return!1;e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),a},e._getMultiMatchers=function(t,n){var a=new o;return a.register({type:"click",which:1,ctrlKey:!0,shiftKey:!0,hasItem:!0},{type:"click",which:1,metaKey:!0,shiftKey:!0,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(n)}),a.register({type:"click",which:1,ctrlKey:!0,hasItem:!0},{type:"click",which:1,metaKey:!0,hasItem:!0},function(e,n){t.toggleSelection(n),t.anchor(n)}),a.register({type:"click",which:1,shiftKey:!0,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(n)}),a.register({type:"click",which:1,hasItem:!1},function(e,n){t.removeSelection()}),a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!1},function(e,n){t.selectItem(n),t.anchor(n)}),a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!0},function(e,n){t.toggleSelection(n),t.anchor(n)}),a.register({type:"keydown",which:c.e.space,hasItem:!0},function(e,n){t.toggleSelection(n),t.anchor(n)}),a.register({type:"keydown",which:c.e.end,ctrlKey:!0,shiftKey:!0},{type:"keydown",which:c.e.end,metaKey:!0,shiftKey:!0},function(e,n){t.appendSelectionFromAnchor(t.lastItem())}),a.register({type:"keydown",which:c.e.end,ctrlKey:!0},{type:"keydown",which:c.e.end,metaKey:!0},function(e,n){var a=t.lastItem();t.focused(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.end,shiftKey:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.lastItem())}),a.register({type:"keydown",which:c.e.end},function(e,n){var a=t.lastItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.home,ctrlKey:!0,shiftKey:!0},{type:"keydown",which:c.e.home,metaKey:!0,shiftKey:!0},function(e,n){t.appendSelectionFromAnchor(t.firstItem())}),a.register({type:"keydown",which:c.e.home,ctrlKey:!0},{type:"keydown",which:c.e.home,metaKey:!0},function(e,n){var a=t.firstItem();t.focused(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.home,shiftKey:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.firstItem())}),a.register({type:"keydown",which:c.e.home},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),(t.hasVertical()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.up,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.up,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.down,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.down,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.up,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.up,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(t.aboveItem(n))}),a.register({type:"keydown",which:c.e.up,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.up,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.aboveItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.up,shiftKey:!0,altKey:!1,hasItem:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.aboveItem(n))}),a.register({type:"keydown",which:c.e.up,altKey:!1,hasItem:!0},function(a,i){var r=t.aboveItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.down,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.down,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)}),a.register({type:"keydown",which:c.e.down,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.down,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.down,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)}),a.register({type:"keydown",which:c.e.down,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),(t.hasHorizontal()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.left,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.left,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.right,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.right,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.left,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.left,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)}),a.register({type:"keydown",which:c.e.left,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.left,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.left,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)}),a.register({type:"keydown",which:c.e.left,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.right,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.right,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)}),a.register({type:"keydown",which:c.e.right,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.right,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.right,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)}),a.register({type:"keydown",which:c.e.right,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),a.register({type:"keydown",which:c.e.a,ctrlKey:!0},{type:"keydown",which:c.e.a,metaKey:!0},function(e,n){t.selectAll()}),a},e.modes={single:e._getSingleMatchers,multi:e._getMultiMatchers},e}();t.e=d},,,function(e,t,n){"use strict";var a=function(){function e(){this.id=++e._lastBatchId}return e._lastBatchId=0,e}();t.e=a}],Array(29),[function(e,t,n){"use strict";n.d(t,"e",function(){return m}),n.d(t,"i",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"t",function(){return g});var a=n(0),i=n(1203),r=n(141),o=n(1912),s=n(2238),c=n(364),d=n(311),l=n(8),u=n(142),f=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this,i=a.observables;a._selectionModel=n.itemSetSelectionModel,a._clientSideExtensionHelper=n.clientSideExtensionHelper,a._itemsStore=n.itemsStore;var s=a.selection=new o.e({selectionMode:1===a._selectionModel.mode?r.n.single:r.n.multiple,onSelectionChanged:a._onSelectionChange.bind(a),getKey:a.getKey.bind(a),canSelectItem:a._canSelectItem.bind(a)});return a._isModal=i.create(!!s.isModal&&s.isModal()),i.compute(a._computeUpdateItems),i.backgroundCompute(a._computeUpdateReactSelection),a.isModal=i.compute({read:function(){return a._isModal()},write:function(e){return s&&s.setModal(e)},pure:!0}),a}return Object(a.__extends)(t,e),t.prototype.getKey=function(e,t){return e&&this._selectionModel.getItemKey(this._itemsStore.getItem("".concat(e.key)))||"".concat(t)},t.prototype._computeUpdateReactSelection=function(){var e=this,t=this._selectionModel,n=this.selection,a=t.selection();this.observables.ignore(function(){if(e._shouldUpdateSelection())if(0===t.mode&&(t.isAllSelected()&&!n.isAllSelected()||0===t.selectedCount()&&n.isAllSelected()))n.setAllSelected(t.isAllSelected()&&!n.isAllSelected());else{n.setChangeEvents(!1),n.setAllSelected(!1);for(var i=0,r=a;i<r.length;i++){var o=r[i];n.setKeySelected(t.getItemKey(o),!0,!1)}n.setChangeEvents(!0)}})},t.prototype._shouldUpdateSelection=function(){var e=this._selectionModel,t=this.selection,n=!1;if(e.selectedCount()!==t.count||0===e.mode&&e.isAllSelected()!==t.isAllSelected())n=!0;else if(!t.isAllSelected()||1===e.mode)for(var a=0,i=e.selection();a<i.length;a++){var r=i[a];if(!t.isKeySelected(e.getItemKey(r))){n=!0;break}}return n},t.prototype._onSelectionChange=function(){var e=this;this.observables.ignore(function(){var t=e._selectionModel,n=e.selection;if(e._isModal(!!n.isModal&&n.isModal()),e._shouldUpdateSelection()){if(n.mode===r.n.multiple&&(!t.isAllSelected()&&n.isAllSelected()||t.isAllSelected()&&0===n.count))!t.isAllSelected()&&n.isAllSelected()?t.selectAll():t.clear();else{for(var a=[],i=0,o=n.getSelection();i<o.length;i++){var s=o[i],c=e.getKey(s);a.push(c)}t.setSelectedKeys(a)}var d=e._clientSideExtensionHelper;d&&d.raiseListChangeEvent(n.getSelection())}})},t.prototype._computeUpdateItems=function(){var e=this,t=this._selectionModel.itemSet(),n=[];if(t)for(var a=0,i=t.content().items;a<i.length;a++){var r=i[a],o=this.observables.peekUnwrap(r);o?n.push(o):n.push(void 0)}this.observables.ignore(function(){var a=t&&e.observables.peekUnwrap(t.item);(t&&!t.isPlaceholder||a&&a.isStub)&&e.selection.setItems(n,!1)})},t.prototype._canSelectItem=function(e){var t=this;return this.observables.ignore(function(){return t._selectionModel.canSelectItem(t._itemsStore.getItem(e.key))})},t}(i.default),p=new l.t({name:"".concat("SelectionManager",".selectionManager"),factory:new u.n(f,Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{itemSetSelectionModel:d.I,clientSideExtensionHelper:c.e.optional,itemsStore:s.t}))}),m=new l.t({name:"".concat("SelectionManager",".getKey"),factory:{dependencies:{selectionManager:p},create:function(e){var t=e.selectionManager;return{instance:function(e,n){return t.getKey(e,n)}}}}}),_=new l.t({name:"".concat("SelectionManager",".selectionMode"),factory:{dependencies:{itemSetSelectionModel:d.I},create:function(e){return{instance:0===e.itemSetSelectionModel.mode?r.n.multiple:r.n.single}}}}),h=new l.t({name:"".concat("SelectionManager",".getKey"),factory:{dependencies:{selectionManager:p},create:function(e){return{instance:e.selectionManager.isModal}}}}),b=new l.t({name:"SelectionManager",factory:{dependencies:{selectionManager:p},create:function(e){return{instance:e.selectionManager.selection}}}}),g=new l.t({name:"".concat("SelectionManager",".hasSelection"),factory:{dependencies:{itemSetSelectionModel:d.I,isSelectionModal:h,observablesFactoryType:i.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType,n=e.itemSetSelectionModel,a=e.isSelectionModal;return{instance:t.pureCompute(function(){return a()||n.selectedCount()>0}),disposable:t}}}})}],Array(22),[function(e,t,n){"use strict";n.r(t),n.d(t,"typeResourceKey",function(){return m});var a=n(0),i=n(2184),r=n(54),o=n(70),s=n(147),c=n(311),d=n(489),l=n(1866),u=n(8),f=n(142),p=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="Navigation";var i=t.url,r=t.viewParams,o=t.target,d=void 0===o?"_top":o,l=t.forceNavigation,u=void 0!==l&&l,f=t.ignoreHistory,p=t.beforeNavigation,m=t.afterNavigation,_=t.postProcessUrl,h=n.navigation,b=void 0===h?a.resources.consume(s.e):h,g=n.viewParamsObservable,v=void 0===g?a.resources.consume(c.P):g;return a._navigation=b,a._viewParams=v,a._url=a.wrapObservable(i),a._inputViewParams=a.wrapObservable(r),a._target=a.wrapObservable(d),a._forceNavigation=u,a._ignoreHistory=f,a._beforeNavigation=p,a._afterNavigation=m,a._postProcessUrl=_,a}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=this._url.peek(),a=this._inputViewParams.peek(),i=this._beforeNavigation;i&&i(this._navigation);var s=this._postProcessUrl?this._postProcessUrl(n):n;return(this._forceNavigation||n)&&this._navigation.navigateTo({url:s,viewParams:a,frameId:this._target.peek(),ignoreHistory:this._ignoreHistory}),this._afterNavigation&&this._afterNavigation(this._navigation),r.n.wrap({resultType:o.e.Success})},t.prototype.onIsAvailable=function(){var e=this._url();if(!e)return!1;if(this._forceNavigation)return!0;var t=this._inputViewParams(),n=this._viewParams(),a="#"+d.t(n),i=t&&0===t.indexOf("#")?t.substring(1):"",r=i+(i?"&":"")+(0===e.indexOf("#")?e.substring(1):"");if(r){var o=d.e(r);return!l.e(n,o)}return e!==a},t.dependencies={resources:u.r,navigation:s.e,viewParamsObservable:c.P},t}(i.e);t.default=p;var m=Object(f.o)("NavigationAction",p)}],Array(21),[function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"f",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"p",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"o",function(){return f}),n.d(t,"s",function(){return p}),n.d(t,"d",function(){return m}),n.d(t,"n",function(){return _}),n.d(t,"l",function(){return h}),n.d(t,"u",function(){return b});var a=n(3344),i=new a.e("createFolder"),r=new a.e("rename"),o=(new a.e("moveFrom"),new a.e("copyFrom"),new a.e("moveTo")),s=new a.e("copyTo"),c=new a.e("deleteItem"),d=new a.e("restoreItem"),l=(new a.e("deleteAllItems"),new a.e("restoreAllItems"),new a.e("createText"),new a.e("changeExpiration"),new a.e("open")),u=new a.e("openInTextEditor"),f=new a.e("openInHtmlViewer"),p=new a.e("openInImageEditor"),m=new a.e("openPdfInBrowser"),_=(new a.e("quickEdit"),new a.e("editItem"),new a.e("createShortcut")),h=new a.e("pinToMru"),b=new a.e("printPdf")}],Array(24),[function(e,t,n){"use strict";n.r(t),n.d(t,"PowerAppsStore",function(){return _}),n.d(t,"getPowerAppRunTimeUrl",function(){return h}),n.d(t,"getPowerAppRunTimeHost",function(){return b}),n.d(t,"resourceKey",function(){return g});var a=n(0),i=n(1203),r=n(8),o=n(142),s=n(43),c=n(383),d=n(3861),l=n(54),u=n(101),f=n(38),p=n(4844),m=n(16).t.isActivated("e034d0fc-3a86-451a-bd9c-a58b8c73135f","09/01/2022","Use the WebPlayer SDK from @ms/bapisdk package"),_=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._initialized=!1,a.recentlyCreatedViews=[],a.appView=a.createObservable(null),a.appForm=a.createObservable(null),a.showAppView=a.createObservable(!1),a.showAppForm=a.createObservable(!1),a.loadPowerApp=a.createObservable(!1),a.formData=a.createObservable(null),a.isFormInitialized=!1,a._powerAppsVerifier=n.powerAppsVerifier,a}return Object(a.__extends)(t,e),t.arePowerAppsFormsEnabled=function(){return p.e.arePowerAppsFormsEnabled()},t.prototype.isPowerAppsSupportedScenario=function(){return this._powerAppsVerifier.isPowerAppsSupportedScenario()},t.prototype.hasPowerAppsForm=function(e){if(void 0===e&&(e=!1),!this._powerAppsVerifier.mayHavePowerAppsForm())return l.n.resolve(!1);var t=this.resources.consume(u.ue);return t.isCurrentQuery(f.e.RecycleBin)||t.isCurrentQuery(f.e.SecondStageRecycleBin)?l.n.resolve(!1):(this._hasPowerAppsFormPromise&&!e||(this._hasPowerAppsFormPromise=l.n.resolve(this.resources.consumeAsync(d.e.optional)).then(function(e){return e&&e.hasFormRenderMode(3)})),this._hasPowerAppsFormPromise)},t.prototype.createAppForm=function(e){var t=this;this.loadPowerAppJs(function(){t.appForm(e)})},t.prototype.setAndShowAppForm=function(e,t,n,a,i){this.formData({item:this.createObservable(e),type:this.createObservable(t),contentTypeId:n,originalClickTime:a,activityPaneSection:i}),this.showAppForm(!0),this.loadPowerApp.peek()||this.loadPowerApp(!0)},t.prototype.createAppView=function(e){var t=this;this.loadPowerAppJs(function(){t.appView(e)})},t.prototype.loadPowerAppJs=function(e){var t=this;this._initialized?e&&e():m?window.require(["power-app"],function(n){t._initialized=!0,e&&e()}):n.e(832).then(n.t.bind(null,5330,7)).then(function(n){t._initialized=!0,e&&e()})},t.prototype.ensureAppLoadSignal=function(e){return this.appLoadSignal&&!e||(this.appLoadSignal=new c.e),this.appLoadSignal},t.prototype.ensureListContextUpdateSignal=function(e){return this.listContextUpdateSignal&&!e||(this.listContextUpdateSignal=new c.e),this.listContextUpdateSignal},t.prototype.ensurePowerAppSdkPreloaded=function(){this._powerAppsVerifier.ensurePowerAppSdkPreloaded()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{powerAppsVerifier:p.t}),t}(i.default);function h(e,t){var n="apps.powerapps.com";if(Object(s.isFeatureEnabled)(s.PowerAppsAndAndProcessSimpleTestEnvironment))n="apps.test.powerapps.com";else if(t&&t.farmSettings){var a=t.farmSettings.ExternalService_powerappsappshostname;a&&(n=a)}return"https://".concat(n,"/play/").concat(e,"?source=sharepoint")}function b(e){var t="apps.powerapps.com";if(Object(s.isFeatureEnabled)(s.PowerAppsAndAndProcessSimpleTestEnvironment))t="apps.test.powerapps.com";else if(e&&e.farmSettings){var n=e.farmSettings.ExternalService_powerappsappshostname;n&&(t=n)}return"https://".concat(t)}t.default=_;var g=new r.t({name:"PowerAppsStore",factory:new o.n(_)})},,,,,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this,a=n.valueAccessor();n._isDragging=a.isDragging,n._mayReceiveDrop=a.mayReceiveDrop,n._receiveDrop=a.receiveDrop;var i=n.observables;return n._state=i.create({isWithinElement:!1,data:void 0}).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}),n._isDragging&&i.compute(function(){n._isDragging.call(n.bindingContext.$data,n._state().isWithinElement,n._state().data)}),n.events.onAll(n.element,{"od-dragEnter":n._onDragEnter,"od-dragLeave":n._onDragLeave,"od-processDrop":n._onProcessDrop,"od-dragOutWindow":n._onDragOutWindow}),n}return Object(a.__extends)(t,e),t.prototype._onDragEnter=function(e){var t=e.args;return!(t&&t.dragData&&t.dropSourceElement&&(this._state({isWithinElement:!0,data:{dragData:t.dragData,dropTargetData:t.dropTargetData}}),!t.dropTargetData&&this._mayReceiveDrop&&(t.dropTargetData=this._mayReceiveDrop.call(this.bindingContext.$data,t.dragData,t.dropSourceElement)),0))},t.prototype._onDragLeave=function(e){return this._state({isWithinElement:!1,data:void 0}),!0},t.prototype._onProcessDrop=function(e){var t=e.args;return!(t&&t.dragData&&t.dropSourceElement&&(!t.isHandled&&this._receiveDrop&&this._receiveDrop.call(this.bindingContext.$data,t.dragData,t.dropSourceElement)?(t.isHandled=!0,1):(this._state({isWithinElement:!1,data:void 0}),0)))},t.prototype._onDragOutWindow=function(e){return this._state({isWithinElement:!1,data:void 0}),!0},t}(n(2175).t);t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return A});var a=n(0),i=n(1203),r=n(54),o=n(253),s=n(70),c=n(91),d=n(38),l=n(1477),u=n(101),f=n(3260),p=n(4211),m=n(90),_=n(1724),h=n(489),b=n(2961),g=n(79),v=n(535),y=n(311),S=n(4593),D=n(8),I=n(142),x=n(1333),C=n(1855),O=!n(16).e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),w=new D.t({name:"".concat("DropHelper",".updateItemMetadataOperator"),loader:new I.t(function(){return r.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-common"),n.e("deferred"),n.e("deferred.odsp-datasources"),n.e(524)]).then(n.bind(null,5406))).then(function(e){return e.typeResourceKey})})}),E=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._urlDataSource=n.urlDataSource,a._shortcutProvider=n.shortcutProvider,a._currentItemSet=n.currentItemSet,a._engagement=n.engagement,a._postUploadProjectionHelper=n.postUploadProjectionHelper,a._isItemsScopeEnabled=n.isItemsScopeEnabled,a._wip=n.wip,a._quotaBlockAction=new(a.managed(n.actionMap.QuotaBlockAction))({isDragAndDrop:!0}),a}return Object(a.__extends)(t,e),t.prototype.processDrop=function(e,t,n,a){var i=this;if(void 0===n&&(n=!1),void 0===a&&(a=!1),!t||!t.isDropEnabled||t===e.item||this._wip&&this._wip.isWIPEnabled())return!1;var b=this._engagement;if(0===e.type){if(b.logData({name:"DragAndDropEvent",isIntentional:!0}),this._quotaBlockAction.isAvailable.peek())return this._quotaBlockAction.execute(null),!1;var v=this._currentItemSet.peek();return r.n.resolve(this.resources.consumeAsync(f.e)).then(function(a){var r=new a({files:e.files,parentItem:t,itemSet:v,wasDragAndDropped:!0,type:e.uploadType,metadata:e.metadata,skipInvalidation:!!n});return i.trackPromise(r.start()),r.wait()}).done(null,function(e){m.e.log(e)}),!0}if(1===e.type){var y=e.metadata&&e.metadata.group;return y?(this._resolveSelection(e).then(function(f){var p=new l.e({name:"DragChangeGroup",pageType:c.e[i._urlDataSource.getPageType()],queryType:d.e[i._urlDataSource.getQueryType()]}),b=[];n&&f.forEach(function(e){var t=_.e(e);if(!a){var n=h.e(t.key);n.group=y.groupingId,t.key=h.t(n)}t.state.upload.status=1,t.properties[y.fieldSchema.Name]=y.groupingId,b.push(i.createObservable(t)),e.state.removing=!0}),r.n.resolve(i.resources.consumeAsync(w)).then(function(a){var o=new a({items:f,metadata:e.metadata,parentItem:t,skipInvalidation:n,onComplete:function(t){t?(n&&i._postUploadProjectionHelper.updateItemSetPostUpload(e.itemSet,b,y),i._isItemsScopeEnabled()&&y.itemKey&&r.n.resolve(i.resources.consumeAsync(u.k)).then(function(e){e.invalidateGroups([y.itemKey])})):alert("failure updating metadata")}});return i.trackPromise(o.start()),o.wait()}).done(void 0,function(e){return m.e.log(e)});var g={},v={count:f.length};if(1===f.length){g.fileType=o.e[f[0].type];var S=O&&f[0].extension?Object(C.e)(f[0].extension):f[0].extension||"";g.extension=S}p.end({resultType:s.e.Success,extraData:g,extraMetrics:v})}).done(null,function(e){return m.e.log(e)}),!0):e.itemSet.item.peek().key!==t.key&&(this._resolveSelection(e).then(function(n){n=n.filter(function(e){return e!==t});var a=new l.e({name:"DragMove",pageType:c.e[i._urlDataSource.getPageType()],queryType:d.e[i._urlDataSource.getQueryType()]});return i.resources.consumeAsync(p.n).then(function(a){return a.copyItems({items:n,parentKey:e.item.parentKey,targetId:t.id,targetKey:t.key,cid:i._urlDataSource.getOwnerId(),group:t.isGroup?1:0,isAsync:!1,isMove:!0})}).then(function(){var e={},r={count:n.length};if(i._isItemsScopeEnabled()&&i.resources.consumeAsync(u.k).then(function(e){e.invalidateItems(t.key)}),1===n.length){e.fileType=o.e[n[0].type];var c=O&&n[0].extension?Object(C.e)(n[0].extension):n[0].extension||"";e.extension=c}a.end({resultType:s.e.Success,extraData:e,extraMetrics:r})},function(){a.end({resultType:s.e.Failure})})}).done(null,function(e){return m.e.log(e)}),!0)}if(3===e.type&&this._shortcutProvider){b.logData({name:"Link.DragAndDrop.Drop",isIntentional:!0});var S=e.links.split("\n");return(S=S.filter(function(e){return"#"!==e.charAt(0)})).forEach(function(e){var n=new g.t(e).getHost()+".url";i._shortcutProvider.createShortcut(t.key,n,e)}),!0}},t.prototype._resolveSelection=function(e){return e.selection?e.selection.resolve().then(function(t){return t&&0!==t.length||(t=[e.item]),t}):r.n.wrap([e.item])},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{shortcutProvider:b.resourceKey.optional,urlDataSource:u.ue,wip:u.Se.optional,actionMap:y.e,currentItemSet:y.s,postUploadProjectionHelper:S.e,engagement:v.e,isItemsScopeEnabled:x.f.lazy}),t}(i.default),A=Object(I.r)("DropHelper",E)},,,,,,,,function(e,t,n){"use strict";n.d(t,"c",function(){return y}),n.d(t,"d",function(){return D}),n.d(t,"a",function(){return x}),n.d(t,"i",function(){return C}),n.d(t,"t",function(){return w}),n.d(t,"o",function(){return E}),n.d(t,"s",function(){return A});var a,i,r,o,s,c=n(353),d=n(2189),l=n(969),u=n(1335);n.d(t,"e",function(){return u.e}),n.d(t,"n",function(){return u.t}),n.d(t,"r",function(){return u.n}),n.d(t,"l",function(){return u.a}),n.d(t,"u",function(){return u.i}),n.d(t,"f",function(){return u.r});var f="ms-word",p="onenote|UsePlain",m="ms-powerpoint",_="ms-excel",h="ms-visio",b="ms-publisher",g="ms-project",v=((a={})[f]=l.OpenInWordOnline,a[p]=l.OpenInOneNoteOnline,a[m]=l.OpenInPowerPointOnline,a[_]=l.OpenInExcelOnline,a[h]=l.OpenInVisioOnline,a);function y(e){return v[e]||""}var S=((i={})[f]=l.OpenInWord,i[p]=l.OpenInOneNote,i[m]=l.OpenInPowerPoint,i[_]=l.OpenInExcel,i[h]=l.OpenInVisio,i[b]=l.OpenInPublisher,i[g]=l.OpenInProject,i["ms-infopath"]=l.OpenInInfoPath,i);function D(e){return S[e]}var I=((r={})[f]="Word",r[p]="OneNote",r[m]="PowerPoint",r[g]="Project",r[h]="Visio",r[_]="Excel",r);function x(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":I[e.appMap]||"Word"}function C(e){return I[e]}(o={})[f]="WordLogo",o[p]="OneNoteLogo",o[m]="PowerPointLogo",o[_]="ExcelLogo",o[h]="VisioLogo",o[b]="Page";var O=((s={})[f]="svg/word_16x1.svg",s[p]="svg/onenote_16x1.svg",s[m]="svg/powerpoint_16x1.svg",s[_]="svg/excel_16x1.svg",s[h]="svg/visio_16x1.svg",s[b]="Page",s.Stream="svg/stream_16x1.svg",s),w={"svg/word_16x1.svg":"svg/word_white_stroke_18x1.svg","svg/onenote_16x1.svg":"svg/onenote_white_stroke_18x1.svg","svg/powerpoint_16x1.svg":"svg/powerpoint_white_stroke_18x1.svg","svg/excel_16x1.svg":"svg/excel_white_stroke_18x1.svg","svg/visio_16x1.svg":"svg/visio_white_stroke_18x1.svg"};function E(e){var t=O[e];return t&&new d.e(t)}function A(e){var t=c.e;return-1!==t["ms-word"].lastIndexOf(e)?"ms-word":-1!==t["ms-powerpoint"].lastIndexOf(e)?"ms-powerpoint":-1!==t["ms-excel"].lastIndexOf(e)?"ms-excel":-1!==t["ms-visio"].lastIndexOf(e)?"ms-visio":-1!==t["onenote|UsePlain"].lastIndexOf(e)?"onenote|UsePlain":-1!==t["ms-access"].lastIndexOf(e)?"ms-access":-1!==t["ms-project"].lastIndexOf(e)?"ms-project":-1!==t["ms-publisher"].lastIndexOf(e)?"ms-publisher":void 0}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1203),i=new(n(8).t)({name:"".concat("UseItemsScope.key",".useItemsScope"),factory:{dependencies:{observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})}],Array(17),[function(e,t,n){"use strict";n.d(t,"e",function(){return _}),n.d(t,"t",function(){return h});var a=n(0),i=n(1203),r=n(2203),o=n(2294),s=n(54),c=n(969),d=n(4429),l=n(2189),u=n(311),f=n(655),p=n(142),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._dialogProvider=n.dialogProvider,a._promiseTracker=n.promiseTracker,a._itemSetSelectionModel=n.itemSetSelectionModel,a}return Object(a.__extends)(t,e),t.prototype.resolveSelection=function(){var e,t,n=this.createObservable(d.e),a=this.createObservable(!0),i=this.createObservable(!1),r=this._shouldShowDialog();return this._itemSetSelectionModel?(t=this._itemSetSelectionModel.resolveSelection().then(function(t){return r=!1,e&&e.state(2),t},function(t){return e&&(n(d.t),a(!1),i(!0)),s.n.wrapError(t)}),r&&(e=this._createDialog(n,a,i)).wait().done(void 0,function(){t.cancel()}),this._promiseTracker&&this._promiseTracker.registerPromise(t)):t=s.n.wrap([]),t},t.prototype._createDialog=function(e,t,n){return this._dialogProvider.requestDialog({title:d.n,isDismissable:!1,component:{name:o.e.tagName,params:{text:e}},actions:[{name:c.cancelActionText,execute:function(){return s.n.wrap(3)},isVisible:t,icon:new l.e("Cancel"),isDefault:!0},{name:c.ok,execute:function(){return s.n.wrap(3)},isVisible:n,icon:new l.e("Cancel"),isDefault:!0}]})},t.prototype._shouldShowDialog=function(){for(var e=0,t=this._itemSetSelectionModel.selection.peek();e<t.length;e++){var n=t[e];if(!this.peekUnwrapObservable(n))return!0}return!1},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{dialogProvider:r.e,promiseTracker:u.w.optional,itemSetSelectionModel:u.I}),t}(i.default);function _(e,t){void 0===t&&(t=!1);var n=e.selection();if(1===n.length){var a=Object(f.i)(n[0]);return t&&a.video?a.appMap?a.appMap:"Stream":a.appMap?a.appMap:"nonOfficeApp"}}var h=Object(p.r)("SelectionHelper",m)},,function(e,t,n){"use strict";n.d(t,"t",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"i",function(){return v}),n.d(t,"e",function(){return y});var a=n(253),i=n(2395),r=n(20),o=n(425),s="Doc",c="One",d="Ppt",l="Xls",u="Vsd",f="Lib",p="Drive",m={WinDocuments:f,WinLibrary:f,WinMusic:f,WinPictures:f,WinPodcastLibrary:f,WinVideos:f,WinDrive:p,CDDrive:"CDDrive",GenericDrive:p,UsbDrive:"USBDrive",ExternalDrive:"ExtDrive",NetworkStorage:"NetDrive",Accdb:"Mdb",Doc:s,Docm:s,Docx:s,Dot:s,Dotm:s,Dotx:s,Exe:"Exe",Html:"Html",Mdb:"Mdb",Mpp:"Mpp",Mpt:"Mpp",Odp:d,Ods:l,Odt:s,One:c,Onepkg:c,Onetoc2:c,Notebook:"OneNotebook",Pot:d,Potm:d,Potx:d,Ppa:d,Ppam:d,Pps:d,Ppsm:d,Ppsx:d,Ppt:d,Pptm:d,Pptx:d,Pub:"Pub",Rtf:"Rtf",Txt:"Txt",Vdw:u,Vsd:u,Vsdm:u,Vsdx:u,Vsl:u,Vss:u,Vssm:u,Vssx:u,Vst:u,Vstm:u,Vstx:u,Xaml:"Xaml",Xla:l,Xlam:l,Xll:l,Xls:l,Xlsb:l,Xlsm:l,Xlsx:l,Xlt:l,Xltm:l,Xltx:l,Xml:"Xml",Xps:"Xps",Xsn:"Xsn",Zip:"Zip"};function _(e,t,n){var o=e.extension,s=o&&o.slice("."===o[0]?1:0),c=s&&s.toUpperCase(),d=g(e.itemFromServer&&e.itemFromServer.iconType||s);return e.isDocSet?i.fileTypeDocSet:d||e.type!==a.e.Folder?n||(e.panorama?i.fileTypePanorama:e.photo&&!e.video?r.format(i.fileTypeImage,c||"").trim():d?i["fileType"+d]:c?r.format(i.fileTypeUnknown,c):t?i.listItemType:i.fileTypeNoExtension):i.fileTypeFolder}function h(e){var t=e.slice(e.lastIndexOf(".")+1);return r.format(i.shortcutFileTypeFormat,t.length!==e.length?this.getShortcutFileTypeFromExtension(t):i.fileTypeNoExtension)}function b(e){var t=i.fileTypeNoExtension;if(!e)return t;var n=g(r.capitalize(e));if(n)return i["fileType"+n];var a=e.toUpperCase();return a?r.format(i.fileTypeUnknown,a):t}function g(e){return m[e]}function v(e){return!!e.properties&&!!e.properties.autoAlbumTag}function y(e){if(!e)return o.e.Word;var t=g(r.capitalize(e.split(".").pop()));return t===c?o.e.OneNote:t===d?o.e.PowerPoint:t===l?o.e.Excel:t===u?o.e.Visio:o.e.Word}},,,,,,,,,,,,,function(e,t,n){"use strict";var a=n(5565);t.e=a.e},function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return u});var a=n(142),i=n(2390),r=n(976),o=n(388),s=n(3237),c=n(2989),d=n(2925),l=n(3343),u=Object(a.r)("PeoplePickerDataSource",i.e,{apiUrlHelper:r.e,pageContext:o.e,dataRequestor:s.e,oAuthTokenProvider:c.e,graphPeoplePickerHelper:d.e,substratePeoplePickerHelper:l.e})}],Array(26),[function(e,t,n){"use strict";var a=n(38);t.e=function(e){void 0===e&&(e=""),this.isDropEnabled=!1,this.permissions={High:0,Low:0},this.key=e,this.revision=0,this.queryType=a.e.Files,this.displayType=a.e.Files,this.isPlaceholder=!0,this.properties={},this.recycleBinProperties={},this.reputationProperties={},this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0},this.urls={},this.state={upload:{status:5},removing:!1}}},,,,function(e,t,n){"use strict";var a=n(1549);n.d(t,"e",function(){return a.e}),n.d(t,"t",function(){return a.t}),n.d(t,"n",function(){return a.n})},function(e,t,n){"use strict";var a=n(4816);t.e=a.e},function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(3344),i=new a.e("share"),r=(new a.e("addToShared"),new a.e("embed")),o=(new a.e("comment"),new a.e("removeFromShared"),new a.e("addAsMountPoint"),new a.e("removeAsMountPoint"),new a.e("reportAbuse"),new a.e("requestReview"),new a.e("alertItem")),s=new a.e("alertItem")}],Array(14),[function(e,t,n){"use strict";n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(213),i=n(37);function r(e){return e}function o(e){return e}function s(e,t){return e&&e.extension&&!!e.openUrl&&!t.isRecycleBin(e.queryType)&&e.itemStatus!==a.t.ConditionalAccessViewOnly&&e.itemStatus!==a.t.ConditionalAccessBlocked&&i.e.hasItemPermission(e,i.e.openItems)}},,,function(e,t,n){"use strict";var a=n(2315);t.e=a.e}],Array(38),[function(e,t,n){"use strict";n.r(t);var a=n(0),i=n("react-lib"),r=n(5300),o=n(2163),s=n(161),c=n(1955),d=n(1956),l=n(504),u=n(226),f=n(113),p=n(158),m=function(e){function t(t){var n=e.call(this,t)||this;n._onButtonClick=function(){n._closeBanner("Button");var e=n.props.buttonClick;e&&e()},n._onCloseClick=function(){n._closeBanner("X")},n._dataStore=new u.e("UpdateBanner",f.e.local),n._dataStoreKey=t.cacheKey,n._engagementPrefix=t.engagementPrefix||"Banner",n.state={isHidden:n._dataStore.getValue(n._dataStoreKey,f.e.local)||!1};var a=n.props,i=a.image,r=a.maxWidth,o=a.minHeight,s=a.canDismiss,c=void 0===s||s;if(n._canDismiss=c,i){var d=n.props.image,l=d.alignBottom,p=d.background,m=d.containerWidth,_=void 0===m?256:m;n._imageContainerStyle={backgroundColor:p,minWidth:_+"px"},n._imageContainerClass="od-Banner-imageContainer od-Banner-image".concat(l?"Bottom":"Center"),n._imageStyle={maxWidth:_-40+"px",height:"calc(100% - ".concat(20*(l?1:2),"px)")}}return n._bannerStyle={maxWidth:r?"".concat(r,"px"):"",minHeight:o?"".concat(o,"px"):""},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.header,n=e.iconName,a=e.message,u=e.image,f=e.buttonText,p=void 0===f?r.e:f,m=e.isVerticalLayout,_=e.className;return this.state.isHidden?i.createElement("div",{className:"od-Banner od-Banner-hide"}):i.createElement(o.e,null,i.createElement("div",{className:Object(s.e)(_,"od-Banner"),style:this._bannerStyle},u&&i.createElement("div",{className:this._imageContainerClass,style:this._imageContainerStyle},i.createElement("img",{role:"presentation",src:u.url,style:this._imageStyle})),i.createElement("div",{className:Object(s.e)("od-Banner-messageContainer",{"od-Banner-messageContainer--vertical":m})},t&&i.createElement("h2",{className:"od-Banner-header"},t),i.createElement("div",{className:Object(s.e)("od-Banner-message",{"od-Banner-message--vertical":m})},i.createElement(l.e,{className:"od-Banner-icon",iconName:n}),i.createElement("span",null,a)),i.createElement(c.e,{className:Object(s.e)("od-Banner-button",{"od-Banner-button--vertical":m,"od-Banner-button--horizontal":!m}),onClick:this._onButtonClick,text:p}),this._canDismiss&&i.createElement(d.e,{className:"od-Banner-close",iconProps:{iconName:"Cancel"},"aria-label":r.t,title:r.t,onClick:this._onCloseClick}))))},t.prototype._closeBanner=function(e){this._canDismiss&&(p.e.logData({name:"".concat(this._engagementPrefix,".Banner.").concat(e,".Click"),isIntentional:!0}),this._dataStore.setValue(this._dataStoreKey,!0,f.e.local),this.setState({isHidden:!0}))},t}(i.Component),_=n(5301),h=function(e){function t(t){var n=e.call(this,t)||this;n._onClick=function(){return n._action.execute(null)};var a=t.actionMap,i=t.resources;return n._action=new(i.injected(a.LaunchTeamChannelAction))({}),n}return Object(a.__extends)(t,e),t.prototype.render=function(){return i.createElement(m,{className:"od-TeamChannelBanner",iconName:"Info",message:_.t,buttonText:_.e,buttonClick:this._onClick,canDismiss:!1,isVerticalLayout:!0,engagementPrefix:"TeamChannel"})},t}(n(1409).e);t.default=h},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1203),i=new(n(8).t)({name:"".concat("UserStateProvider.key",".updateQuota"),factory:{dependencies:{observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},function(e,t,n){"use strict";var a=n(0),i=n(2175),r=n(2210),o=function(e){function t(t){var n,a,i=e.call(this,t)||this,r=i.valueAccessor();return a=(n=i.isObservable(r)?{hasFocus:r}:r).focusState?n.focusState:n.hasFocus?i.createComputed({read:function(){return n.hasFocus()?2:0},write:function(e){return n.hasFocus(!!e)},pure:!0}):i.createObservable(0),i._focusState=a,i._asyncUpdateFocus=i.async.debounce(i._updateFocus,30),i.events.on(i.element,"focus",i._onFocus),i.events.on(i.element,"blur",i._onBlur),i.subscribe(i._focusState,i._onFocusStateChanged),n.timeout?i.async.setTimeout(i._startUpdateFocus,n.timeout):i._startUpdateFocus(),i}return Object(a.__extends)(t,e),t.prototype._onFocus=function(){this._focusState(2),this._startUpdateFocus()},t.prototype._onBlur=function(){this._focusState(0),this._startUpdateFocus()},t.prototype._onFocusStateChanged=function(){this._startUpdateFocus()},t.prototype._startUpdateFocus=function(){this._focusAttempts=0,this._updateFocus()},t.prototype._updateFocus=function(){var e=this._focusState.peek();if(e){this._focusAttempts++;var t=Object(r.t)(this.element),n=void 0,a=void 0;t&&(n=t.scrollTop,a=t.scrollLeft),this.element.focus(),t&&1===e&&(t.scrollTop!==n&&(t.scrollTop=n),t.scrollLeft!==a&&(t.scrollLeft=a)),!this._checkIfFocused()&&this._focusAttempts<3&&this._asyncUpdateFocus()}else this.element.blur()},t.prototype._checkIfFocused=function(){var e,t=this.element.ownerDocument;try{e=t.activeElement}catch(n){e=t.body}return e===this.element},t}(i.t);t.e=o},,,,,,,,,function(e,t,n){"use strict";n.r(t);var a=n(54),i=n("knockout-lib"),r=n(2237),o=Object(r.e)("sp-teamify-banner","@ms/odsp-shared-react/lib/TeamifyBanner",function(){return a.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e(850)]).then(n.bind(null,3142)))});i.components.isRegistered(o.tagName)||i.components.register(o.tagName,o),t.default=o},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a.e}),n(5183);var a=n(2989)},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(1203),r=n(142),o=n(2435),s=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a.contexts=a.observables.createArray(),a._additions=[],a._removals=[],a._needsOverlayContent=n.needsOverlayContent,a}return Object(a.__extends)(t,e),t.prototype.transclude=function(e){var t=this;return this._needsOverlayContent.needsOverlayContent.set(!0),this._transclude(e),{dispose:function(){t._dispose(e)}}},t.prototype._transclude=function(e){this._additions.push(e),this._updateContextsTimeoutId||this._updateContexts()},t.prototype._dispose=function(e){this._removals.push(e),this._updateContextsTimeoutId||this._updateContexts()},t.prototype._updateContexts=function(){this._updateContextsTimeoutId=this.async.requestAnimationFrame(this._onUpdateContextsTimeout);var e=this.contexts.peek(),t=this._additions.splice(0),n=this._removals.splice(0);this.contexts.valueWillMutate(),e.push.apply(e,t);for(var a=0,i=n;a<i.length;a++){var r=i[a],o=e.indexOf(r);o>-1&&e.splice(o,1)}this.contexts.valueHasMutated()},t.prototype._onUpdateContextsTimeout=function(){this.contexts.valueHasMutated(),this._updateContextsTimeoutId=void 0,(this._additions.length||this._removals.length)&&this._updateContexts()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{needsOverlayContent:o.e}),t}(i.default),c=new r.n(s,i.default.dependencies)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"r",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"n",function(){return d});var a=n(3344),i=new a.e("checkout"),r=new a.e("quickEdit"),o=new a.e("editItem"),s=new a.e("viewItem"),c=new a.e("versionHistory"),d=new a.e("exportList")},,function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return u});var a=n(0),i=n(2698),r=n(142),o=n(40),s=n(90),c=n(11),d=function(){function e(){}return e.Online="Online",e.Offline="Offline",e}(),l=function(e){function t(t,n){return e.call(this,n.pageContext)||this}return Object(a.__extends)(t,e),t.prototype.getListAIModel=function(e,t){var n="".concat(e,"/_api/web/Lists('").concat(t,"')/rootfolder/properties?$select=vti_x005f_modellibrary,vti_x005f_predictionmodelid,vti_x005f_predictionmodel");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t=JSON.parse(e);return null==t?void 0:t.d},qosName:"getListModelProperty",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}}).then(function(e){var t,n=e.vti_x005f_modellibrary||"",a=n?{driveId:n}:void 0,i=e.vti_x005f_predictionmodelid||"",r=e.vti_x005f_predictionmodel||"",o=[];if(r)try{o=JSON.parse(r)}catch(e){s.e.logError("JSON parse failed for vti_x005f_predictionmodel propety value: "+r)}if(c.e.isActivated("d4a520ab-4c94-4f34-a24d-afbb43276999","09/23/2021","Avoid using Array find method because of error in IE11 that find function is undefined"))t=i&&o&&o.length>0?o.find(function(e){return e.id===i}):void 0;else if(i&&o&&o.length>0)for(var d=0;d<o.length;d++)if(o[d].id===i){t=o[d];break}return{machineTeachingModel:a,predictionModel:t||(!t&&i?{id:i}:void 0)}})},t.prototype.updateFormProcessingModelRetentionLabel=function(e,t,n){var a="".concat(e,"/_api/web/Lists('").concat(t,"')/UpdateFormProcessingModelRetentionLabel(retentionLabel='").concat(n,"')");return this.dataRequestor.getData({url:a.toString(),qosName:"updateFormProcessingModelRetentionLabel",method:"POST",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"},noRedirect:!0})},t.prototype.UpdateFormProcessingModelSettings=function(e,t,n,a){var i=void 0!==n?n:"",r=void 0!==a?a:"",o="".concat(e,"/_api/web/Lists('").concat(t,"')/UpdateFormProcessingModelSettings(retentionLabel='").concat(i,"',linkedList='").concat(r,"')");return this.dataRequestor.getData({url:o.toString(),qosName:"UpdateFormProcessingModelSettings",method:"POST",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"},noRedirect:!0})},t.prototype.getLayoutCandidateFields=function(e,t){var n="?$select=Id,Title,TypeDisplayName,InternalName&$filter=(Hidden eq false) and (ReadOnlyField eq false) and (FieldTypeKind eq 2)",a=t?"".concat(e,"/_api/web/Lists('").concat(t,"')/fields").concat(n):"".concat(e,"/_api/web/fields").concat(n);return this.dataRequestor.getData({url:a.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getLayoutCandidateFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getLinkedCandicateLists=function(e){var t="".concat(e,"/_api/web/Lists?$Select=Id,Title&$filter=BaseTemplate eq 100 and BaseType eq 0 and Hidden eq false");return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){var t,n=JSON.parse(e);return null===(t=null==n?void 0:n.d)||void 0===t?void 0:t.results},qosName:"getLinkedCandicateLists",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})},t.prototype.getAllLists=function(e){var t="".concat(e,"/_api/web/Lists?$Select=Id,Title,BaseTemplate,BaseType,Hidden");return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){var t,n=JSON.parse(e);return null===(t=null==n?void 0:n.d)||void 0===t?void 0:t.results},qosName:"getLinkedCandicateLists",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})},t.dependencies={pageContext:o.f},t}(i.e),u=Object(r.r)("ListModelDataSource",l)}],Array(19),[function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a={INPUT:!0,TEXTAREA:!0},i={A:!0,BUTTON:!0};function r(e){var t=e;return!(!t||!(t.tagName in a)&&!t.isContentEditable)}function o(e){return!(!e||!(e.tagName in i))}}],Array(16),[function(e,t,n){"use strict";var a=n(598),i=n(190),r=Object(i.t)(a.i),o=r?window.require.toUrl("odsp-media/fluenthybridfont/"):window.require.toUrl("odsp-media/fonts/");(r?function(){return n.e(694).then(n.bind(null,5825))}:function(){return n.e(691).then(n.bind(null,5826))})().then(function(e){(0,e.initializeIcons)(o,{disableWarnings:!0},!0)}).catch(function(e){console.error("Icons error",e)})},,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"e",function(){return p});var a=n(2),i=n(130),r=n(15),o=n(1060),s=n(24),c=n(18),d=n(541),l=n(3),u=new i.e("knockoutStoreItem",function(e,t){var n=t.itemKey,a=e.demandItemFacet(d.t,n);if(void 0!==a){Object(l.Jr)(l.Mr)||e.demandItemFacet(p,n&&f.serialize({itemKey:n}));var i=e.demandItemFacet(o.e,r.c),s=o.e.evaluate(i)(e,{}).getItem;if(s)return s(a.key)}}),f=new s.e("odspNextStoreKey",{itemKey:c.e}),p=new a.e("createdStoreItem")}],Array(19),[function(e,t,n){"use strict";var a;!function(e){e[e.normal=0]="normal",e[e.blocker=1]="blocker",e[e.vaultBlocker=2]="vaultBlocker"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(2788),r=new a.t({name:"OverlayProvider.key",factory:i.e})},function(e,t,n){"use strict";n.d(t,"n",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"i",function(){return u});var a=n(1203),i=n(971),r=n(8),o=function(e){return{dependencies:{observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(t){var n=new(0,t.observablesFactoryType)({}),a=n.create();return e&&(a.equalityComparer=i.n),{instance:a,disposable:n}}}},s=new r.t({name:"".concat("ShareCommandKeys",".shareFocusItem"),factory:o(!0)}),c=new r.t({name:"".concat("ShareCommandKeys",".copyLinkFocusItem"),factory:o()}),d=new r.t({name:"".concat("ShareCommandKeys",".copyFormLinkFocusItem"),factory:o()}),l=new r.t({name:"".concat("ShareCommandKeys",".copyLinkFocusItem"),factory:o()}),u=new r.t({name:"".concat("ShareCommandKeys",".shareFromGrantAccess"),factory:o()})},,,function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(3344),i=new a.e("createWorkflow"),r=new a.e("baseFlow")},,,,,function(e,t,n){"use strict";var a=n(0),i=(n(4418),n("react-lib")),r=n(2178),o=n(8),s=n(3040),c=n(2234),d=n(125),l=n(62),u=n(257);function f(e){var t=e.specification,n=e.placeholder,a=Object(l.n)(),o=Object(s.t)(t),f=Object(d.e)(function(t,i){var s=new u.e;if(e.onApplyBindings){var c=e.onApplyBindings(t);c&&s.attach(c)}return s.attach(new(a.resolved(r.a))({element:t,valueAccessor:function(){return{specification:o,placeholder:n}},bindingContext:i})),s});return i.createElement(c.e,{applyBindings:f},e.children)}function p(e){var t=e.resources,n=Object(a.__rest)(e,["resources"]),r=i.createElement(f,Object(a.__assign)({},n));return t?i.createElement(l.e,{resources:t},r):r}t.e=p,new o.t({name:"Knockout",factory:new o.e(p)})}],Array(22),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("rootItems")}],Array(21),[function(e,t,n){"use strict";var a=n(2174),i=n(0),r=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.isSelectable,i=void 0!==a&&a,r=t.isSelected,o=void 0!==r&&r;return n.isSelectable=n.wrapObservable(i),n.isSelected=n.wrapObservable(o),n}return Object(i.__extends)(t,e),t}(n(2173).e),o=Object(a.e)({tagName:"ms-item-check",template:'<span class="ItemCheck"><i class="ItemCheck-circle ms-Icon ms-Icon--CircleRing" data-bind="icon:true"></i><i class="ItemCheck-check ms-Icon ms-Icon--StatusCircleCheckmark" data-bind="icon:true"></i></span>',viewModel:r,synchronous:!0});t.e=o},,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"disabledCampaign",function(){return _}),n.d(t,"resourceKey",function(){return b});var a=n(0),i=n(43),r=n(1203),o=n(142),s=n(226),c=n(113),d=n(147),l=n(421),u=n(3336),f=n(3259),p=n(74),m="CoachmarkTearDropSeen",_={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:i.Off,isCoachmark:!0},h=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._dataStore=new s.e("CoachmarkProvider",c.e.session),a._currentCampaign=a.createObservable(_),a._isVisible=a.createObservable(!1),a._navigation=n.navigation,a._firstRunExperienceStatus=n.firstRunExperienceStatus,a._currentTeachingBubble=a.createObservable({campaign:a._currentCampaign,isVisible:a._isVisible}),a._navigation.viewParams.resetAllBubbles&&a._dataStore.remove(m);var i=a.resources.consume(p.e);return a._teachingBubbleProviderPromise=i.waitForPLT().then(function(){return a.resources.consume(l.D)}),a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!1,configurable:!0}),t.prototype.hideCampaign=function(){this._isVisible(!1),this._currentCampaign(_)},t.prototype.setCampaign=function(e){var t=this;if(!e)return this._currentCampaign(_),void this._isVisible(!1);if(this._firstRunExperienceStatus.get()!==f.e.visible){var n="".concat(e.name).concat(m);this._dataStore.getValue(m)||this._teachingBubbleProviderPromise.then(function(a){a&&a.shouldBubbleBeAdded(e,!1).then(function(a){a&&(t._currentCampaign(e),t._isVisible(!0),t._dataStore.setValue(n,!0))})})}},t.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.default.dependencies),{navigation:d.e,firstRunExperienceStatus:u.e}),t}(r.default);t.default=h;var b=Object(o.r)("CoachmarkProvider",h)},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(388),i=n(142),r=n(3265),o=n(2989),s=n(3858),c=Object(i.r)("GraphPeoplePickerHelper",r.t,{oAuthTokenProvider:o.e,pageContext:a.e,sharingContextInformation:s.e.optional})}],Array(24),[function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(8),i=n(142),r="f9ebc8b2-a976-48f0-a8fa-0846164c0466",o=new a.t({name:"ListDataSource.key",loader:new i.t(function(){return n.e(796).then(n.bind(null,2280)).then(function(e){return e.resourceKey})})})},,,,,,,,,function(e,t,n){"use strict";var a;!function(e){e[e.Lock=1]="Lock",e[e.Unlock=2]="Unlock",e[e.Manage=3]="Manage",e[e.FreDialog=4]="FreDialog",e[e.ShowFiles=5]="ShowFiles",e[e.Reset=6]="Reset",e[e.Debug=7]="Debug",e[e.FilesRemaining=8]="FilesRemaining"}(a||(a={})),t.e=a},,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return m});var a=n(0),i=n(54),r=n(1203),o=n(101),s=n(2202),c=n(38),d=n(8),l=n(142),u=n(2238),f=!n(16).e.isActivated("8485CDCB-7021-4116-8F71-B4B0E64E13EB","6/21/2022","Blocks KOToItemCacheItemsStore from being used in the ShortcutProvider, which is fully KO"),p=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._urlDataSource=n.urlDataSource,f?(a.legacyStoreResourceScope=a.addDisposable(new d.n(a.resources)),a.legacyStoreResourceScope.block(u.t),a._itemProvider=a.legacyStoreResourceScope.consume(s.resourceKey)):a._itemProvider=n.itemProvider,a}return Object(a.__extends)(t,e),t.prototype.createShortcut=function(e,t,n){var a=this;return this._getShortcutDataSource().then(function(a){return a.createShortcut(e,t,n)}).then(function(t){return a._itemProvider.invalidateItem(e),t})},t.prototype.getShortcutTargetData=function(e,t,n,a){return this._getShortcutDataSource().then(function(i){return i.getShortcutTargetData({url:e,avoidGetFileByUrlCall:t,parentKey:n,targetSiteUrl:a})})},t.prototype.getFileByUrl=function(e){return this._getShortcutDataSource().then(function(t){return t.getFileByUrl(e)})},t.prototype.getRecentFiles=function(){var e={parentKey:this._urlDataSource.getRootItemKey(c.e.Recent),startIndex:0,endIndex:5,queryType:c.e.Recent};return this._itemProvider.getItem(e)},t.prototype._getShortcutDataSource=function(){return i.n.resolve(this.resources.consumeAsync(o.ne))},t}(r.default);t.default=p;var m=Object(l.r)("ShortcutProvider",p,Object(a.__assign)(Object(a.__assign)({},r.default.dependencies),{urlDataSource:o.ue,itemProvider:s.resourceKey}))},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1615);function i(e){return!!e.flags2&&Object(a.e)(e.flags2,e.isDocLib,e.listTemplateType)}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("SmartFiltersDataSource.key")},function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"n",function(){return u});var a=n(0),i=n(70),r=n(138),o={};function s(e){return o[e]}function c(e,t){o[e]=t}function d(e){var t=s(e);if(t&&(t.end({resultType:i.e.Failure}),t=void 0),!t){var n={name:e};c(e,t=new r.e(n))}return t}function l(e){f(e,i.e.Success)}function u(e,t){f(e,i.e.Failure,t)}function f(e,t,n){var i=s(e);if(i){var r={resultType:t};n&&(r=Object(a.__assign)(Object(a.__assign)({},r),{resultCode:n.name||"Unknown",error:n.message||"Unknown",extraData:{errorStackTrace:n.stack}})),i.end(r),c(e,void 0)}}}],Array(24),[function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(142),i=n(3709),r=n(737),o=n(608),s=n(3265),c=n(3342),d=n(54),l=n(29),u=function(){function e(e,t){this._getIdentityDataSource=t.getIdentityDataSource}return e.prototype.getToken=function(e,t){return this.getInstrumentedToken(e,t).then(function(e){return e.tokenInfo.token})},e.prototype.getInstrumentedToken=function(e,t){var n=Date.now();return d.n.resolve(this._getIdentityDataSource().then(function(t){return e===s.e&&t.getGraphToken?t.getGraphToken({resource:e}):e===c.e&&t.getSubstrateToken?t.getSubstrateToken(o.e.Default):"ocps"===e&&t.getOCPSToken?t.getOCPSToken():t.getOAuthSessionToken?t.getOAuthSessionToken(e):void 0}).then(function(e){var t=null==e?void 0:e.accessToken;if(!e||!t)throw new l.e({code:"UnableToResolveToken"});return{tokenInfo:{token:t,isGuest:!1,expirationTimeMs:e.tokenExpiry},spRequestId:e.correlationId||"",spRequestTimestamp:n}}))},e}(),f=Object(a.r)("OAuthTokenDataSource",u,{getIdentityDataSource:r.e.async.lazy}),p=Object(a.r)("OAuthTokenProviderBase",i.e,{oAuthTokenDataSource:f})},,,,,,function(e,t,n){"use strict";var a=n(3257),i=n("knockout-lib"),r=n(971);t.e=function(e,t,n){this.key=e||"",this.content=i.observable(new a.e(n)),this.content.equalityComparer=r.n,this.schema=i.observableArray([]),this.schema.equalityComparer=r.e,this.context=i.utils.extend({},t),this.contentTypes=i.observableArray([]),this.isPlaceholder=!0,this.version=0}},function(e,t,n){"use strict";n.d(t,"t",function(){return u});var a=n(0),i=n("knockout-lib"),r=n(46),o=n(311),s=n(40),c=n(72),d=n(177),l=n(1423);function u(e){var t=e.listSchema,n=e.resources,a=e.groupSchema,i=e.hasFixedSchema,r=e.listContext,u=e.getItemContext,f=e.sortFallback,m=n.consume(o.f.optional),_=n.consume(d.e).isMobile&&n.consume(o.k.optional);r||(r=n.consume(s.o));var h={hasFixedSchema:i,serverSupportsAutoHyperLink:!1,useCustomColumn:_,disableShareHeroCommand:m},b=l.e.buildSchema(t,r,h,a,u),g=n.consume(s.f),v=Number(g.webTemplate)===c.t.mySite;return b.filter(function(e){return!v||"ItemChildCount"!==e.internalName&&"FolderChildCount"!==e.internalName}).map(function(e){return e.groupable=!v&&e.groupable,f.sortField===e.internalName&&f.sortDirection&&(e.isSorted=!0,e.isAscending="ascending"===f.sortDirection),p(e,r)})}var f=function(){function e(){}return e.getCustomColumns=function(e,t,n){var a=this,i=this._convertToSPColumn(e),r=t.map(function(e){return e.map(function(e){return a._convertToSPColumn(e)})}),o=n.map(function(e){return a._convertToSPColumn(e)});return l.e.getCustomColumns(i,r,o).map(function(e){return p(e)})},e.getMappedColumnType=function(e){return l.e.getMappedColumnType(e)},e.getIconColumnWidth=function(e){return e.consume(d.e).isMobile&&e.consume(o.k.optional)?48:16},e.getIconColumnMinWidth=function(e){return e.consume(d.e).isMobile&&e.consume(o.k.optional)?48:16},e.fillColumnDefinitionDefaults=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={});var o=t.isCollapsible,s=void 0===o||o;return e.map(function(e,o){var c=e.isIcon,d=void 0!==c&&c,l=e.sortable,u=void 0===l?!!t.sortable:l,f=e.resizable,p=void 0===f?!!t.resizable:f,m=e.isCollapsable,_=void 0===m?s:m,h=e.fieldType,b=void 0===h?r.e.Text:h,g=e.name,v=e.getValue,y=e.key,S=e.width,D=!!n.sortField&&n.sortField===e.internalName,I=!!n.groupBy&&n.groupBy===e.internalName;return Object(a.__assign)(Object(a.__assign)({},e),{key:y,name:g,width:S,index:o,fieldType:b,isCollapsable:_,isIcon:d,isVisible:!0,isVisibleMobile:!0,isGrouped:I,sortable:u,isSorted:D,isAscending:D&&n.isAscending,filterable:!1,isFocused:i.observable(!1),getValue:v,resizable:p})})},e._convertToSPColumn=function(e){var t=this;return Object(a.__assign)(Object(a.__assign)({},e),{isFiltered:e.isFiltered&&e.isFiltered.peek(),filterValues:e.filterValues&&e.filterValues.peek(),customWidth:e.customWidth&&e.customWidth.peek(),clientSideColumnAdapter:e.clientSideColumnAdapter,customFields:e.customFields&&e.customFields.map(function(e){return t._convertToSPColumn(e)})})},e}();function p(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{key:(n=e.key,"FileSizeDisplay"===n?"size":n),clientSideColumnAdapter:e.clientSideColumnAdapter,isFiltered:i.observable(e.isFiltered),isMenuOpen:i.observable(!1),isFocused:i.observable(!1),customWidth:i.observable(0),filterValues:i.observable(e.filterValues),customFields:e.customFields?e.customFields.map(function(e){return p(e,t)}):void 0});var n}t.e=f},,,function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(3344),i=new a.e("upload"),r=new a.e("download"),o=new a.e("sync")}],Array(25),[function(e,t,n){"use strict";var a=n(2174),i=n(0),r=n(2173),o=n(2175),s=n("knockout-lib"),c=function(e){this.templateNodes=e.templateNodes,this.bindingContext=e.bindingContext,this.renderCount=e.renderCount||s.observable(0),this.parentElement=e.parentElement||null,this.options=e.options||null},d=n(4808),l=function(e){function t(t){var n=e.call(this,t)||this;return new(n.managed(d.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return n._onReceiveComponentParentContext.bind(n)}}),n.controlsDescendantBindings=!0,n}return Object(i.__extends)(t,e),t.prototype._onReceiveComponentParentContext=function(e){var t=this.valueAccessor(),n=new c({parentElement:t.parentElement,templateNodes:e.templateNodes,bindingContext:e.bindingContext,renderCount:t.renderCount,options:t.options});t.context(n)},t.supportsVirtualElements=!0,t}(o.t),u=function(e){function t(t){var n=e.call(this,t)||this;return n.addBindingHandlers({transclusionContent:l}),n._provider=t.provider,n.bindingParams={context:s.observable(),parentElement:t.parentElement,renderCount:t.renderCount,options:t.options},n.createComputed(function(){var e=n.bindingParams.context();n._transclusion&&(n._transclusion.dispose(),n._transclusion=null),e&&(n._transclusion=n.addDisposable(n._provider.transclude(e)))}),n}return Object(i.__extends)(t,e),t}(r.e),f=a.e({tagName:"od-transclusion-content",template:"\x3c!--ko transclusionContent:bindingParams--\x3e\x3c!--/ko--\x3e",viewModel:u,synchronous:!0});t.e=f}],Array(14),[function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"t",function(){return u}),n.d(t,"a",function(){return f}),n(0);var a=n("react-lib"),i=n(62),r=n(655),o=n(1203),s=n(197),c=n(324);function d(e,t){var n=function(e,t){var n=f(),i=u(a.useMemo(function(){return e},t)),r=a.useRef();return r.current||(r.current=Object(s.e)(n.pureCompute(function(){return i()()}),{equalityComparer:c.e}))}(e,t);return l(n)}function l(e){var t=f(),n=t.peekUnwrap(e),i=a.useState(function(){return n})[1];return a.useEffect(function(){if(t.isObservable(e)){i(function(){return e.peek()});var n=t.subscribe(e,function(e){i(function(){return e})});return function(){n.dispose()}}},[e]),n}function u(e,t){var n,i=null!==(n=null==t?void 0:t.inline)&&void 0!==n&&n,r=f(),o=a.useRef(),d=o.current||(o.current=Object(s.e)(r.create(e),{equalityComparer:c.e}));return(i?a.useMemo:a.useEffect)(function(){d(e)},[e]),d}function f(){var e=Object(i.n)(),t=a.useRef(),n=t.current||(t.current=new(e.consume(o.observablesFactoryTypeResourceKey.optional)||r.e));return a.useLayoutEffect(function(){return function(){n.dispose()}},[]),n}},,,function(e,t,n){"use strict";var a;function i(){return"boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a}n.d(t,"e",function(){return i})}],Array(41),[function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(2408),i=n(0),r=n("react-lib"),o=n(47),s=n(3040),c=n(2839);function d(e,t){void 0===t&&(t={});var n,d=Object(a.createItemsScopeActionFromKnockout)(e,t);return(n=function(e){return{item:e}},function(e){var t=e;return Object(o.e)(function(e,t){return{storeItem:e.demandItemFacet(c.t,t.itemKey)}})(function(e){var a=e.storeItem,o=Object(s.n)(a),c=Object(s.t)(o);return r.createElement(t,Object(i.__assign)({},e,n(c)))})})(d)}},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"r",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"i",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"a",function(){return c});var a="MoveItemsOperation",i="CopyItemsOperation",r="MoveItemsOperationAsync",o="CopyItemsOperationAsync",s="CopyItems",c="MoveItems"},,,function(e,t,n){var a;!function(i,r){"use strict";var o=function(e){if("object"!=typeof e.document)throw new Error("Cookies.js requires a `window` with a `document` object");var t=function(e,n,a){return 1===arguments.length?t.get(e):t.set(e,n,a)};return t._document=e.document,t._cacheKeyPrefix="cookey.",t._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),t.defaults={path:"/",secure:!1},t.get=function(e){return t._cachedDocumentCookie!==t._document.cookie&&t._renewCache(),t._cache[t._cacheKeyPrefix+e]},t.set=function(e,n,a){return(a=t._getExtendedOptions(a)).expires=t._getExpiresDate(n===r?-1:a.expires),t._document.cookie=t._generateCookieString(e,n,a),t},t.expire=function(e,n){return t.set(e,r,n)},t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&e.secure!==r?e.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){if(n=n||new Date,"number"==typeof e?e=e===1/0?t._maxExpireDate:new Date(n.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){var a=(e=(e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent)).replace(/\(/g,"%28").replace(/\)/g,"%29"))+"="+(t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent));return a+=(n=n||{}).path?";path="+n.path:"",a+=n.domain?";domain="+n.domain:"",(a+=n.expires?";expires="+n.expires.toUTCString():"")+(n.secure?";secure":"")},t._getCacheFromString=function(e){for(var n={},a=e?e.split("; "):[],i=0;i<a.length;i++){var o=t._getKeyValuePairFromCookieString(a[i]);n[t._cacheKeyPrefix+o.key]===r&&(n[t._cacheKeyPrefix+o.key]=o.value)}return n},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");return t=t<0?e.length:t,{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}},t._renewCache=function(){t._cache=t._getCacheFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){var e="cookies.js",n="1"===t.set(e,1).get(e);return t.expire(e),n},t.enabled=t._areEnabled(),t},s="object"==typeof i.document?o(i):o;(a=function(){return s}.call(t,n,t,e))===r||(e.exports=a)}("undefined"==typeof window?this:window)},function(e,t,n){"use strict";n.d(t,"i",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"r",function(){return d});var a=n(3344),i=(new a.e("createExcel"),new a.e("createOneNote"),new a.e("createPowerPoint"),new a.e("createWord"),new a.e("createSurvey"),new a.e("viewSurvey"),new a.e("editSurvey"),new a.e("publishSurvey"),new a.e("openOnline")),r=new a.e("openInClient"),o=(new a.e("viewVersionHistory"),new a.e("openInPowerBI")),s=new a.e("contentTypeNavigation"),c=new a.e("editNewMenu"),d=new a.e("uploadTemplate")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1203),i=new(n(8).t)({name:"".concat("Selection.key",".hasSelection"),factory:{dependencies:{observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.createCallback({defaultValue:!1,reducer:function(e,t){return e||t}}),disposable:t}}}})}],Array(19),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(0);function i(e){if(e){var t=e.fieldSchema,n=e.children,r=Object(a.__rest)(e,["fieldSchema","children"]);return Object(a.__assign)({fieldSchema:t?Object(a.__assign)(Object(a.__assign)({},t),{Name:t.Name}):void 0,children:n?n.map(i):void 0},r)}}}],Array(39),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1203),i=new(n(8).t)({name:"".concat("UseItemCacheData.key",".useItemCacheData"),factory:{dependencies:{observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},,,function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c});var a=n(3),i=n(157);function r(e){var t=!!e&&!!e.folder,n=e&&e.properties.ProgId;return o()&&t&&s(n)}function o(){return Object(a.Jr)(a.Li)}function s(e){return!!e&&0===e.toLowerCase().indexOf("team.channel")}function c(e){return e&&e.relatedGroupId&&(e.teamsChannelType===i.o.SharedChannel||e.teamsChannelType===i.o.PrivateChannel)}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)({name:"ModuleLoaderDataSource.key"})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"SuiteNavProvider.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(629)]).then(n.bind(null,2358)).then(function(e){return e.resourceKey})})})}],Array(69),[function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(142),i=n(0),r=n(292),o=n(737),s=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._identityDataSource=n.identityDataSource,a}return Object(i.__extends)(t,e),t.prototype.getToken=function(){return this._identityDataSource.getGraphToken({})},t.dependencies=Object(i.__assign)(Object(i.__assign)({},r.e.dependencies),{identityDataSource:o.e}),t}(r.e),c=Object(a.r)("GraphTokenProvider",s),d=n(8),l=function(){function e(){}return e.prototype.getApiName=function(){return"Graph"},e.prototype.getApiBaseUrl=function(){return"https://graph.microsoft.com/beta"},e}(),u=new d.t({name:"GraphUrlDataSource",factory:new a.i(l)}),f=n(1213),p=Object(a.r)("GraphDataRequestor",f.e,{sessionManagementProvider:c,urlDataSource:u});f.e}],Array(19),[function(e,t,n){"use strict";t.e=function(e){this.items=new Array(e||0),this.groupings=null,this.partialResultRequestCount=0,this.partialResultStatus=0}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n("react-lib"),r=n(70),o=n(90),s=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return Object(a.__extends)(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0}},t.prototype.render=function(){return this.state.hasError?null:i.createElement(i.Fragment,null,this.props.children)},t.prototype.componentDidCatch=function(e,t){var n=this.props.onError;o.e.logError(e,{"react.componentStack":t.componentStack,"react.component":this.props.componentName},{eventName:"ReactRenderError",resultCode:"",resultType:r.e.Failure}),n&&n(e)},t}(i.PureComponent)},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.notConfigured=0]="notConfigured",e[e.visible=1]="visible",e[e.notVisible=2]="notVisible"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"UploadOperator.key",loader:new i.t(function(){return Promise.all([n.e("deferred"),n.e("deferred.odsp-common"),n.e(525)]).then(n.bind(null,3686)).then(function(e){return e.typeResourceKey})})})},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(134),i=n(217),r=n(43),o=n(4809),s=n(656);function c(e,t,n,c,d){if(!c)return[!1,void 0];var l=Object(s.e)(c);if(Object(s.i)(l)||Object(s.n)(l))return[!1,void 0];var u=Object(r.isFeatureEnabled)(n);if(Object(s.r)(l)&&!u)return[!1,void 0];var f=Object(r.isFeatureEnabled)(e),p={experimentId:"number"==typeof e.ODB?e.ODB:void 0,variant:f?1:0,isAATest:!1,isOverride:a.n.isFeatureEnabled(e),correlationId:c?c.CorrelationId:"",cloudType:c?String(c.cloudType):""},m=0;f||(m=Object(i.n)(t,c));var _=function(e,t){if(!t)return{experimentId:e,variant:void 0,isAATest:!1,isOverride:!1,correlationId:"",cloudType:""};var n=Object(i.t)(e,t);return{experimentId:n._experimentId,variant:n._variantToLog,isAATest:n._isAATest,isOverride:n._isOverride,correlationId:t.CorrelationId,cloudType:String(t.cloudType)}}(t,c),h=f?p:_,b=f||m>0;return void 0!==h.variant?[b,h=function(e,t){var n=o.e();return void 0===e.variant||t&&JSON.stringify(t)===JSON.stringify(e)||(o.t(n,e),t=e),t}(h,d)]:[b,void 0]}},,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a,i=n(0),r=n(2184),o=n(54),s=n(70),c=n(2193),d=n(101),l=n(253),u=n(849),f=n(38);!function(e){e[e.DefaultClick=0]="DefaultClick",e[e.OpenInOfficeOnline=1]="OpenInOfficeOnline",e[e.OpenFileLocation=2]="OpenFileLocation",e[e.OpenItemActivityItem=3]="OpenItemActivityItem",e[e.OpenPdfInBrowser=4]="OpenPdfInBrowser"}(a||(a={}));var p=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.item,i=t.openRelation,r=void 0===i?0:i,o=t.actionType;return n.name="OpenInDesktop",n._itemSelectionHelper=new(n.child(c.e))({overrideItem:2===r?a:void 0,allowMultiSelect:!1,canFallback:0!==r,ignoreSelection:0!==r}),n._urlDataSource=n.resources.consume(d.ue),n._actionType=o,n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem(),i={id:n.id,name:n.name,actionType:a[this._actionType],queryType:f.e[n.queryType],itemType:l.e[n.type],openUrl:n.openUrl,parentUrl:n.parentLink,shortcutUrl:n.urls[u.t.shortcutTarget],siteUrl:this._urlDataSource.getCurrentSiteUrl(),fullItemUrl:this._urlDataSource.getItemUrl(n.key),extension:n.extension};return window.external.notify(JSON.stringify(i)),o.n.wrap({resultType:s.e.Success})},t}(r.e);t.t=p},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(1203),r=new a.t({name:"".concat("IsListFormActivityPaneExpanded.key",".IsListFormActivityPaneExpanded"),factory:{dependencies:{observablesFactoryType:i.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(!1),disposable:t}}}})},,,,,,function(e,t,n){"use strict";var a=function(){function e(){}return e.alert=function(t,n,a,i,r){void 0===a&&(a=!1),void 0===r&&(r="alert");var o="sp_a11y_alert_"+t,s=document.querySelector("#"+o);s&&document.body.removeChild(s);var c=document.createElement("p");a||c.setAttribute("style",e._cssHidden),i&&c.classList.add(i),c.setAttribute("role",r),c.setAttribute("aria-live","assertive"),c.setAttribute("id",o);var d=document.createTextNode(n);document.body.appendChild(c),c.appendChild(d)},e._cssHidden="position:absolute;text-indent:-9999px;\n    width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0;",e}();t.e=a}],Array(18),[function(e,t,n){"use strict";var a=n("knockout-lib"),i=function(){function e(){}return e.update=function(e,t){var n=a.unwrap(t());e.style.visibility=n?"inherit":"hidden"},e}();t.e=i}],Array(24),[function(e,t,n){"use strict";var a=n(0),i=n(1203),r=n(4818),o=n(659),s=n(79),c=n(1472),d=n(731),l=function(e){function t(t){var n=e.call(this,t)||this;return n.resources&&(n._itemUrlHelper=n.resources.consume(d.c),n._sharingContextInformation=n.resources.consume(c.e.optional)),n._sharingDataSourceHelperCommon=new r.e({itemUrlHelper:n._getItemUrlHelper(),sharingContextInformation:n._getSharingContextInformation()}),n}return Object(a.__extends)(t,e),t.prototype.encodeSharingLink=function(e){if(!e)return e;var t=e.split("?");return o.e(t[0],!0)+(t[1]?"?".concat(t[1]):"")},t.prototype.getApiRoot=function(e,t){var n=this.getParentListId(t),a=this._getSharingContextInformation();return a&&t.isRootFolder&&(a.isListSharing=!0),this._sharingDataSourceHelperCommon.getApiRoot(e,this.convertToISPListItem(t),n)},t.prototype.getExpirationFromLink=function(e){if(e&&e.indexOf("expiration=")>-1){var t=new s.t(e).getQueryParameter("expiration");t.indexOf("Z")!==t.length-1&&(t=t.replace(/\+/g," ")+" UTC");var n=Date.parse(t);if(n)return new Date(n).toString()}return null},t.prototype.getExpirationFromSharingLinkInfo=function(e){return""!==e?e:null},t.prototype.getFileUrl=function(e){return this._getItemUrlHelper().getItemUrlParts(e.key).fullItemUrl},t.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},t.prototype._getItemUrlHelper=function(){return this._itemUrlHelper},t.prototype._getSharingContextInformation=function(){return this._sharingContextInformation},t}(i.default),u=l,f=n(16),p=n(38),m=n(2192),_=n(2714),h=function(e){function t(t){var n=e.call(this,t)||this;return n._itemParentHelper=n.resources.consume(m.e),n}return Object(a.__extends)(t,e),t.prototype.getParentListId=function(e){var t,n,a;if(f.e.isActivated("d559ae5a-9bcc-467b-93a4-3bc2c5a23451","07/14/2022","Share command for search results")||(null==e?void 0:e.queryType)!==p.e.Search){var i=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));a=i?i.list.id:e&&e.properties?e.properties.listId:null}else if(!(a=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.listId)){var r=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));a=null===(n=null==r?void 0:r.list)||void 0===n?void 0:n.id}return a},t.prototype.convertToISPListItem=function(e){return Object(_.n)(e)},t}(u);t.e=h}],Array(18),[function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(8),i=n(1428),r=n(3259),o=new a.t({name:"".concat("FirstRunExperienceStatus.key",".FirstRunExperienceStatus"),factory:{dependencies:{},create:function(e){return{instance:new i.e(r.e.notConfigured)}}}})},function(e,t,n){"use strict";var a=n(0),i=n(1203),r=n("knockout-lib"),o=n(238),s=function(e){function t(){var t=e.call(this)||this;return t._focusedIndex=-1,t._subscriptions=[],t._selectItemKeyToModel={},t.keyToIndexHash={},t.indexToKeyHash={},t.unresolvedSelectedIndices={},t._focusedIndex=-1,t._subscriptions=[],t._selectItemKeyToModel={},t.itemSet=r.observable(null),t.layout=r.observable(),t.selection=r.observableArray().extend({rateLimit:{timeout:200,method:"notifyWhenChangesStop"}}),t.selectionKeyHash=r.observable({}),t.focused=r.observable().extend({rateLimit:{timeout:50,method:"notifyWhenChangesStop"}}),t.items=r.observableArray(),t.focusedKeyHash=r.observable({}),t.isAllSelected=r.observable(!1),t.isActive=r.observable(!1),t.clearSelectionOnRemoval=!1,t.selectFirstItemOnActivate=!0,t}return Object(a.__extends)(t,e),t._set=function(e,t,n,a){(e=r.utils.unwrapObservable(e))&&e.hasOwnProperty(t)&&r.isObservable(e[t])&&e[t](n),e&&e.key&&(a()[e.key]=n,a.valueHasMutated())},t._setAll=function(e,n,a,i){for(var r=0;r<e.length;r++)t._set(e[r],n,a,i)},t._hasCssClass=function(e,t){return!!(e&&e.className&&-1!==e.className.indexOf(t)&&e.className.match("\\b"+t+"\\b"))},t._getParentElement=function(e){return e&&Object(o.e)(e)||null},t._insideElementWithClass=function(e,n,a){a=a||null;for(var i=e;i;){if(t._hasCssClass(i,n))return!0;if(i===a)return!1;i=t._getParentElement(i)}return!1},t.prototype.init=function(e){var n=this;if(!this.items)throw new Error("The selection binding can only be used together with `foreach`, `foreach: { data: ... }`, `template: { foreach: ... }` or like `selection: { data: ... }`.");if(!r.isObservable(this.selection))throw new Error("The selection binding should be bound to either an `observableArray` or a object containing a `selection` `observableArray`.");this.properties=e.properties,this._buildKeyIndexHash(),this.async.setTimeout(function(){n.cleanup(),n._updateFocused(e.properties.focused,!0)},0),this._subscriptions=[],this._subscriptions.push(this.focused.subscribe(function(e){var t;(t=(e=r.utils.unwrapObservable(e))?e.key:null)&&n._updateIsFocusedObservable(t,!1)},this,"beforeChange")),this._subscriptions.push(this.focused.subscribe(function(e){n._focusedIndex=e?n._findItemIndex(n.focused()):-1,n._focusedIndex>-1&&n._updateIsFocusedObservable(n.indexToKeyHash[n._focusedIndex],!0)})),this._subscriptions.push(this.selection.subscribe(function(a){t._setAll(n.selection(),e.properties.selected,!1,n.selectionKeyHash)},this,"beforeChange")),this._subscriptions.push(this.selection.subscribe(function(a){"single"===n.mode()&&a.length>1?n.selection([a.slice(-1)[0]]):t._setAll(a,e.properties.selected,!0,n.selectionKeyHash);var i=n.items().length,r=n.selection().length;n.isAllSelected(i>0&&i===r)})),this._subscriptions.push(this.items.subscribe(function(e){n._buildKeyIndexHash(),n.cleanup()})),t._setAll(this.selection.peek(),e.properties.selected,!0,this.selectionKeyHash),this._subscriptions.push(this.focused.subscribe(function(a){t._set(a,e.properties.focused,!1,n.focusedKeyHash)},this,"beforeChange")),this._subscriptions.push(this.focused.subscribe(function(a){t._set(a,e.properties.focused,!0,n.focusedKeyHash)})),this.focused()&&t._set(this.focused(),e.properties.focused,!0,this.focusedKeyHash)},t.prototype.cleanup=function(){var e=this;if(!this.itemSet.peek()||!this.itemSet.peek().isPlaceholder){var t=[];if(this.focused.peek()){var n=this._findItemIndex(this.focused.peek());-1===n?this.focused(null):this._focusedIndex=n}this.anchor.peek()&&-1===this._findItemIndex(this.anchor.peek())&&this.anchor(null),this.isAllSelected()?this.selectAll():(r.utils.arrayForEach(this.selection.peek(),function(n){-1!==e._findItemIndex(n)&&t.push(n)}),t.length!==this.selection.peek().length&&this.selection(t))}},t.prototype.clear=function(){this.focused&&this.focused(null),this.anchor&&this.anchor(null),this._focusedIndex=-1,this.removeSelection()},t.prototype.hasHorizontal=function(){return"horizontal"===this.direction.peek()},t.prototype.hasVertical=function(){return"vertical"===this.direction.peek()},t.prototype.hasCustom=function(){return"custom"===this.direction.peek()},t.prototype.toggleAllSelected=function(){this.selection.peek().length===this.items.peek().length?(this.selection([]),this._updateAllSelectItemViewModels(!1)):this.selectAll()},t.prototype.selectAll=function(){var e=this.items.peek().slice();this.unresolvedSelectedIndices={};for(var t=0;t<e.length;t++)e[t]||(this.unresolvedSelectedIndices[t]=!0);this.selection(this.items().slice()),this._updateAllSelectItemViewModels(!0)},t.prototype.selectItem=function(e){var t=[],n=r.utils.unwrapObservable(e);this._updateSelectItemViewModelInSelection(!1),e&&(t.push(e),this._updateIsSelectedObservable(n.key,!0)),this.selection(t),this.focused(e)},t.prototype.firstItem=function(){return this.items()[0]},t.prototype.lastItem=function(){return this.items()[this.items().length-1]},t.prototype.nextItem=function(e){var t=this._findItemIndex(e);return this.items()[Math.min(t+1,this.items().length-1)]},t.prototype.previousItem=function(e){var t=this._findItemIndex(e);return this.items()[Math.max(t-1,0)]},t.prototype.leftItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexLeft(t)]:this.hasHorizontal()?this.previousItem(e):null},t.prototype.aboveItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexAbove(t)]:this.hasVertical()?this.previousItem(e):null},t.prototype.rightItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexRight(t)]:this.hasHorizontal()?this.nextItem(e):null},t.prototype.belowItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexBelow(t)]:this.hasVertical()?this.nextItem(e):null},t.prototype.isAlreadySelected=function(e){var t=r.utils.unwrapObservable(e);return t.hasOwnProperty("key")?!0===this.selectionKeyHash()[t.key]:-1!==r.utils.arrayIndexOf(this.selection(),e)},t.prototype.toggleSelection=function(e,t){var n=r.utils.unwrapObservable(e);this.isAlreadySelected(e)?t||(this.selection.remove(e),this._updateIsSelectedObservable(n.key,!1)):!1!==t&&(this.selection.push(e),this._updateIsSelectedObservable(n.key,!0)),this.focused(e)},t.prototype.removeSelection=function(){this.unresolvedSelectedIndices={},this.selection([]),this._updateAllSelectItemViewModels(!1)},t.prototype.appendSelectionWithCurrentItem=function(e){if(e){if(this.anchor(e),!this.isAlreadySelected(e)){var t=r.utils.unwrapObservable(e);this.selection.push(e),this._updateIsSelectedObservable(t.key,!0)}this.focused(e)}},t.prototype.appendSelectionFromAnchor=function(e){if(e){var t=this.anchor.peek();t?this.selection.remove(t):this.anchor(e),this.selection.push.apply(this.selection,this._createRange(this.items,this.anchor(),e,!0)),this._updateSelectItemViewModelInSelection(!0),this.focused(e)}},t.prototype.replaceSelectionWithRangeFromAnchor=function(e){e&&(this.anchor.peek()||this.anchor(e),this._updateSelectItemViewModelInSelection(!1),this.selection(this._createRange(this.items,this.anchor.peek(),e)),this._updateSelectItemViewModelInSelection(!0),this.focused(e))},t.prototype.findItemData=function(e){var t=r.contextFor(e);if(!t||!t.$data)return null;for(var n=this._getItemFromContext(t)||t.$data;t;){if(n&&this._findItemIndex(n)>=0)return n;t=t.$parentContext,n=this._getItemFromContext(t)}return null},t.prototype.isClickOnToggleElement=function(e,n){var a=this.toggleClass;return!!a&&t._insideElementWithClass(n,a,e)},t.prototype.activate=function(){r.utils.toggleDomNodeCssClass(this.rootElement.peek(),this.properties.activeClass,!0),this.isActive(!0)},t.prototype.deactivate=function(){r.utils.toggleDomNodeCssClass(this.rootElement.peek(),this.properties.activeClass,!1),this.isActive(!1)},t.prototype.subscribeSelectItemViewModel=function(e,t){this._selectItemKeyToModel[e]?this._selectItemKeyToModel[e].push(t):this._selectItemKeyToModel[e]=[t]},t.prototype.disposeSelectItemViewModel=function(e,t){var n=this._selectItemKeyToModel[e],a=-1;n&&((a=n.indexOf(t))>-1&&n.splice(a,1),0===n.length&&delete this._selectItemKeyToModel[e])},t.prototype.getFocusedItemKey=function(){var e=null;return this._focusedIndex>-1&&(e=this.indexToKeyHash[this._focusedIndex]),e},t.prototype.ensureFocusedItemViewModel=function(){var e=this.getFocusedItemKey();this._updateIsFocusedObservable(e,!0)},t.prototype.setFocusItemByKey=function(e){var t=this.keyToIndexHash[e];void 0!==t&&this.focused(this.items.peek()[t])},t.prototype.getViewModelsForKey=function(e){return this._selectItemKeyToModel[e]},t.prototype._findItemIndex=function(e){var t=-1,n=r.utils.unwrapObservable(e);if(n)if(n.hasOwnProperty("key")){var a=this.keyToIndexHash[n.key];void 0!==a&&(t=a)}else t=r.utils.arrayIndexOf(this.items.peek(),e);return t},t.prototype._getKeyForItem=function(e){var t,n=r.utils.unwrapObservable(e);return n&&n.hasOwnProperty("key")&&(t=n.key),t},t.prototype._createRange=function(e,t,n,a){var i=this.selectionKeyHash(),r=e(),o=this._findItemIndex(t),s=this._findItemIndex(n),c=[];if(o>s){var d=o;o=s,s=d}for(var l=o;l<=s;l+=1){var u=this._getKeyForItem(r[l]);u?a&&i[u]||c.push(r[l]):this.unresolvedSelectedIndices[l]=!0}return c},t.prototype._updateFocused=function(e,t){for(var n=this.items.peek(),a=0;a<n.length;a++){var i=n[a];if(i&&i.hasOwnProperty(e)&&r.isObservable(i[e])&&i[e]()===t){this.focused(i);break}}},t.prototype._updateIsSelectedObservable=function(e,t){var n;e&&(n=this._selectItemKeyToModel[e])&&n.forEach(function(e){e.isSelected(t)})},t.prototype._updateIsFocusedObservable=function(e,t){var n;e&&(n=this._selectItemKeyToModel[e])&&n.forEach(function(e){e.isFocused(t)})},t.prototype._updateAllSelectItemViewModels=function(e){for(var t in this._selectItemKeyToModel)this._selectItemKeyToModel[t].forEach(function(t){t.isSelected(e)})},t.prototype._updateSelectItemViewModelInSelection=function(e){for(var t,n,a=this.selection.peek(),i=0;i<a.length;i++)(t=r.utils.unwrapObservable(a[i]))&&(n=t.key,this._updateIsSelectedObservable(n,e))},t.prototype._buildKeyIndexHash=function(){var e,t,n=this.items.peek();this.keyToIndexHash={},this.indexToKeyHash={};for(var a=0;a<n.length;a++)(t=r.utils.unwrapObservable(n[a]))&&t.hasOwnProperty("key")&&(e=t.key,this.keyToIndexHash[e]=a,this.indexToKeyHash[a]=e);this._checkUnresolvedIndicies()},t.prototype._checkUnresolvedIndicies=function(){var e,t=this.items.peek();for(var n in this.unresolvedSelectedIndices)t[Number(n)]&&(delete this.unresolvedSelectedIndices[n],(e=e||{})[n]=!0);if(e){for(var a=[],i=this.selectionKeyHash.peek(),r=0;r<t.length;r++){var o=t[r];(i[this._getKeyForItem(o)]||e[r]||this.unresolvedSelectedIndices[r])&&a.push(o)}this.selection(a)}},t.prototype._getItemFromContext=function(e){return e&&e.$data?"function"==typeof e.$data.getItem?e.$data.getItem():e.$data.isSelectable?e.$data:null:null},t}(i.default);t.e=s},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(1203),r=new a.t({name:"".concat("UploadedItemResourceKey",".UploadedItem"),factory:{dependencies:{observablesFactoryType:i.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create({}),disposable:t}}}})},,function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(8),i=new a.t({name:"".concat("OneUpOnePlayerFlightResourceKeys",".isOnePlayerEnabled"),factory:new a.e(!1)}),r=new a.t({name:"".concat("OneUpOnePlayerFlightResourceKeys",".isOnePlayerVroomTranscriptsEnabled"),factory:new a.e(function(){return!1})})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(3858),i=n(388),r=n(142),o=n(3342),s=n(2989),c=Object(r.r)("SubstratePeoplePickerHelper",o.t,{oAuthTokenProvider:s.e,pageContext:i.e,sharingContextInformation:a.e.optional})},function(e,t,n){"use strict";var a=function(){function e(t){this.id="".concat(++e._lastId),this.name=t}return e.prototype.matches=function(e){return e===this},e._lastId=0,e}();t.e=a}],Array(26),[function(e,t,n){}],Array(44),[function(e,t,n){"use strict";var a=n(0),i=n(5102),r=n(4821),o=n(2254),s=n(40),c=n(70),d=n(54),l=n(38),u=n(2202),f=n(147),p=function(e){function t(t){var n=e.call(this,t)||this;return n.name="CreateCustomDocument",n.openInNewTab=!1,n.fileCreationMenu=t.fileCreationMenu,n.entryIndex=t.entryIndex,n.navigation=n.resources.consume(f.e),n.itemProvider=n.resources.consume(u.resourceKey),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return this.item().queryType===l.e.Files},t.prototype.onExecute=function(e,t){var n=this.item.peek();return this._createCustomDocument(n)},t.prototype._createCustomDocument=function(e,t){var n=this,a=null,i=this.fileCreationMenu.createNewFileControl(this.entryIndex),r=i.get_fileExtension(),o=this.itemProvider.createCustomDocument(e.key,r,t).then(function(e){return e?(a=e.id,d.n.wrap({resultType:c.e.Success})):d.n.wrap({resultType:c.e.Failure})});return o.done(function(e){if(a&&null!=i){var t=n.resources.consume(s.f);i.set_itemUrl(a),i.set_httpRoot(t.webAbsoluteUrl);var r=i.getRedirectUrl();null!=r&&n.async.setImmediate(function(){return n.navigation.navigateTo({url:r,frameId:n.openInNewTab?"_blank":null})})}}),o},t}(o.e),m=n(5103),_=n(2184),h=n(2498),b=n(8),g=n(142),v=new b.t({name:"AppUrlHelper.key",loader:new g.t(function(){return n.e(485).then(n.bind(null,5696)).then(function(e){return e.resourceKey})})}),y=function(e){function t(t){var n=e.call(this,t)||this;return n.name="ExternalNavigate",n._item=t.item,n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this._item})},t.prototype.onExecute=function(e){var t=this,n=window.open("","_blank");return d.n.resolve(this.resources.consumeAsync(v)).then(function(e){return e.getItemUrl(t._item.peek())}).then(function(e){return n.location.href=e,{resultType:c.e.Success}},function(){return n.close(),{resultType:c.e.Failure}})},t}(_.e),S=n(2193),D=n(2203),I=n(849),x=n(43),C=n(2189),O=n(2294),w=n(2499),E=n(69),A=n(1691),L=function(e){function t(t){var n=e.call(this,t)||this,a=n.resources;return n.name="OpenInImmersiveReader",n._itemSelectionHelper=new(n.child(S.e))({allowMultiSelect:!1,canFallback:!1}),n._dialogProvider=a.consume(D.e),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){if(!Object(x.isFeatureEnabled)(x.EnableOpenInImmersiveReader))return!1;var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=e.urls&&e.urls[I.t.immersiveReaderUrl],n=e.size;return!!t&&!!n&&Object(A.e)(n)},t.prototype.onExecute=function(e,t){return Object(a.__awaiter)(this,void 0,d.n,function(){var e,t,i,r,o,s,l,u=this;return Object(a.__generator)(this,function(f){switch(f.label){case 0:return e=this._itemSelectionHelper.firstItem(),(t=e&&e.urls&&e.urls[I.t.immersiveReaderUrl])?(i=t,(null==e?void 0:e.displayName)&&Object(x.isFeatureEnabled)(x.EnableTitleInImmersiveReader)&&(i="".concat(t,"&title=").concat(e.displayName)),[4,n.e(9).then(n.bind(null,4874))]):[2,d.n.wrap({resultType:c.e.Failure})];case 1:return r=f.sent().getImmersiveReaderOptions,(o=r({url:i,qosName:"OpenInImmersiveReader.ko"}).getImmersiveReaderContext)?[4,n.e(10).then(n.bind(null,4903))]:[2,d.n.wrap({resultType:c.e.Failure})];case 2:return s=f.sent().launchImmersiveReader,l=new E.e,[2,s({getImmersiveReaderContext:o,options:{uiZIndex:1000001,onExit:function(){l.resolve()}}}).then(function(){return l.promise.then(function(){return d.n.wrap({resultType:c.e.Success})}).catch(function(){return d.n.wrap({resultType:c.e.Failure})})}).catch(function(e){return Object(a.__awaiter)(u,void 0,void 0,function(){var e,t=this;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return e=this.observables.create(!0),[4,this._dialogProvider.requestDialog({title:w.s,component:{name:O.e.tagName,params:{text:w.r}},actions:[{name:w.o,execute:function(){return Object(a.__awaiter)(t,void 0,d.n,function(){return Object(a.__generator)(this,function(e){return[2,2]})})},isAvailable:e,isDefault:!0,icon:new C.e("Cancel"),automationId:"ImmersiveReaderErrorDialog"}]}).wait()];case 1:return n.sent(),[2,d.n.wrap({resultType:c.e.Failure})]}})})})]}})})},t}(_.e),k=n(3851),M=n(311),P=n(101),T=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t)||this;a.name="NavigateToItem",a._urlDataSource=a.resources.consume(P.ue),a._viewParams=a.resources.consume(M.P);var i=t.item,r=t.itemSet,o=void 0===r?a.resources.consume(M.s.optional):r,s=t.parentItem,c=t.urlType,d=t.isRedirect,l=void 0!==d&&d,u=t.forceInSameWindow,f=void 0!==u&&u,p=t.shouldPreserveAction,m=void 0!==p&&p;a._itemSet=o,a._parentItem=s,a._urlType=a.wrapObservable(c),a._isRedirect=l,a._forceInSameWindow=a.wrapObservable(f),a._shouldPreserveAction=a.wrapObservable(m);var _=n.itemSelectionHelperType,h=void 0===_?a.resources.consume(S.e):_;a._itemSelectionHelper=new(a.scope.attached(h))({overrideItem:i,allowMultiSelect:!1,canFallback:!0}),a._url=a.createPureComputed(a._computeUrl),a._target=a.createPureComputed(a._computeTarget);var b=a.resources.consume(M.e);return a._navigationAction=new(a.managed(b.NavigationAction))({url:a._url,ignoreHistory:a._isRedirect,target:a._target}),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._navigationAction.isAvailable()},t.prototype.onExecute=function(e){return this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return Object(x.isFeatureEnabled)(x.EngagementTelemetryEnhancement)?e.prototype.getEngagement.call(this).withPart(h.e,{item:this._itemSelectionHelper.firstItem}):e.prototype.getEngagement.call(this)},t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._urlDataSource.getDefaultClickUrl(e,{urlType:this._urlType(),preserveAction:this._shouldPreserveAction(),itemSet:this._itemSet&&this._itemSet(),parentItem:this._parentItem&&this._parentItem(),viewParams:this._viewParams()})||""},t.prototype._computeTarget=function(){var e;return!this._forceInSameWindow()&&(e=this._url())&&0!==e.indexOf("#")?"_blank":"_top"},t}(_.e),U=n(2560),F=n(4441),H=n(7),R=n(52),N=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="OpenDocSet",a._urlDataSource=a.resources.consume(P.ue),a._url=a.createPureComputed(a._computeTargetUrl),a._actionMap=a.resources.consume(M.e),a}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e){return new(this.managed(this._actionMap.NavigationAction))({url:this._url}).execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this.item})},t.prototype._computeTargetUrl=function(){var e,t=this.item();return this._urlDataSource.getDefaultClickUrl(t,{additionalViewParams:(e={},e[H.n.viewIdKey]=R.e.normalizeLower(t.properties.WelcomeViewId,!1),e)})},t}(o.e),B=n(3100),j=n(4823),V=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="OpenInExplorer",n._helper=new(n.managed(j.e)),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){return this.onIsAvailable()?(B.set("odbnu","0"),this._helper.navigateToClassic(),d.n.wrap({resultType:c.e.Success})):d.n.wrap({resultType:c.e.ExpectedFailure})},t.prototype.onIsAvailable=function(){return this._helper.canOpenInExplorer()},t.prototype.onIsToggled=function(){return!1},t}(_.e),z=n(421),G=n(262);function K(e){if(!(e=(e||"").toLowerCase())||0!==e.indexOf("~site/_layouts/15/formserver.aspx"))return!1;var t=e.substring(e.indexOf("?")+1),n=G.e(t);return"{itemurl}"===n.xmllocation&&"browser"===n.openin}var W,q=function(e){function t(t){var n=e.call(this,t)||this;return n._fallbackAction=t.fallbackOpenAction,n._item=t.item,n._actionMap=n.resources.consume(M.e),n._customActionProvider=n.resources.consume(z.t.optional),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=this,a=this._item.peek();return(this._customActionProvider?this._customActionProvider.getCustomActionData().then(function(e){for(var t=0,i=e.ContextMenu||[];t<i.length;t++){var r=i[t];if(!r.children){var o=r;if(K(o.action)&&"function"==typeof o.isEnabled&&o.isEnabled(a))return new(n.managed(n._actionMap.CustomActionNavigationAction))({customAction:o,item:n._item})}}return n._fallbackAction}).catch(function(){return n._fallbackAction}):d.n.resolve(this._fallbackAction)).then(function(t){return t.execute(e)})},t}(_.e),Q=n(4442),Y=n(2239),J=n(3101),X=n(115),Z=n(11),$=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenInOfficeOnline";var a=t.openLocal,i=void 0!==a&&a,r=t.forceReadOnly,o=void 0!==r&&r,s=t.useDefaultAction,c=void 0!==s&&s;n._forceReadOnly=o,n._useDefaultAction=c,n._urlDataSource=n.resources.consume(P.ue),n._viewParams=n.resources.consume(M.P),n._itemSelectionHelper=new(n.child(S.e))({overrideItem:t.item}),n._itemCommandHelper=n.resources.consume(Y.t),n.item=n._itemSelectionHelper.firstItem,n._url=n.createPureComputed(n._computeUrl);var d=!1;Z.e.isActivated("4DF83139-3BF3-4543-81F8-8AE4BF66F8B3","09/03/2018","Teams Open Office Online In-App")||(d=Object(X.n)());var l=n.resources.consume(M.e);return n._navigationAction=new(n.managed(l.NavigationAction))({url:n._url,target:i||d?void 0:"_blank",postProcessUrl:function(e){return n._postProcessUrl(e)}}),n}return Object(a.__extends)(t,e),t.prototype._postProcessUrl=function(e){return e},t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&e.openUrl&&e.appMap)&&this._itemCommandHelper.isCommandSupported(e,J.i)&&this._navigationAction.isAvailable()},t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this._itemSelectionHelper.firstItem})},t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return"";var t=this._viewParams();return this._urlDataSource.getOpenInOfficeOnlineUrl(e,t,{forceReadOnly:this._forceReadOnly,useDefaultAction:this._useDefaultAction})},t}(_.e),ee=n(1914),te=n(197),ne=n(2429),ae=n(3266),ie=n(1855),re=n(16),oe=!re.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),se=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._pageContext=n.resources.consume(s.f);var a=n.resources.consume(M.e);return Object(X.e)()&&(n._openInDesktopAction=new(n.managed(a.OpenInDesktopAction))({openRelation:2,item:n.item,actionType:ae.e.OpenInOfficeOnline})),n}return Object(a.__extends)(t,e),t.prototype._postProcessUrl=function(e){var t=(new Date).getTime().toString();return ee.e.AddWopiPerfMarkToTargetUrl(t,"DocLib",e)},t.prototype.onIsAvailable=function(){return!(this._openInDesktopAction&&!this._openInDesktopAction.isAvailable())&&e.prototype.onIsAvailable.call(this)},t.prototype.onExecute=function(t,n){var a=this.item.peek();if(n.data.extraData||(n.data.extraData={}),this._openInDesktopAction)return this._openInDesktopAction.execute(t);var i=this._pageContext.userDisplayName,r=this._pageContext.userLoginName,o=r&&-1!==r.lastIndexOf("@")?r.substring(0,r.lastIndexOf("@")):void 0,s=void 0;if(a&&a.sharingType){var d=a&&a.sharingType;s=d===ne.e.Shared||d===ne.e.Public||d===ne.e.PublicUnlisted}var l=a.extension?a.extension.toLowerCase():void 0;return te.e(n.data.extraData,{uniqueId:a.properties?a.properties.uniqueId:void 0,fileType:oe&&l?Object(ie.e)(l):l,isInODB:a.itemFromServer&&a.itemFromServer.SiteTitle&&i?-1!==a.itemFromServer.SiteTitle.indexOf(i):void 0,isInODBv2:a.openUrl&&o?-1!==a.openUrl.toLowerCase().indexOf(o.toLowerCase()):void 0,isItemShared:s}),e.prototype.onExecute.call(this,t,n).then(function(){return{resultType:c.e.Success}})},t}($),ce=new b.t({name:"".concat("ODSPTeamsSharedResources",".hostedApplication"),loader:{load:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(545)]).then(n.bind(null,4412))];case 1:return e=t.sent().HostedApplicationFactory,[2,new b.e(function(t){return e.getHostedApplicationInstance(t)})]}})})}}});new b.t({name:"".concat("ODSPTeamsSharedResources",".utilities"),loader:{load:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,n.e(546).then(n.bind(null,2922))];case 1:return e=t.sent().TeamsUtilities,[2,new b.e(e)]}})})}}}),function(e){e.AppType="doclibPagesApp"}(W||(W={}));var de=n(2192),le=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.item,i=t.openRelation,r=void 0===i?0:i;return n.name="OpenInTeamsPreview",n._itemSelectionHelper=new(n.child(S.e))({overrideItem:2===r?a:void 0,allowMultiSelect:!1,canFallback:0!==r,ignoreSelection:0!==r}),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){var n,a,i,r=this,o=this._itemSelectionHelper.firstItem();this._itemParentHelper=this.resources.consume(de.e),this._pageContext=this.resources.consume(s.f);var l=this.observables.peekUnwrap(this._itemParentHelper.getFacetedAncestorOrSelf(o,"subsite")),u=null!==(a=null===(n=null==l?void 0:l.subsite)||void 0===n?void 0:n.serverRelativeUrl)&&void 0!==a?a:this._pageContext.webAbsoluteUrl,f={id:null===(i=null==o?void 0:o.properties)||void 0===i?void 0:i.uniqueId,name:o.name||o.displayName,openUrl:o.openUrl,extension:o.extension,type:o.type,baseUrl:u||""};return this.resources.consumeAsync(ce).then(function(e){r._teamsHostedApplication=e(W.AppType),r._teamsHostedApplication.openOneDriveItemInFilePreview(f)}),d.n.wrap({resultType:c.e.Success})},t}(_.e),ue=n(94),fe=n(148),pe=n(177),me=n(213),_e=n(1351),he=n(2582),be=n(3),ge=n(3043),ve=Z.e.isActivated("995DA390-4F3E-4CA5-A276-9DAB53FEE8A8","10/21/2022","Enables the openInTextEditor Command for html files"),ye=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=a.resources,r=n.itemUrlHelper,o=void 0===r?i.consume(fe.c):r;return a._itemUrlHelper=o,a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){if(!e.prototype.onIsAvailable.call(this))return!1;var t=this.itemSelectionHelper.firstItem();return!(!t||this._itemUrlHelper.getItemUrlParts(t.key).geoRelation!==ue.e.sameGeo)},t}(function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="OpenInTextEditor";var i=a.resources,r=n.urlDataSource,o=void 0===r?i.consume(P.ue):r,s=n.viewParams,c=void 0===s?i.consume(M.P):s,d=n.itemCommandHelper,l=void 0===d?i.consume(Y.t):d,u=n.platformDetection,f=void 0===u?i.consume(pe.e):u,p=n.actionMap,m=void 0===p?i.consume(M.e):p;return a._urlDataSource=o,a._viewParams=c,a._itemCommandHelper=l,a._platformDetection=f,a._url=a.createPureComputed(a._computeUrl),a.itemSelectionHelper=new(a.child(S.e))({overrideItem:t.item}),a._navigationAction=new(a.managed(m.NavigationAction))({url:a._url,target:a._platformDetection.isPWA?"_self":"_blank"}),a._isOneDriveWinApp=Object(X.e)(),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.itemSelectionHelper.firstItem();if(!e)return!1;if(Object(be.Jr)(x.EnableOneUpTextFileV2)&&!this._availableForHtml(e))return!1;var t=this.itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key),a=this._urlDataSource.getQueryType(n),i=Z.e.isActivated("35BD4D5C-F09B-4F80-BBFD-1080AFB2EBC1","11/10/2021","Use item.parentKey as fallback since item.UNSAFE_parent will not be set in ItemsScope pivots")?!!e.UNSAFE_parent||Object(be.Jr)(be.Mr)&&!!e.parentKey:!!e.UNSAFE_parent||!!e.parentKey;return this._itemCommandHelper.isCommandSupported(e,he.c)&&!this._platformDetection.isMobile&&this._navigationAction.isAvailable()&&!!e&&i&&Object(_e.a)(e)&&a!==l.e.SharedWithMe&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(a)&&e.itemStatus!==me.t.ConditionalAccessViewOnly&&e.itemStatus!==me.t.ConditionalAccessBlocked},t.prototype.onExecute=function(e){return this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this.itemSelectionHelper.firstItem})},t.prototype._computeUrl=function(){var e=this.itemSelectionHelper.firstItem();if(!e||!e.UNSAFE_parent&&!e.parentKey)return"";if(!Object(be.Jr)(x.EnableOneUpTextFileV2))return this._urlDataSource.getTextEditorItemUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams()});var t=this._availableForHtml(e)?this._urlDataSource.saveViewerType("TextFile"):{};return this._urlDataSource.getDefaultClickUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams(),additionalViewParams:t})},t.prototype._availableForHtml=function(e){var t=e&&e.htmlConversion&&Object(be.Jr)(x.UseSandboxHtmlViewer)&&(Object(ge.e)()||this._platformDetection.isEdge),n="TextFile"===this._urlDataSource.getViewerType(this._viewParams());return t&&!n&&!ve},t}(_.e)),Se=Z.e.isActivated("17DB17D7-FC3F-4243-B2CE-A54D5E531404","10/27/2022","Enable OpenInHtmlViewer Action"),De=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="OpenInHtmlViewer";var i=a.resources,r=n.urlDataSource,o=void 0===r?i.consume(P.ue):r,s=n.viewParams,c=void 0===s?i.consume(M.P):s,d=n.itemCommandHelper,l=void 0===d?i.consume(Y.t):d,u=n.platformDetection,f=void 0===u?i.consume(pe.e):u,p=n.actionMap,m=void 0===p?i.consume(M.e):p;return a._urlDataSource=o,a._viewParams=c,a._itemCommandHelper=l,a._platformDetection=f,a._url=a.createPureComputed(a._computeUrl),a.itemSelectionHelper=new(a.child(S.e))({overrideItem:t.item}),a._navigationAction=new(a.managed(m.NavigationAction))({url:a._url,target:a._platformDetection.isPWA?"_self":"_blank"}),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.itemSelectionHelper.firstItem();if(!e)return!1;if(!Object(be.Jr)(x.EnableOneUpTextFileV2))return!1;var t=e&&e.htmlConversion&&Object(be.Jr)(x.UseSandboxHtmlViewer)&&(Object(ge.e)()||this._platformDetection.isEdge),n="TextFile"!==this._urlDataSource.getViewerType(this._viewParams());return this._itemCommandHelper.isCommandSupported(e,he.o)&&t&&!n&&!Se},t.prototype.onExecute=function(e){return this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this.itemSelectionHelper.firstItem})},t.prototype._computeUrl=function(){var e=this.itemSelectionHelper.firstItem();if(!e||!e.UNSAFE_parent&&!e.parentKey)return"";var t=this._urlDataSource.saveViewerType("Html");return this._urlDataSource.getDefaultClickUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams(),additionalViewParams:t})},t}(_.e),Ie=n(2714),xe=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenPdfInBrowserAction";var a=n,i=a.observables,r=a.resources;n._itemCommandHelper=r.consume(Y.t),n._itemSelectionHelper=new(n.child(S.e))({overrideItem:t.item}),n._urlDataSource=r.consume(P.ue);var o=i.pureCompute(function(){var e=n._itemSelectionHelper.firstItem();return e&&e.openUrl}),s=r.consume(M.e);return n._navigationAction=new(n.managed(s.NavigationAction))({url:o,target:"_blank"}),Object(X.e)()&&(n._openInDesktopAction=new(n.managed(s.OpenInDesktopAction))({openRelation:2,item:n._itemSelectionHelper.firstItem,actionType:ae.e.OpenPdfInBrowser})),n._pdfViewerHelper=t.pdfViewerHelper,n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!(this._openInDesktopAction&&!this._openInDesktopAction.isAvailable())&&!!e&&Object(Ie.e)(e,this._urlDataSource)&&this._itemCommandHelper.isCommandSupported(e,he.d)&&".pdf"===e.extension.toLowerCase()&&(!this._pdfViewerHelper||!this._pdfViewerHelper.isPdfEditAvailable(e))},t.prototype.onExecute=function(e,t){return this._openInDesktopAction?this._openInDesktopAction.execute(e):this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this._itemSelectionHelper.firstItem})},t}(_.e),Ce=n(4443),Oe=n(226),we=n(113),Ee=n(656),Ae=n(253),Le=!re.e.isActivated("A61307C5-CA5C-474C-99AB-E9F954A94351","06/06/2022","Hide preview button for loop powered files"),ke=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Preview";var a=n.resources.consume(M.e);return n._dataStore=new Oe.e("",we.e.local),n._itemSelectionHelper=new(n.child(S.e))({allowMultiSelect:!1,overrideItem:t.item,canFallback:!1}),n._openAction=new(n.managed(a.OpenAction))({urlType:n.observables.compute(n._computeUrlType),item:t.item,openRelation:t.item?2:void 0,nonFoldersOnly:!0}),n._itemParentHelper=n.resources.consume(de.e),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=void 0;return e&&(t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"))),!(Le&&this._isBFile()||!e||e.external||!this._openAction.isAvailable()||e.type===Ae.e.OneNote||Object(Ee.i)()&&e.queryType===l.e.SharedWithMe||t&&t.list&&!t.list.isDocumentLibrary)},t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem.peek();return!n||"ms-word"!==n.appMap&&"ms-powerpoint"!==n.appMap?this._dataStore.setValue("OfficeDocClickTime",""):this._dataStore.setValue("OfficeDocClickTime",new Date),this._openAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this._itemSelectionHelper.firstItem})},t.prototype._computeUrlType=function(){var e=this._itemSelectionHelper.firstItem();return e&&e.queryType===l.e.Recent?"default":"focus"},t.prototype._isBFile=function(){var e=this._itemSelectionHelper.firstItem();if(e){var t=e.extension,n=e.properties,a=t?t.toLowerCase():"",i=n&&n.ProgId?n.ProgId:"";return".fluid"===a||".note"===a||".whiteboard"===a||".loop"===a||"Fluid."===i.substring(0,6)}return!1},t}(_.e),Me=n(93),Pe=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._isOneDriveWinApp=Object(X.e)(),n._pageContext=n.resources.consume(s.f),n._itemSelectionHelp=new(n.child(S.e))({allowMultiSelect:!1,overrideItem:t.item,canFallback:!1}),n._platformDetection=n.resources.consume(pe.e),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!this._isOneDriveWinApp&&!Object(Me.d)()&&!this._platformDetection.isPWA&&this._pageContext.isSPO&&e.prototype.onIsAvailable.call(this)},t.prototype.onExecute=function(t,n){var a=this._itemSelectionHelp.firstItem.peek();n.data.extraData||(n.data.extraData={});var i=this._pageContext.userDisplayName,r=this._pageContext.userLoginName,o=r&&-1!==r.lastIndexOf("@")?r.substring(0,r.lastIndexOf("@")):void 0,s=void 0;if(a&&a.sharingType){var c=a&&a.sharingType;s=c===ne.e.Shared||c===ne.e.Public||c===ne.e.PublicUnlisted}return te.e(n.data.extraData,{isInODB:a.itemFromServer&&a.itemFromServer.SiteTitle&&i?-1!==a.itemFromServer.SiteTitle.indexOf(i):void 0,isInODBv2:a.openUrl&&o?-1!==a.openUrl.toLowerCase().indexOf(o.toLowerCase()):void 0,isItemShared:s}),e.prototype.onExecute.call(this,t,n)},t}(ke),Te=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="SelectAction";var i=n.itemSelectionHelperType,r=void 0===i?a.resources.consume(S.e):i,o=n.actionMap,s=void 0===o?a.resources.consume(M.e):o;return a._item=t.item,a._selectItems=t.selectItems,a._itemSelectionHelper=new r({overrideItem:t.item,allowMultiSelect:!0,canFallback:!1}),t.showProperties&&(a._showPropertiesAction=new(a.managed(s.ShowPropertiesAction))({})),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.observables.unwrap(this._item);return!!e&&!e.isPlaceholder},t.prototype.onExecute=function(e,t){return Object(a.__awaiter)(this,void 0,d.n,function(){var t,n=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return this._selectItems?(t=this._selectItems.map(function(e){return n.observables.peekUnwrap(e)}),this._itemSelectionHelper.selectItems(t)):this._item&&this._itemSelectionHelper.selectItems([this.observables.peekUnwrap(this._item)]),this._showPropertiesAction?[4,this._showPropertiesAction.execute(e)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2,{resultType:c.e.Success}]}})})},t}(_.e),Ue=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="SelectAll",a._selectionModel=a.resources.consume(M.I),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return 0===this._selectionModel.mode},t.prototype.onExecute=function(e,t){return this._selectionModel.selectAll(),d.n.resolve({resultType:c.e.Success})},t}(_.e),Fe=n(1330),He=function(e){function t(t){var n=e.call(this,t)||this;return n.name="SetFocus",n._selector=t.selector,n._shouldClick=t.shouldClick,n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=document.querySelector(this._selector);return n&&(n.focus(),this._shouldClick&&Fe.e.clickElement(n)),d.n.wrap({resultType:c.e.Success})},t}(o.e),Re=n(4824),Ne=n(2537),Be=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="ToggleSelectionModeAction",n._platformDetection=n.resources.consume(pe.e),n._isSelectionModal=n.resources.consume(Ne.n),n._selectionHelper=new(n.child(S.e))({}),n._isOneDriveXboxApp=Object(X.t)(),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._isOneDriveXboxApp||this._platformDetection.isMobile&&!this._isSelectionModal()&&!this._selectionHelper.firstItem()},t.prototype.onExecute=function(e){var t=this._isSelectionModal.peek();return this._isSelectionModal(!t),d.n.wrap({resultType:c.e.Success})},t.prototype.onIsToggled=function(){return this._isSelectionModal()},t}(_.e),je=n(1206),Ve=n(4440),ze=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="OpenInClipChamp";var i=a.resources,r=n.urlDataSource,o=void 0===r?i.consume(P.ue):r,s=n.actionMap,c=void 0===s?i.consume(M.e):s;return a._urlDataSource=o,a.itemSelectionHelper=new(a.child(S.e))({overrideItem:t.item}),a._url=a.createPureComputed(a._computeUrl),a._navigationAction=new(a.managed(c.NavigationAction))({url:a._url,target:"_blank"}),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.itemSelectionHelper.firstItem();return Object(Ve.e)(e)},t.prototype.onExecute=function(e){return this._navigationAction.execute(e)},t.prototype._computeUrl=function(){var e=this.itemSelectionHelper.firstItem();return this._urlDataSource.getClipChampUrl(e)},t}(_.e);function Ge(e,t){return r.e(e,function(){return t().then(je.e)})}var Ke=function(e){function t(){var t=e.call(this)||this;return t.CreateCustomDocumentAction=p,t.DefaultClickAction=m.e,t.ExternalNavigateAction=y,t.FileHandlerOpenAction=k.e,t.NavigateToItemAction=T,t.NavigationAction=U.default,t.OpenAction=F.e,t.OpenInExplorerAction=V,t.OpenInfoPathAction=q,t.OpenInOfficeClientAction=Q.e,t.OpenInOfficeOnlineAction=se,t.OpenInImmersiveReaderAction=L,t.OpenInDesktopAction=ae.t,t.OpenInTeamsPreviewAction=le,t.OpenInTextEditorAction=ye,t.OpenInHtmlViewerAction=De,t.OpenInClipChampAction=ze,t.OpenPdfInBrowserAction=xe,t.OpenShortcutAction=Ce.e,t.PreviewAction=Pe,t.SelectAction=Te,t.SelectAllAction=Ue,t.SetFocusAction=He,t.ShowOperationsAction=Re.e,t.ToggleSelectionModeAction=Be,t.OpenDocSetAction=N,t.ActivateUniversalAnnotationAction=Ge("../ActivateUniversalAnnotationAction",function(){return n.e(113).then(n.bind(null,5689))}),t.AddFlowAction=Ge("../flow/AddFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(140)]).then(n.bind(null,4645))}),t.AddToOneDriveAction=Ge("../AddToOneDriveAction",function(){return n.e(122).then(n.bind(null,5072))}),t.SetUpReminderFlowAction=Ge("../flow/SetUpReminderFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(142)]).then(n.bind(null,4648))}),t.LaunchConfigureFlowsPanelAction=Ge("../flow/launchConfigureFlowsPanel/LaunchConfigureFlowsPanelAction",function(){return n.e(150).then(n.bind(null,4649))}),t.AlertAction=Ge("./AlertAction",function(){return n.e(228).then(n.bind(null,3973))}),t.AuthenticationPolicyWarningAction=Ge("./AuthenticationPolicyWarningAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(229)]).then(n.bind(null,4959))}),t.CheckInAction=Ge("./CheckInAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(230)]).then(n.bind(null,4155))}),t.CheckOutAction=Ge("./CheckOutAction",function(){return n.e(231).then(n.bind(null,4960))}),t.ClearFilterAction=Ge("../ClearFilterAction",function(){return n.e(114).then(n.bind(null,3967))}),t.ClearSelectionAction=Ge("../ClearSelectionAction",function(){return n.e(115).then(n.bind(null,3974))}),t.ContentTypeNavigationAction=Ge("./ContentTypeNavigationAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(232)]).then(n.bind(null,3975))}),t.CreateDocumentAction=Ge("./CreateDocumentAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(233)]).then(n.bind(null,3432))}),t.CreateFolderAction=Ge("../createFolder/odb/CreateFolderAction",function(){return n.e(124).then(n.bind(null,3648))}),t.CreateFileRequestAction=Ge("../createFileRequest/CreateFileRequestAction",function(){return n.e(569).then(n.bind(null,4961))}),t.CreateNewFolderAction=Ge("../createNewFolder/CreateNewFolderAction",function(){return n.e(126).then(n.bind(null,4962))}),t.CustomActionNavigationAction=Ge("./CustomActionNavigationAction",function(){return n.e(234).then(n.bind(null,4651))}),t.DeleteAction=Ge("../delete/odb/DeleteAction",function(){return n.e(127).then(n.bind(null,3978))}),t.DownloadAction=Ge("../download/odb/DownloadAction",function(){return n.e(131).then(n.bind(null,3979))}),t.OpenSWAAction=Ge("../openswa/OpenSWAAction",function(){return n.e(246).then(n.bind(null,5690))}),t.DownloadZipContentsAction=Ge("../downloadZipContents/odb/DownloadZipContentsAction",function(){return n.e(129).then(n.bind(null,5049))}),t.EditAction=Ge("./EditAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(235)]).then(n.bind(null,3668))}),t.EditPdfAction=Ge("../mspdf/EditPdfAction",function(){return n.e(225).then(n.bind(null,5691))}),t.EmptyRecycleBinAction=Ge("../emptyRecycleBin/odb/EmptyRecycleBinAction",function(){return n.e(137).then(n.bind(null,3980))}),t.FilterAction=Ge("../FilterAction",function(){return n.e(116).then(n.bind(null,3969))}),t.InvokeFirstRunExperienceAction=Ge("../splist/InvokeFirstRunExperienceAction",function(){return n.e(295).then(n.bind(null,4615))}),t.GetLinkAction=Ge("../getLink/odb/GetLinkAction",function(){return n.e(154).then(n.bind(null,3981))}),t.GroupItemsAction=Ge("../groupItems/GroupItemsAction",function(){return n.e(157).then(n.bind(null,4652))}),t.LaunchColumnManagementPanelAction=Ge("../launchColumnManagementPanel/LaunchColumnManagementPanelAction",function(){return n.e(775).then(n.bind(null,4963))}),t.LaunchColumnCustomizationPaneAction=Ge("../splist/LaunchColumnCustomizationPaneAction",function(){return Promise.all([n.e("deferred"),n.e("deferred.odsp-common"),n.e(774)]).then(n.bind(null,3575))}),t.LaunchCreateGroupPanelAction=Ge("../LaunchCreateGroupPanelAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(117)]).then(n.bind(null,5974))}),t.LaunchCreateShortcutPanel=Ge("./LaunchCreateShortcutPanel",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(236)]).then(n.bind(null,4142))}),t.LaunchFlowWidgetPanelAction=Ge("../flow/launchFlowWidgetPanel/LaunchFlowWidgetPanelAction",function(){return n.e(152).then(n.bind(null,4653))}),t.LaunchGroupifyPanelAction=Ge("../launchGroupifyPanel/LaunchGroupifyPanelAction",function(){return n.e(207).then(n.bind(null,4964))}),t.LaunchMoveCopyPanelAction=Ge("../launchMoveCopyPanel/odb/LaunchMoveCopyPanelAction",function(){return n.e(213).then(n.bind(null,4175))}),t.LaunchPdfExtractionAction=Ge("../LaunchPdfExtractionAction",function(){return n.e(226).then(n.bind(null,5692))}),t.LaunchTeamChannelAction=Ge("../launchTeamChannel/LaunchTeamChannelAction",function(){return n.e(218).then(n.bind(null,4965))}),t.LaunchUserExpirationPanelAction=Ge("../launchUserExpirationPanel/LaunchUserExpirationPanelAction",function(){return Promise.all([n.e("deferred"),n.e(591)]).then(n.bind(null,4564))}),t.MoveCopyAction=Ge("../moveCopy/odb/MoveCopyAction",function(){return n.e(224).then(n.bind(null,5104))}),t.NavigateToSharePointHomeAction=Ge("../navigateToSharePointHome/NavigateToSharePointHomeAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(227)]).then(n.bind(null,4966))}),t.OpenInPowerBIAction=Ge("../OpenInPowerBIAction",function(){return n.e(118).then(n.bind(null,4967))}),t.OpenSiteAction=Ge("../openSite/OpenSiteAction",function(){return n.e(245).then(n.bind(null,5693))}),t.PinToMruAction=Ge("../pinToMru/PinToMruAction",function(){return n.e(248).then(n.bind(null,4968))}),t.PolicyTipAction=Ge("../PolicyTipAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e("deferred.odsp-common"),n.e("deferred.odsp-datasources"),n.e(636)]).then(n.bind(null,4134))}),t.PrintPdfAction=Ge("../printPdf/odb/PrintPdfAction",function(){return n.e(250).then(n.bind(null,4969))}),t.RemoveFromSharedListAction=Ge("./RemoveFromSharedListAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(237)]).then(n.bind(null,4365))}),t.RemoveTagAction=Ge("../RemoveTagAction",function(){return n.e(119).then(n.bind(null,4970))}),t.RenameAction=Ge("../rename/odb/RenameAction",function(){return n.e(251).then(n.bind(null,3982))}),t.RestoreAction=Ge("../restore/RestoreAction",function(){return n.e(253).then(n.bind(null,3983))}),t.SaveAction=Ge("../save/odb/SaveAction",function(){return n.e(255).then(n.bind(null,4176))}),t.ShareAction=Ge("../share/odb/ShareAction",function(){return n.e(801).then(n.bind(null,3782))}),t.ShareByLinkAction=Ge("../shareByLink/odb/ShareByLinkAction",function(){return n.e(257).then(n.bind(null,3783))}),t.ShowPermissionsAction=Ge("../showPermissions/ShowPermissionsAction",function(){return n.e(621).then(n.bind(null,3984))}),t.ShowRunReportAction=Ge("../showRunReport/ShowRunReportAction",function(){return n.e(268).then(n.bind(null,4971))}),t.ShowItemAnalyticsAction=Ge("../showItemAnalytics/ShowItemAnalyticsAction",function(){return n.e(260).then(n.bind(null,4177))}),t.ShowKeyPointsAction=Ge("../showKeyPoints/ShowKeyPointsAction",function(){return n.e(262).then(n.bind(null,4178))}),t.ShowShareAction=Ge("../showShare/ShowShareAction",function(){return n.e(785).then(n.bind(null,4972))}),t.ShowKeyboardMapAction=Ge("../showKeyboardMap/ShowKeyboardMapAction",function(){return n.e(264).then(n.bind(null,3985))}),t.ShowExistingFlowsAction=Ge("../flow/ShowExistingFlowsAction",function(){return n.e(143).then(n.bind(null,4654))}),t.ShowFiltersAction=Ge("../showFilters/odb/ShowFiltersAction",function(){return n.e(746).then(n.bind(null,4318))}),t.ShowPropertiesAction=Ge("../ShowPropertiesAction",function(){return n.e(747).then(n.bind(null,3986))}),t.ShowSelectionAction=Ge("../ShowSelectionAction",function(){return n.e(120).then(n.bind(null,3987))}),t.ShowVersionHistoryAction=Ge("../showVersionHistoryAction/ShowReactVersionHistoryAction",function(){return n.e(270).then(n.bind(null,4973))}),t.ShowMalwareDetectedAction=Ge("./ShowMalwareDetectedAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(238)]).then(n.bind(null,4366))}),t.ViewInFolderAction=Ge("../viewInFolder/ViewInFolderAction",function(){return n.e(326).then(n.bind(null,4319))}),t.OneDriveSortAction=Ge("../sort/od/OneDriveSortAction",function(){return n.e(273).then(n.bind(null,3784))}),t.SortAction=Ge("../sort/SortAction",function(){return n.e(272).then(n.bind(null,3483))}),t.SyncAction=Ge("./SyncAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(240)]).then(n.bind(null,4136))}),t.ToggleIsLeftNavUserExpandedAction=Ge("../../controls/leftNavExpander/actions/ToggleIsLeftNavUserExpandedAction",function(){return n.e(385).then(n.bind(null,2877))}),t.ToggleListLayoutAction=Ge("../toggleListLayout/odb/ToggleListLayoutAction",function(){return n.e(325).then(n.bind(null,3433))}),t.TriggerFlowAction=Ge("../flow/TriggerFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(145)]).then(n.bind(null,2876))}),t.TriggerFlowByIdAction=Ge("../flow/TriggerFlowByIdAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(146)]).then(n.bind(null,4656))}),t.TriggerODBConvertToPdfFlowAction=Ge("../flow/TriggerODBConvertToPdfFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(147)]).then(n.bind(null,4657))}),t.TriggerODBRequestSignOffFlowAction=Ge("../flow/TriggerODBRequestSignOffFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(148)]).then(n.bind(null,4658))}),t.UndoCheckOutAction=Ge("./UndoCheckOutAction",function(){return n.e(241).then(n.bind(null,3988))}),t.UpdatePermissionsAction=Ge("../UpdatePermissionsAction",function(){return n.e(121).then(n.bind(null,2882))}),t.UploadAction=Ge("./UploadAction",function(){return n.e(242).then(n.bind(null,3431))}),t.ViewOriginalAction=Ge("../viewOriginal/ViewOriginalAction",function(){return n.e(327).then(n.bind(null,4975))}),t.BackToClassicAction=Ge("../odb/BackToClassicAction",function(){return Promise.resolve().then(n.bind(null,5694))}),t.OpenInImageEditorAction=Ge("../openInImageEditor/OpenInImageEditorAction",function(){return n.e(243).then(n.bind(null,5695))}),t.EmbedAction=Ge("../embed/odb/EmbedAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(136)]).then(n.bind(null,5884))}),t}return Object(a.__extends)(t,e),t}(i.e);t.e=Ke}],Array(13),[function(e,t,n){"use strict";var a=n(0),i=n(4213),r=n(2202),o=n(54),s=n(311),c=n(383),d=n(70),l=n("knockout-lib"),u=function(e){function t(t){var n=e.call(this,t)||this,a=t.itemSet,i=void 0===a?n.resources.consume(s.s):a,r=t.indexResolver;return n._itemSet=i,n._indexResolver=r,n}return Object(a.__extends)(t,e),t.prototype.resolveSelection=function(e){var t=this._getUnresolvedIndices(e);return t.length?this._resolveIndices(t):o.n.wrap()},t.prototype._isItemResolved=function(e){return this._indexResolver.isItemResolved(e)},t.prototype._resolveIndices=function(e){return this._indexResolver.resolveIndices(e)},t.prototype._getUnresolvedIndices=function(e){for(var t=this._itemSet.peek().content.peek().items,n=[],a=0,i=e;a<i.length;a++){var r=i[a],o=t[r];this._isItemResolved(o)||n.push(r)}return n},t}(n(1203).default),f=n(2192),p=n(4214),m=n(3162),_=n(2238),h=n(1412),b=function(e){function t(t){void 0===t&&(t={});var n=this,a={getItemKey:v};l.utils.extend(a,t||{}),n=e.call(this,a)||this;var i=t.itemSet,o=void 0===i?n.resources.consume(s.s):i,c=t.indexResolver,d=t.enableSelectionResolution,h=void 0===d||d;return n.itemSet=o,n.itemProvider=n.resources.consume(r.resourceKey),n._enableSelectionResolution=h,n._itemParentHelper=n.resources.consume(f.e),n._refreshMessageHelper=n.resources.consume(p.e),n._currentItems=n.createPureComputed(n.computeCurrentItems),n._itemKey=n.createPureComputed(n._computeItemKey),n._useItemCacheData=n.resources.consume(m.e),n._itemsStore=n.resources.consume(_.t),n.createComputed(function(){n._onItemSetChanged(n._currentItems())}),n.createComputed(n._computeResetSelectionOnKeyChange),c&&(n._selectionResolver=new(n.managed(u))({itemSet:n.itemSet,indexResolver:c})),n._itemCacheToKOStoreDataSource=n._getItemCacheToKOStoreDataSource(),n.observables.backgroundCompute(n._computeOnItemCacheSelectionUpdate),n}return Object(a.__extends)(t,e),t.prototype.resolveSelection=function(){var e=this,t=this.itemSet.peek();if(!t)return o.n.wrap([]);if(this._enableSelectionResolution){if(this._selectionResolver){for(var n=[],a=this.getItems(),i=0;i<a.length;i++)(this.isIndexSelected(i)||!a[i]&&this.isAllSelected.peek())&&n.push(i);return this._selectionResolver.resolveSelection(n).then(function(){return e._unwrapSelection(e.selection.peek())})}var r={resolveAttempt:0,itemSet:t,missingRanges:null,pendingRanges:0,signal:new c.e,getItemPromises:[]};return this.validateResolvedSelection(r),r.signal.getPromise()}return o.n.wrap(this._unwrapSelection(this.selection.peek(),!0))},t.prototype.validateResolvedSelection=function(e){if(e.resolveAttempt++,e.resolveAttempt>4)e.signal.error({resultType:d.e.Failure,resultCode:"TooManyAttempts"});else{var t=this.getMissingRanges();if(e.getItemPromises=[],e.missingRanges=t,e.pendingCount=t.length,0===e.missingRanges.length)e.signal.complete(this._unwrapSelection(this.selection.peek()));else for(var n=0;n<5;n++)this.resolveNextRange(e)}},t.prototype.resolveNextRange=function(e){var t=this;if(e.missingRanges.length>0){var n=e.missingRanges.pop(),a=l.utils.extend({},e.itemSet.context);a.avoidSeamSnapping=!0,a.startIndex=n.start,a.endIndex=n.end,a.pageSize=n.end-n.start+1,e.getItemPromises.push(this.itemProvider.getItem(a).then(function(){e.pendingCount--,e.pendingCount?t.resolveNextRange(e):t.validateResolvedSelection(e)},function(n){t.cancelResolve(e,n)}))}},t.prototype.cancelResolve=function(e,t){for(var n=0;n<e.getItemPromises.length;n++)e.getItemPromises[n].cancel();t?e.signal.error(t):e.signal.cancel()},t.prototype.getMissingRanges=function(){var e=[],t=-1,n=-1,a=this.getMissingIndicies();if(a.length)for(t=a[0],n=a[a.length-1];t>-1;){var i=Math.min(n,t+1e3-1),r={start:t,end:i};e.push(r),t=i===n?-1:i+1}return e},t.prototype.computeCurrentItems=function(){var e=this.itemSet(),t=e&&e.content();return t&&t.items||[]},t.prototype._onItemSetChanged=function(e){var t=this,n=this.itemSet.peek(),a=n&&n.item&&this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n.item.peek(),"list"));a&&a.list?this.getItemKey=g.bind(void 0,a.list.isDocumentLibrary):this.getItemKey=v;var i=n&&n.item&&n.item.peek()&&n.item.peek().key,r=!!i&&this._refreshMessageHelper.hasItemRefreshedRecently(i);this.onAddItem=r?function(e){return!t.isSelectedDefaultState||-1!==t.selection.indexOf(e)}:void 0,this.setItems(e,!1),this._refreshMessageHelper.clearRecentlyRefreshedItems()},t.prototype._computeResetSelectionOnKeyChange=function(){this._itemKey(),this.clear(!0)},t.prototype._unwrapSelection=function(e,t){void 0===t&&(t=!1);for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o=this.peekUnwrapObservable(r);!o&&t||n.push(o)}return n},t.prototype._computeItemKey=function(){var e=this.itemSet(),t=e&&e.item();return t&&t.key},t.prototype._computeOnItemCacheSelectionUpdate=function(){var e=this._itemCacheToKOStoreDataSource();if(e){for(var t=[],n=0,a=e.selectedKOItemKeys();n<a.length;n++){var i=a[n];if(i){var r=this._itemsStore.getItem(i);t.push(this.getItemKey(r))}}0===t.length?this.clear():this.setSelectedKeys(t)}},t.prototype._getItemCacheToKOStoreDataSource=function(){var e=this,t=this.observables.create();return this.observables.backgroundCompute(function(){e._useItemCacheData.peek()?e.resources.consumeAsync(h.e.optional).then(function(e){e&&t(e)}):e._useItemCacheData()}),this.observables.pureCompute(function(){return e._useItemCacheData()?t():void 0})},t}(i.e);function g(e,t){var n=t&&t.peek&&t.peek();return n&&n.properties&&(e?n.properties.uniqueId:n.properties.ID)||n&&n.key||null}function v(e){var t=e&&e.peek&&e.peek();return t&&t.key||null}t.e=b}],Array(13),[function(e,t,n){"use strict";var a;n.d(t,"e",function(){return i}),function(e){e[e.none=0]="none",e[e.locate=1]="locate",e[e.defaultClick=2]="defaultClick",e[e.download=3]="download",e[e.share=4]="share",e[e.sharing=5]="sharing",e[e.sendSurvey=6]="sendSurvey",e[e.createTextDocument=7]="createTextDocument",e[e.createWord=8]="createWord",e[e.createExcel=9]="createExcel",e[e.createExcelForm=10]="createExcelForm",e[e.createPowerPoint=11]="createPowerPoint",e[e.createOneNote=12]="createOneNote",e[e.openInExcel=13]="openInExcel",e[e.openInWord=14]="openInWord",e[e.openInPowerPoint=15]="openInPowerPoint",e[e.openInOneNote=16]="openInOneNote",e[e.openInVisio=17]="openInVisio",e[e.openInProject=18]="openInProject",e[e.openInPublisher=19]="openInPublisher",e[e.openInOffice=20]="openInOffice",e[e.embed=21]="embed",e[e.reportAbuse=22]="reportAbuse",e[e.addToShared=23]="addToShared",e[e.editBrowser=24]="editBrowser",e[e.feedback=25]="feedback",e[e.versionHistory=26]="versionHistory",e[e.showProperties=27]="showProperties"}(a||(a={}));var i={};for(var r in a)if("number"==typeof a[r]){var o=r,s=a[o];i[o.toLowerCase()]=s}t.t=a},,,,,,,,,function(e,t,n){"use strict";(function(e){var a=n(5186),i=n(5187),r=n(5188);function o(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return d(this,e,t,n)}function d(e,t,n,a){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,a){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(a||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===a?new Uint8Array(t):void 0===a?new Uint8Array(t,n):new Uint8Array(t,n,a),c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=f(e,t),e}(e,t,n,a):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var a=0|m(t,n),i=(e=s(e,a)).write(t,n);return i!==a&&(e=e.slice(0,i)),e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|p(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(a=t.length)!=a?s(e,0):f(e,t);if("Buffer"===t.type&&r(t.data))return f(e,t.data)}var a;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(l(t),e=s(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|p(t.length);e=s(e,n);for(var a=0;a<n;a+=1)e[a]=255&t[a];return e}function p(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function m(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var a=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return B(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(e).length;default:if(a)return B(e).length;t=(""+t).toLowerCase(),a=!0}}function _(e,t,n){var a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,n);case"utf8":case"utf-8":return O(this,t,n);case"ascii":return E(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,n);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function h(e,t,n){var a=e[t];e[t]=e[n],e[n]=a}function b(e,t,n,a,i){if(0===e.length)return-1;if("string"==typeof n?(a=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,a)),c.isBuffer(t))return 0===t.length?-1:g(e,t,n,a,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):g(e,[t],n,a,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,n,a,i){var r,o=1,s=e.length,c=t.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(e.length<2||t.length<2)return-1;o=2,s/=2,c/=2,n/=2}function d(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var l=-1;for(r=n;r<s;r++)if(d(e,r)===d(t,-1===l?0:r-l)){if(-1===l&&(l=r),r-l+1===c)return l*o}else-1!==l&&(r-=r-l),l=-1}else for(n+c>s&&(n=s-c),r=n;r>=0;r--){for(var u=!0,f=0;f<c;f++)if(d(e,r+f)!==d(t,f)){u=!1;break}if(u)return r}return-1}function v(e,t,n,a){n=Number(n)||0;var i=e.length-n;a?(a=Number(a))>i&&(a=i):a=i;var r=t.length;if(r%2!=0)throw new TypeError("Invalid hex string");a>r/2&&(a=r/2);for(var o=0;o<a;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function y(e,t,n,a){return V(B(t,e.length-n),e,n,a)}function S(e,t,n,a){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,a)}function D(e,t,n,a){return S(e,t,n,a)}function I(e,t,n,a){return V(j(t),e,n,a)}function x(e,t,n,a){return V(function(e,t){for(var n,a,i,r=[],o=0;o<e.length&&!((t-=2)<0);++o)a=(n=e.charCodeAt(o))>>8,i=n%256,r.push(i),r.push(a);return r}(t,e.length-n),e,n,a)}function C(e,t,n){return 0===t&&n===e.length?a.fromByteArray(e):a.fromByteArray(e.slice(t,n))}function O(e,t,n){n=Math.min(e.length,n);for(var a=[],i=t;i<n;){var r,o,s,c,d=e[i],l=null,u=d>239?4:d>223?3:d>191?2:1;if(i+u<=n)switch(u){case 1:d<128&&(l=d);break;case 2:128==(192&(r=e[i+1]))&&(c=(31&d)<<6|63&r)>127&&(l=c);break;case 3:r=e[i+1],o=e[i+2],128==(192&r)&&128==(192&o)&&(c=(15&d)<<12|(63&r)<<6|63&o)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:r=e[i+1],o=e[i+2],s=e[i+3],128==(192&r)&&128==(192&o)&&128==(192&s)&&(c=(15&d)<<18|(63&r)<<12|(63&o)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,u=1):l>65535&&(l-=65536,a.push(l>>>10&1023|55296),l=56320|1023&l),a.push(l),i+=u}return function(e){var t=e.length;if(t<=w)return String.fromCharCode.apply(String,e);for(var n="",a=0;a<t;)n+=String.fromCharCode.apply(String,e.slice(a,a+=w));return n}(a)}t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return d(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,a){return l(t),t<=0?s(e,t):void 0!==n?"string"==typeof a?s(e,t).fill(n,a):s(e,t).fill(n):s(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return u(null,e)},c.allocUnsafeSlow=function(e){return u(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,a=t.length,i=0,r=Math.min(n,a);i<r;++i)if(e[i]!==t[i]){n=e[i],a=t[i];break}return n<a?-1:a<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!r(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var a=c.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(a,i),i+=o.length}return a},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?O(this,0,e):_.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,a,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===a&&(a=0),void 0===i&&(i=this.length),t<0||n>e.length||a<0||i>this.length)throw new RangeError("out of range index");if(a>=i&&t>=n)return 0;if(a>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var r=(i>>>=0)-(a>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(r,o),d=this.slice(a,i),l=e.slice(t,n),u=0;u<s;++u)if(d[u]!==l[u]){r=d[u],o=l[u];break}return r<o?-1:o<r?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},c.prototype.write=function(e,t,n,a){if(void 0===t)a="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)a=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===a&&(a="utf8")):(a=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");for(var r=!1;;)switch(a){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return y(this,e,t,n);case"ascii":return S(this,e,t,n);case"latin1":case"binary":return D(this,e,t,n);case"base64":return I(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(r)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),r=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function E(e,t,n){var a="";n=Math.min(e.length,n);for(var i=t;i<n;++i)a+=String.fromCharCode(127&e[i]);return a}function A(e,t,n){var a="";n=Math.min(e.length,n);for(var i=t;i<n;++i)a+=String.fromCharCode(e[i]);return a}function L(e,t,n){var a,i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",o=t;o<n;++o)r+=(a=e[o])<16?"0"+a.toString(16):a.toString(16);return r}function k(e,t,n){for(var a=e.slice(t,n),i="",r=0;r<a.length;r+=2)i+=String.fromCharCode(a[r]+256*a[r+1]);return i}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,n,a,i,r){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<r)throw new RangeError('"value" argument is out of bounds');if(n+a>e.length)throw new RangeError("Index out of range")}function T(e,t,n,a){t<0&&(t=65535+t+1);for(var i=0,r=Math.min(e.length-n,2);i<r;++i)e[n+i]=(t&255<<8*(a?i:1-i))>>>8*(a?i:1-i)}function U(e,t,n,a){t<0&&(t=4294967295+t+1);for(var i=0,r=Math.min(e.length-n,4);i<r;++i)e[n+i]=t>>>8*(a?i:3-i)&255}function F(e,t,n,a,i,r){if(n+a>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function H(e,t,n,a,r){return r||F(e,0,n,4),i.write(e,t,n,a,23,4),n+4}function R(e,t,n,a,r){return r||F(e,0,n,8),i.write(e,t,n,a,52,8),n+8}c.prototype.slice=function(e,t){var n,a=this.length;if((e=~~e)<0?(e+=a)<0&&(e=0):e>a&&(e=a),(t=void 0===t?a:~~t)<0?(t+=a)<0&&(t=0):t>a&&(t=a),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;n=new c(i,void 0);for(var r=0;r<i;++r)n[r]=this[r+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var a=this[e],i=1,r=0;++r<t&&(i*=256);)a+=this[e+r]*i;return a},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var a=this[e+--t],i=1;t>0&&(i*=256);)a+=this[e+--t]*i;return a},c.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var a=this[e],i=1,r=0;++r<t&&(i*=256);)a+=this[e+r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var a=t,i=1,r=this[e+--a];a>0&&(i*=256);)r+=this[e+--a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,a){e=+e,t|=0,n|=0,a||P(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,r=0;for(this[t]=255&e;++r<n&&(i*=256);)this[t+r]=e/i&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,a){e=+e,t|=0,n|=0,a||P(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,r=1;for(this[t+i]=255&e;--i>=0&&(r*=256);)this[t+i]=e/r&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):T(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):T(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):U(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,a){if(e=+e,t|=0,!a){var i=Math.pow(2,8*n-1);P(this,e,t,n,i-1,-i)}var r=0,o=1,s=0;for(this[t]=255&e;++r<n&&(o*=256);)e<0&&0===s&&0!==this[t+r-1]&&(s=1),this[t+r]=(e/o>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,a){if(e=+e,t|=0,!a){var i=Math.pow(2,8*n-1);P(this,e,t,n,i-1,-i)}var r=n-1,o=1,s=0;for(this[t+r]=255&e;--r>=0&&(o*=256);)e<0&&0===s&&0!==this[t+r+1]&&(s=1),this[t+r]=(e/o>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):T(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):T(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):U(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return H(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return H(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return R(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return R(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,a){if(n||(n=0),a||0===a||(a=this.length),t>=e.length&&(t=e.length),t||(t=0),a>0&&a<n&&(a=n),a===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-t<a-n&&(a=e.length-t+n);var i,r=a-n;if(this===e&&n<t&&t<a)for(i=r-1;i>=0;--i)e[i+t]=this[i+n];else if(r<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<r;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+r),t);return r},c.prototype.fill=function(e,t,n,a){if("string"==typeof e){if("string"==typeof t?(a=t,t=0,n=this.length):"string"==typeof n&&(a=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==a&&"string"!=typeof a)throw new TypeError("encoding must be a string");if("string"==typeof a&&!c.isEncoding(a))throw new TypeError("Unknown encoding: "+a)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var r;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(r=t;r<n;++r)this[r]=e;else{var o=c.isBuffer(e)?e:B(new c(e,a).toString()),s=o.length;for(r=0;r<n-t;++r)this[r+t]=o[r%s]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function B(e,t){var n;t=t||1/0;for(var a=e.length,i=null,r=[],o=0;o<a;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&r.push(239,191,189);continue}if(o+1===a){(t-=3)>-1&&r.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&r.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&r.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;r.push(n)}else if(n<2048){if((t-=2)<0)break;r.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;r.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;r.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return r}function j(e){return a.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(N,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,a){for(var i=0;i<a&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(974))}],Array(111),[function(e,t,n){"use strict";n.r(t),n.d(t,"themeOffice",function(){return i}),n.d(t,"themeDarkMode",function(){return r}),n.d(t,"themeODDarkModeDialog",function(){return d}),n.d(t,"themeODDarkMode",function(){return l}),n.d(t,"isODBDarkModeKey",function(){return u});var a=n(0),i={themeName:"Office",themeDescription:"Default theme",themePrimary:"#0078d4",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#005a9e",themeDarker:"#004578",neutralLighterAlt:"#f8f8f8",neutralLighter:"#f4f4f4",neutralLight:"#eaeaea",neutralQuaternaryAlt:"#dadada",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c8c8",neutralTertiary:"#a6a6a6",neutralSecondaryAlt:"#767676",neutralSecondary:"#666666",neutralPrimary:"#333",neutralPrimaryAlt:"#3c3c3c",neutralDark:"#212121",black:"#000000",white:"#fff",primaryBackground:"#fff",primaryText:"#333"},r={themeName:"Dark Mode",themeDescription:"(Dark) A dark theme based on the default.",themePrimary:"#2899f5",themeLighterAlt:"#0c2031",themeLighter:"#043862",themeLight:"#092C47",themeTertiary:"#185f00",themeSecondary:"#004C87",themeDarkAlt:"#3AA0F3",themeDark:"#6CB8F6",themeDarker:"#82c7ff",neutralLighterAlt:"#282828",neutralLighter:"#201f1e",neutralLight:"#252423",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondary:"#a19f9d",neutralPrimaryAlt:"#c8c6c4",neutralPrimary:"#f3f2f1",neutralDark:"#FAF9F8",black:"#ffffff",white:"#1b1a19",primaryBackground:"#1f1f1f",primaryText:"#f3f2f1",bodyBackground:"#1f1f1f",bodyText:"#ffffff",disabledBackground:"#1d1d1d",disabledText:"#797775"},o={themeName:"ODB Dark Mode",themeDescription:"ODB dark mode",themePrimary:"#2899f5",themeLighterAlt:"#092c47",themeLighter:"#043862",themeLight:"#004c87",themeTertiary:"#0078D4",themeSecondary:"#0078d4",themeDarkAlt:"#3aa0f3",themeDarker:"#82c7ff",themeDark:"#6cb8f6",neutralLighterAlt:"#201f1e",neutralLighter:"#252423",neutralLight:"#292827",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondaryAlt:"#979693",neutralSecondary:"#a19f9d",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralDark:"#faf9f8",black:"#ffffff",white:"#1b1a19",redDark:"#F1707B",primaryBackground:"#1b1a19",primaryText:"#f3f2f1",whiteTranslucent40:"rgba(0,0,0,.5)",freOverlayColor:"rgba(0,0,0,.5)",shareSuccessIcon:"#92C353",wordColor:"#296FE6",powerpointColor:"#CA5010",excelColor:"#10893C",excelPrimaryColor:"#10893C",excelShade10Color:"#0F7937",excelShade20Color:"#0A5325",powerpointPrimaryColor:"#CA5010",powerpointShade10Color:"#B1470E",powerpointShade20Color:"#79310A",wordPrimaryColor:"#296FE6",wordShade10Color:"#2461CA",wordShade20Color:"#19428A",wordIconColor:"#598FEC",powerpointIconColor:"#D67540",excelIconColor:"#37A660",visoIconColor:"#598FEC",oneNoteIconColor:"#D0AFE2",oneUpPaneBackground:"rgba(27, 26, 25, .75)"},s={bodyBackground:o.primaryBackground,bodyStandoutBackground:o.neutralLight,buttonText:o.black,buttonTextPressed:o.neutralDark,buttonTextHovered:o.neutralPrimary,bodySubtext:o.neutralSecondary,disabledBackground:o.neutralQuaternaryAlt,errorText:o.redDark,inputBackgroundChecked:o.themePrimary,menuBackground:o.neutralLighter,menuItemBackgroundHovered:o.neutralQuaternaryAlt,menuItemBackgroundPressed:o.neutralQuaternary,menuDivider:o.neutralTertiaryAlt,menuIcon:o.themeDarkAlt,menuHeader:o.black,menuItemText:o.neutralPrimary,menuItemTextHovered:o.neutralDark,messageText:o.neutralPrimary,primaryButtonBackground:o.themeTertiary,primaryButtonBackgroundHovered:o.themeLight,primaryButtonBackgroundPressed:o.themeLighter,primaryButtonText:o.black,primaryButtonTextHovered:o.black,primaryButtonTextPressed:o.black,primaryButtonTextDisabled:"#605e5c",variantBorder:o.neutralQuaternary,infoBackground:o.neutralQuaternaryAlt,infoIcon:o.neutralPrimaryAlt,errorIcon:o.redDark,warningIcon:o.neutralPrimaryAlt,blockingIcon:"#442726",severeWarningIcon:"#FCE100",successIcon:"#92C353",errorBackground:"#442726",blockingBackground:"#442726",warningBackground:"#433519",severeWarningBackground:"#4F2A0F",successBackground:"#393D1B"},c=Object(a.__assign)(Object(a.__assign)({},o),{white:"#252423",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",themePrimary:"#3AA0F3",themeDarkAlt:"#6CB8F6",themeDark:"#82C7FF"}),d={palette:c,semanticColors:Object(a.__assign)(Object(a.__assign)({},s),{bodyStandoutBackground:c.neutralLight,disabledBackground:c.neutralQuaternaryAlt,inputBackgroundChecked:c.themePrimary,menuBackground:c.neutralLighter,menuItemBackgroundHovered:c.neutralQuaternaryAlt,menuIcon:c.themeDarkAlt}),isInverted:!0},l={palette:o,semanticColors:s,isInverted:!0},u="isODBDarkMode"},,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"getProperties",function(){return r}),n.d(t,"createSearchRoot",function(){return o}),n.d(t,"getItemStatistics",function(){return s}),n.d(t,"getUserFromOwsString",function(){return c});var a=n(2693),i=n(253);function r(e){for(var t={},n=0,a=e.results;n<a.length;n++){var i=a[n],r=i.Key,o=i.Value;switch(i.ValueType){case"Edm.Boolean":t[r]={false:!1,true:!0}[o];break;case"Edm.Double":t[r]=parseFloat(o);break;case"Edm.Byte":case"Edm.Int32":case"Edm.Int64":t[r]=parseInt(o,10);break;case"Null":t[r]=null;break;case"Edm.String":if("Edges"===r){for(var s=JSON.parse(o),c=0,d=s;c<d.length;c++){var l=d[c];l.Properties.BlobContent&&(l.Properties.BlobContent=JSON.parse(l.Properties.BlobContent.toString()))}t[r]=s}else t[r]=o;break;default:t[r]=o}}return t}function o(e){var t=new a.e(e.key);return t.type=i.e.Folder,t.queryType=t.displayType=e.queryType,t.name=t.displayName=e.name,t.isRootFolder=!0,e.isPlaceholder||(t.isPlaceholder=!1),"number"==typeof e.childCount&&(t.folder={childCount:e.childCount}),t}function s(e){return{views:e.ViewsLifeTime||0,viewsUnique:e.ViewsLifeTimeUniqueUsers||0,viewsLast2Weeks:e.ViewsRecent||0,viewsLast2WeeksUnique:e.ViewsRecentUniqueUsers||0,viewsLastMonth:e.ViewsLastMonths1||0,viewsLastMonthUnique:e.ViewsLastMonths1Unique||0,viewsLastWeek:(e.ViewsLast7Days||0)+(e.ViewsLast6Days||0)+(e.ViewsLast5Days||0)+(e.ViewsLast4Days||0)+(e.ViewsLast3Days||0)+(e.ViewsLast2Days||0)+(e.ViewsLast1Days||0),viewsLastWeekUnique:(e.ViewsLast7DaysUniqueUsers||0)+(e.ViewsLast6DaysUniqueUsers||0)+(e.ViewsLast5DaysUniqueUsers||0)+(e.ViewsLast4DaysUniqueUsers||0)+(e.ViewsLast3DaysUniqueUsers||0)+(e.ViewsLast2DaysUniqueUsers||0)+(e.ViewsLast1DaysUniqueUsers||0)}}function c(e){var t={title:"",email:"",id:"",sip:""};if(e){var n=e.indexOf("|");t.sip=e.slice(0,n).trim();var a=e.indexOf("|",n+1);t.title=e.slice(n+1,a).trim()}return t}},,function(e,t,n){"use strict";n.r(t),n.d(t,"isCustomizingCardResourceKey",function(){return f}),n.d(t,"setCustomFormatterClass",function(){return p}),n.d(t,"setColumnToFormat",function(){return m});var a=n(0),i=n(2184),r=n(488),o=n(311),s=n(8),c=n(54),d=n(70),l=n(1933),u=n(1941),f=new s.t("base.columnCustomizationPane.isCustomizingCard");function p(){return window.CustomFormatter?c.n.wrap({resultType:d.e.Success}):c.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e(805)]).then(n.bind(null,4328))).then(function(e){return window.CustomFormatter=e.CustomFormatter,{resultType:d.e.Success}})}function m(e,t,n,a){if(!a&&void 0!==t&&n)for(var i=0,o=n.peek()&&n.peek().schema.peek();i<o.length;i++){var s=o[i];if(s.internalName===t){a=s;break}}e.consume(r.e.columnCustomizationPane.columnToFormat)(a),e.consume(r.e.columnCustomizationPane.viewToFormat)(null)}var _=function(e){function t(t){var n=e.call(this,t)||this;return n.name="LaunchColumnCustomizationPane",n._columnToFormat=t.column,n._internalName=t.internalName,n._itemSet=n.resources.consume(o.s),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){try{this.resources.consume(u.resourceKey)(!1),this.resources.consume(l.resourceKey)(!1),m(this.resources,this._internalName,this._itemSet,this._columnToFormat);var n=this.resources.consume(r.e.columnCustomizationPane.isColumnCustomizationPaneExpanded);return n(!1),n(!0),p()}catch(e){return c.n.wrap({resultType:d.e.Failure})}},t.prototype.onIsAvailable=function(){return!!this.resources.consume(o.l)()},t}(i.e);t.default=_},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return o});var a,i=n(1221),r=n(1655);!function(e){e[e.ExistingItemUpload=0]="ExistingItemUpload",e[e.SPOFilePicker=1]="SPOFilePicker",e[e.BrowseDeviceFilePicker=2]="BrowseDeviceFilePicker"}(a||(a={}));var o=function(e){e.consumeAsync(r.e).then(function(t){t.getComplianceCheckResult().then(function(t){t&&Object(i.e)(e,"SyntexModelsGeneralFeedback",!0)})})}}],Array(36),[function(e,t,n){"use strict";var a=n(386);n.d(t,"e",function(){return a})}],Array(76),[function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(8),i=new a.t("app.admin"),r=new a.t("app.spourl");new a.t("app.suitenavrendered")}],Array(17),[function(e,t,n){"use strict";var a=n("knockout-lib"),i=function(){function e(){}return e.init=function(e,t,n,i,r){var o=a.utils.unwrapObservable(t()),s=o&&o.activate||o;s&&s.call(r.$data,e)},e.supportsVirtualElements=!0,e}();t.e=i},,function(e,t,n){"use strict";n.r(t),n.d(t,"previewImageUrl",function(){return i}),n.d(t,"previewImageUrlFromProps",function(){return r}),n.d(t,"previewImageUrlFromUrl",function(){return o});var a=n(2663);function i(e,t,n,a){if(n.isSPO){var i=e.SiteId||e.SiteID||e.siteId||n.siteId,s=e.WebId||e.webId||n.webId,c=e.UniqueId||e.UniqueID||e.uniqueId,d=e.Url||e.url||e.Path;return c&&i&&s&&!a?r(i,s,c,t,n):o(d,t,n)}}function r(e,t,n,a,i){var r;if(i.isSPO)return n&&(r=s(function(r){var o=r?"":"&resolution=Width1024";return a+"/"+i.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&guidFile="+n+"&guidSite="+e+"&guidWeb="+t+o})),r}function o(e,t,n){var a;if(n.isSPO)return e&&(a=s(function(a){var i=a?"":"&resolution=Width1024";return t+"/"+n.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&path="+e+i})),a}function s(e){return{url:e(!0),width:0,height:0,getAligned:function(t,n){return{url:e(n.name===a.t.name),width:0,height:0}}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"n",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"r",function(){return u});var a=n(2409),i=n(3716),r=n(20);function o(e){return e?r.format(a.k,e):""}function s(e){var t=e&&e[e.length-1];return t?t.title||t.Title:""}function c(e){var t=e&&e[e.length-1];return{title:t&&t.title,email:t&&t.email,picture:t&&Object(i.t)({userLoginName:t.email})}}function d(e){return e?e.substr(e.lastIndexOf("\n")+1):""}function l(e){if(!e)return"";try{var t=window.DOMParser,n=t&&(new t).parseFromString(e,"text/html");return n&&n.body&&n.body.innerText}catch(e){return""}}function u(e){return e&&"0x0120"===e.slice(0,6)}},,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a="_shareHeroCommand",i="_calloutInvoker",r=["DocIcon","LinkFilename",a,i,"Modified","Editor"];function o(e,t){if(e.length===r.length){for(var n=0;n<r.length;n++){var o=r[n];if(!(t&&o===a||o===i)&&e[n].internalName!==o)return!1}return!0}return!1}},function(e,t,n){"use strict";var a;!function(e){e[e.Success=0]="Success",e[e.FolderDoesNotExist=1]="FolderDoesNotExist",e[e.ItemDoesNotExist=2]="ItemDoesNotExist",e[e.TooManyItems=3]="TooManyItems",e[e.ItemNotInSpotlight=4]="ItemNotInSpotlight",e[e.InvalidArgument=5]="InvalidArgument",e[e.ServerError=6]="ServerError",e[e.InvalidServerJSON=7]="InvalidServerJSON",e[e.UnknownServerResult=8]="UnknownServerResult"}(a||(a={})),t.e=a}],Array(84),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return $});var a=n(2178),i=n(0),r=n(2173),o=n(2191),s=n(1946),c=n(4545),d=n(311),l=n(5255),u=n(2198),f=n("knockout-lib"),p=n(188),m=function(){function e(){}return e.init=function(e,t,n,a,i){var r=new p.t(null);r.on(e,"focus",f.unwrap(t()).bind(f.dataFor(e))),f.utils.domNodeDisposal.addDisposeCallback(e,function(){r.dispose()})},e}(),_=n(535),h=n(977),b=n(91),g=n(2436),v=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.strings=l,a.addBindingHandlers({focus:m,keyboard:u.e,teachingBubble:g.e});var i=n.currentPageType,r=void 0===i?a.createObservable(b.e.Files):i,o=n.engagement,s=t.context;return a.context=s,a.teachingBubbleOptions={campaign:a.createObservable(h.ODC_PHOTOS_SEARCH),isVisible:a._isPhotosPage},a._engagement=o,a._isPhotosPage=a.createPureComputed(a._computeIsPhotosPage),a._pageType=r,a}return Object(i.__extends)(t,e),t.prototype.handleClick=function(){var e=this.peekUnwrapObservable(this.teachingBubbleOptions.campaign);e&&this._teachingBubbleProvider&&(this._teachingBubbleProvider.clearCurrentBubble(),this._teachingBubbleProvider.markBubbleAsDismissed(e)),this._engagement.logData({name:"Focus.SearchBox.SearchBox.Click",isIntentional:!0}),this.context.focusInput()},t.prototype._computeIsPhotosPage=function(){return this._pageType()===b.e.Photos},t.dependencies=Object(i.__assign)(Object(i.__assign)({},r.e.dependencies),{currentPageType:d.c.optional,engagement:_.e}),t}(r.e),y=Object(a.n)({name:"SearchBox",automationName:"ms-search-box",viewModelType:v,template:'<div class="od-SearchBox" role="presentation" data-bind="click:context.focusInput,css:{\'od-SearchBox--active\':context.isActive,\'od-SearchBox--hasBack\':context.hasBack,\'od-SearchBox--hasText\':context.searchText,\'od-SearchBox--searchIconLeft\':context.searchIconLeft,\'od-SearchBox--searchIconRight\':context.searchIconRight},teachingBubble:teachingBubbleOptions"><span class="od-SearchBox-iconWrapper od-SearchBox-iconArrowWrapper" data-bind="attr:{title:strings.BackIconLabel}"><button class="ms-Icon ms-Icon--Back" data-bind="icon:true,click:context.onBack,clickBubble:false"></button></span><span class="od-SearchBox-search"><input class="od-SearchBox-input" type="text" role="search" data-bind="hasFocus:context.inputFocused,keyboard:{allowInputEvents:true,preventDefault:true,mappings:{Enter:context.onEnter,Down:context.onArrowDown,Up:context.onArrowUp}},attr:{placeholder:context.placeholder,name:context.placeholder,\'aria-label\':context.searchBoxAriaLabel},textInput:context.searchText,automation:\'SearchBox-Input\',click:handleClick,clickBubble:false"></span><span class="od-SearchBox-iconWrapper od-SearchBox-iconSearchWrapper"><button class="ms-Icon ms-Icon--Search" data-bind="attr:{\'aria-label\':strings.SearchIconLabel},icon:true,click:context.onSearchClick,clickBubble:false,focus:context.focusInput"></button></span><span class="od-SearchBox-iconWrapper od-SearchBox-iconClearWrapper"><button class="ms-Icon ms-Icon--Cancel" data-bind="icon:true,click:context.clearInput.bind(this),clickBubble:false,attr:{\'aria-label\':strings.ClearIconLabel}"></button></span></div>'}),S=n(2476),D=n(2174),I=n(1331),x=n(70),C=function(){function e(){}return e.Default="od-search-result-default",e.Expanded="od-search-result-expanded",e.Glyph="od-search-result-glyph",e.Upscope="od-search-result-upscope",e}(),O=n(2319),w=n(3712),E=n(2504),A=n(3292),L=n(2281),k=n(4544),M=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.addBindingHandlers({activate:w.e,keyboard:u.e,selection:E.e,visibility:A.e});var i=t.context,r=a.observables,s=a.resources,d=i.searchData;return a.context=i,a.fadeIn=r.create(!1),a.getRelativeDateTimeStringPast=I.r,a.iconDesiredSize=r.pureCompute(function(){return a._getIconDesiredSize()}),a.imageFrameTagName=S.e.tagName,a.isRenderComplete=r.create(!1),a.parentFolderLabel=c.t,a.progressSpinnerFlatTagName=O.e.tagName,i.capabilities.showOnlyResults?a.statusMessage=r.create(""):a.statusMessage=r.pureCompute(function(){var e=i.searchData(),t=i.errorMessage(),n=i.searchText;return t||(n&&n().length<i.capabilities.minimumQueryLength?c.r:i.queryInProgress()?c.i:!i.capabilities.showNoResults||e.containers&&e.containers.length?"":c.e)}).extend({rateLimit:150}),a._responsiveUI=s.consume(o.t),a.responsiveMaxHeight=r.pureCompute(function(){var e=a._responsiveUI,t=e.formFactorSize(),n=e.windowHeight();return"Small"===t||"Medium"===t?"100%":"".concat(.7*n,"px")}),r.compute(function(){if(d()&&a.isRenderComplete()){var e=d.peek(),t=e.traceId;t&&a.resources.consumeAsync(k.e).then(function(e){e.logSuggestionsResultsRendered(t)});var n=e.responseToRenderEvent;n&&n.end({resultType:x.e.Success})}}),a}return Object(i.__extends)(t,e),t.prototype.getTemplate=function(e){var t;switch(e.type){case 6:t=C.Expanded;break;case 3:case 4:t=C.Glyph;break;case 7:t=C.Upscope;break;default:t=C.Default}return{name:t}},t.prototype.onClickResult=function(e,t){this.context.searchResultClicked(e)},t.prototype.getIconImage=function(e){var t=this,n=e.iconName;return{url:n,width:96,height:96,getAligned:function(e,a){var i,r=e.width;return i=r<24?16:r<32?24:r<48?32:r<64?48:r<96?64:96,{url:L.e(t.resources,n,i),width:i,height:i}}}},t.prototype.displayOdbMetadata=function(e){return!!e.parentFolder&&!!e.lastModifiedDateDisplay},t.prototype.displayLastModifiedBy=function(e){return!!e.lastModifiedBy},t.prototype.renderComplete=function(){this.isRenderComplete(!0)},t.prototype._getIconDesiredSize=function(){return"Small"===this._responsiveUI.formFactorSize()?{width:20,height:20}:{width:48,height:48}},t}(r.e);Object(D.t)(C.Default,'<li class="od-SearchResults-suggestion" tabindex="-1" data-bind="attr:{\'aria-label\':titleAriaLabel||title},click:$component.onClickResult.bind($component),clickBubble:false,css:{\'od-SearchResults-result-link--focused\':isFocused},hasFocus:isFocused"><div class="od-SearchResults-result-icon" data-bind="component:{name:$component.imageFrameTagName,params:{desiredSize:$component.iconDesiredSize,fadeIn:$component.fadeIn,image:$component.getIconImage($data)}}"></div><div class="od-SearchResults-result-title"><div class="od-SearchResults-result-title-text" data-bind="html:title"></div>\x3c!--ko if:$component.displayOdbMetadata($data)--\x3e<div class="od-SearchResults-result-metadata"><div data-bind="text:parentFolder"></div><div data-bind="text:lastModifiedDateDisplay" class="ms-dotSeparatorBefore"></div>\x3c!--ko if:$component.displayLastModifiedBy($data)--\x3e<div data-bind="text:lastModifiedBy" class="ms-dotSeparatorBefore"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></li>'),Object(D.t)(C.Expanded,'<li class="od-SearchResults-result od-SearchResults-expanded-result" role="presentation"><div class="od-SearchResults-result-link" tabindex="-1" role="listitem" data-bind="click:$component.onClickResult.bind($component),clickBubble:false,css:{\'od-SearchResults-result-link--focused\':isFocused},attr:{\'aria-label\':titleAriaLabel||title},hasFocus:isFocused"><div class="od-SearchResults-result-icon" data-bind="component:{name:$component.imageFrameTagName,params:{image:{url:iconUrl},desiredSize:{width:24,height:24},fadeIn:$component.fadeIn}}"></div><span class="od-SearchResults-result-title" data-bind="html:title"></span></div>\x3c!--ko if:!!$data.lastModifiedBy&&!!$data.lastModifiedDate&&!!$data.parentFolder--\x3e<div class="od-SearchResults-result-metadata ms-font-s ms-fontColor-neutralSecondary"><span data-bind="text:lastModifiedBy" class="ms-dotSeparatorAfter"></span><a data-bind="text:parentFolder,attr:{href:parentUrl,\'aria-label\':$component.parentFolderLabel}" class="od-SearchResults-result-folderLink ms-font-s ms-fontColor-themePrimary" target="_blank" tabindex="-1"></a><span data-bind="text:$component.getRelativeDateTimeStringPast(lastModifiedDate)" class="ms-dotSeparatorBefore"></span></div>\x3c!--/ko--\x3e\x3c!--ko if:$data.showSummary&&!!$data.summary--\x3e<div class="od-SearchResults-result-summary ms-font-s ms-fontColor-neutralSecondary"><span data-bind="html:summary" class="ms-enquote"></span></div>\x3c!--/ko--\x3e</li>'),Object(D.t)(C.Glyph,'<li class="od-SearchResults-suggestion" tabindex="-1" data-bind="attr:{\'aria-label\':titleAriaLabel},click:$component.onClickResult.bind($component),clickBubble:false,css:{\'od-SearchResults-result-link--focused\':isFocused},hasFocus:isFocused"><div class="od-SearchResults-result-glyph" data-bind="component:{name:\'od-icon-glyph\',params:{icon:glyph}}"></div><div class="od-SearchResults-result-title"><div class="od-SearchResults-result-title-text" data-bind="html:title"></div></div></li>'),Object(D.t)(C.Upscope,'<li class="od-SearchResults-result od-SearchResults-upscope-result" role="presentation"><div class="od-SearchResults-result-link" tabindex="0" role="link" data-bind="click:$component.onClickResult.bind($component),clickBubble:false,css:{\'od-SearchResults-result-link--focused\':isFocused},attr:{\'aria-label\':titleAriaLabel},hasFocus:isFocused">\x3c!--ko component:{name:\'od-icon-glyph\',params:{icon:glyph}}--\x3e\x3c!--/ko--\x3e<span class="od-SearchResults-result-title" data-bind="text:title"></span></div></li>');var P=Object(a.n)({name:"SearchResults",automationName:"ms-search-results",viewModelType:M,template:'<div class="od-SearchResults" data-bind="css:{\'od-SearchResults-hasStatus\':!!statusMessage()},style:{\'max-height\':responsiveMaxHeight()},keyboard:{allowInputEvents:true,preventDefault:true,mappings:{Enter:context.onEnter,Esc:context.clearInput,Down:context.onArrowDown,Up:context.onArrowUp,Space:context.onSpace}}">\x3c!--ko if:!context.queryInProgress()&&!statusMessage()--\x3e<div class="ms-accessible" aria-live="assertive" data-bind="text:context.newResultsAlert"></div>\x3c!--/ko--\x3e<div class="od-SearchResults-progressBox" data-bind="component:{name:progressSpinnerFlatTagName},visible:context.queryInProgress()"></div><div class="od-SearchResults-status" data-bind="text:statusMessage"></div><ul class="od-SearchResults-resultsBox ms-noList" data-bind="attr:{id:context.ariaResultsId}" role="list">\x3c!--ko foreach:context.searchData().containers--\x3e\x3c!--ko foreach:results--\x3e\x3c!--ko template:$component.getTemplate.call($component,$data)--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:$index()<$parent.context.searchData().containers.length-1--\x3e<li class="od-SearchResults-separator" role="separator"><hr class="od-SearchResults-separator-line"></li>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</ul>\x3c!--ko activate:$component.renderComplete()--\x3e\x3c!--/ko--\x3e</div>'}),T=n(1203),U=n(147),F=n(20),H=n(54),R=n(142),N=n(2193),B=n(38),j=n(7),V=n(8),z=n(101),G=new V.t({name:"SearchProvider",factory:new R.e(z.J)}),K=n(421),W=n(2189),q=function(e){function t(n,a){var i=e.call(this,n,a)||this,r=i._engagement=a.engagement;return i._hideDropdown=f.observable(!1),i._instrumentationProvider=a.instrumentationProvider,i._navigation=a.navigation,i._searchProvider=a.searchProvider,i._urlDataSource=a.urlDataSource,i._viewParams=a.viewParams,i._itemSelectionHelper=new(i.scope.attached(a.itemSelectionHelperType))({canFallback:!1,ignoreSelection:!0}),i._currentItem=i._itemSelectionHelper.currentItem,i.search=function(){var e=i.searchText.peek();i._searchProvider&&e&&(i._tsLogSearchDone(e),r.logData({name:"Upscope.Search.Click",isIntentional:!0}),i._onNavigateAway(),i._searchProvider.upscopeSearch({query:e}),i.unfocusInput())},i.onSpace=function(){var e=i.focusedItem.peek();e&&7===e.type&&i.searchResultClicked(e)},i.onEnter=function(){var e=i.focusedItem.peek();e?i.searchResultClicked(e):i._logAndSubmit()},i.clearInput=function(){i.searchText(""),i._tsResetSearchSession(),i.inputFocused(!0),i._setFocusItem(null),i.isActive(!0),i._hideDropdown(!0)},i.focusInput=function(){i._hideDropdown(!1),i.inputFocused(!0),i._setFocusItem(null),i.isActive(!0),""===i.searchText.peek()&&i._autoSuggest("")},i.onSearchClick=function(){i.isActive.peek()?i._logAndSubmit():i.focusInput()},i.unfocusInput=function(){i.inputFocused(!0),i.inputFocused(!1),i.isActive(!1)},i.onBack=function(){i.clearInput(),i.unfocusInput()},i.onArrowDown=function(){if(i._hideDropdown(!1),i.showResults.peek()){var e=i.allResults.peek();if(e&&e.length){var t=i.focusedItem.peek(),n=e[0];if(null!==t){var a=e.indexOf(t);n=(a+=1)===e.length?null:e[a]}i._setFocusItem(n)}return!1}},i.onArrowUp=function(){if(i._hideDropdown(!1),i.showResults.peek()){var e=i.allResults.peek();if(e&&e.length){var t=i.focusedItem.peek(),n=e[e.length-1];if(null!==t){var a=e.indexOf(t);n=0!==a?e[a-=1]:null}i._setFocusItem(n)}return!1}},i.searchResultClicked=function(e){var t;if(i._setFocusItem(null),i._searchProvider&&e)if(7===e.type)i._logAndSubmit();else{i._tsLogEntitySelected(e),i._engagement.logData({name:"InlineResult.Search.Click",isIntentional:!0}),i._searchProvider.searchResultClicked(e),i._updateText(e,!1),i._instrumentationProvider&&e.instrumentationUrl&&i._instrumentationProvider.userClickSuggestion(e.instrumentationUrl);var n=e.key,a=e.url;n?(i._onNavigateAway(),i._navigation.navigateTo({url:i._urlDataSource.getItemUrl(n,{viewParams:(t={},t.v="",t)})})):a&&(i._onNavigateAway(),i._navigation.navigateTo({url:a,frameId:"_blank"}))}i.unfocusInput()},i.placeholder=n.searchParams.placeholder,i.submitPlaceholder=n.searchParams.submitPlaceholder,i.hasBack=n.searchParams.hasBack,i.hideResultsUntilChange=f.observable(!1),i.submitAction=n.searchParams.submitAction||i.search,i.searchIconLeft=f.observable(!1),i.searchIconRight=f.observable(!1),i.createBackgroundComputed(function(){i._urlDataSource.getQueryType(i._viewParams&&i._viewParams())!==B.e.Search&&(i.searchText(""),i._tsResetSearchSession(),i._hideDropdown(!0))}),i.capabilities=i._searchProvider.getCapabilities(),i.isFocused=f.observable(!1),i.isActive=f.observable(!1),i.ariaAutoComplete=i.capabilities.supportsResultsWheeling?"list":"none",i.ariaResultsId="od-searchResults-list-"+t.resultsId++,i.searchBoxAriaLabel=n.searchParams.searchBoxAriaLabel,i.searchText=n.searchParams.searchText||f.observable(""),i.searchText.peek()&&i.async.setImmediate(function(){i._logAndSubmit()}),i.inputFocused=f.observable(!1),i._hadResults=!1,i._ignorableTextUpdateCount=0,i._isTemporarySuggestion=!1,i._tsLastTraceId=void 0,i._tsLastLogicalId=void 0,i.searchData=f.observable({}),i.allResults=f.observableArray(),i.newResultsAlert=f.observable(""),i.focusedItem=f.observable(null),i.subscribe(i.allResults,function(){i._setFocusItem(null)}),i.queryInProgress=f.observable(!1),i.errorMessage=f.observable(""),i.createComputed(i._computeSearchTextChanged).extend({rateLimit:i.capabilities.maxQueryRate}),i.createComputed(function(){i.isFocused()?i.isActive(!0):i.isActive(!1)}),i.showResults=i.addDisposable(f.pureComputed({read:function(){var e=i.searchText();if(i._hideDropdown()||i.hideResultsUntilChange())return!1;var t=!0;if(i.capabilities.showOnlyResults){var n=i.allResults();n&&n.length&&(i._hadResults||n.length>1)?(t=!0,i._hadResults=!0):t=!1}else e.length<i.capabilities.minimumQueryLength&&(t=!1);return i.capabilities.supportsResultsWheeling&&i.isFocused()&&t},write:function(){}})),i.createComputed(function(){i.isFocused()||i.hideResultsUntilChange(!1)}),i.createBackgroundComputed(function(){i.isActive();var e=o.e.determineWindowSize(window.innerWidth);o.e.DEFAULT_BREAKPOINTS[e]<=o.e.DEFAULT_BREAKPOINTS.Large&&i.async.setTimeout(function(){p.t.raise(document.body,"resize",void 0,!0)},400)}),i.observables.compute(function(){var e=i.searchData();e&&(i._tsLastTraceId=e.traceId,i._tsLastLogicalId=e.logicalId)}),i}return Object(i.__extends)(t,e),t.prototype._computeSearchTextChanged=function(){var e=this.searchText();e&&this._hideDropdown(!1),this.hideResultsUntilChange(!1),this.capabilities.supportsResultsWheeling&&this.isFocused.peek()&&this._previousSearchText!==e&&0===this._ignorableTextUpdateCount&&(this._isTemporarySuggestion=!1,this._autoSuggest(e)),this._ignorableTextUpdateCount&&this._ignorableTextUpdateCount--},t.prototype._autoSuggest=function(e){this.queryInProgress.peek()&&this._searchResultsRequestPromise&&this._searchResultsRequestPromise.cancel(),this.queryInProgress(!0),this._searchProvider.getItems&&(this._searchResultsRequestPromise=this._searchProvider.getItems(e,this._currentItem?this._currentItem.peek():null),this._searchResultsRequestPromise.done(this._resultCallback(),this._errorCallback()),this._previousSearchText=e)},t.prototype._logAndSubmit=function(){this._instrumentationProvider.logStartSearchOnSubmit(),this.submitAction(this)},t.prototype._clearResults=function(){this.searchData({}),this.allResults.removeAll()},t.prototype._resultCallback=function(){var e=this;return function(t){e.queryInProgress(!1),e.errorMessage("");var n=t.containers,a=!t.upscopeUnavailable&&e.searchText();if(a){var i=e.submitPlaceholder.peek();n.push({results:[{type:7,title:i,titleAriaLabel:i,glyph:new W.e("Search")}]})}var r=e._viewFromISearchResult(t),o=r.containers.reduce(function(e,t){return e.concat(t.results)},[]),s=o.length;e.capabilities.showOnlyResults&&!s&&e.showResults(!1),e.searchData(r),e.allResults(o),e.newResultsAlert(F.format(c.a,a?s-1:s))}},t.prototype._errorCallback=function(){var e=this;return function(t){H.n.isCanceled(t)||(e.queryInProgress(!1),e.errorMessage(String(t)),e._clearResults())}},t.prototype._viewFromISearchResult=function(e){var t=e.containers.map(function(e){return{results:e.results.map(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{isFocused:f.observable(!1)})})}});return Object(i.__assign)(Object(i.__assign)({},e),{containers:t})},t.prototype._onNavigateAway=function(){this._tsResetSearchSession(),this._isTemporarySuggestion=!1,this._searchResultsRequestPromise&&this._searchResultsRequestPromise.cancel()},t.prototype._setFocusItem=function(e){var t=this.focusedItem.peek();t!==e&&(t&&t.isFocused(!1),this.focusedItem(e),e?(e.isFocused(!0),this._updateText(e,!0)):this.focusInput())},t.prototype._updateText=function(e,t){4===e.type?(this._ignorableTextUpdateCount++,this.searchText(e.titleText),this._isTemporarySuggestion=t):this._isTemporarySuggestion&&(this._ignorableTextUpdateCount++,this.searchText(this._previousSearchText),this._isTemporarySuggestion=!1)},t.prototype._tsLogEntitySelected=function(e){var t=this.searchData.peek().traceId,n=e.referenceId,a=this.searchData.peek().logicalId;t&&n&&this.resources.consumeAsync(k.e).then(function(e){e.selectedEntity(t,n,a)})},t.prototype._tsLogSearchDone=function(e){var t=this._tsLastTraceId,n=this._tsLastLogicalId;e!==this._navigation.viewParams[j.n.queryParamKey]&&t&&this.resources.consumeAsync(k.e).then(function(e){e.didSearch(t,n)})},t.prototype._tsResetSearchSession=function(){this._tsLastTraceId&&this.resources.consumeAsync(k.e).then(function(e){e.renderedResults("",-1)}),this._tsLastTraceId=void 0,this._tsLastLogicalId=void 0},t.dependencies=Object(i.__assign)(Object(i.__assign)({},T.default.dependencies),{engagement:_.e,instrumentationProvider:K.r,navigation:U.e,searchProvider:G,urlDataSource:z.ue,viewParams:d.P,itemSelectionHelperType:N.e}),t.resultsId=0,t}(T.default),Q=Object(R.o)("SearchContext",q),Y=n(2394),J=n(2200),X=n(2245),Z=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.addBindingHandlers({keyboard:u.e,hasChildFocus:Y.e,element:J.e,control:a.a}),i._responsiveUI=n.responsiveUI,i.rootElement=i.createObservable(),i.overlayTagName=X.e.tagName;var r=t.placeholder,o=void 0===r?i.createObservable(s.S):r,d=t.searchBoxAriaLabel,l=void 0===d?s.h:d,f=t.submitPlaceholder,p=void 0===f?i.createObservable(c.n):f,m=t.hasBack,_=void 0===m?i.createObservable(!1):m,h=t.searchText,b=t.submitAction;return i.context=i.scope.attach(new n.searchContextType({searchParams:{placeholder:o,searchBoxAriaLabel:l,submitPlaceholder:p,hasBack:_,searchText:h,submitAction:b}})),i.searchBoxSpecification=n.searchBoxControl.toSpecification({context:i.context}),i.searchResultsSpecification=n.searchResultsControl.toSpecification({context:i.context}),i.isMdDown=i.createPureComputed(function(){if(i._responsiveUI){var e=i._responsiveUI.formFactorSize();return"Medium"===e||"Small"===e}return!1}),i.resultsStyle=i.createPureComputed(function(){var e=i.context.isFocused(),t=i.isMdDown(),n=i.rootElement();if(e&&t&&n){var a=n.getBoundingClientRect();return{top:String(a.top+a.height)+"px"}}return{}}),i}return Object(i.__extends)(t,e),t.dependencies=Object(i.__assign)(Object(i.__assign)({},r.e.dependencies),{responsiveUI:o.t,searchBoxControl:y,searchResultsControl:P,searchContextType:Q}),t}(r.e),$=Object(a.n)({name:"Search",automationName:"ms-search",viewModelType:Z,template:'<div class="od-Search" id="od-Search-div" data-bind="keyboard:{allowInputEvents:true,mappings:{Esc:context.clearInput}},css:{\'od-Search--active\':context.isActive},hasChildFocus:context.isFocused,element:rootElement">\x3c!--ko control:searchBoxSpecification--\x3e\x3c!--/ko--\x3e\x3c!--ko if:context.showResults()--\x3e\x3c!--ko component:{name:overlayTagName,params:{alignToParent:!isMdDown()}}--\x3e<div class="od-Search-overlay" data-bind="control:searchResultsSpecification,css:{\'od-Search--active\':context.isActive,\'od-Search--maximized\':isMdDown()},style:resultsStyle"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'})},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return m}),n.d(t,"r",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"i",function(){return g}),n.d(t,"e",function(){return v});var a=n(311),i=n(2408),r=n(0),o=n(80),s=n(12),c=n(5),d=n(1),l=n(37),u=n(31),f=n(121),p=n(14),m=Object(s.r)()(Object(s.a)()(Object(o.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(174).then(n.bind(null,5720))];case 1:return[2,e.sent().ComplianceDetailsAction]}})})},function(e,t){var n=t.itemKey;if(n){var a=e.demandItem({isFolder:c.h,permissions:d.St,spItem:u.e},n),i=a.isFolder,r=a.permissions,o=a.spItem,s=o&&f.e.serialize(o),m=e.demandItemFacet(d.We,s);if(m&&m.templateType===p.t.mySiteDocumentLibrary)return!1;var _=l.t.hasItemPermission({permissions:r},l.t.viewVersions);return!i&&_}return!1}))),_=Object(i.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(a.e);return new(e.injected(t.WorkflowAction))}),h=Object(i.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(a.e);return new(e.injected(t.EditRenditionsAction))}),b=Object(i.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(a.e);return new(e.injected(t.PublishAction))}),g=Object(i.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(a.e);return new(e.injected(t.UnPublishAction))({unPublishType:0})}),v=Object(i.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(a.e);return new(e.injected(t.UnPublishAction))({unPublishType:1})})}],Array(30),[function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(720),i=a.t.protocolCommand;function r(e,t,n,i,r,o){var s=a.e.none;return r&&(s=a.e.encodeCommand),a.t.createProtocolHandlerUrl(e,t,n,i,s,o)}},,,function(e,t,n){"use strict";function a(e,t){return{definitionKey:e,params:t}}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("ItemCacheEvaluationContext.key")},function(e,t,n){"use strict";var a=n(0),i=n(2184),r=n(70),o=n(2193),s=n(54),c=n(2360),d=n(364),l=function(e){function t(t){var n=e.call(this,t)||this;n.name="FileHandlerOpen";var a=n._fileHandlerAction=t.fileHandlerAction;return n._fileHandlerProvider=n.resources.consume(c.e),n._itemSelectionHelper=new(n.child(o.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1}),n._defaultHandlerAction=n.observables.pureCompute(n._computeDefaultHandlerAction),a&&a.handler&&a.handler.isPromoted&&(n.name="PromotedFileHandlerOpen"),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e||!e.graph)return!1;var t=e.extension,n=this._fileHandlerProvider,a=this._fileHandlerAction;return a?n.isActionForExtension(a,t):!!this._defaultHandlerAction()},t.prototype.onExecute=function(e){var t,n=this,a=this._fileHandlerAction;if(!a||!a.handler.isPromoted){if(!(t=window.open("","_blank")))return s.n.reject({resultType:r.e.ExpectedFailure,resultCode:"window.open"});t.opener=null}return this._itemSelectionHelper.resolveFirst().then(function(e){var i=a||n._defaultHandlerAction.peek();return i?n.resources.consumeAsync(d.t).then(function(n){return n.invokeAction({items:[e],action:i,target:t})}):s.n.reject("No action available for file handler")}).then(function(){return s.n.wrap({resultType:r.e.Success})},function(e){return s.n.wrap({resultType:s.n.isCanceled(e)?r.e.ExpectedFailure:r.e.Failure})})},t.prototype._computeDefaultHandlerAction=function(){if(!this._fileHandlerAction){var e=this._itemSelectionHelper.firstItem();if(e&&e.graph)return this._fileHandlerProvider.getDefaultOpenHandler(e.extension)}},t}(i.e);t.e=l},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("sharingContextInformation")},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(1203),r=n(101),o=n(142),s=function(e){function t(t,n){var a=e.call(this,t)||this;return a._commandDataSource=n.itemCommandDataSource,a}return Object(a.__extends)(t,e),t.prototype.getCommand=function(e,t){return this._commandDataSource.getCommand(e,t)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{itemCommandDataSource:r.A}),t}(i.default),c=Object(o.r)("ItemCommandProvider",s)},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("MoveCopyCapabilities")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"provider.clientForm.async",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred"),n.e("deferred.odsp-common"),n.e("deferred.odsp-datasources"),n.e(565)]).then(n.bind(null,2918)).then(function(e){return e.resourceKey})})})}],Array(282),[function(e,t,n){"use strict";var a=n(2174),i=n(0),r=n(2173),o=n(2832),s=n(2414),c=n(2175),d=n(1203),l=n(383),u=n(142),f=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=a._images=[];return a.async.setInterval(function(){i.length>300&&i.splice(300,1/0)},6e4),a}return Object(i.__extends)(t,e),t.prototype.checkOutImage=function(){return this._images.shift()||document.createElement("img")},t.prototype.checkInImage=function(e){var t=this,n=new l.e,a=this.async;return a.setTimeout(function(){e.setAttribute("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="),e.removeAttribute("style"),e.removeAttribute("class"),a.setTimeout(function(){e.removeAttribute("src"),t._images.push(e),n.complete()},1e3)},0),n.getPromise()},t}(d.default),p=Object(u.r)("ImageRecycler",f),m=n("knockout-lib"),_=function(e){function t(t){var n=e.call(this,t)||this,a=n.resources.consume(p),r=n.valueAccessor(),o=a.checkOutImage(),c=n.bindingContext,d=r.attr,l=void 0===d?{}:d,u=r.style,f=r.css,_=r.class;return m.applyBindingsToNode(o,{attr:Object(i.__assign)({alt:""},l)},c),u&&m.applyBindingsToNode(o,{style:u},c),f&&m.applyBindingsToNode(o,{css:f},c),_&&m.applyBindingsToNode(o,{class:_},c),new(n.managed(s.e))({element:o,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return r.imageLoader},bindingContext:c}),m.virtualElements.setDomNodeChildren(n.element,[o]),n.addDisposable({dispose:function(){o&&(m.cleanNode(o),a.checkInImage(o).done())}}),n.controlsDescendantBindings=!0,n}return Object(i.__extends)(t,e),t.supportsVirtualElements=!0,t}(c.t),h=n(20),b=n(726),g=n(1194),v=n(2663),y=n(4425),S=n(1866),D=n(16),I=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.addBindingHandlers({imageLoader:s.e,imageRecycler:_});var i=t.image,r=t.rotation,c=void 0===r?o.e.none:r,d=t.desiredSize,l=t.scale,u=void 0===l?1:l,f=t.isLoaded,p=void 0===f?a.createObservable(!1):f,m=t.position,h=t.loadedImage,b=t.error,g=t.loadImageScenarioName,D=n.thumbnailCache,I=void 0===D?a.resources.consume(y.e):D,x=n.outputExtenders,C=void 0===x?{deferred:!0}:x;return a._image=a.wrapObservable(i),a._rotation=a.wrapObservable(c),a._scale=a.wrapObservable(u),a._desiredSize=a.wrapObservable(d),a._alignment=v.n(t.alignment),a._thumbnailCache=I,a._loadedImage=a.wrapObservable(h),a._error=a.wrapObservable(b),a.isRotating=a._getIsRotating(),a.alignmentName=a.createPureComputed(a._computeAlignmentName),a.actualSize=a.createPureComputed(a._computeActualSize),a.actualSize.equalityComparer=S.e,a.isLoaded=a.createPureComputed(a._computeIsLoaded),a._imageUrl=a.createPureComputed(a._computeImageUrl),a._finalSize=a.createPureComputed(a._computeFinalSize),a._finalSize.equalityComparer=S.e,a._position=a.createPureComputed(a._computePosition),a._position.equalityComparer=S.e,a.imageElementStyle=a.createPureComputed(a._computeImageElementStyle),a.imageElementStyle.equalityComparer=S.e,a.imageBackgroundStyle=a.createPureComputed(a._computeImageBackgroundStyle),a.imageBackgroundStyle.equalityComparer=S.e,a.createBackgroundComputed(a._computeRecordImage),a.imageLoaderParams={src:a._imageUrl,image:a._loadedImage,error:a._error,scenarioName:g,getContents:a.observables.pureCompute(function(){return a._image().getContents})},m&&a.createBackgroundComputed(function(){return m(a._position())}).extend(C),p&&a.createBackgroundComputed(function(){return p(a.isLoaded())}).extend(C),a}return Object(i.__extends)(t,e),t.prototype._computeImageUrl=function(){var e=this._image();return e&&e.url&&h.format(e.url,e.width,e.height)||""},t.prototype._computeFinalSize=function(){var e,t=this._image(),n=this._scale();if(t&&!t.width){var a=this.actualSize(),i=window.devicePixelRatio||1;e=a&&{width:a.width*n/i,height:a.height*n/i}}else e=t&&{width:t.width*n,height:t.height*n};return e},t.prototype._computeImageElementStyle=function(){var e,t=this._desiredSize(),n=this._finalSize(),a=this._rotation();if(n){var i;i=t&&t.width&&t.height?t:n;var r=this._alignment.getTransform(n,i),o=r.translate.x/i.width,s=r.translate.y/i.height,c=r.scale*n.width/i.width,d=void 0;if(a){var l=void 0;if(a%2==1){var u={width:n.height,height:n.width};l=this._alignment.getTransform(u,i).multiply(r.invert())}else l=b.e.IDENTITY;d="rotate(".concat(90*a,"deg) scale(").concat(l.scale.toFixed(6),")")}else d="";e={left:"".concat((100*o).toFixed(2),"%"),top:"".concat((100*s).toFixed(2),"%"),width:"".concat((100*c).toFixed(2),"%"),"-webkit-transform":d,"-ms-transform":d,transform:d}}else e={left:"",top:"",width:"","-webkit-transform":"","-ms-transform":"",transform:""};return e},t.prototype._computeImageBackgroundStyle=function(){var e,t,n=this._finalSize(),a=D.t.isActivated("0ECA92CE-9CE8-41A7-8AEA-ED7D0D862836","10/08/2022","fix secure thumbnail link and meta throttling issue"),i=!a&&(null===(e=this._image())||void 0===e?void 0:e.getContents)?null===(t=this._loadedImage())||void 0===t?void 0:t.url:this._imageUrl();return{"max-width":n?"".concat(n.width.toFixed(2),"px"):"","max-height":n?"".concat(n.height.toFixed(2),"px"):"","background-image":a||i?'url("'.concat(i,'")'):""}},t.prototype._getIsRotating=function(){var e,t=this,n=this.createObservable(this._rotation.peek()),a=this.createPureComputed(function(){var a=t._rotation();return e&&t.async.clearTimeout(e),e=t.async.setTimeout(function(){return n(a)},300),n()});return this.createPureComputed(function(){return t._rotation()!==a()})},t.prototype._computeRecordImage=function(){var e=this._image();e&&this.isLoaded()&&this._thumbnailCache.record(e)},t.prototype._computeIsLoaded=function(){return!!this._loadedImage()},t.prototype._computeActualSize=function(){var e,t=this._loadedImage();return t&&(e={width:t.width,height:t.height}),e},t.prototype._computePosition=function(){var e,t=this._desiredSize(),n=this._finalSize(),a=this._rotation();if(n){var i,r;i=t&&t.width&&t.height?t:n,r=a%2==1?{width:n.height,height:n.width}:n;var o=this._alignment.getTransform(r,i),s=o.translate.x,c=o.translate.y,d=o.scale*r.width,l=o.scale*r.height;e=new g.e(s,c,d,l)}return e},t.prototype._computeAlignmentName=function(){var e;if(!this._rotation())switch(this._alignment.name){case"cover-center":e="cover";break;case"fit-center":e="fit"}return e},t}(r.e),x=Object(a.e)({tagName:"od-image-tile",template:"<span class=\"od-ImageTile\" data-bind=\"css:{'od-ImageTile--isLoaded':isLoaded,'od-ImageTile--isDimensioned':!!actualSize(),'od-ImageTile--isRotating':isRotating,'od-ImageTile--isAligned':!!alignmentName(),'od-ImageTile--isCustom':!alignmentName()},class:alignmentName()?'od-ImageTile--'+alignmentName():''\"><span class=\"od-ImageTile-background\" data-bind=\"style:imageBackgroundStyle\"></span>\x3c!--ko imageRecycler:{imageLoader:imageLoaderParams,class:'od-ImageTile-image',style:imageElementStyle}--\x3e\x3c!--/ko--\x3e</span>",viewModel:I,synchronous:!0});t.e=x},function(e,t,n){"use strict";var a,i=n(0),r=n(1203),o=n(358),s=n(101),c=n(421),d=n(311),l=n(364),u=n(488),f=n(40),p=n(254),m=n(147),_=n(5069),h=n(535),b=n(43);!function(e){e[e.Page=0]="Page",e[e.Card=1]="Card"}(a||(a={}));var g=a,v=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._peopleToPrefetch={},n._debouncedPrefetch=n.async.debounce(function(){return n._prefetchPeopleCards()},50),n}return Object(i.__extends)(t,e),t.prototype.personRendered=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];a&&!this._peopleToPrefetch[a]&&(this._peopleToPrefetch[a]=!0)}this._debouncedPrefetch()},t.prototype.getPeopleCardData=function(e){Object(b.isFeatureEnabled)(b.PeopleCardsOnLoki)&&!Object(b.isFeatureEnabled)(b.PeopleCardsReactComponent)&&(this.resources.consume(h.e).logData({name:"PeopleCard.DataLoad"}),this._peopleCardProvider||(this._peopleCardProvider=this.resources.consume(c.l)),this._peopleCardProvider.getPeopleCard(e,!1))},t.prototype._prefetchPeopleCards=function(){if(Object(b.isFeatureEnabled)(b.PeopleCardsOnLoki)&&!Object(b.isFeatureEnabled)(b.PeopleCardsReactComponent)){this._peopleCardProvider||(this._peopleCardProvider=this.resources.consume(c.l));var e=Object.keys(this._peopleToPrefetch);e.length>0&&this._peopleCardProvider.prefetchPeopleCards(e,g.Page)}this._peopleToPrefetch={}},t}(r.default),y=n(1578),S=n(4755),D=n(1551),I=n(4828),x=n(1343),C=function(){var e=this.mediaBaseUrl="odsp-media";x.e.addPaths({"@ms/odsp-media/lib":e})},O=n(4829),w=n(4224),E=n(4434),A=n(4830),L=n(2950),k=n(4831),M=n(1656),P=n(990),T=n(313),U=n(302),F=n(3166),H=n(8),R=n(142),N=n(91),B=n(4445),j={base:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(494)]).then(n.bind(null,5697))}),settings:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(514)]).then(n.bind(null,5882))}),share:Object(B.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(515)]).then(n.bind(null,5958))}),mobileUpsell:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(510)]).then(n.bind(null,5940))}),picker:Object(B.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(498)]).then(n.bind(null,5698))}),textEditor:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(517)]).then(n.bind(null,5838))}),fileRequest:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(500)]).then(n.bind(null,5867))}),embed:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(496)]).then(n.bind(null,5843))}),oneUp:Object(B.e)(function(){return n.e(511).then(n.bind(null,5914))}),files:Object(B.e)(function(){return n.e(501).then(n.bind(null,5959))}),error:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(497)]).then(n.bind(null,5941))}),mobileUpsellInner:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(509)]).then(n.bind(null,5071))}),settingsInner:Object(B.e)(function(){return n.e(513).then(n.bind(null,5891))}),restore:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(512)]).then(n.bind(null,5915))}),commands:Object(B.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(503)]).then(n.bind(null,5924))})},V=function(){function e(){}return e.prototype.getPageModuleLoader=function(e){if(e===N.e.MobileAppUpsell&&Object(b.isFeatureEnabled)(b.EnableMobileWebOfficeAppUpsell))return j.mobileUpsell;switch(e){case N.e.Error:case N.e.Restore:return j.base;case N.e.Settings:return j.settings;case N.e.Share:return j.share;case N.e.FilePicker:return j.picker;case N.e.TextFileEditor:return j.textEditor;case N.e.FileRequest:return j.fileRequest;case N.e.Embed:return j.embed;case N.e.OneUp:return j.oneUp;default:return j.files}},e.prototype.getInnerPageModuleLoader=function(e){switch(e){case N.e.MobileAppUpsell:return j.mobileUpsellInner;case N.e.Settings:return j.settingsInner;case N.e.Restore:return j.restore;case N.e.Error:default:return j.error}},e.prototype.getCommandSetModuleLoader=function(){return j.commands},e}(),z=new H.t({name:"ModuleLoaderDataSource",factory:new R.i(V)}),G=n(3860),K=n(4832),W=n(1083),q=n(4833),Q=n(1432),Y=n(2238),J=n(3430),X=n(3416),Z=n(4834),$=n(4164),ee=n(4446),te=n(3102),ne=n(1933),ae=n(3267),ie=n(2537),re=function(){function e(e,t){}return e.prototype.isWIPEnabled=function(){return!1},e}(),oe=Object(R.r)("WIPDataSource",re,{}),se=function(){function e(){}return e.exposeIfNeeded=function(e,t,n){return e.isExposed(t)?e.consume(t):e.expose(t,n())},e.exposeFactoryIfNeeded=function(e,t,n){e.isDefined(t)||e.exposeFactory(t,new R.e(n))},e.exposeResources=function(t){var n=t.resourceScope,a=t.pageContext,h=t.viewId,b=t.itemResultSetOptions,g=new o.e,x=g.attach(new(n.consume(r.observablesFactoryTypeResourceKey)));e.exposeIfNeeded(n,s.i,function(){return new(n.injected(k.e))}),e.exposeIfNeeded(n,c.e,function(){return new(n.injected(_.e))}),e.exposeIfNeeded(n,f.f,function(){return a}),e.exposeIfNeeded(n,Y.t,function(){return new Y.e}),e.exposeIfNeeded(n,m.e,function(){return new W.t}),e.exposeIfNeeded(n,s.X,function(){return new C}),e.exposeFactoryIfNeeded(n,F.e,z),e.exposeIfNeeded(n,s.ue,function(){return new(n.injected(S.default))}),e.exposeFactoryIfNeeded(n,s.ne,E.e),e.exposeFactoryIfNeeded(n,P.e,M.e),e.exposeIfNeeded(n,f.o,function(){return new(n.injected(D.e))({pageContext:a,listRootFolderWebRelativeUrl:t.listRootFolderWebRelativeUrl,listFullUrl:t.listFullUrl,listId:t.listId})}),n.expose(I.t,t.listShouldRenderFilesTitle),e.exposeFactoryIfNeeded(n,s.v,I.e),e.exposeFactoryIfNeeded(n,s.T,I.e),e.exposeFactoryIfNeeded(n,s.s,I.e),e.exposeFactoryIfNeeded(n,f.s,I.e),e.exposeFactoryIfNeeded(n,s.Se,oe),n.isDefined(s.c)||n.exposeFactory(s.c,new R.e(O.e)),e.exposeFactoryIfNeeded(n,s.V,w.e),e.exposeIfNeeded(n,c.r,function(){return new(n.injected(y.e))}),e.exposeFactoryIfNeeded(n,s.S,T.a),e.exposeIfNeeded(n,d.P,function(){return x.create({})}),e.exposeFactoryIfNeeded(n,s.r,A.e),e.exposeFactoryIfNeeded(n,G.e,K.e),e.exposeIfNeeded(n,c.f,function(){return new(n.injected(v))}),e.exposeFactoryIfNeeded(n,s.fe,U.resourceKey),e.exposeIfNeeded(n,p.t,function(){return"StandaloneList"}),e.exposeFactoryIfNeeded(n,p.e,Q.n),e.exposeFactoryIfNeeded(n,u.o,Z.e),e.exposeIfNeeded(n,u.e.leftNav.isLeftNavUserExpanded,function(){return x.create(!1)}),e.exposeFactoryIfNeeded(n,s.H,L.t);var H=e.exposeIfNeeded(n,u.t,function(){return new(n.injected($.e))({defaultViewId:h,itemResultSetOptions:b})});e.exposeIfNeeded(n,d.o,function(){return H.item}),e.exposeIfNeeded(n,u.a.layoutType,function(){return H.layoutType}),e.exposeIfNeeded(n,d.s,function(){return H.itemSet}),e.exposeIfNeeded(n,d.m,function(){return H.focusItem}),e.exposeIfNeeded(n,d._,function(){return H.focusItemSet}),e.exposeIfNeeded(n,d.l,function(){return H.currentView}),e.exposeIfNeeded(n,d.a,function(){return x.create(!1)}),e.exposeIfNeeded(n,d.d,function(){return new(n.injected(ee.e))});var N=n.consume(d.d);e.exposeIfNeeded(n,d.I,function(){return new(n.injected(J.e))(Object(i.__assign)(Object(i.__assign)({},t&&t.selectionOptions||{}),{selectionModelGroup:N,enableSelectionResolution:!1}))});var B=n.consume(te.e);return g.attach(B.register(x.pureCompute(function(){var e=N.currentSelection();return!!e&&e.selectedCount()>0}))),g.attach(B.register(n.consume(ie.t))),e.exposeIfNeeded(n,ne.resourceKey,function(){return x.create(!1)}),e.exposeIfNeeded(n,ae.e,function(){return x.create(!1)}),e.exposeIfNeeded(n,d.e,function(){return new X.e}),e.exposeIfNeeded(n,d.i,function(){return x.create(!0)}),e.exposeIfNeeded(n,l.a,function(){return new(n.injected(q.e))}),g},e}();t.e=se}],Array(18),[function(e,t,n){"use strict";var a=n(0),i=n(14),r=n(72),o=n(1203),s=n(1597),c=n(147),d=n(971),l=n(90),u=n(54),f=n(177),p=n(52),m=n(158),_=n(138),h=n(70),b=n(113),g=n(1866),v=n(63),y=n(20),S=n(358),D=n(1206),I=n(1945),x=n(2461),C=n(2861),O=n(91),w=n(38),E=n(7),A=n(2192),L=n(2693),k=n(2995),M=n(3257),P=n(2238),T=n(2202),U=n(311),F=n(101),H=n(254),R=n(488),N=n(421),B=n(40),j=n(2632),V=n(8),z=new V.t({name:"titleUpdater.key",factory:new V.e(function(e){e&&(document.title=e)})}),G=n(2191),K=n(115),W=n(43),q=n(1395),Q=n(4225),Y=n(1344),J="SPColumnSize",X="-Unsaved",Z=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.defaultViewId,i=t.itemResultSetOptions;n._itemResultSetOptions=i,n._autoExecuteRequested=!1,n._useRequiredRangeSync=!1;var r=n,o=r.observables,s=r.resources;n._defaultViewId=p.e.normalizeLower(a),n._resetPartialResultRequestCount=o.create(!1),n._viewParams=s.consume(U.P),n._responsiveUI=s.consume(G.t),n._isLeftNavUserExpanded=s.consume(R.e.leftNav.isLeftNavUserExpanded),n._navigation=s.consume(c.e),n._dataStore=s.consume(P.t),n._rumOneHelper=s.consume(H.e),n._onePageNavigationDataFetch=o.create(!1);var u=s.consume(B.u.optional);u&&(u.onePageNavigationDataFetch=n._onePageNavigationDataFetch),n._pageContext=s.consume(B.f),n._itemParentHelper=s.consume(A.e),n._loaderProvider=s.consume(N.e),n._isSwitchingLayout=o.create(void 0),n._currentItemKey=o.pureCompute(n._computeCurrentItemKey,{deferEvaluation:!0}),n._focusItemKey=o.pureCompute(n._computeFocusItemKey),n.focusRange=o.create({start:0,end:0}).extend({throttle:500});var m=n._getPlaceholderItemSet();n.item=s.expose(U.o,m.item),n.item.equalityComparer=d.n,n.itemSet=s.expose(U.s,o.create(m)),n.itemSet.equalityComparer=d.n,n._children=o.createArray([]),n.isEmptyView=o.create(!1),n.isGroupThrottled=s.consume(U.h.optional)||o.create(!1),n.showErrorPage=o.create(!1),n.isRetrievingData=o.create(!0),n.error=o.create(void 0),n.error.subscribe(function(e){e&&l.e.logError(e)}),n._groupingType=o.pureCompute(n._computeGroupingType),o.compute(function(){var e=n.itemSet().content();n._children(e.items);var t=(e.groupings||[])[0],a=void 0===t?void 0:t,i=a&&a.itemGroups&&a.isAllCollapsed&&a.isAllCollapsed(),r=!n.showErrorPage()&&!n.itemSet().isPlaceholder&&0===e.items.length&&!i;n.isEmptyView(r&&!n.itemSet().isExpired)}),o.compute(function(){n.item(n.itemSet().item())}),n.currentView=o.create(void 0),s.expose(U.l,n.currentView),n._itemProvider=s.consume(T.resourceKey),n._urlDataSource=s.consume(F.ue),n.queryType=o.compute(n._computeQueryType,{deferEvaluation:!0}),n.requiredRange=o.create({start:0,end:0}).extend({throttle:500}),n.requiredRangeSync=o.create({start:0,end:0}),n.itemsPerGroup=s.consume(B.r.optional)||o.create(-1),n.requiredGroup=o.create(void 0),n.expandAll=o.create(!1),n.layoutType=n._getLayoutType(),n.supportsNestedGroups=o.pureCompute(n._computeSupportsNestedGroups),n.canModifySchema=o.pureCompute(n._computeCanModifySchema),n.title=o.compute(n._computeTitle,{deferEvaluation:!0}),n.focusItem=o.pureCompute(n._computeFocusItem),n.focusItemSet=o.pureCompute(n._computeFocusItemSet),o.backgroundCompute(n._computeUpdateFocusItemSetContent,{deferEvaluation:!0}),n.isOneUp=o.pureCompute(n._computeIsOneUp),n._useItemsScope=s.consume(j.e),o.backgroundCompute(n._computeSetDocumentTitle),n._dataManagerDeferred=n._getDataManagerDeferred(),n._getItemContext=o.pureCompute(n._computeGetItemContext),n._getItemContext.equalityComparer=g.e,o.compute(n._computeHandleLayoutUpdates);var _=o.compute(n._computeItemSet).extend({rateLimit:{timeout:1,method:"notifyWhenChangesStop"}});return o.compute(function(){n._currentItemKey(),_()}),n.platform=s.consume(f.e),n._loaderProvider.waitForPLT().then(function(){n._setupAutoExecuteRequests(),n._doDeferredWork()}),o.backgroundCompute(n._computeRequestFocusItem).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),o.backgroundCompute(function(){var e=n._dataManagerDeferred(),t=n.itemSet();t.content();var a=t.isPlaceholder,i=!!t.item().error;e&&(i||!a)&&e.inNewFolderDataFetch&&e.firstDataFetchComplete(!0)}),n}return Object(a.__extends)(t,e),t.prototype.setLayoutIteration=function(e){var t=this;this.subscribe(e,function(e){t._handlePageLoad()})},t.prototype.onLayoutRenderComplete=function(){this._handlePageLoad()},t.prototype.updateSort=function(e,t){},t.prototype.getCrumbs=function(e){var t=this._dataManagerDeferred&&this._dataManagerDeferred();return t?t.getCrumbs(e):[]},t.prototype.getDefaultLayoutForView=function(){var e=this._itemProvider.getItemSync({parentKey:this._currentItemKey()}).item,t=e.peek();t.isPlaceholder&&e();var n=this._getRootItem(t),a=n&&n.list,o=this._getItemQueryType(t);if(o===w.e.Subsites)return x.u;if(o===w.e.DocumentLibraries)return x.s;if(o===w.e.Recent)return x.r;if(a&&void 0!==a.isDocumentLibrary&&!a.isDocumentLibrary&&!a.isPromotedLinks)return x.i;var s=this._responsiveUI,c=this._getContextualLayoutTypes(n)[o],d=Number(this._pageContext.webTemplate)===r.t.mySite||a&&a.templateType===i.n.mySiteDocumentLibrary;if(c)return this._getCorrectedLayoutType(c);if(s.compareSize(s.formFactorSize(),"Medium")<=0||t&&t.displayType===w.e.Photos)return x.s;if(a){if(a.templateType===i.n.pictureLibrary||a.isPromotedLinks||a.templateType===i.n.publishingAsset)return x.s;if(d)return x.r;if(a.isDocumentLibrary)return x.i}return d?x.r:x.i},t.prototype.getMorePartialResult=function(){1===this.itemSet.peek().content.peek().partialResultStatus&&(m.e.logData({name:"LargeList.GetMorePartialResult"}),this._resetPartialResultRequestCount&&this._resetPartialResultRequestCount(!0))},t.prototype.setRequiredRange=function(e,t){t?(this._useRequiredRangeSync=!0,this.requiredRangeSync(e)):(this._useRequiredRangeSync=!1,this.requiredRange(e))},t.prototype.getRequiredRange=function(e){return e?this.requiredRangeSync.peek():this.requiredRange.peek()},t.prototype.cacheLayoutContext=function(){var e=this.item.peek(),t=this._urlDataSource.getKeyParams(e.key),n=this._dataManagerDeferred.peek(),a=this.observables.peekUnwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));if((n&&!n.inNewFolderDataFetch||this._isSwitchingLayout.peek())&&e&&!e.isPlaceholder){var i=e&&e.displayType===w.e.Photos?w.e.Photos:this._urlDataSource.getQueryType(t),r=this._getContextualLayoutTypes(a);r[i]=this.layoutType.peek(),this._dataStore.setValue(this._getLayoutLocalStorageKey(a),r,b.e.local),this._isSwitchingLayout(void 0)}},t.prototype.getColumnWidthsFromLocalStorage=function(e,t){var n=t?X:"";try{return JSON.parse(localStorage.getItem("".concat(J).concat(n,"-").concat(e))||"")||{}}catch(e){return l.e.log(e,"Error parsing localStorage for column widths"),{}}},t.prototype.setColumnWidthsToLocalStorage=function(e,t,n){var a=this.getColumnWidthsFromLocalStorage(e,!0);a[t]=n.toString(),localStorage.setItem("".concat(J).concat(X,"-").concat(e),JSON.stringify(a))},t.prototype.onColumnReorder=function(e,t){var n=this.currentView.peek();if(n){var a=n.getEffectiveFieldNames().indexOf(t);n.updateField(e,a),this.currentView.valueHasMutated&&this.currentView.valueHasMutated()}},t.prototype._getItemQueryType=function(e){var t=this._urlDataSource.getKeyParams(e.key);return e&&e.displayType===w.e.Photos?w.e.Photos:this._urlDataSource.getQueryType(t)},t.prototype._handlePageLoad=function(e){var t=this._dataManagerDeferred.peek();if(t)if(t.firstDataFetchComplete.peek())if(t.pltLogComplete){var n=this.itemSet.peek().content.peek().items;n&&(n.length>0||e)&&this.async.setTimeout(function(){s.e.logData(),q.n()},0)}else this._rumOneHelper.mark("pageLoadComplete before setTimeout"),this.async.setTimeout(this._pageLoadComplete,0);else t.listViewMounted(!0)},t.prototype._computeItemSet=function(){var e=this._dataManagerDeferred&&this._dataManagerDeferred();e&&this._getItemContext&&e.computeItemSet(this.itemSet,this._getItemContext,this._useRequiredRangeSync)},t.prototype._getContextualLayoutTypes=function(e){var t,n=this._dataStore.getValue(this._getLayoutLocalStorageKey(e),b.e.local);return Object(a.__assign)(((t={version:2})[w.e.Files]="",t[w.e.Recent]="",t[w.e.SharedWithMe]="",t[w.e.Photos]="",t),n&&2===n.version?n:{})},t.prototype._getDataManagerDeferred=function(){var e,t=this,n=this.observables.create(),a=this.observables.pureCompute(function(){if(t._useItemsScope.peek())t._useItemsScope();else{var e=t.resources.consume(Q.e.optional);if(e)return e;t.trackPromise(u.n.resolve(t.resources.consumeAsync(Q.e.local.bypass))).then(function(e){n(e)})}return n()});return a.equalityComparer=d.n,this.observables.pureCompute(function(){var n=a();if(n&&(e&&(e.dispose(),e=void 0),!t._useItemsScope()))return(e=t.scope.attach(new S.e)).attach({dispose:function(){t.itemSet(t._getPlaceholderItemSet())}}),e.attach(t._createDataManagerDeferred(n))})},t.prototype._createDataManagerDeferred=function(e){return new e({defaultViewId:this._defaultViewId,expandAll:this.expandAll,isOneUp:this.isOneUp,focusRange:this.focusRange,requiredRange:this.requiredRange,requiredRangeSync:this.requiredRangeSync,requiredGroup:this.requiredGroup,supportsNestedGroups:this.supportsNestedGroups,resetPartialResultRequestCount:this._resetPartialResultRequestCount,currentItemKey:this._currentItemKey,currentView:this.currentView,groupingType:this._groupingType,itemResultSetOptions:this._itemResultSetOptions,error:this.error,showErrorPage:this.showErrorPage,isRetrievingData:this.isRetrievingData,queryType:this.queryType,onePageNavigationDataFetch:this._onePageNavigationDataFetch,handlePageLoad:this._handlePageLoad.bind(this)})},t.prototype._computeGetItemContext=function(){var e=this._dataManagerDeferred&&this._dataManagerDeferred();if(e)return e.computeGetItemContext(this.itemSet.peek(),this._getItemContext.peek(),this._useRequiredRangeSync)},t.prototype._computeHandleLayoutUpdates=function(){this._currentItemKey();var e=this._dataManagerDeferred();e&&(e.resetLayoutOnDataFetch(!0),e.inNewFolderDataFetch=!0),this._isLeftNavUserExpanded(!1)},t.prototype._computeQueryType=function(){var e=this._urlDataSource.getKeyParams(this._currentItemKey());return this._urlDataSource.getQueryType(e)},t.prototype._computeTitle=function(){var e=this.currentView(),t=this.item();return this._getItemName(e,t)},t.prototype._computeSetDocumentTitle=function(){var e=this.currentView(),t=this.unwrapObservable(this.focusItem()),n=this.item(),a=t||n;this.resources.consume(z)(this._getDocumentTitle(e,a))},t.prototype._getItemName=function(e,t){var n=t&&t.name||"";if(t&&this._urlDataSource.getQueryType(this._urlDataSource.getKeyParams(t.key))===w.e.DocumentLibraries)return I.r;if(Number(this._pageContext.webTemplate)!==r.t.mySite)if(e&&Object(Y.t)(e.viewType))n=e.title;else if(!n){var a=this._getRootItem(t);n=a&&a.name||""}return n},t.prototype._getDocumentTitle=function(e,t){var n=this._getItemName(e,t),a=this._pageContext,i="";return Object(K.i)(a)?n?y.format(I.h,n):I._:(Number(a.webTemplate)!==r.t.mySite?(i+=a.webTitle,n&&(i+=" - "+n),e&&e.title&&(i+=" - "+e.title)):i=n?y.format(I.y,n):I.v,i)},t.prototype._computeGroupingType=function(){return this.layoutType()===x.s&&Object(W.isFeatureEnabled)(W.UseTilesList)?1:0},t.prototype._getLayoutLocalStorageKey=function(e){var t=this._pageContext,n="SPO.Files.FilesQueryType."+t.webAbsoluteUrl,a=e&&e.list&&e.list.id||t.listId;return a&&(n+="."+a),n},t.prototype._computeFocusItemIndex=function(){var e=this._focusItemKey(),t=this._children();if(t)for(var n=0,a=t.length;n<a;n++){var i=this.peekUnwrapObservable(t[n]);if(i&&i.key===e)return n}return-1},t.prototype._computeFocusItemSet=function(){var e=this.itemSet(),t=new k.e(e.key,e.context);return t.item=e.item,t.content(this._getFocusItemSetContent(e.content.peek())),t.schema=e.schema,t.isPlaceholder=e.isPlaceholder,t},t.prototype._computeUpdateFocusItemSetContent=function(){var e=this.itemSet(),t=this.focusItemSet(),n=e.content();t&&t.content(this._getFocusItemSetContent(n))},t.prototype._getFocusItemSetContent=function(e){var t=this,n=this._urlDataSource,a=new M.e(e.items.length);return a.items=e.items.map(function(e){if(!e)return e;var a=e.peek().key;if(!a)return e;var i=n.getKeyParams(a);return delete i[E.n.uniqueParamKey],delete i[E.n.queryTypeParamKey],t._itemProvider.getItemSync({ownerId:n.getOwnerId(a),queryType:w.e.Files,parentKey:n.getKey(i),ignoreChildren:!0}).item}),a.groupings=e.groupings,a},t.prototype._computeFocusItem=function(){var e=this._focusItemKey();if(e){var t=this._computeFocusItemIndex();return t>-1?this._children()[t]:this._itemProvider.getItemSync({parentKey:e}).item}},t.prototype._computeIsOneUp=function(){return!!this._focusItemKey()},t.prototype._setupAutoExecuteRequests=function(){var e=this.queryType(),t=this._viewParams();if(!this._autoExecuteRequested&&e===w.e.Files){var n=t[E.n.policyTipKey]||t[E.n.policyTipKey.toLowerCase()],a=t[E.n.sharingKey]||t[E.n.sharingKey.toLowerCase()],i=t[E.n.managePermissionsKey]||t[E.n.managePermissionsKey.toLowerCase()];n?(this._autoExecuteRequested=!0,this._showAutoExecuteAction(0,n)):a?(this._autoExecuteRequested=!0,this._showAutoExecuteAction(1,a)):i&&(this._autoExecuteRequested=!0,this._showAutoExecuteAction(2,i))}},t.prototype._showAutoExecuteAction=function(e,t){var i,r,o=this,s=this.itemSet.peek().content.peek().items.filter(function(e){var n=e.peek().properties;return!!n&&n.ID===t}),c=this.resources;t&&(r=c.consume(T.resourceKey).getSpecifiedItems({itemKeys:[t],recurseInFolders:!0}).then(function(e){return e.children})),r.then(function(r){1===e&&m.e.logData({name:"Sharing.AutoExecute"}),2===e&&(m.e.logData({name:"ManagePermissions.AutoExecute"}),i={engagementSource:"QueryParameter"}),s[0]?(0===e&&m.e.logData({name:"PolicyTip.LaunchFromEmail.ItemInView"}),i=Object(a.__assign)(Object(a.__assign)({},i),{item:s[0]})):2===e?i=Object(a.__assign)(Object(a.__assign)({},i),{item:o.createObservable(r[0])}):(0===e&&m.e.logData({name:"PolicyTip.LaunchFromEmail.ItemOutsideView"}),i={itemKey:t}),1===e&&(i={overrideItem:r[0],focusItemResourceKey:C.n});var d,l=function(){var t=o._viewParams.peek();0===e?delete t[E.n.policyTipKey]:1===e?delete t[E.n.sharingKey]:2===e&&delete t[E.n.managePermissionsKey],o._navigation.updateViewParams(t,{ignoreHistory:!0})};d=0===e?u.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e("deferred.odsp-common"),n.e("deferred.odsp-datasources"),n.e(636)]).then(n.bind(null,4134))).then(D.e):2===e?u.n.resolve(n.e(621).then(n.bind(null,3984)).then(D.e)):u.n.resolve(n.e(785).then(n.bind(null,4972))).then(D.e),o.trackPromise(d),d.then(function(e){new(c.injected(e))(i).execute(null).done(l,l)})})},t.prototype._pageLoadComplete=function(){var e=this._dataManagerDeferred.peek();if(e&&!e.pltLogComplete){var t=v.n.now();e.pltLogComplete=!0;var n=this.queryType.peek(),a=this._urlDataSource.getPageType(this._viewParams.peek()),i=this.focusItem.peek()?O.e[O.e.OneUp]:"".concat(O.e[a]||"Default","-").concat(w.e[n]||"Default");this._loaderProvider.pageLoaded(i),new _.e({name:i,extraData:{layoutType:this.layoutType.peek()},startTimeOverride:v.n.getResponseEnd()}).end({resultType:h.e.Success}),this._rumOneHelper.logRUMOneForListView(t),this.events.raise("pageLoadComplete")}},t.prototype._doDeferredWork=function(){var e=this,t=this.resources;this.trackPromise(u.n.resolve(Promise.resolve().then(n.bind(null,6008))).then(D.e)).then(function(n){var a=new(t.injected(n));e._itemProvider.registerProjection(a.key,a)})},t.prototype._computeCurrentItemKey=function(){var e=this._viewParams(),t=this._urlDataSource,n=t.getCurrentItemKey(e),a=t.getKeyParams(n);return void 0!==this._queryTypeOverride&&(a[E.n.queryTypeParamKey]=this._queryTypeOverride),t.getKey(a)},t.prototype._computeSupportsNestedGroups=function(){if(Number(this._pageContext.webTemplate)===r.t.mySite)return!1;if(this.queryType()!==w.e.Files)return!1;var e=this.layoutType();return e===x.i||e===x.r||e===x.n},t.prototype._computeCanModifySchema=function(){var e=this.currentView(),t=this._viewParams(),n=this.item(),a=this._getRootItem(n,!0),i=a&&a.list&&a.list.permissions;return!(!e||!i||!i.manageLists&&!i.managePersonalViews||t[E.n.needsAttentionViewKey])},t.prototype._getRootItem=function(e,t){var n=this._itemParentHelper.getFacetedAncestorOrSelf(e,"list");return t?this.unwrapObservable(n):this.peekUnwrapObservable(n)},t.prototype._computeFocusItemKey=function(){return this._urlDataSource.getFocusItemKey(this._viewParams())},t.prototype._computeRequestFocusItem=function(){var e=this._focusItemKey(),t=this.focusItem(),n=t&&t();e&&n&&n.isPlaceholder&&this.trackPromise(this._itemProvider.getItem({parentKey:e,ignoreChildren:!0}))},t.prototype._getLayoutType=function(){var e=this;return this.observables.compute({read:function(){return e._isSwitchingLayout()||e.getDefaultLayoutForView()},write:function(t){e._isSwitchingLayout(t)},pure:!0})},t.prototype._getCorrectedLayoutType=function(e){var t=this._itemProvider.getItemSync({parentKey:this._currentItemKey()}).item,n=t.peek();n.isPlaceholder&&t();var a=this._getRootItem(n),o=a&&a.list,s=o&&o.isDocumentLibrary,c=this._pageContext.listBaseTemplate,d=void 0===c?"":c,l=Number(this._pageContext.webTemplate)===r.t.mySite||o&&o.templateType===i.n.mySiteDocumentLibrary;return x.m(e,{isCustomList:(s||void 0===s&&Object(i.i)(d))&&!l,isPlaceholder:n.isPlaceholder})},t.prototype._getPlaceholderItemSet=function(){var e=new L.e,t=new k.e;return t.item=this.observables.create(e),t},t}(o.default);t.e=Z}],Array(37),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(462),i=n(72);function r(e){if(e.featureInfo){var t=new a.e(e.featureInfo);if(t){var n=t.get("SitePagePublishing");return!!n&&n.enabled}return!1}return Number(e.webTemplate)===i.t.sitePagePublishing}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return o});var a=n(8),i=n(142),r=n(3097);n.d(t,"e",function(){return r.e}),n.d(t,"t",function(){return r.a});var o=new a.t({name:"MoveCopyProvider.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e("deferred.odsp-common"),n.e(519)]).then(n.bind(null,4567)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";function a(e){var t;t={};for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o="".concat(r);t[o]||(t[o]=!0,n.push(r))}return n}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";var a=n(0),i=n(1203),r=n(971),o=function(e){function t(n){var a=e.call(this,n)||this;return a._clearFocusIsUserInput=function(){a.isDisposed||(a._focusIsUserInput=!1)},a._keyForItem=new Map,a._focusIsUserInput=!1,a.mode=n.mode||0,a.maximumSelectedCount=n.maximumSelectedCount,a.getItemKey=n.getItemKey,a._canSelectItem=n.canSelectItem||s,a._selectionModelGroup=n.selectionModelGroup,a._allSelectables={},a._items=[],a.selectedCount=a.createObservable(),a.selection=a.observables.createArray().extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),a.isAllSelected=a.createObservable(!1).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),a.focusedItem=a.createObservable(),a.focusedItem.equalityComparer=r.n,a.isActive=a.createObservable(!0),a.clear(!0),a._clearFocusIsUserInput=a.async.throttle(a._clearFocusIsUserInput,0,{trailing:!0}),a._selectionModelId="".concat(++t._nextSelectionModelId),a._selectionModelGroup&&a._selectionModelGroup.registerSelectionModel(a,a._selectionModelId),a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"getItemKey",{get:function(){return this._getItemKey},set:function(e){var t=this._keyForItem;t.clear(),this._getItemKey=function(n){var a=t.get(n);return a||(a=e(n),t.set(n,a)),a}},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._selectionModelGroup&&this._selectionModelGroup.unregisterSelectionModel(this._selectionModelId),this._allSelectables={},this._keyForItem.clear()},t.prototype.clear=function(e){this.isSelectedDefaultState=!1,this._keysExempt={},this._exemptCount=0,e&&(this._focusIndex=-1,this._anchorIndex=-1,this._anchorKey=null,this._focusIsUserInput=!1,this.focusedItem(null)),this.selection.removeAll(),this.isAllSelected(!1),this._updateAllSelectables(),this._updateSelectedCount()},t.prototype.setItems=function(e,t){this._items=e,this._selectableItems=this._items,t&&this.clear(!0),this._onItemsChanged(!0)},t.prototype.setAllFocusableItems=function(e){this._items=e,this._focusIndex=-1,this._onItemsChanged(!1)},t.prototype.getItems=function(){return this._items},t.prototype.canSelectItem=function(e){var t=this.getItemKey(e);return(!this.maximumSelectedCount||this.selectedCount()<this.maximumSelectedCount||this.isItemSelected(e))&&t&&this._selectableItemsMap[t]&&this._canSelectItem(e)},t.prototype.isItemSelected=function(e){var t=this.getItemKey(e),n=!!this._keysExempt[t];return this._canSelectItem(e)&&(this.isSelectedDefaultState&&!n||!this.isSelectedDefaultState&&n)},t.prototype.setSelectedKeys=function(e){var t=[];this._keysExempt={};for(var n=0,a=e;n<a.length;n++){var i=a[n],r=this._keyToIndex[i];if(r>=0){var o=this._items[r];this.canSelectItem(o)&&(this._keysExempt[i]=o,t.push(o))}}this._exemptCount=t.length,this.isSelectedDefaultState=!1,this.selection(t),this._updateIsAllSelected(),this._updateSelectedCount(),this._updateAllSelectables(),this._selectionModelGroup&&t.length&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)},t.prototype.isKeySelected=function(e){var t=!!this._keysExempt[e];return!!(this.selectedCount.peek()>0&&this.isAllSelected.peek()&&!t||!this.isAllSelected.peek()&&t)},t.prototype.getFocusedKey=function(){var e=this.focusedItem.peek();return e?this.getItemKey(e):null},t.prototype.isIndexSelected=function(e){var t=this._items[e];return this.isItemSelected(t)},t.prototype.setItemSelected=function(e,t){this._setItemSelectedCore(e,t,!0)},t.prototype.setIndexSelected=function(e,t){this.setItemSelected(this._items[e],t)},t.prototype.toggleItemSelected=function(e){this.setItemSelected(e,!this.isItemSelected(e))},t.prototype.toggleIndexSelected=function(e){this.toggleItemSelected(this._items[e])},t.prototype.setItemFocus=function(e,t){void 0===t&&(t={});var n=t.preventAnchor,a=void 0!==n&&n,i=t.isFocusInput,r=void 0===i||i,o=this.focusedItem.peek(),s=this.getItemKey(e),c=this._keyToIndex[s];if(this._focusIsUserInput=r,e!==o){var d=this.getItemKey(o);this._updateSelectable(d,{focusState:0,isFocused:!1})}c>=0?(d=this.getItemKey(e),this._focusIndex=c,this.focusedItem(e||null),d&&this._updateSelectable(d,{focusState:r?2:1,isFocused:!0})):this.focusedItem(null),a||(this._anchorIndex=c||-1,this._anchorKey=s),this._clearFocusIsUserInput()},t.prototype.setIndexFocus=function(e,t){void 0===t&&(t={}),this.setItemFocus(this._items[e],t)},t.prototype.invokeFocusedItem=function(e){var t=this.focusedItem.peek(),n=this.getItemKey(t),a=this._allSelectables[n];if(a&&a.length)for(var i=0;i<a.length;i++){var r=a[i];if(r.onInvoke)return r.onInvoke(e)}return!0},t.prototype.setIsActive=function(e){this.isActive(e)},t.prototype.selectToItem=function(e){if(1===this.mode)this.setItemSelected(e,!0);else{var t=this._items,n=this.getItemKey(e);if(n){var a=this._keyToIndex[n],i=Math.min(t.length-1,Math.max(0,this._anchorIndex)),r=Math.max(a,i),o=[];if(t.length&&r>=0)for(var s=Math.min(a,i);s<=r;s++)o.push(t[s]);this._setItemsSelected(o,!0)}}},t.prototype.selectToIndex=function(e){this.selectToItem(this._items[e])},t.prototype.selectAll=function(){if(!(this.maximumSelectedCount&&this.maximumSelectedCount<this._selectableItems.length)&&0===this.mode){this.isSelectedDefaultState=!0;for(var e=[],t=0,n=this._selectableItems;t<n.length;t++){var a=n[t];this._canSelectItem(a)&&e.push(a)}this.selection(e),this._keysExempt={},this._exemptCount=0,this._updateIsAllSelected(),this._updateAllSelectables(),this._updateSelectedCount(),this._selectionModelGroup&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}},t.prototype.toggleSelectAll=function(){this.isAllSelected.peek()||this.maximumSelectedCount<this._selectableItems.length&&this.selectedCount.peek()||1===this.mode&&this.selectedCount.peek()>0?this.clear():this.selectAll()},t.prototype.registerSelectable=function(e,t){var n,a=this;if(!e)throw new Error("Need to specify key or targetItem to register the selectable.");n="string"==typeof e?e:this.getItemKey(e),this._allSelectables[n]||(this._allSelectables[n]=[]),this._allSelectables[n].push(t);var i=this._items[this._keyToIndex[n]],r=this.focusedItem.peek()===i,o=r?this._focusIsUserInput?2:1:0,s=this.isItemSelected(i);return this._updateSelectable(n,{focusState:o,isFocused:r,isSelected:s}),{dispose:function(){if(a._allSelectables&&a._allSelectables[n]){var e=a._allSelectables[n];if(1===e.length)delete a._allSelectables[n];else{var i=e.indexOf(t);i>=0&&e.splice(i,1)}}}}},t.prototype.getFocusIndex=function(){return this._focusIndex},t.prototype.getMissingIndicies=function(){for(var e=[],t=this._items,n=0;t&&n<t.length;n++){var a=t[n];this.isItemSelected(a)&&!this.getItemKey(a)&&e.push(n)}return e},t.prototype.getSelectionModelGroup=function(){return this._selectionModelGroup},t.prototype.getItemByKey=function(e){var t=e?this._keyToIndex[e]:-1;return this.getItemByIndex(t)},t.prototype.getItemByIndex=function(e){return e>=0?this._items[e]:null},t.prototype._setItemSelectedCore=function(e,t,n){var a=this,i=this.getItemKey(e);if(i&&i in this._keyToIndex&&t!==this.isItemSelected(e)){if(t&&!this.observables.ignore(function(){return a.canSelectItem(e)}))return;1===this.mode&&t&&this.clear(),this._keysExempt[i]?delete this._keysExempt[i]:this._keysExempt[i]=e;var r,o=this.selection.peek();r=t?o.concat([e]):o.filter(function(e){return a.getItemKey(e)!==i}),this.selection(r),this._updateSelectable(i,{isSelected:this.isItemSelected(e)}),this._exemptCount+=t?1:-1,this._updateIsAllSelected(),this._updateSelectedCount(),this._selectionModelGroup&&t&&n&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}},t.prototype._setItemsSelected=function(e,t){var n,a=this,i=this.selection.peek(),r=[],o=[];e.forEach(function(e){var n=a.getItemKey(e);n&&n in a._keyToIndex&&t!==a.isItemSelected(e)&&a.canSelectItem(e)&&(r.push(n),t&&o.push(e),a._keysExempt[n]?delete a._keysExempt[n]:a._keysExempt[n]=e)}),n=t?i.concat(o):i.filter(function(e){return-1===r.indexOf(a.getItemKey(e))}),this.selection(n),r.forEach(function(e){a._updateSelectable(e,{isSelected:t}),a._exemptCount+=t?1:-1}),this._updateIsAllSelected(),this._updateSelectedCount(),this._selectionModelGroup&&t&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)},t.prototype._updateIsAllSelected=function(){if(!this._selectableItems||!this._selectableItems.length)return!1;var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount,t=0===this.mode?e===this._selectableItems.length:e>0;this.isAllSelected(t)},t.prototype._updateSelectable=function(e,t){var n=this._allSelectables[e];if(n)for(var a=0,i=n;a<i.length;a++){var r=i[a];for(var o in t){var s=t[o],c=r[o];this.isObservable(c)&&c(s)}}},t.prototype._updateAllSelectables=function(){var e=this;this.observables.ignore(function(){for(var t in e._allSelectables){var n=e._items[e._keyToIndex[t]];n&&e._canSelectItem(n)&&e._updateSelectable(t,{isSelected:e.isItemSelected(n)})}})},t.prototype._onItemsChanged=function(e){var t=this;this._keyToIndex={},this._keyForItem.clear(),e&&(this._selectableItemsMap={});var n=this._items,a=[],i=this.getItemKey(this.focusedItem.peek()),r=this._anchorKey;if(n){for(var o=0,s=function(s){var d=n[s],l=c.observables.ignore(function(){return t.getItemKey(d)});if(l&&(c._keyToIndex[l]=s,e&&(c._selectableItemsMap[l]=!0),i&&i===l&&(c._focusIndex=s),r&&r===l&&(c._anchorIndex=s)),c.isItemSelected(d)){if(c.onAddItem&&!1===c.onAddItem(d))return o++,c._keysExempt[l]=d,"continue";a.push(d)}},c=this,d=0;d<n.length;d++)s(d);this._exemptCount+=o,this._focusIndex=n.length?Math.min(n.length-1,this._focusIndex):-1,this.setIndexFocus(this._focusIndex,{preventAnchor:!0,isFocusInput:!1}),this.selection(a),this._updateIsAllSelected(),this._updateSelectedCount()}},t.prototype._updateSelectedCount=function(){var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount;this.selectedCount(e)},t._nextSelectionModelId=1,t}(i.default);function s(e){return!0}t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(142),i=function(){function e(e,t){this._itemRefreshMessages={},this._itemKeysRefreshed=[]}return e.prototype.getItemRefreshMessage=function(e){return this._itemRefreshMessages?this._itemRefreshMessages[e]:null},e.prototype.setRefreshMessages=function(e){this.clearRefreshMessages();for(var t=0,n=e;t<n.length;t++){var a=n[t];this._itemRefreshMessages[a.id]=a}},e.prototype.clearRefreshMessages=function(){this._itemRefreshMessages={}},e.prototype.hasItemRefreshedRecently=function(e){return-1!==this._itemKeysRefreshed.indexOf(e)},e.prototype.markRecentlyRefreshedItem=function(e){this._itemKeysRefreshed.push(e)},e.prototype.clearRecentlyRefreshedItems=function(){this._itemKeysRefreshed=[]},e.dependencies={},e}(),r=Object(a.r)("RefreshMessageHelper",i)},function(e,t,n){"use strict";var a=n(910);n.d(t,"e",function(){return a.t}),n.d(t,"t",function(){return a.n})},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(8),i=new a.t({name:"".concat("MalwareDetection.key",".allowInfectedFileDownloads"),factory:new a.e(!1)})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(8),i=new a.t({name:"".concat("BlockDownloadPolicy.key",".m365GroupsBlockDownloadsExperienceEnabled"),factory:new a.e(!1)})},function(e,t,n){"use strict";n.d(t,"e",function(){return w});var a=n(158),i=n(7),r=n(38),o=n(101),s=n(2274),c=n(4212),d=n(40),l=n(197),u=n(253),f=n(3164),p=n(14),m=n(1334),_=n(148),h=n(1422),b=n(846),g=n(489),v=n(8),y=n(142),S=n(1421),D=n(11),I=n(4811),x=D.e.isActivated("1E9F2B0E-270E-4F40-9918-01DD9B46C5F0","7/2/2021","Use the page context from the list response for Web data"),C=!1,O=function(){function e(e,t){this._urlDataSource=t.urlDataSource,this._pageContext=t.pageContext,this._itemUrlHelper=t.itemUrlHelper,this._vroomUrlHelper=t.vroomUrlHelper}return e.prototype.processResponse=function(e){var t=e.response,n=e.response,a=n.WebUrl,i=n.HttpRoot,r=n.ListData,o=n.rootFolder,s=n.ListSchema,d=(void 0===s?{}:s).Collapse,l=void 0===d?"FALSE":d,u=e.pageContext,p=e.requestKey,m=e.observer,_=this._urlDataSource.getKeyParams(p),h="TRUE"===l,b=this._itemUrlHelper.getItemUrlParts(p),g=this._itemUrlHelper.getUrlParts({path:b.serverRelativeListUrl,listUrl:b.fullListUrl});(a||i)&&this._processWeb({list:t,pageContext:u,requestKeyParts:_,observer:m});var v=this._processList({list:t,pageContext:u,listUrlParts:g,requestKeyParts:_,observer:m}).listRootItemKey,y=[];if(o){var S=this._processRootFolder({list:t,listUrlParts:g,requestKeyParts:_,observer:m});y.push.apply(y,S.parentItemUrls)}r&&!h&&(S=this._processListData({listData:r,listUrlParts:g,parentKey:p,requestKeyParts:_,observer:m}),y.push.apply(y,S.parentItemUrls));var D={};if(t.ParentInfo)for(var I=0,x=t.ParentInfo.ParentFolderInfo;I<x.length;I++){var C=x[I];D[C.ServerRelativeUrl]=f.t.fromHexString(C.Permissions)}for(var O=0,w=Object(c.e)(y);O<w.length;O++){var E=w[O];this._processParentItem({itemUrl:E,listUrlParts:g,parentInfo:D,requestKeyParts:_,observer:m})}return{listRootItemKey:v}},e.prototype._processListData=function(e){for(var t=e.listData.Row,n=e.parentKey,a=e.requestKeyParts,i=e.listUrlParts,r=e.observer,o=[],c="",d=0,l=t;d<l.length;d++){var u=l[d],f=u.FileRef,p=this._processRow({row:u,observer:r,requestKeyParts:a,listUrlParts:i}).key;o.push.apply(o,this._getParentItemUrls({listUrlParts:i,itemUrl:f})),r.update([new s.e(p).succeed({set:{parent:{key:n},after:{key:c}}})]),c=p}return{parentItemUrls:o}},e.prototype._processRow=function(e){var t,n,a,o=e.row,c=e.row.FileRef,d=e.listUrlParts,u=e.requestKeyParts,f=e.observer,p=this._itemUrlHelper.getUrlParts({path:c,listUrl:d.fullListUrl});if((t={})[i.n.idParamKey]=p.serverRelativeItemUrl,t[i.n.listUrlKey]=p.normalizedListUrl,a=t,this._isFolder(o)){var m={},_=this._urlDataSource.getQueryType(u),h=u[i.n.typeFiltersKey];_!==r.e.Search&&(m[i.n.queryTypeParamKey]=u[i.n.queryTypeParamKey]),h&&(m[i.n.typeFiltersKey]=h),l.e(a,m),u[i.n.metadataSearchIdKey]&&l.e(a,((n={})[i.n.metadataSearchIdKey]=u[i.n.metadataSearchIdKey],n))}var b=this._urlDataSource.getKey(a),g=this._getParentKeyForListItem({listUrlParts:d,itemUrl:c,requestKeyParts:u}),v={key:b};return g&&(v.parentKey=g),f.update([new s.e(b).succeed({item:v})]),{key:b}},e.prototype._processRootFolder=function(e){var t,n,a,r=e.list,o=e.listUrlParts,c=e.requestKeyParts,d=e.observer,l=r.rootFolder,f=this._itemUrlHelper.getUrlParts({path:l,listUrl:o.fullListUrl}),p=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=f.serverRelativeItemUrl,t[i.n.listUrlKey]=f.normalizedListUrl,t[i.n.queryTypeParamKey]=c[i.n.queryTypeParamKey],t[i.n.queryParamKey]=c[i.n.queryParamKey],t[i.n.typeFiltersKey]=c[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=c[i.n.metadataSearchIdKey],t)),_=this._getParentKeyForListItem({listUrlParts:o,itemUrl:l,requestKeyParts:c}),h={key:p,type:u.e.Folder,newWOPIDocumentEnabled:m.optional(r.NewWOPIDocumentEnabled)};if(_&&(h.parentKey=_),r.ListData){if(n=r.ListData.FolderId,"Sharepoint.DocumentSet"===r.ListData.CurrentFolderProgId&&(h.isDocSet=!0,r.AvailableContentTypes))for(var b=0,g=r.AvailableContentTypes;b<g.length;b++){var v=g[b],y=v.contentTypeId;if(y&&0===y.indexOf("0x0120D520")){h.contentTypeId=y,a=v.displayName;break}}if(r.ListData.CurrentFolderSpItemUrl){var S=this._vroomUrlHelper.getUrlParts(r.ListData.CurrentFolderSpItemUrl);h.itemId=m.optional(S.itemId),h.graph={itemId:m.optional(S.itemId),driveId:m.optional(S.driveId)}}}if(a&&h.contentTypeId?h.properties={ID:m.optional(n),ContentType:a,ContentTypeId:h.contentTypeId}:h.properties={ID:m.optional(n)},!this._isListRoot({itemUrl:l,listUrlParts:o})){var D=l.split("/").slice(-1)[0];h.name=D,h.displayName=D}return d.update([new s.e(p).succeed({item:h})]),{parentItemUrls:this._getParentItemUrls({listUrlParts:o,itemUrl:l})}},e.prototype._processWeb=function(e){var t,n=e.list,a=e.requestKeyParts,o=e.observer,c=n.HttpRoot,d=n.SiteTitle,l=n.WebUrl||c&&b.i(decodeURIComponent(c)),f=this._itemUrlHelper.getUrlParts({path:l,webUrl:l}),p=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=f.normalizedItemUrl,t[i.n.queryTypeParamKey]=r.e.DocumentLibraries,t[i.n.typeFiltersKey]=a[i.n.typeFiltersKey],t)),m={serverRelativeUrl:l},_={key:p,type:u.e.Folder,subsite:m},h=!x&&e.pageContext||this._pageContext.webAbsoluteUrl===l&&this._pageContext;h&&(_.name=d,_.displayName=d,m.webTemplateId=Number(h.webTemplate),m.serverRelativeUrl=h.webAbsoluteUrl,m.id=h.webId,m.siteCollectionId=h.siteId,m.title=h.webTitle,m.icon=h.webLogoUrl),o.update([new s.e(p).succeed({item:_})])},e.prototype._processList=function(e){var t,n,o,c,d,l,f=e.list,_=e.listUrlParts,h=e.requestKeyParts,v=e.observer,y=f.ListTitle,D=f.HttpRoot,I=f.ListUrl,O=f.listUrlDir,w=I||O&&decodeURIComponent(O),E=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=_.serverRelativeItemUrl,t[i.n.listUrlKey]=_.normalizedListUrl,t[i.n.queryTypeParamKey]=h[i.n.queryTypeParamKey],t[i.n.queryParamKey]=h[i.n.queryParamKey],t[i.n.typeFiltersKey]=h[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=h[i.n.metadataSearchIdKey],t)),A=f.AllowCreateFolder,L=f.EnableMinorVersions,k=f.verEnabled,M=f.AllowGridMode,P=f.DisableGridEditing,T=f.ListTemplateType,U=f.BasePermissions,F=void 0===U?{}:U,H=F.ManageLists,R=void 0===H?void 0:H,N=F.ManagePersonalViews,B=void 0===N?void 0:N,j=F.OpenItems,V=void 0===j?void 0:j,z=F.UseClientIntegration,G=void 0===z?void 0:z,K=f.ListSchema,W=void 0===K?{}:K,q=W.DefaultItemOpen,Q=void 0===q?void 0:q,Y=W[".driveAccessTokenV21"],J=void 0===Y?void 0:Y,X=W[".driveAccessToken"],Z=void 0===X?void 0:X,$=W[".driveUrl"],ee=void 0===$?void 0:$,te=W[".driveUrlV21"],ne=void 0===te?void 0:te,ae=f.ExcludeFromOfflineClient,ie=f.WebExcludeFromOfflineClient,re=f.listBaseType,oe=Z,se=J,ce=ee,de=ne,le=!x&&e.pageContext||w===this._pageContext.listUrl&&this._pageContext,ue=null==le?void 0:le.driveInfo;f.isFromServiceWorkerCache&&ue&&(ue[".driveAccessToken"]&&(oe=ue[".driveAccessToken"]),ue[".driveAccessTokenV21"]&&(se=ue[".driveAccessTokenV21"]),ue[".driveUrl"]&&(ce=ue[".driveUrl"]),ue[".driveUrlV21"]&&(de=ue[".driveUrlV21"])),oe&&(o={accessToken:(d=Object(g.e)(oe)).access_token,proofToken:d.prooftoken,tokenUrl:ce}),se&&(c={accessToken:(d=Object(g.e)(se)).access_token,proofToken:d.prooftoken,tokenUrl:de});var fe=f.WebUrl||D&&b.i(decodeURIComponent(D));if(fe){var pe=this._itemUrlHelper.getUrlParts({path:fe,webUrl:fe});l=this._urlDataSource.getKey(((n={})[i.n.idParamKey]=pe.normalizedItemUrl,n[i.n.queryTypeParamKey]=r.e.DocumentLibraries,n[i.n.typeFiltersKey]=h[i.n.typeFiltersKey],n))}var me="string"==typeof Q?"0"===Q:void 0;me&&(C||(a.e.logData({name:"List.openInClient"}),C=!0));var _e=ce&&this._vroomUrlHelper.getUrlParts(ce)||void 0;o&&Object(S.e)({authToken:o.accessToken,proofToken:o.proofToken})&&(o=void 0),c&&Object(S.e)({authToken:c.accessToken,proofToken:c.proofToken})&&(c=void 0);var he="number"==typeof re?Object(p.a)(String(re)):void 0;return v.update([new s.e(E).succeed({item:{key:E,parentKey:m.optional(l),itemId:m.backup("root"),graph:{itemId:m.backup("root"),driveId:m.optional((null==_e?void 0:_e.driveId)||void 0),sessionToken:m.optional(o),sessionTokenV21:m.optional(c)},type:u.e.Folder,name:m.optional(y),displayName:m.optional(y),isRootFolder:!0,isDropEnabled:!0,folder:{},newWOPIDocumentEnabled:m.optional(f.rootFolder?void 0:f.NewWOPIDocumentEnabled),list:{id:m.optional(f.listName),allowGridMode:"boolean"==typeof M?M:m.backup(!0),allowCreateFolder:m.optional(A),disableCommenting:"boolean"==typeof f.DisableCommenting&&f.DisableCommenting,disableGridEditing:"boolean"==typeof P?P:m.backup(!1),enableMinorVersions:m.optional(L),enableVersions:m.optional(k),templateType:m.optional("string"==typeof T?Number(T):void 0),isDocumentLibrary:m.optional(he),isPromotedLinks:m.optional("string"==typeof T?Object(p.o)(T):void 0),isForceCheckout:m.optional(f.isForceCheckout),isModerated:m.optional(f.isModerated),newWOPIDocumentEnabled:m.optional(f.NewWOPIDocumentEnabled),newWOPIDocumentTypes:m.optional(f.NewWOPIDocumentTypes),permissions:{manageLists:m.optional(R),managePersonalViews:m.optional(B),openItems:m.optional(V),useClientIntegration:m.optional(G)},openInClient:m.optional(me),excludeFromOfflineClient:m.optional("boolean"==typeof ae||"boolean"==typeof ie?ae||ie:void 0),contentTypesEnabled:m.optional(f.ContentTypesEnabled),metadataNavFeatureEnabled:m.optional(f.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:m.optional(f.canUserCreateMicrosoftForm),itemCount:m.optional(f.ListSchema&&f.ListSchema.ItemCount),rowLimit:m.optional(f.ListData.RowLimit),listUrlDir:w,createdFromExcel:m.optional(f.CreatedFromExcel),createdFromExisting:m.optional(f.CreatedFromExisting)},properties:{commandsSupported:m.optional(f.CanShareLinkForNewDocument&&{canShareLinkForNewDocument:"1"})}}})]),{listRootItemKey:E}},e.prototype._processParentItem=function(e){var t,n=e.itemUrl,a=e.listUrlParts,r=e.parentInfo,o=e.requestKeyParts,c=e.observer,d=this._itemUrlHelper.getUrlParts({path:n,listUrl:a.fullListUrl}),l=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=d.serverRelativeItemUrl,t[i.n.listUrlKey]=d.normalizedListUrl,t[i.n.queryTypeParamKey]=o[i.n.queryTypeParamKey],t[i.n.queryParamKey]=o[i.n.queryParamKey],t[i.n.typeFiltersKey]=o[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=o[i.n.metadataSearchIdKey],t)),f={key:l,parentKey:this._getParentKeyForListItem({listUrlParts:a,itemUrl:n,requestKeyParts:o}),queryType:this._urlDataSource.getQueryType(o)};if(this._isListRoot({itemUrl:n,listUrlParts:a}))f.list={};else{var p=b.a(n);f.name=p,f.displayName=p,f.type=u.e.Folder,f.isDropEnabled=!0,f.folder={},r&&r[n]&&(f.permissions=r[n])}c.update([new s.e(l).succeed({item:f})])},e.prototype._getParentKeyForListItem=function(e){var t,n,a=e.listUrlParts,r=e.itemUrl,o=e.requestKeyParts;if(a.serverRelativeListUrl!==r){if(!D.e.isActivated("556c889b-eaaf-4e07-a746-6f7c7eee8553","8/18/2021","Show a more user-friendly error when the item does not have a FileRef field")&&!r)throw new Error(I.e);var s=r.split("/").slice(0,-1).join("/"),c=this._itemUrlHelper.getUrlParts({path:s,listUrl:a.fullListUrl});n=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=c.serverRelativeItemUrl,t[i.n.listUrlKey]=c.normalizedListUrl,t[i.n.queryTypeParamKey]=o[i.n.queryTypeParamKey],t[i.n.queryParamKey]=o[i.n.queryParamKey],t[i.n.typeFiltersKey]=o[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=o[i.n.metadataSearchIdKey],t))}return n},e.prototype._getParentItemUrls=function(e){var t=e.listUrlParts,n=e.itemUrl,a=[],i=t.serverRelativeListUrl;if(0===n.indexOf(i))for(var r="",o=0,s=n.substring(i.length).split("/").slice(1,-1);o<s.length;o++){var c=s[o];r+="/".concat(c);var d="".concat(i).concat(r);a.push(d)}return a},e.prototype._isListRoot=function(e){var t=e.itemUrl;return e.listUrlParts.serverRelativeListUrl===t},e.prototype._isFolder=function(e){var t;if("1"===e.FSObjType){var n=e["File_x0020_Type.mapapp"],a=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];t=!(n&&"onenote"===n.substring(0,7)||a&&-1!==a.indexOf("onenote"))}else t=!1;return t},e.dependencies={urlDataSource:o.ue,pageContext:d.f,itemUrlHelper:_.c,vroomUrlHelper:h.e,resources:v.r},e}(),w=Object(y.r)("ListItemResultProcessor",O)},,function(e,t,n){"use strict";var a=n(4817);t.e=a.e},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n("knockout-lib"),r=n(1203),o=n(142),s=function(e){function t(t,n){var a=e.call(this,t,n)||this,r=a._controls=a.observables.createArray([]),o=document.createElement("div");o.style.display="none";var s=document.createElement("div");return s.setAttribute("data-bind","component: $data"),document.body.appendChild(o),i.applyBindingsToNode(o,{template:{nodes:[s],foreach:r}}),a}return Object(a.__extends)(t,e),t.prototype.requestControl=function(e){var t={name:e.name,params:Object(a.__assign)({resources:this.resources},e.params)};return this._controls.push(t),t},t.prototype.disposeControl=function(e){var t=this._controls,n=t.indexOf(e);t.splice(n,1)},t}(r.default),c=Object(o.r)("HiddenDomProvider",s)},function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(8),i=new a.t({name:"".concat("ListItemsDataSourceParams.key",".useFolderScopedSearch"),factory:new a.e(!0)}),r=new a.t({name:"".concat("ListItemsDataSourceParams.key",".listShouldRenderFilesTitle"),factory:new a.e(void 0)})},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(0),i=n(1203),r=n(54),o=n(142),s=n(590),c=n(148),d=n(1340),l=n(7),u=n(311),f=n(2192),p=n(5571),m=n(3858),_=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._apiUrlHelper=n.apiUrlHelper,a._dataRequestor=a.scope.attach(new n.dataRequestorType({qosName:"PolicyTipDataSource"})),a._itemParentHelper=n.itemParentHelper,a._itemUrlHelper=n.itemUrlHelper,a._viewParams=n.viewParams,a._sharingContextInformation=n.sharingContextInformation,a}return Object(a.__extends)(t,e),t.prototype.getExternalSharingStatus=function(){return this._isPseudo()?r.n.wrap({isExternalSharingTipEnabled:!0,externalSharingTipsLearnMoreUrl:"http://bing.com"}):this._dataRequestor.getData({url:this._apiUrlHelper.build().segments("web","DataLeakagePreventionStatusInfo").toString(),qosName:"GetExternalSharingStatus"}).then(function(e){var t=e&&e.d;return t?{isExternalSharingTipEnabled:t.ExternalSharingTipsEnabled,externalSharingTipsLearnMoreUrl:t.ExternalSharingTipsLearnMoreUrl}:null})},t.prototype.getPolicyTip=function(e){if(this._isPseudo())return r.n.wrap({issueDescriptions:["Item contains the following sensitive information: U.S. Social Security Number (SSN)","Item is shared with people outside your organization","Item contains sensitive document properties"],overrideOption:p.n.allowWithJustification,lastScanned:new Date,policyInfoUrl:"http://bing.com",explanationText:"This item conflicts with a policy in your organization. Access to this item is blocked for everyone except its owner, last modifier, and the site owner."});if(!this._sharingContextInformation&&!e)return r.n.wrap(null);var t=this._getApiRoot(e).segment("getdlppolicytip");return this._dataRequestor.getData({url:t.toString(),qosName:"GetPolicyTip"}).then(function(e){var t=e&&e.d;if(!t||null===t.GetDlpPolicyTip)return r.n.wrap(null);var n=t.MatchedConditionDescriptions,a=t.OverrideOptions,i=void 0===a?p.n.none:a,o=t.GeneralText,s=t.AppliedActionsText,c=Date.parse(t.LastProcessedTime);return{issueDescriptions:n&&n.results,overrideOption:Number(i),policyInfoUrl:t.ComplianceUrl,explanationText:o&&s?"".concat(o," ").concat(s):o||s||"",lastScanned:isNaN(c)?void 0:new Date(c)}})},t.prototype.updatePolicy=function(e){if(this._isPseudo())return r.n.wrap(e.action===p.e.override?p.t.overridden:e.action===p.e.reportFalsePositive?p.t.falsePositiveReportedAndOverridden:p.t.none);var t=this._getApiRoot(e.item).segment("overridepolicytip");return this._dataRequestor.getData({url:t.toString(),additionalPostData:JSON.stringify({userAction:e.action,justification:e.justification}),method:"POST",qosName:"UpdatePolicyTip"}).then(function(e){var t=e&&e.d,n=t&&t.OverridePolicyTip;return"number"==typeof n?n:null})},t.prototype._getApiRoot=function(e){var t;if(this._sharingContextInformation)if(this._sharingContextInformation.uniqueId){var n=this._sharingContextInformation.isFolder?"GetFolderById":"GetFileById",a={guid:this._sharingContextInformation.uniqueId};t=this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method(n,a).segment("ListItemAllFields")}else t=this._sharingContextInformation.listUrl?this._apiUrlHelper.build().webByUrl({listUrl:this._sharingContextInformation.listUrl}).method("GetListItem",this._sharingContextInformation.serverRelativeItemUrl):this._sharingContextInformation.itemUrl?this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetFileByUrl",this._sharingContextInformation.itemUrl).segment("ListItemAllFields"):this._sharingContextInformation.listId&&this._sharingContextInformation.listItemId?this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("Lists",this._sharingContextInformation.listId).method("GetItemById",this._sharingContextInformation.listItemId):this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetListItemByResourceId",this._sharingContextInformation.resourceId);else{var i=this._itemUrlHelper.getItemUrlParts(e.key),r=this._getParentListId(e);t=this._apiUrlHelper.build().webByItemUrl(i).method("Lists",r).method("GetItemById",e.properties.ID)}return t},t.prototype._getParentListId=function(e){var t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return t?t.list.id:e&&e.properties&&e.properties.listId},t.prototype._isPseudo=function(){return"1"===this._viewParams.peek()[l.n.pseudoPolicyTipKey]},t}(i.default),h=Object(o.r)("PolicyTipDataSource",_,{apiUrlHelper:s.e,dataRequestorType:d.t,itemParentHelper:f.e,itemUrlHelper:c.c,viewParams:u.P,sharingContextInformation:m.e.optional})},function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"DataManagerDeferred.key",loader:new i.t(function(){return n.e(507).then(n.bind(null,3698)).then(function(e){return e.typeResourceKey.local})})});t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"ItemsScopeItemContent.key",loader:new i.t(function(){return Promise.all([n.e("odsp.react.lib"),n.e(372)]).then(n.bind(null,5463)).then(function(e){return e.knockoutResourceKey.local})})})},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"PushChannelProvider.key",loader:new i.t(function(){return n.e(609).then(n.bind(null,4671)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("RootItemsTypeFilter.key")},function(e,t,n){"use strict";function a(e){return!!e.canUserUseSyntex}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("searchUpscopeProvider")},function(e,t,n){"use strict";n.r(t),n.d(t,"ItemsScopeItemSelectionHelper",function(){return D}),n.d(t,"typeResourceKey",function(){return I});var a=n(0),i=n(54),r=n(1203),o=n(142),s=n(2477),c=n(390),d=n(840),l=n(133),u=n(107),f=n(2839),p=n(431),m=n(5),_=n(2693),h=n(539),b=n(118),g=n(101),v=n(15),y=n(3850),S=n(763),D=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=t.allowMultiSelect,r=void 0!==i&&i,o=t.canFallback,s=void 0!==o&&o,c=t.overrideItem,d=t.ignoreSelection,p=void 0!==d&&d,h=n.itemsScopeItemKey,b=n.itemCacheObservablesFactory,g=n.itemCacheStore,v=n.urlDataSource,y=n.itemCacheEvaluationContext;return a._itemCacheStore=g,a._itemsScopeItemKey=h,a._placeholder=a.observables.create(new _.e),a._urlDataSource=v,a._itemCacheEvaluationContext=y,a._currentKnockoutStoreItem=a.scope.attach(b.pureCompute(function(e){var t=Object(u.e)(e,{itemsScopeItemKey:h});return e.demandItemFacet(m.f,t),e.demandItemFacet(f.t,t)||a._placeholder},{evaluationContext:a._itemCacheEvaluationContext})),a.currentItem=a.observables.pureCompute(function(){var e=a._currentKnockoutStoreItem();return e&&e()}),a._selectedKnockoutStoreItems=a.scope.attach(b.pureCompute(function(e){return c?[[void 0,c]]:function(e,t){void 0===t&&(t={});var n=t.itemsScopeItemKey,a=t.allowMultiSelect,i=void 0!==a&&a,r=t.ignoreSelection,o=void 0!==r&&r,s=t.canFallback,c=void 0!==s&&s,d=Object(l.e)(e,{itemsScopeItemKey:n}),p=Object(u.e)(e,{itemsScopeItemKey:n}),m=d&&d.length>0;if(!i&&d&&d.length>1)return[];for(var _=[],h=0,b=m&&!o||!c?d||[]:p?[p]:[];h<b.length;h++){var g=b[h],v=e.demandItemFacet(f.t,g);v&&_.push([g,v])}return _}(e,{itemsScopeItemKey:h,allowMultiSelect:r,canFallback:s,ignoreSelection:p})},{evaluationContext:a._itemCacheEvaluationContext})),a.selection=a.observables.pureCompute(function(){return a._selectedKnockoutStoreItems().map(function(e){return e[1]})}),a.firstItem=a.observables.pureCompute(function(){var e=a._selectedKnockoutStoreItems()[0],t=(void 0===e?[]:e)[1],n=void 0===t?void 0:t;return n&&n()}),a}return Object(a.__extends)(t,e),t.prototype.filterItems=function(e){var t=this._selectedKnockoutStoreItems(),n=this.observables;if(!t.length)return!1;for(var a=0,i=t;a<i.length;a++){var r=i[a][1],o=n.unwrap(r);if(!o)return!0;if(!e(o))return!1}return!0},t.prototype.resolveSelection=function(){return Object(a.__awaiter)(this,void 0,i.n,function(){var e,t;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e=this._selectedKnockoutStoreItems.peek(),[4,n.e(781).then(n.bind(null,3240))];case 1:return t=a.sent().oneDriveItemFacet,[4,this._itemCacheStore.dispatch(Object(S.e)(function(n){for(var a=0,i=e;a<i.length;a++){var r=i[a][0];n.demandItemFacet(t,r)}}))];case 2:return a.sent(),[2,e.map(function(e){return e[1].peek()})]}})})},t.prototype.resolveFirst=function(){return Object(a.__awaiter)(this,void 0,i.n,function(){var e,t,i,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return(e=this._selectedKnockoutStoreItems.peek()[0])?(t=e[0],i=e[1],[4,n.e(781).then(n.bind(null,3240))]):[2,void 0];case 1:return r=a.sent().oneDriveItemFacet,[4,this._itemCacheStore.dispatch(Object(S.e)(function(e){e.demandItemFacet(r,t)}))];case 2:return a.sent(),[2,i.peek()]}})})},t.prototype.selectItems=function(e){var t=this._urlDataSource,n=this._itemsScopeItemKey;this._itemCacheStore.dispatch(function(a){var i=a(Object(b.e)(function(n){for(var a=n.demandItemFacet(h.e,v.c),i=[],r=0,o=e;r<o.length;r++){var s=o[r],c=h.e.evaluate(a)(n,{viewParams:t.getKeyParams(s.key)}).itemKey;c&&i.push(c)}return i}));a(Object(p.t)({itemsScopeItemKey:n,selectedItemKeys:i,currentSelectionKey:void 0}))})},t.prototype.clearSelection=function(){this._itemCacheStore.dispatch(Object(p.e)({itemsScopeItemKey:this._itemsScopeItemKey}))},t.prototype.selectAll=function(){},t}(r.default),I=Object(o.o)("ItemSelectionHelper",D,Object(a.__assign)(Object(a.__assign)({},r.default.dependencies),{itemCacheStore:d.e,itemCacheObservablesFactory:s.e,itemsScopeItemKey:c.e,urlDataSource:g.ue,itemCacheEvaluationContext:y.e.optional}))},function(e,t,n){"use strict";n.d(t,"t",function(){return L}),n.d(t,"e",function(){return k});var a=n(971),i=n(8),r=n(142),o=n(107),s=n(2477),c=n(390),d=n(2693),l=n(2995),u=n(2839),f=n(295),p=n(41),m=n(4234),_=n(4235),h=n(4455),b=n(3257),g=n(358),v=n(1203),y=n(296),S=n(539),D=n(15),I=n(101),x=n(133),C=n(1405),O=new i.t({name:"".concat("ItemCacheDataManager",".enableOneUpLensRouting"),factory:new i.e(!0)}),w=new d.e,E=[],A=function(){function e(e,t){var n=this;this._computeParentItemInner=function(e){var t=Object(o.e)(e,{itemsScopeItemKey:n._itemsScopeItemKey});return e.demandItemFacet(u.t,t)||n._emptyItem},this._computeParentItem=function(){var e=n._parentItemObservable,t=e&&e();return t&&t()},this._computeExpandedKeys=function(e){var t=Object(p.e)(e,n._itemsScopeItemKey),a=Object(_.t)(e,{itemSetKey:t});return Object(h.e)(e,{itemKeys:a})},this._computeItems=function(e){if(k(e,{itemsScopeItemKey:n._itemsScopeItemKey,urlDataSource:n._urlDataSource,enableOneUpLensRouting:n._enableOneUpLensRouting}))return E;var t=n.expandedChildKeys(),a=Object(x.e)(e,{itemsScopeItemKey:n._itemsScopeItemKey});return Object(m.n)(e,t,a)},this._computeCurrentItemSet=function(){var e=n._emptyItem,t=n._parentItemObservable(),a=new l.e;return a.item=t,a.isPlaceholder=t===e,a},this._computeOnItemSetContentChange=function(){var e=n.currentItemSet(),t=new b.e;t.items=n._itemsObservable(),e.content(t)},this._computeViewParams=function(e){return e.demandItemFacet(f.e,n._itemsScopeItemKey)};var i=t.itemsScopeItemKey,r=t.itemCacheObservablesFactory,s=t.urlDataSource,c=t.enableOneUpLensRouting,d=t.observablesFactoryType;this._itemsScopeItemKey=i,this._urlDataSource=s,this._enableOneUpLensRouting=c,this._scope=new g.e;var v=this._scope.attach(new d({owner:this}));this._parentItemObservable=this._scope.attach(r.pureCompute(this._computeParentItemInner)),this._parentItemObservable.equalityComparer=a.n;var y=v.pureCompute(this._computeParentItem);y.equalityComparer=a.n,this.currentItem=y,this.expandedChildKeys=this._scope.attach(r.pureCompute(this._computeExpandedKeys)),this.expandedChildKeys.equalityComparer=a.e,this._itemsObservable=this._scope.attach(r.pureCompute(this._computeItems)),this._itemsObservable.equalityComparer=a.e,this._emptyItem=v.create(w),this.currentItemSet=v.pureCompute(this._computeCurrentItemSet),v.compute(this._computeOnItemSetContentChange),(this.viewParams=this._scope.attach(r.pureCompute(this._computeViewParams))).equalityComparer=a.n}return e.prototype.dispose=function(){this._scope.dispose()},e.dependencies={itemsScopeItemKey:c.e,itemCacheObservablesFactory:s.e,observablesFactoryType:v.observablesFactoryTypeResourceKey,urlDataSource:I.ue,enableOneUpLensRouting:O},e}(),L=Object(r.r)("ItemCacheDataManager",A);function k(e,t){var n,a=t.itemsScopeItemKey,i=t.urlDataSource;if(t.enableOneUpLensRouting){var r=Object(C.e)(e,{itemsScopeItemKey:a});n=null==r?void 0:r.focusItemKey}else{var o=e.demandItemFacet(f.e,a),s=i.getFocusItemKey(o),c=s&&i.getKeyParams(s);if(!c)return;var d=e.demandItemFacet(S.e,D.c);n=S.e.evaluate(d)(e,{viewParams:c,isNavigation:!1}).itemKey}return n?Object(y.e)(e,{itemKey:n}):void 0}},function(e,t,n){"use strict";n.d(t,"n",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"t",function(){return u});var a=n(66),i=n(9),r=n(2839),o=n(499),s={suppressGetItems:!0};function c(e,t,n){return e.demandItemFacet(t,n,s)}function d(e,t,n){for(var s=new Set(n),d=[],l=0,u=t.length;l<u;l++){var f=t[l],p=c(e,i.a,f)||c(e,a.r,f),m=s.has(f);d[l]=p||!m?void 0:e.demandItemFacet(r.t,f)}return Object(o.t)(d)}function l(e,t){for(var n=[],s=0,d=t.length;s<d;s++){var l=t[s],u=c(e,i.a,l)||c(e,a.r,l);n[s]=u?void 0:e.demandItemFacet(r.t,l)}return Object(o.t)(n)}function u(e,t){var n=e.demandItemFacet(r.t,t.focusItemKey),s=t.itemKeys,d=t.fetchRadius,l=void 0===d?2:d;if(!n||!s.length)return o.e;for(var u=[],f=0,p=s.length;f<p;f++){var m=s[f];c(e,i.a,m)||c(e,a.r,m)?u[f]=void 0:u[f]=e.demandItemFacet(r.t,m)}var _=u.indexOf(n);if(_<0)return o.e;var h=Math.max(0,_-l),b=Math.min(_+l,u.length-1);for(f=h;f<=b;f++)u[f]||e.demandItemFacet(i.e,s[f]);return Object(o.t)(u)}},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return S});var a=n(0),i=n(590),r=n(2698),o=n(142),s=n(4853),c=n(8),d=n(2964),l=n(40),u=n(147),f=n(52),p=n(2372),m=n(90),_=n(1212),h=n(43),b=n(2777),g=n(16),v="Intelligent Document Content Types",y=function(e){function t(t,n){var a,i=this;return(i=e.call(this,n.pageContext)||this)._defaultListViewAsDefaultKSEnabled=g.e.isActivated("4db47ade-4d1b-4ca4-8a6d-1b92f9eda86a","07/21/2022","Pass ListViewAsDefault as default view option to model publication API"),i.extractFileName=function(e){var t=e.split("/");return t[t.length-1]},i._apiUrlHelper=n.apiUrlHelper,i._navigation=n.navigation,i._pageContext=n.pageContext,i._vroomDataRequestor=n.vroomDataRequestor,i._resources=n.resources,i._isRunModelFlatFileStructureSupportEnabled=Object(h.isFeatureEnabled)(h.RunModelFlatFileStructureSupport),i._shouldSupportFolderLevelClassificationWithCustomization=Object(h.isFeatureEnabled)(h.RunModelFolderClassificationSupportEnabled)&&Object(h.isFeatureEnabled)(h.RunModelCustomizationSupportEnabled),i._tokenProvider=null===(a=i._resources)||void 0===a?void 0:a.consume(b.e.optional),i}return Object(a.__extends)(t,e),t.prototype.getModelPublishInfo=function(e){var t="".concat(this._pageContext.webAbsoluteUrl,"/_api/machinelearning/publications/GetByModelUniqueIdAndPublicationType('").concat(e,"')");return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getModelPublishInfo",method:"GET",additionalHeaders:{accept:"application/json;odata=nometadata","OData-Version":"3.0",Scenario:"Syntex_ModelManagement"}})},t.prototype.unpromoteModel=function(e,t,n){var a={promotions:[{ModelUniqueId:e,TargetSiteUrl:n,TargetWebServerRelativeUrl:t}]},i="".concat(this._pageContext.webAbsoluteUrl,"/_api/machinelearning/publications/batchUnpromote"),r=JSON.stringify(a);return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"batchUnpromote",additionalPostData:r,method:"POST",additionalHeaders:{accept:"application/json;odata=nometadata","OData-Version":"3.0",Scenario:"Syntex_ModelManagement"}})},t.prototype.unpublishModel=function(e,t,n,a,i,r){var o={publications:[{ModelUniqueId:e,TargetSiteUrl:n,TargetWebServerRelativeUrl:t,TargetLibraryServerRelativeUrl:a}],modelSiteUrl:i,modelWebServerRelativeUrl:r},s="".concat(this._pageContext.webAbsoluteUrl,"/_api/machinelearning/publications/batchremove"),c=JSON.stringify(o);return this.dataRequestor.getData({url:s.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"UnPublishModel",additionalPostData:c,method:"POST",additionalHeaders:{accept:"application/json;odata=nometadata","OData-Version":"3.0"}})},t.prototype.getServerRelativeUrlFromListId=function(e,t){var n="".concat(e,"/_api/web/Lists(guid'").concat(t,"')/rootfolder");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return console.log(JSON.parse(e)),JSON.parse(e).ServerRelativeUrl},qosName:"getserverrelativeurl",method:"GET",additionalHeaders:{accept:"application/json;odata=nometadata","OData-Version":"3.0"}})},t.prototype.getAllLists=function(e){var t="".concat(e,"/_api/web/Lists?$Select=Id,Title,BaseTemplate,BaseType,Hidden");return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getallist",method:"GET",additionalHeaders:{accept:"application/json;odata=nometadata","OData-Version":"3.0"}})},t.prototype.publishModel=function(e,t,n,a,i,r,o,s){this._defaultListViewAsDefaultKSEnabled||s||(s="ListViewAsDefault");var c={__metadata:{type:"Microsoft.Office.Server.ContentCenter.SPMachineLearningPublicationsEntityData"},Publications:{results:[o?{ModelUniqueId:e,TargetSiteUrl:n,TargetWebServerRelativeUrl:t,TargetLibraryServerRelativeUrl:a,TargetTableListServerRelativeUrl:o,ViewOption:s}:{ModelUniqueId:e,TargetSiteUrl:n,TargetWebServerRelativeUrl:t,TargetLibraryServerRelativeUrl:a,ViewOption:s}]},ModelSiteUrl:i,ModelWebServerRelativeUrl:r},d="".concat(this._pageContext.webAbsoluteUrl,"/_api/machinelearning/publications"),l=JSON.stringify(c);return this.dataRequestor.getData({url:d.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"PublishModel",additionalPostData:l,method:"POST",additionalHeaders:{accept:"application/json;odata=nometadata","OData-Version":"3.0"}})},t.prototype.getAnalyzedContent=function(e,t,n,i){var r=this;return this._getOAuthToken().then(function(o){return Object(a.__awaiter)(r,void 0,void 0,function(){var r,s,c,d,l;return Object(a.__generator)(this,function(a){return r=o.endPoint,s=o.token,c=i?"PrebuiltModelId":"trainingModelId",d="".concat(r,"/analyze?extension=").concat(e,"&provider=spoModel&profile=FormClassificationDiscovery&docid=").concat(t,"&").concat(c,"=").concat(n),l={accept:"application/json","content-type":"application/json",Authorization:"Bearer ".concat(s)},[2,this.dataRequestor.getData({url:d,parseResponse:function(e){var t,n,a,r;return i?null===(n=null===(t=JSON.parse(e))||void 0===t?void 0:t.FormRecognizer)||void 0===n?void 0:n.FormClassifications:null===(r=null===(a=JSON.parse(e))||void 0===a?void 0:a.FormClassification)||void 0===r?void 0:r.FormClassifications},qosName:"getAnalyzedContent",method:"GET",additionalHeaders:l})]})})})},t.prototype.getAnalyzedContentMerged=function(e,t,n,i,r){var o=this;return this._getOAuthToken().then(function(s){return Object(a.__awaiter)(o,void 0,void 0,function(){var o,c,d,l;return Object(a.__generator)(this,function(a){return o=s.endPoint,c=s.token,n&&(n="&trainingModelId=".concat(n)),i&&(i="&PrebuiltModelId=".concat(i)),r&&(r="&AIBModelId=".concat(r)),d="".concat(o,"/analyze?extension=").concat(e,"&provider=spoModel&profile=FormClassificationDiscovery&docid=").concat(t).concat(n).concat(i).concat(r),l={accept:"application/json","content-type":"application/json",Authorization:"Bearer ".concat(c)},[2,this.dataRequestor.getData({url:d,parseResponse:function(e){var t,n,a,i,r,o,s=[],c=null===(n=null===(t=JSON.parse(e))||void 0===t?void 0:t.FormRecognizer)||void 0===n?void 0:n.FormClassifications,d=null===(i=null===(a=JSON.parse(e))||void 0===a?void 0:a.FormClassification)||void 0===i?void 0:i.FormClassifications,l=null===(o=null===(r=JSON.parse(e))||void 0===r?void 0:r.FormProcessing)||void 0===o?void 0:o.FormClassifications;return c&&(s=s.concat(c)),d&&(s=s.concat(d)),l&&(s=s.concat(l)),s},qosName:"getAnalyzedContent",method:"GET",additionalHeaders:l})]})})})},t.prototype.getModels=function(e,t,n,a,i){var r=i?"14":"6",o=n||a?"".concat(e,"/_api/machinelearning/getmodels(listid='").concat(t,"',modeltypes='").concat(r,"',publicationtypes='6')?$select=*,ManagementAllowed"):"".concat(e,"/_api/machinelearning/getmodels(guid'").concat(t,"')?$select=*,ManagementAllowed");return i&&(o=n||a?"".concat(e,"/_api/machinelearning/getmodels(listid='").concat(t,"',modeltypes='").concat(r,"',publicationtypes='6')?$select=*,ManagementAllowed,ExtractorFieldMapping,ModelTypeAsString"):"".concat(e,"/_api/machinelearning/getmodels(listid='").concat(t,"',includeManagementNotAllowedModels=true)?$select=*,ManagementAllowed,ExtractorFieldMapping,ModelTypeAsString")),this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getModels",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getWebFields=function(e){var t="".concat(e,"/_api/web/fields?$select=Id,Title,TypeAsString&$filter=(Hidden eq false) and (ReadOnlyField eq false) and (TypeDisplayName ne 'Managed Metadata') and (Group ne '_Hidden')");return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getWebFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getWebFieldsByContentTypeId=function(e,t){var n="".concat(e,"/_api/web/ContentTypes('").concat(t,"')/Fields?$select=Title,InternalName,TypeAsString&$filter=(Hidden eq false) and (ReadOnlyField eq false) and (TypeDisplayName ne 'Managed Metadata') and (Group ne '_Hidden')");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getWebFieldsByContentTypeId",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getContentTypeIdByName=function(e,t){var n="".concat(e,"/_api/web/AvailableContentTypes?$select=Id,Title,TypeAsString&$filter=Name eq '").concat(t,"'");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return JSON.parse(e).value[0].Id.StringValue},qosName:"getContentTypeIdByName",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getSiteContentTypes=function(e,t,n,a){void 0===a&&(a=v);var i=e.substr(0,e.indexOf(t)),r=i.replace("https://","");n=n.replace("{","").replace("}","");var o="".concat(i,"/_api/V2.0/sites/").concat(r,",").concat(n,"/ContentTypes");return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){var t=JSON.parse(e).value;return a&&(t=t.filter(function(e){return e.group===a})),t},qosName:"getSiteContentTypes",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getColumnsForSiteContentType=function(e,t,n,a){var i=e.substr(0,e.indexOf(t)),r=i.replace("https://","");n=n.replace("{","").replace("}","");var o="".concat(i,"/_api/V2.0/sites/").concat(r,",").concat(n,"/ContentTypes/").concat(a,"/columnLinks");return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e).value.map(function(e){return f.e.normalizeLower(e.id)})},qosName:"getColumnsForSiteContentType",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getViewIds=function(e,t){var n="".concat(e,"/_api/Web/Lists(guid'").concat(t,"')/views");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t=JSON.parse(e).value,n=[];return t.forEach(function(e){return n.push(e.ListViewXml)}),n},qosName:"getViewIds",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getMachineTeachingModelsForList=function(e,t){var n="".concat(e,"/_api/web/Lists(guid'").concat(t,"')/contenttypes?$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/machinelearning/modelid', SchemaXml) eq true");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getMachineTeachingModelsForList",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getFormProcessingModelsForList=function(e,t){var n="".concat(e,"/_api/web/Lists(guid'").concat(t,"')/contenttypes?$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/formprocessing/models', SchemaXml) eq true");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getFormProcessingModelsForList",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getModelDetails=function(e,t,n){var a="".concat(e,"/_api/v2.1/drives/").concat(t,"/items/").concat(n," ");return this._vroomDataRequestor.send({path:a.toString(),apiName:"modelDetails",qosExtraData:{qosName:"getModelDetails"},requestType:"GET",allowCookies:!0,getErrorAsMessage:!0,expectedErrorCodes:{403:!0}})},t.prototype.getContentTypeColumnTypes=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getWebFields(e)];case 1:return t=a.sent(),n={},t.forEach(function(e){return n[e.Title]=e.TypeAsString}),[2,n]}})})},t.prototype.getModelContentTypeFields=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getContentTypeIdByName(e,t)];case 1:return n=a.sent(),[4,this.getWebFieldsByContentTypeId(e,n)];case 2:return[2,a.sent()]}})})},t.prototype.getModelDetailsManageModelKillSwitchActivated=function(e,t,n){var a="".concat(e,"/_api/v2.1/drives/").concat(t,"/items/").concat(n," ");return this.dataRequestor.getData({url:a.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"getModelDetailsManageModelKillSwitchActivated",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getUserInformation=function(e,t,n){var a="$filter=ModelUsageModelName eq '".concat(n,"' and ModelUsageTargetListID eq '").concat(t,"'"),i="".concat(e,"/_api/web/lists/modelusage/items?").concat("$select=Author/Name,Author/Title&$expand=Author/Id","&").concat(a);return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){return JSON.parse(e).value[0]},qosName:"getUserInformation",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getModelSettings=function(e,t,n){var a="".concat(e,"/_api/machinelearning/models/getbyuniqueid('").concat(t,"')");return this.dataRequestor.getData({url:a.toString(),parseResponse:function(e){var t=JSON.parse(e),a=JSON.parse(t.ModelSettings),i=t.Schemas;return n?{modelSettings:a,schema:i}:a},qosName:"getModelSettings",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.runModel=function(e){var t=this._apiUrlHelper.build().segment("machinelearning").segment("workItems");return this.runModelBatchRequest(t.toString(),function(e){return e},"runModel",function(){return e})},t.prototype.createOrUpdateModel=function(e,t,n,a,i){void 0===i&&(i=v);var r={__metadata:{type:"Microsoft.Office.Server.ContentCenter.SPMachineLearningModelEntityData"},ColumnId:a,ColumnName:n,ContentTypeGroup:i,ContentTypeId:t,ContentTypeName:e,Schemas:""},o=this._apiUrlHelper.build().segment("machinelearning").segment("models");return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"createContentTypeAndModel",additionalPostData:JSON.stringify(r),method:"POST"})},t.prototype.navigateToTrainingPage=function(e){var t=[];t.push(this._pageContext.webAbsoluteUrl),t.push(this._pageContext.layoutsUrl),t.push("training.aspx");var n=t.join("/")+e;this._navigation.navigateTo(n)},t.prototype.navigateToModelHomePage=function(e){var t="?v=modelHome"+"&modelUniqueId=".concat(e),n=[];n.push(this._pageContext.webAbsoluteUrl),n.push(this._pageContext.layoutsUrl),n.push("training.aspx");var a=n.join("/")+t;this._navigation.navigateTo({url:a,frameId:"_blank"})},t.prototype.getModelIdByContentType=function(e){var t=this._apiUrlHelper.build().toString();return t="".concat(t,"/machinelearning/models/getbytitle('").concat(e,"')"),this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).UniqueId},qosName:"getModelIdByContentType",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.importModel=function(e){var t=this._apiUrlHelper.build().segment("machinelearning").segment("models").segment(e?"import('".concat(e,"')"):"import('BenefitsChangeNotice.cmp')");return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){var t,n;return(null===(n=null===(t=JSON.parse(e))||void 0===t?void 0:t.d)||void 0===n?void 0:n.UniqueId)||""},qosName:"createContentImportModel",method:"Post"})},t.prototype.checkIfModelExists=function(e){var t=this._pageContext,n=t.webAbsoluteUrl,a=t.webServerRelativeUrl,i="".concat(n,"/_api/web/GetFileByServerRelativeUrl('").concat(a,"/Model/").concat(e,"')");return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){return!0},qosName:"checkIfModelExists",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.runModelBatchRequest=function(e,t,n,a){var i=this;if(!a)return Promise.reject("failed");for(var r=f.e.generate(),o="multipart/mixed; boundary=batch_".concat(r),s=[],c=Math.ceil(a().length/30),d=0;d<c;d++){var l=a().slice(30*d,30*(d+1)),u=this.getConvertedData(l,e,r);s.push(this.dataRequestor.getData({url:p.e.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:t,qosName:"".concat(this.getDataSourceName(),".").concat(n),additionalPostData:u,method:"POST",contentType:o}).then(function(e){return p.e.getBatchResponseText(e)}).catch(function(e){var t;m.e.log("[ccui] fetching content type failed "+(null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.value)),Promise.reject(e)}))}return this._shouldSupportFolderLevelClassificationWithCustomization?Promise.all(s).then(function(e){return[].concat.apply([],e).reduce(function(e,t){var n,a,r;if(t){var o=JSON.parse(t);return i._isRunModelFlatFileStructureSupportEnabled?e[null===(n=null==o?void 0:o.d)||void 0===n?void 0:n.TargetUniqueId]=null===(a=null==o?void 0:o.d)||void 0===a?void 0:a.StatusCode:e[i.extractFileName(o.d.TargetServerRelativeUrl)]=null===(r=null==o?void 0:o.d)||void 0===r?void 0:r.StatusCode,e}},{})}):Promise.all(s).then(function(e){var t=[].concat.apply([],e);return new Set(t.map(function(e){var t,n,a;if((null===(t=null==(e=JSON.parse(e))?void 0:e.d)||void 0===t?void 0:t.Created)&&(null===(n=null==e?void 0:e.d)||void 0===n?void 0:n.TargetServerRelativeUrl)&&201===(null===(a=null==e?void 0:e.d)||void 0===a?void 0:a.StatusCode))return i._isRunModelFlatFileStructureSupportEnabled?e.d.TargetUniqueId:i.extractFileName(e.d.TargetServerRelativeUrl)}))})},t.prototype._getOAuthToken=function(){var e,t;return Object(a.__awaiter)(this,void 0,void 0,function(){var n=this;return Object(a.__generator)(this,function(i){return[2,null===(t=null===(e=this._resources)||void 0===e?void 0:e.consumeAsync(s.e))||void 0===t?void 0:t.then(function(e){return e.getMicroServiceEndPoints("media")}).then(function(e){return Object(a.__awaiter)(n,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,null===(n=this._tokenProvider)||void 0===n?void 0:n.getToken(e,!0)];case 1:return t=a.sent()||"",[2,{endPoint:e,token:t}]}})})}).catch(function(e){return console.log(e),d.n("FetchOAuthTokenForAnalyze"),{endPoint:"",token:""}})]})})},t.prototype.getConvertedData=function(e,t,n){if(void 0===t&&(t=""),void 0===n&&(n=""),!e)return e;var a=p.e.defaultBatchAcceptData,i=[],r=[],o=[],s=p.e.defaultBatchRequestPostData,c=1;return e.forEach(function(e){o.push("".concat(c++)),i.push(t),r.push(JSON.stringify(e))}),p.e.getBatchContentExtended(n,i,"POST",s,r,a)},t.dependencies={pageContext:l.f,apiUrlHelper:i.e,navigation:u.e,vroomDataRequestor:_.e,resources:c.r},t}(r.e),S=Object(o.r)("ContentCenterDataSource",y)}],Array(50),[function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(0),i=n("react-lib"),r=n(4539),o=n(4897),s=n(166),c=n(5871),d=n(100),l=n(158),u=n(1348),f=n(752),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onDismiss=function(){l.e.logData({name:"".concat(t._getEngagementNamePrefix(),".Close"),extraData:{campaignGuid:t._getCampaignGuid()}});var e=t.props.onDismiss;e&&e()},t._onTeachingBubbleSeen=function(){l.e.logData({name:"".concat(t._getEngagementNamePrefix(),".Rendered"),extraData:{campaignGuid:t._getCampaignGuid()}});var e=t.props.onTeachingBubbleSeen;e&&e()},t._getCampaignGuid=function(){return t.props.teachingBubbleCampaign.campaignGuid},t._getEngagementNamePrefix=function(){return t.props.teachingBubbleCampaign.isCoachmark?"Coachmark":"TeachingBubble"},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.teachingBubbleCampaign,a=t.onAnimationOpenStart,l=t.directionalHint;e=n.automateExperimentBodyCopy&&Object(u.a)()?n.automateExperimentBodyCopy:n.bodyCopy;var p=n.teachingBubbleContentAs?Object(f.e)(n.teachingBubbleContentAs,r.e):r.e,m=n.teachingBubbleContentAs?Object(f.e)(n.teachingBubbleContentAs,o.e):o.e;return n.isCoachmark?i.createElement(c.e,{target:this.props.target,positioningContainerProps:{directionalHint:l||n.directionalHint||s.e.bottomCenter},styles:n.coachMarkStyles,onAnimationOpenStart:a,persistentBeak:n.persistentBeak,onAnimationOpenEnd:this._onTeachingBubbleSeen,preventFocusOnMount:!0},i.createElement(p,{headline:n.title,illustrationImage:n.illustrationImage,styles:n.teachingBubbleStyles,calloutProps:{doNotLayer:!0},hasCloseIcon:n.isDismissable,closeButtonAriaLabel:d.closeButton,onDismiss:this._onDismiss,hasCondensedHeadline:!n.disableCondensedHeadline},e)):i.createElement(m,{target:this.props.target,headline:n.title,hasCloseIcon:!0,closeButtonAriaLabel:d.closeButton,onDismiss:this._onDismiss,hasCondensedHeadline:!0,calloutProps:{onLayerMounted:this._onTeachingBubbleSeen}},e)},t}(i.PureComponent)}],Array(30),[function(e,t,n){"use strict";var a=n(0),i=n(54),r=n("knockout-lib"),o=n(2173),s=n(311),c=n(488),d=n(2764),l=n(2198),u=n(1206),f=function(e){function t(t){var n=e.call(this,t)||this;return n.group=t.group,n.selectionModel=n.resources.consume(s.I),n.isSelected=r.observable(!1),n.isFocused=r.observable(!1),n.isFocused.subscribe(function(e){n.onFocusChange(e)}),n.tabindex=n.createPureComputed(function(){return n.isFocused()?0:-1}),n._updateSelectionSubscription(t.key),n.addBindingHandlers({keyboard:l.e,delayedHasFocus:d.e}),n}return Object(a.__extends)(t,e),t.filterAndExpandGroup=function(e,t,a,r){var o=null;if(t.fieldSchema){var d=e.consume(c.t);d.requiredGroup(null),d.expandAll(!0),i.n.resolve(n.e("deferred.odsp-datasources").then(n.bind(null,3070))).then(u.e).then(function(n){var i=e.consume(s.s),c=i&&i.peek().content.peek().groupings,l=c&&c.length&&c[0].itemGroups,u=n.getFilterDetails(t,l),f=e.consume(s.e);o=new(e.injected(f.FilterAction))({field:u.fields,value:u.values,isFilterOn:!0,clearExistingFilters:d.supportsNestedGroups&&d.supportsNestedGroups.peek()}),r&&r(o),o.execute(a)})}return a&&(a.stopPropagation(),a.preventDefault()),!1},t.prototype.filterByGroupAndExpand=function(e,n){return t.filterAndExpandGroup(e.resources,e.group,n,function(t){e.addDisposable(t)})},t.prototype.onFocusChange=function(e){},t.prototype.onInvoke=function(e){return!0},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._updateSelectionSubscription(null)},t.prototype._updateSelectionSubscription=function(e){this._selectionSubscription&&(this._selectionSubscription.dispose(),this._selectionSubscription=null),this.selectionModel&&e&&(this._selectionSubscription=this.selectionModel.registerSelectable(e,this))},t}(o.e);t.e=f}],Array(59),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return E});var a=n(0),i=n(1203),r=n(5568),o=n(52),s=n(423),c=n(90),d=n(54),l=n(2784),u=n(79),f=n(76),p=n(44),m=n(3714),_=n(2634),h=n(2344),b=n(2274),g=n(849),v=n(590),y=n(148),S=n(1340),D=n(40),I=n(142),x=new(n(8).t)({name:"ShortcutUpdater.key",loader:new I.t(function(){return n.e(461).then(n.bind(null,5767)).then(function(e){return e.resourceKey})})}),C=n(1333),O=n(313),w=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._shortcutResolverQueue=new l.e,a._pageContext=n.pageContext,a._apiUrlHelper=n.apiUrlHelper,a._itemUrlHelper=n.itemUrlHelper,a._identityDataSource=n.identityDataSource,a._dataRequestor=new(a.scope.attached(n.dataRequestorType))({qosName:"ShortcutLinkDataSource"}),a}return Object(a.__extends)(t,e),t.isSharePointUrl=function(e){var t=new u.t(e).getHost().toLowerCase();return t.indexOf("spoppe.com")>=0||t.indexOf("sharepoint.com")>=0||t.indexOf("sharepoint.cn")>=0},t.prototype.isInternal=function(e,t){if(t&&t!==o.e.Empty&&/@"^[{|\(]?[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}[\)|}]?$/i.test(t))return!0;if(!this._itemUrlHelper.getUrlParts({path:e}).isCrossDomain)return!0;var n=new u.t(e).getHost().toLowerCase(),a=new u.t(this._pageContext.webAbsoluteUrl).getHost().toLowerCase();if(n===a)return!0;var i=void 0,r=/(?:(.+?)(-my)??(\.[^\/]*))|(?:([^\.]*)$)/i.exec(a);if(!r)return!1;if(void 0!==r[2])i=r[1]+r[3];else if(void 0!==r[3])i=r[1]+"-my"+r[3];else if(void 0!==r[4])return!1;return n===i},t.prototype.createShortcut=function(e,t,n){var a=this._itemUrlHelper.getItemUrlParts(e),i=this._apiUrlHelper.build().webByItemUrl(a).methodWithAliases("GetFolderByServerRelativePath",{decodedUrl:a.serverRelativeItemUrl}).segment("Files").methodWithAliases("AddUsingPath",{decodedUrl:t,overwrite:!1});return this._dataRequestor.getData({url:i.toString(),parseResponse:function(e){return e},qosName:"CreateShortcut",method:"POST",additionalPostData:this._getCreateShortcutPostBody(n)}).then(void 0,function(e){var t=e.code;return/^\-2130575257,/.test(t)?d.n.wrapError(_.e.ShortcutErrors.NewFileCreationFileAlreadyExistsError):/^\-2130575245,/.test(t)?d.n.wrapError(_.e.ShortcutErrors.InvalidCharacterError):d.n.wrapError(_.e.ShortcutErrors.UnknownError)})},t.prototype.getShortcutTargetData=function(e){var n,a,i=this,r=e.url,c=e.avoidGetFileByUrlCall,l=e.parentKey,u=e.targetSiteUrl,f=d.n.resolve(void 0);if(u)n=new s.t({webAbsoluteUrl:u}).build(),f=this._getAuthTokenForSite(u),a=decodeURIComponent(r);else{var p=l?this._itemUrlHelper.getItemUrlParts(l):this._itemUrlHelper.getUrlParts({path:r});l&&p.isCrossDomain?(n=new s.t({webAbsoluteUrl:p.fullWebUrl}).build(),f=this._getAuthToken({parentKey:l})):n=this._apiUrlHelper.build(),a=p.fullItemUrl}return n=n.method("SP.Utilities.ShortcutLink.GetShortcutLink",a),f.then(function(e){return i._dataRequestor.getData({url:n.toString(),qosName:"GetShortcutTargetData",method:"GET",noRedirect:!0,authToken:e}).then(function(e){return{url:e.d.url,siteId:e.d.siteId!==o.e.Empty?e.d.siteId:null,webId:e.d.webId!==o.e.Empty?e.d.webId:null,uniqueId:e.d.uniqueId!==o.e.Empty?e.d.uniqueId:null,isInternal:i.isInternal(e.d.url,e.d.uniqueId),webUrl:void 0}},function(e){return null}).then(function(e){return e.uniqueId||c?d.n.wrap(e):t.isSharePointUrl(e.url)?i.getFileByUrl(e.url).then(function(t){var n=!!t&&t.UniqueId&&o.e.normalizeLower(t.UniqueId);return n&&(e.uniqueId=n),e}):d.n.wrap(e)})})},t.prototype.generateShortcutsOpenUrl=function(e,t,n,a,i,r){if(a&&i&&r&&-1===n.toLowerCase().indexOf("guestaccess.aspx")){var o="",s="?";if(n){var c=n.indexOf("?");-1!==c&&(s=n.substring(c)+"&")}return o=e+"/"+t+"/ShortcutLink.aspx",o+=s+"siteid="+f.e.encodeURIComponent(a),(o+="&webid="+f.e.encodeURIComponent(i))+"&uniqueid="+f.e.encodeURIComponent(r)}return n},t.prototype.enqueueParseShortcut=function(e,t){var n=this,a=this._itemUrlHelper.getItemUrlParts(e);this.trackPromise(this._shortcutResolverQueue.enqueue(function(){var i=new(n.managed(h.default));return n.getShortcutTargetData({url:a.fullItemUrl,avoidGetFileByUrlCall:!0,parentKey:e}).then(function(a){var r,o=n.generateShortcutsOpenUrl(n._pageContext.webAbsoluteUrl,n._pageContext.layoutsUrl,a.url,a.siteId,a.webId,a.uniqueId),s={key:e,shortcutInfo:{shortcutLinkRewritten:!0},urls:(r={},r[g.t.shortcutTarget]=o,r)};a.uniqueId&&(s.thumbnail=m.previewImageUrl(a,n._pageContext.webAbsoluteUrl,n._pageContext)),i.update([new b.e(e).succeed({item:s})]),i.flush(),n.resources.consume(C.f)&&t&&n.resources.consumeAsync(x).then(function(n){n.updateItemShortcutValues(e,t,a)})}).then(function(){i.dispose()},function(e){return i.dispose(),d.n.wrapError(e)})}))},t.prototype.getFileByUrl=function(e){var t,n=this,a=this._itemUrlHelper.getUrlParts({path:e});if(a.isCrossDomain||a.siteRelation===y.t.sameSite)t=d.n.wrap(e);else{var i=this._apiUrlHelper.contextInfoUrl(a.fullItemUrl);t=this._dataRequestor.getData({url:i,method:"POST",qosName:"GetContextInfo"}).then(function(e){return e.d.GetContextWebInformation.WebFullUrl})}return t.then(function(t){var a=n._apiUrlHelper.build().webByUrl({path:t,webUrl:t}).method("GetFileByUrl",e);return n._dataRequestor.getData({url:a.toString(),qosName:"GetFileByUrl",method:"GET",noRedirect:!0}).then(function(t){return n._parseGetFileResponse(t,e)})})},t.prototype._getCreateShortcutPostBody=function(e){return"[InternetShortcut]\nURL="+e+"\n"},t.prototype._parseGetFileResponse=function(e,t){return{CheckInComment:e.d.CheckInComment,CheckOutType:parseInt(e.d.CheckOutType,10),ContentTag:e.d.ContentTag,CustomizedPageStatus:e.d.CustomizedPageStatus,ETag:e.d.ETag,Exists:!!e.d.Exists,IrmEnabled:!!e.d.IrmEnabled,Length:parseInt(e.d.Length,10),Level:parseInt(e.d.Level,10),LinkingUrl:e.d.LinkingUrl,MajorVersion:parseInt(e.d.MajorVersion,10),MinorVersion:parseInt(e.d.MinorVersion,10),Name:e.d.Name,ServerRelativeUrl:e.d.ServerRelativeUrl,ServerUrl:new p.e(t).authority,TimeCreated:Object(r.t)(e.d.TimeCreated),TimeLastModified:Object(r.t)(e.d.TimeLastModified),Title:e.d.Title,UIVersion:parseInt(e.d.UIVersion,10),UIVersionLabel:e.d.UIVersionLabel,UniqueId:e.d.UniqueId}},t.prototype._getAuthToken=function(e){var t=d.n.resolve(void 0),n=this._itemUrlHelper.getItemUrlParts(e.parentKey);return n&&n.fullWebUrl&&n.isCrossDomain&&(t=this._identityDataSource.getSharePointToken(new p.e(n.fullItemUrl).authority).then(function(e){return e.accessToken}).catch(function(e){c.e.logError(e)})),t},t.prototype._getAuthTokenForSite=function(e){return this._identityDataSource.getSharePointToken(e).then(function(e){return e.accessToken}).catch(function(e){c.e.logError(e)})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{pageContext:D.f,apiUrlHelper:v.e,itemUrlHelper:y.c,dataRequestorType:S.t,identityDataSource:O.a}),t}(i.default),E=(t.default=w,Object(I.r)("ShortcutLinkDataSource",w))}],Array(34),[function(e,t,n){"use strict";var a=n("knockout-lib");n(2533),n(2994),window.__ko=a},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(87),r=Object(i.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred.odsp-common"),n.e(808)]).then(n.bind(null,5479))];case 1:return[2,e.sent().WithKnockoutResourcesAndItemCacheData]}})})})},,,function(e,t,n){"use strict";var a=n(0),i=n(1203),r=n(54),o=function(e){function t(t){var n=e.call(this,t)||this;n.key=t.key;var a=n.observables,i=t.count,r=void 0===i?a.create(1):i,o=t.isAvailable,c=void 0===o?a.create(!0):o,d=t.onExecute,l=void 0===d?s:d;return n.count=r,n.isAvailable=c,n._onExecute=l.bind(t.operation),n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._onExecute=s},t.prototype.execute=function(){return this._onExecute()},t}(i.default);function s(){return r.n.wrap()}t.e=o},,function(e,t,n){"use strict";var a=n(312),i=function(){function e(e,t){this.value=e,this.extraClasses=t}return e.prototype.getClass=function(){var e=this.value?Object(a.t)(this.value):void 0;return"ms-Icon ms-Icon--".concat(this.value," ").concat(e||"").concat(this.extraClasses?" "+this.extraClasses:"")},e.prototype.getExtraClasses=function(){return this.extraClasses},e.prototype.toString=function(){return this.value},e}();t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(1203),r=n(142),o=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a._recordsByThumbnailKey={},a._bucketsByImageKey={};var i=a.observables;a.lastAccessedDate=i.create(new Date);var r=n.pruneThumbnailsExtenders,o=void 0===r?{rateLimit:{timeout:6e5}}:r;return i.backgroundCompute(a._pruneThumbnails).extend(o),a}return Object(a.__extends)(t,e),t.prototype.getCoveragePercent=function(e,t){var n=l(e),a=l(t);return Math.sqrt(a/n)},t.prototype.register=function(e,t,n,a){void 0===n&&(n=t),void 0===a&&(a=!0);var i=this.lastAccessedDate;i(new Date);var r=d(this.getCoveragePercent(e,n)),o=c(e),s=c(t),l=this._recordsByThumbnailKey,u=this._bucketsByImageKey,f=l[o]||{lastAccessed:void 0,buckets:{}};f.lastAccessed=i.peek();var p=f.buckets[r];(!p||this.getCoveragePercent(p.size,n)>1)&&(p&&delete u[p.key],p=f.buckets[r]={key:s,size:n,image:t,isLoaded:a,lastAccessed:i.peek()}),u[s]=p,l[o]=f},t.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var n=c(e),a=this._bucketsByImageKey,i=a[n];i?i.isLoaded=!0:a[n]={key:n,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}},t.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var n=c(e),a=this._bucketsByImageKey[n];return a&&(a.lastAccessed=t.peek()),!!a&&a.isLoaded},t.prototype.retrieve=function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=t);var a=c(e),i=this._recordsByThumbnailKey[a],r=this.lastAccessedDate;if(r(new Date),i){var o=i.buckets;i.lastAccessed=r.peek();var s=d(t),l=d(n),u=-1/0,f=!1;for(var p in o){var m=Number(p);m<=s&&m>=l&&o[m].isLoaded&&(u=Math.max(u,m),f=!0)}var _=f&&o[u];return _&&_.image}},t.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();u(this._recordsByThumbnailKey,e),u(this._bucketsByImageKey,e)},t}(i.default),s=Object(r.r)("ThumbnailCache",o);function c(e){var t=e.url,n=e.width,a=e.height;return JSON.stringify({url:t,width:n,height:a})}function d(e){return Math.floor(Math.log(e)/Math.log(2)*4)}function l(e){return e.width*e.height}function u(e,t){for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];t-e[i].lastAccessed.getTime()>432e5&&delete e[i]}}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return D});var a=n(2193),i=n(224),r=n(55),o=n(390),s=n(16),c=n(840),d=n(261),l=n(107),u=n(45),f=n(317),p=n(40),m=n(295),_=n(3040),h=n(311),b=n(1242),g=n(3850),v=n("react-lib"),y=n(8),S=s.e.isActivated("5abccc76-54e5-4c12-98dd-8dcd1fd81022","2/3/2022","Re-expose itemsScopeItemKey for Details Pane");function D(e,t,n){var D=Object(i.i)(function(e){var t=Object(r.e)(e).itemsScopeItemKey,n=Object(l.e)(e),a=Object(u.e)(e,n),i=Object(f.e)(e);return[t,e.demandItemFacet(m.e,t),a,i]},[]),I=D[0],x=D[1],C=D[2],O=D[3],w=Object(i.n)(),E=e.consume(c.e),A=e.consume(p.u.optional),L=Object(_.t)(x,{inline:!0}),k=v.useMemo(function(){return S||A||!C||O&&O.webAbsoluteUrl===C.webAbsoluteUrl&&O.listUrl===C.listUrl?void 0:{pageContext:C,store:E,itemsScopeItemKey:I,viewParamsObservable:L}},[O,C,E,I,L]);return{childResource:Object(b.t)(function(){var i=new y.n(e);return!s.e.isActivated("39107185-9E15-471B-BECB-F5ACE7B98951","02/08/2022","Override ItemCache evaluation context for shimmed components")&&n&&i.expose(g.e,w),t&&i.block(a.e),k&&(i.expose(c.e,k.store),i.expose(d.e,k.store),i.expose(o.e,k.itemsScopeItemKey),i.expose(p.f,k.pageContext),i.expose(h.P,k.viewParamsObservable)),[i]},[e,t,k])[0]}}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(0),i=n(2184),r=n(54),o=n(70),s=n(2498),c=n(2693),d=n(311),l=n(253),u=n(2193),f=n(197),p=n(1855),m=!n(16).e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),_=new c.e,h=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="Open";var i=t.item,r=t.openRelation,o=void 0===r?0:r,s=t.ignoreHistory,c=void 0!==s&&s,l=t.itemSet,f=t.openLocal,p=void 0!==f&&f,m=t.urlType,_=void 0===m?"default":m,h=t.preserveAction,b=void 0!==h&&h,g=t.nonFoldersOnly,v=void 0!==g&&g;a._openRelation=o,a._nonFoldersOnly=v,a._urlType=a.wrapObservable(_),a._itemSelectionHelper=new(a.child(u.e))({overrideItem:2===o?i:void 0,allowMultiSelect:!1,canFallback:0!==o,ignoreSelection:0!==o}),a.item=a.createComputed(a._computeItem,{deferEvaluation:!0,pure:!0});var y=a.resources.consume(d.e);return a._navigateToItemAction=new(a.managed(y.NavigateToItemAction))({item:a.item,itemSet:l,parentItem:a._itemSelectionHelper.currentItem,urlType:a._urlType,forceInSameWindow:p,isRedirect:c,shouldPreserveAction:b}),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.item();return(!this._nonFoldersOnly||!!e&&!e.folder)&&this._navigateToItemAction.isAvailable()},t.prototype.onExecute=function(e,t){var n=this.item.peek();return n?(n.type===l.e.Folder&&t&&t.data&&(t.data.folder=!0),t.data.extraData||(t.data.extraData={}),f.e(t.data.extraData,{uniqueId:n.properties?n.properties.uniqueId:void 0}),this._navigateToItemAction.execute(e).then(function(){var e=m&&n.extension?Object(p.e)(n.extension):n.extension||"",t={fileType:l.e[n.type||l.e.Unknown],extension:e};return r.n.resolve({resultType:o.e.Success,extraData:t})})):r.n.resolve({resultType:o.e.ExpectedFailure})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(s.e,{item:this.item})},t.prototype.trackUserAction=function(t){var n=this.item.peek();if(n)switch(n.type){case l.e.File:e.prototype.trackUserAction.call(this,"Open.File");break;case l.e.Media:e.prototype.trackUserAction.call(this,"Open.Media");break;default:e.prototype.trackUserAction.call(this,t)}},t.prototype._computeItem=function(){var e=this._itemSelectionHelper.firstItem();return(3===this._openRelation?e&&e.UNSAFE_parent:e)||_},t}(i.e);t.t=h},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(43),r=new a.t({name:"EnableDarkThemeForOneUpMediaResourceKey",factory:new a.e(Object(i.isFeatureEnabled)(i.EnableDarkThemeForOneUpMediaViewer))})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(43),r=new a.t({name:"EnableNewOneUpCommandBarResourceKey",factory:new a.e(Object(i.isFeatureEnabled)(i.EnableNewOneUpCommandBar))})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"ShortcutLinkDataSource.key",loader:new i.t(function(){return Promise.resolve().then(n.bind(null,4383)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=[".dcm",".dcm30",".dic",".dicm",".dicom"],i={".docm":!0,".dotm":!0,".dotx":!0,".docx":!0,".bmp":!0,".jpg":!0,".jpeg":!0,".tiff":!0,".tif":!0,".png":!0,".gif":!0,".emf":!0,".wmf":!0,".psd":!0,".svg":!0,".ai":!0,".eps":!0,".pdf":!0,".pptm":!0,".pptx":!0,".potm":!0,".potx":!0,".ppsm":!0,".ppsx":!0,".xlsm":!0,".xlsx":!0,".aspx":!0};function r(e){return!!e&&i[e.toLowerCase()]}function o(e){return a.indexOf(e)>=0}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("vroom.dataContext")},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(8),i=new a.t({name:"DetailsListSchemaDataSource.key",factory:new a.e({postProcessSchema:function(e,t){return t}})})},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(3);function i(e){return Object(a.Jr)(a.N)&&!!e&&!!e.extension&&".clipchamp"===e.extension.toLowerCase()}},function(e,t,n){"use strict";var a=n(0),i=n(4431),r=n(2239),o=n(2582),s=n(4822),c=n(43),d=function(e){function t(t){var n=e.call(this,t)||this;return n._itemCommandHelper=n.resources.consume(r.t),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var t=this.item();return!!t&&!!this._itemCommandHelper.isCommandSupported(t,o.r)&&e.prototype.onIsAvailable.call(this)},t.prototype.onExecute=function(t,n){if(c.isOneDrive){var a=this.item.peek();this.resources.consumeAsync(s.e).then(function(e){e.isInRecentView(a)&&e.fireOpenItemEvent(a)})}return e.prototype.onExecute.call(this,t,n)},t}(i.t);t.e=d},function(e,t,n){"use strict";var a=n(0),i=n(54),r=n(37),o=n(197),s=n(213),c=n(70),d=n(147),l=n(177),u=n(2429),f=n(43),p=n(40),m=n(311),_=n(2184),h=n(101),b=n(2239),g=n(148),v=n(2192),y=n(3101),S=n(4822),D=n(2193),I=n(2498),x=n(1855),C=!n(16).e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),O=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="OpenInOfficeClient";var i=t.url,r=t.appMap,o=t.callback,s=t.isTemplate,c=void 0!==s&&s,u=t.retryWithWac,f=void 0!==u&&u;return a._url=i,a._callback=o,a._appMap=r,a._isTemplate=c,a._retryWithWac=f,a._navigation=a.resources.consume(d.e),a._platform=a.resources.consume(l.e),a._itemUrlHelper=a.resources.consume(g.c),a._itemParentHelper=a.resources.consume(v.e),a._itemCommandHelper=a.resources.consume(b.t),a._actionMap=a.resources.consume(m.e),a._pageContext=a.resources.consume(p.f),a._urlDataSource=a.resources.consume(h.ue),a._itemSelectionHelper=new(a.child(D.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._platform,t=this._itemSelectionHelper.firstItem();if(!(e.isMac||e.isWindows||e.isIOS||e.isWinPhone||e.isAndroid)||!t||!this._itemCommandHelper.isCommandSupported(t,y.n))return!1;var n=this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(t,"list")),a=!0;return n&&n.list&&n.list.permissions&&(a=!(!n.list.permissions.useClientIntegration||!r.e.hasItemPermission(t,r.e.openItems))),a&&!(!t.openUrl||!t.appMap)&&t.itemStatus!==s.t.ConditionalAccessBlocked&&t.itemStatus!==s.t.ConditionalAccessViewOnly},t.prototype.onExecute=function(e,t){return Object(a.__awaiter)(this,void 0,i.n,function(){var n,r,s,d,l,p,m,_,h,b,g,v,y,D=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(n=a.sent())?(f.isOneDrive&&this.resources.consumeAsync(S.e).then(function(e){e.isInRecentView(n)&&e.fireOpenItemEvent(n)}),r=function(){if(D._callback)D._callback();else{var t=D._actionMap;new(D.managed(t.OpenInOfficeOnlineAction))({item:D.observables.create(n)}).execute(e)}},s=function(e){D._callback?D._callback():D._doNavigation(e)},t.data.extraData||(t.data.extraData={}),d=this._pageContext.userDisplayName,l=this._pageContext.userLoginName,p=l&&-1!==l.lastIndexOf("@")?l.substring(0,l.lastIndexOf("@")):void 0,m=void 0,n&&n.sharingType&&(_=n&&n.sharingType,m=_===u.e.Shared||_===u.e.Public||_===u.e.PublicUnlisted),h=n.extension?n.extension.toLowerCase():void 0,o.e(t.data.extraData,{uniqueId:n.properties?n.properties.uniqueId:void 0,fileType:C&&h?Object(x.e)(h):h,isInODB:n.itemFromServer&&n.itemFromServer.SiteTitle&&d?-1!==n.itemFromServer.SiteTitle.indexOf(d):void 0,isInODBv2:n.openUrl&&p?-1!==n.openUrl.toLowerCase().indexOf(p.toLowerCase()):void 0,isItemShared:m}),b=this._itemSelectionHelper.currentItem.peek(),g=this._itemUrlHelper.getItemUrlParts(b.key),v=g.fullItemUrl,y="",this._url&&this._appMap&&(this._isTemplate&&this._urlDataSource.getOpenTemplateInOfficeClientUrl?y=this._urlDataSource.getOpenTemplateInOfficeClientUrl(this._appMap,this._url):v&&(y=this._urlDataSource.getNewInOfficeClientUrl(this._appMap,this._url,v))),y||(y=this._urlDataSource.getOpenInOfficeClientUrl(n,this._navigation.viewParams)),this._retryWithWac?"function"!=typeof navigator.msLaunchUri||this._platform.isWinPhone?s(y):navigator.msLaunchUri(y,null,r):s(y),[2,i.n.resolve({resultType:c.e.Success})]):[2,i.n.resolve({resultCode:"EmptySelection",resultType:c.e.Failure})]}})})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(I.e,{item:this._itemSelectionHelper.firstItem})},t.prototype._doNavigation=function(e){this._navigation.navigateTo({url:e,frameId:null})},t}(_.e);t.e=O},function(e,t,n){"use strict";var a=n(0),i=n(70),r=n(54),o=n(2203),s=n(969),c=n(2294),d=n(2189),l=n(2961),u=n(535),f=n(311),p=n(101),m=n(2254),_=n(148),h=n(2498),b=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="OpenShortcut",a._shortcutProvider=a.resources.consume(l.resourceKey.optional),a._dialogProvider=a.resources.consume(o.e),a._urlDataSource=a.resources.consume(p.ue),a._itemUrlHelper=a.resources.consume(_.c),a._url=a.createPureComputed(a._computeTargetUrl),a._actionMap=a.resources.consume(f.e),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!!this._shortcutProvider&&!!this.unwrapObservable(this.item)&&!!this._url.peek()},t.prototype.onExecute=function(e){var t,n,a,o=this,l=this.item.peek();if(this.resources.consume(u.e).logData({name:"ShortcutLink.ItemRow.Click",isIntentional:!0}),l.shortcutInfo&&l.shortcutInfo.shortcutLinkRewritten)return new(this.managed(this._actionMap.NavigationAction))({url:this._url,target:this.wrapObservable("_blank")}).execute(e);l.external?(a=null===(t=this.item.peek().itemFromServer)||void 0===t?void 0:t.SPWebUrl,n=this.item.peek().properties.path):n=this._itemUrlHelper.getItemUrlParts(l.key).fullItemUrl;var f=this._shortcutProvider;return f?f.getShortcutTargetData(n,!0,void 0,a).then(function(t){var n=t.url,a="web=1";return t.isInternal&&n.indexOf(a)<0&&(n+="".concat(n.indexOf("?")>0?"&":"?").concat(a)),(t.isInternal?r.n.wrap():o._dialogProvider.requestDialog({title:s.confirmNavigateDialogTitle,component:{name:c.e.tagName,params:{text:s.openShortcutNavigateToExternalWarning}},actions:[{name:s.navigationDialogConfirmButtonLabel,execute:function(){return r.n.wrap(2)},isAvailable:o.observables.create(!0),icon:new d.e("Forward"),isDefault:!0}]}).wait()).then(function(){return new(o.managed(o._actionMap.NavigationAction))({url:o.wrapObservable(n),target:o.wrapObservable("_blank")}).execute(e)})},function(t){return new(o.managed(o._actionMap.NavigationAction))({url:o._url,target:o.wrapObservable("_blank")}).execute(e),r.n.wrap({resultType:i.e.Failure})}):r.n.wrap({resultType:i.e.ExpectedFailure})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this.item})},t.prototype._computeTargetUrl=function(){return this._urlDataSource.getDefaultClickUrl(this.item(),{})},t}(m.e);t.e=b},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"StandaloneList.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(441)]).then(n.bind(null,3538)).then(function(e){return e.resourceKey.local})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(54);function i(e){var t;return function(){return t||(t=a.n.resolve(e()).then(function(e){return e.default}).catch(function(e){return t=void 0,a.n.reject(e)}))}}},function(e,t,n){"use strict";var a=n(0),i=n("knockout-lib"),r=function(e){function t(){var t=e.call(this,{})||this;return t._store=i.observable({}),t._store.extend({notify:"always"}),t.currentSelection=t.createPureComputed(t._computeCurrentSelection),t}return Object(a.__extends)(t,e),t.prototype.registerSelectionModel=function(e,t){var n=this._store.peek();if(n[t])throw"Duplicate selectionModelId: "+t;n[t]=e,this._store(n)},t.prototype.unregisterSelectionModel=function(e){var t=this._store.peek();return!!t[e]&&(delete t[e],this._store(t),!0)},t.prototype.clearOtherSelectionModels=function(e){var t=this._store.peek();for(var n in t)n!==e&&t[n].clear()},t.prototype._computeCurrentSelection=function(){var e=this._store();for(var t in e)if(e[t].selectedCount()>0)return e[t];return null},t}(n(1203).default);t.e=r},function(e,t,n){"use strict";var a=n(8),i=n(142),r=new a.t({name:"SpotlightHost.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(440)]).then(n.bind(null,5474)).then(function(e){return e.resourceKey.local})})});t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"ItemColumnDataSource.key",loader:new i.t(function(){return n.e(459).then(n.bind(null,5323)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(3344),i=(new a.e("play"),new a.e("rotate"),new a.e("editCaption"),new a.e("editTags"),new a.e("removeTags"),new a.e("viewOriginal"));new a.e("applyOfficeLens"),new a.e("removeOfficeLens"),new a.e("addToAlbum"),new a.e("removeFromAlbum"),new a.e("addPhotosToAlbum")},function(e,t,n){"use strict";n.d(t,"e",function(){return y});var a=n(0),i=n(1203),r=n(8),o=n(2344),s=n(253),c=n(38),d=n(72),l=n(14),u=n(101),f=n(7),p=n(148),m=n(2238),_=n(4229),h=n(1404),b=n(1942),g=n(985),v={itemTaskObserverType:o.resourceKey,itemUrlHelper:p.c,itemsStore:m.t,observablesFactoryType:i.observablesFactoryTypeResourceKey,rootItemsTypeFilter:_.e.optional,urlDataSource:u.ue,webDataSource:h.e},y=new r.t({name:"".concat("RootItems.key",".rootItems"),factory:{dependencies:v,create:function(e){var t=e.itemUrlHelper,n=e.itemsStore,i=e.rootItemsTypeFilter,r=e.urlDataSource,u=new g.e,m=u.attach(new e.observablesFactoryType).create();return u.trackPromise(e.webDataSource.getMyOneDriveUrl()).then(function(u){var _,h,g=t.getUrlParts({path:u,webUrl:u}),v=t.getUrlParts({path:"".concat(u,"/Documents"),listUrl:"".concat(u,"/Documents"),webUrl:u}),y=new e.itemTaskObserverType,S=r.getKey(((_={})[f.n.idParamKey]=g.normalizedItemUrl,_[f.n.queryTypeParamKey]=c.e.DocumentLibraries,_)),D=r.getKey(Object(a.__assign)(((h={})[f.n.idParamKey]=v.serverRelativeItemUrl,h[f.n.listUrlKey]=v.normalizedListUrl,h),r.saveItemTypeFilter(i))),I=r.getKey(Object(a.__assign)(Object(a.__assign)({},r.getKeyParams(r.getRootItemKey(c.e.Recent))),r.saveItemTypeFilter(i)));y.update([new o.Task(S).succeed({item:{key:S,subsite:{webTemplateId:d.t.mySite,serverRelativeUrl:g.fullItemUrl}}}),new o.Task(D).succeed({item:{key:D,name:o.Graft.backup(v.siteRelation===p.t.sameSite?b.n:b.u),displayName:o.Graft.backup(v.siteRelation===p.t.sameSite?b.n:b.u),type:s.e.Folder,parentKey:S,list:{templateType:l.n.mySiteDocumentLibrary},folder:{}}}),new o.Task(I).succeed({item:{key:I,name:o.Graft.backup(b.i),displayName:o.Graft.backup(b.i),type:s.e.Folder,folder:{}}})]),y.flush(),m({files:n.getItem(D),recent:n.getItem(I)})}),{instance:m,disposable:u}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(16);function i(e,t,n){var i;a.t.isActivated("c697dc4c-a759-483d-8f1c-569d265f6a95","1/18/2021","remove window history optional entry url, as it could be different origin and will throw exception")&&(i=e),window.history.pushState({returnUrl:n},"",i),t.navigateTo(e)}},,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("imageEditorDataSource")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("InfoPaneManager.key")},,,,,,,,,function(e,t,n){(function(t){e.exports=function(e){function t(a){if(n[a])return n[a].exports;var i=n[a]={exports:{},id:a,loaded:!1};return e[a].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function a(e,t){"object"===(void 0===e?"undefined":i(e))&&(t=e,e=void 0),t=t||{};var n,a=r(e),o=a.source,d=a.id,l=a.path,u=c[d]&&l in c[d].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||u?n=s(o,t):(c[d]||(c[d]=s(o,t)),n=c[d]),a.query&&!t.query&&(t.query=a.query),n.socket(a.path,t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n(1),o=n(4),s=n(9);n(3)("socket.io-client"),e.exports=t=a;var c=t.managers={};t.protocol=o.protocol,t.connect=a,t.Manager=n(9),t.Socket=n(34)},function(e,t,n){"use strict";var a=n(2);n(3)("socket.io-client:url"),e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==t?t.protocol+"//"+e:"https://"+e),n=a(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var i=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port,n.href=n.protocol+"://"+i+(t&&t.port===n.port?"":":"+n.port),n}},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,a=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),r=e.indexOf("]");-1!=i&&-1!=r&&(e=e.substring(0,i)+e.substring(i,r).replace(/:/g,";")+e.substring(r,e.length));for(var o=n.exec(e||""),s={},c=14;c--;)s[a[c]]=o[c]||"";return-1!=i&&-1!=r&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=function(e,t){var n=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.substr(0,1)&&0!==t.length||n.splice(0,1),"/"==t.substr(t.length-1,1)&&n.splice(n.length-1,1),n}(0,s.path),s.queryKey=function(e,t){var n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,a){t&&(n[t]=a)}),n}(0,s.query),s}},function(e,t){"use strict";e.exports=function(){return function(){}}},function(e,t,n){function a(){}function i(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var a=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===a)return f;n+=a}return n}function r(){this.reconstructor=null}function o(e){this.reconPack=e,this.buffers=[]}function s(e){return{type:t.ERROR,data:"parser error: "+e}}var c=(n(3)("socket.io-parser"),n(5)),d=n(6),l=n(7),u=n(8);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=a,t.Decoder=r;var f=t.ERROR+'"encode error"';a.prototype.encode=function(e,n){t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?function(e,t){d.removeBlobs(e,function(e){var n=d.deconstructPacket(e),a=i(n.packet),r=n.buffers;r.unshift(a),t(r)})}(e,n):n([i(e)])},c(r.prototype),r.prototype.add=function(e){var n;if("string"==typeof e)n=function(e){var n=0,a={type:Number(e.charAt(0))};if(null==t.types[a.type])return s("unknown packet type "+a.type);if(t.BINARY_EVENT===a.type||t.BINARY_ACK===a.type){for(var i="";"-"!==e.charAt(++n)&&(i+=e.charAt(n),n!=e.length););if(i!=Number(i)||"-"!==e.charAt(n))throw new Error("Illegal attachments");a.attachments=Number(i)}if("/"===e.charAt(n+1))for(a.nsp="";++n&&","!==(o=e.charAt(n))&&(a.nsp+=o,n!==e.length););else a.nsp="/";var r=e.charAt(n+1);if(""!==r&&Number(r)==r){for(a.id="";++n;){var o;if(null==(o=e.charAt(n))||Number(o)!=o){--n;break}if(a.id+=e.charAt(n),n===e.length)break}a.id=Number(a.id)}if(e.charAt(++n)){var c=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n));if(!1===c||a.type!==t.ERROR&&!l(c))return s("invalid payload");a.data=c}return a}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new o(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!u(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},r.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},o.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=d.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},o.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){function a(e){if(e)return function(e){for(var t in a.prototype)e[t]=a.prototype[t];return e}(e)}e.exports=a,a.prototype.on=a.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},a.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},a.prototype.off=a.prototype.removeListener=a.prototype.removeAllListeners=a.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var a,i=0;i<n.length;i++)if((a=n[i])===t||a.fn===t){n.splice(i,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},a.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],a=1;a<arguments.length;a++)t[a-1]=arguments[a];if(n){a=0;for(var i=(n=n.slice(0)).length;a<i;++a)n[a].apply(this,t)}return this},a.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},a.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){function a(e,t){if(!e)return e;if(o(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(r(e)){for(var i=new Array(e.length),s=0;s<e.length;s++)i[s]=a(e[s],t);return i}if("object"==typeof e&&!(e instanceof Date)){for(var c in i={},e)i[c]=a(e[c],t);return i}return e}function i(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(r(e))for(var n=0;n<e.length;n++)e[n]=i(e[n],t);else if("object"==typeof e)for(var a in e)e[a]=i(e[a],t);return e}var r=n(7),o=n(8),s=Object.prototype.toString,c="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===s.call(Blob),d="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===s.call(File);t.deconstructPacket=function(e){var t=[],n=e.data,i=e;return i.data=a(n,t),i.attachments=t.length,{packet:i,buffers:t}},t.reconstructPacket=function(e,t){return e.data=i(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,a=e;(function e(i,s,l){if(!i)return i;if(c&&i instanceof Blob||d&&i instanceof File){n++;var u=new FileReader;u.onload=function(){l?l[s]=this.result:a=this.result,--n||t(a)},u.readAsArrayBuffer(i)}else if(r(i))for(var f=0;f<i.length;f++)e(i[f],f,i);else if("object"==typeof i&&!o(i))for(var p in i)e(i[p],p,i)})(a),n||t(a)}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,n){e.exports=function(e){return a&&t.isBuffer(e)||i&&(e instanceof ArrayBuffer||r(e))};var a="function"==typeof t&&"function"==typeof t.isBuffer,i="function"==typeof ArrayBuffer,r=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}},function(e,t,n){"use strict";function a(e,t){if(!(this instanceof a))return new a(e,t);e&&"object"===(void 0===e?"undefined":i(e))&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new f({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||c;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n(10),o=n(34),s=n(5),c=n(4),d=n(36),l=n(37),u=(n(3)("socket.io-client:manager"),n(33)),f=n(38),p=Object.prototype.hasOwnProperty;e.exports=a,a.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)p.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},a.prototype.updateSocketIds=function(){for(var e in this.nsps)p.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},a.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},s(a.prototype),a.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},a.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},a.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},a.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},a.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},a.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},a.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},a.prototype.open=a.prototype.connect=function(e,t){if(~this.readyState.indexOf("open"))return this;this.engine=r(this.uri,this.opts);var n=this.engine,a=this;this.readyState="opening",this.skipReconnect=!1;var i=d(n,"open",function(){a.onopen(),e&&e()}),o=d(n,"error",function(t){if(a.cleanup(),a.readyState="closed",a.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else a.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;0===s&&i.destroy();var c=setTimeout(function(){i.destroy(),n.close(),n.emit("error","timeout"),a.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(i),this.subs.push(o),this},a.prototype.onopen=function(){this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(d(e,"data",l(this,"ondata"))),this.subs.push(d(e,"ping",l(this,"onping"))),this.subs.push(d(e,"pong",l(this,"onpong"))),this.subs.push(d(e,"error",l(this,"onerror"))),this.subs.push(d(e,"close",l(this,"onclose"))),this.subs.push(d(this.decoder,"decoded",l(this,"ondecoded")))},a.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},a.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},a.prototype.ondata=function(e){this.decoder.add(e)},a.prototype.ondecoded=function(e){this.emit("packet",e)},a.prototype.onerror=function(e){this.emitAll("error",e)},a.prototype.socket=function(e,t){function n(){~u(i.connecting,a)||i.connecting.push(a)}var a=this.nsps[e];if(!a){a=new o(this,e,t),this.nsps[e]=a;var i=this;a.on("connecting",n),a.on("connect",function(){a.id=i.generateId(e)}),this.autoConnect&&n()}return a},a.prototype.destroy=function(e){var t=u(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},a.prototype.packet=function(e){var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var a=0;a<n.length;a++)t.engine.write(n[a],e.options);t.encoding=!1,t.processPacketQueue()}))},a.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},a.prototype.cleanup=function(){for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},a.prototype.close=a.prototype.disconnect=function(){this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},a.prototype.onclose=function(e){this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},a.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):e.onreconnect()}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},a.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){e.exports=n(11),e.exports.parser=n(19)},function(e,t,n){function a(e,t){return this instanceof a?(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=c(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=c(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=d.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,void this.open()):new a(e,t)}var i=n(12),r=n(5),o=(n(3)("engine.io-client:socket"),n(33)),s=n(19),c=n(2),d=n(27);e.exports=a,a.priorWebsocketSuccess=!1,r(a.prototype),a.protocol=s.protocol,a.Socket=a,a.Transport=n(18),a.transports=n(12),a.parser=n(19),a.prototype.createTransport=function(e){var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=s.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new i[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},a.prototype.open=function(){var e;if(this.rememberUpgrade&&a.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},a.prototype.setTransport=function(e){var t=this;this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},a.prototype.probe=function(e){function t(){if(u.onlyBinaryUpgrades){var e=!this.supportsBinary&&u.transport.supportsBinary;l=l||e}l||(d.send([{type:"ping",data:"probe"}]),d.once("packet",function(e){if(!l)if("pong"===e.type&&"probe"===e.data){if(u.upgrading=!0,u.emit("upgrading",d),!d)return;a.priorWebsocketSuccess="websocket"===d.name,u.transport.pause(function(){l||"closed"!==u.readyState&&(c(),u.setTransport(d),d.send([{type:"upgrade"}]),u.emit("upgrade",d),d=null,u.upgrading=!1,u.flush())})}else{var t=new Error("probe error");t.transport=d.name,u.emit("upgradeError",t)}}))}function n(){l||(l=!0,c(),d.close(),d=null)}function i(e){var t=new Error("probe error: "+e);t.transport=d.name,n(),u.emit("upgradeError",t)}function r(){i("transport closed")}function o(){i("socket closed")}function s(e){d&&e.name!==d.name&&n()}function c(){d.removeListener("open",t),d.removeListener("error",i),d.removeListener("close",r),u.removeListener("close",o),u.removeListener("upgrading",s)}var d=this.createTransport(e,{probe:1}),l=!1,u=this;a.priorWebsocketSuccess=!1,d.once("open",t),d.once("error",i),d.once("close",r),this.once("close",o),this.once("upgrading",s),d.open()},a.prototype.onOpen=function(){if(this.readyState="open",a.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause)for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])},a.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}},a.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},a.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},a.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},a.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},a.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},a.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},a.prototype.write=a.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},a.prototype.sendPacket=function(e,t,n,a){if("function"==typeof t&&(a=t,t=void 0),"function"==typeof n&&(a=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),a&&this.once("flush",a),this.flush()}},a.prototype.close=function(){function e(){a.onClose("forced close"),a.transport.close()}function t(){a.removeListener("upgrade",t),a.removeListener("upgradeError",t),e()}function n(){a.once("upgrade",t),a.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var a=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},a.prototype.onError=function(e){a.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},a.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},a.prototype.filterUpgrades=function(e){for(var t=[],n=0,a=e.length;n<a;n++)~o(this.transports,e[n])&&t.push(e[n]);return t}},function(e,t,n){var a=n(13),i=n(16),r=n(30),o=n(31);t.polling=function(e){var t=!1,n=!1,o=!1!==e.jsonp;if("undefined"!=typeof location){var s="https:"===location.protocol,c=location.port;c||(c=s?443:80),t=e.hostname!==location.hostname||c!==e.port,n=e.secure!==s}if(e.xdomain=t,e.xscheme=n,"open"in new a(e)&&!e.forceJSONP)return new i(e);if(!o)throw new Error("JSONP disabled");return new r(e)},t.websocket=o},function(e,t,n){var a=n(14),i=n(15);e.exports=function(e){var t=e.xdomain,n=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||a))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(e){}if(!t)try{return new(i[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t){e.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},function(e,t,n){function a(){}function i(e){if(c.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function r(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function o(){for(var e in r.requests)r.requests.hasOwnProperty(e)&&r.requests[e].abort()}var s=n(13),c=n(17),d=n(5),l=n(28),u=(n(3)("engine.io-client:polling-xhr"),n(15));e.exports=i,e.exports.Request=r,l(i,c),i.prototype.supportsBinary=!0,i.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new r(e)},i.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,a=this.request({method:"POST",data:e,isBinary:n}),i=this;a.on("success",t),a.on("error",function(e){i.onError("xhr post error",e)}),this.sendXhr=a},i.prototype.doPoll=function(){var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},d(r.prototype),r.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new s(e),n=this;try{t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var a in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(a)&&t.setRequestHeader(a,this.extraHeaders[a])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout(function(){n.onError("number"==typeof t.status?t.status:0)},0))},t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}"undefined"!=typeof document&&(this.index=r.requestsCount++,r.requests[this.index]=this)},r.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},r.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},r.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},r.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=a:this.xhr.onreadystatechange=a,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete r.requests[this.index],this.xhr=null}},r.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},r.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},r.prototype.abort=function(){this.cleanup()},r.requestsCount=0,r.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",o):"function"==typeof addEventListener&&addEventListener("onpagehide"in u?"pagehide":"unload",o,!1))},function(e,t,n){function a(e){var t=e&&e.forceBase64;d&&!t||(this.supportsBinary=!1),i.call(this,e)}var i=n(18),r=n(27),o=n(19),s=n(28),c=n(29);n(3)("engine.io-client:polling"),e.exports=a;var d=null!=new(n(13))({xdomain:!1}).responseType;s(a,i),a.prototype.name="polling",a.prototype.doOpen=function(){this.poll()},a.prototype.pause=function(e){function t(){n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var a=0;this.polling&&(a++,this.once("pollComplete",function(){--a||t()})),this.writable||(a++,this.once("drain",function(){--a||t()}))}else t()},a.prototype.poll=function(){this.polling=!0,this.doPoll(),this.emit("poll")},a.prototype.onData=function(e){var t=this;o.decodePayload(e,this.socket.binaryType,function(e,n,a){return"opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())},a.prototype.doClose=function(){function e(){t.write([{type:"close"}])}var t=this;"open"===this.readyState?e():this.once("open",e)},a.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};o.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},a.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||e.sid||(e.b64=1),e=r.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){function a(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var i=n(19),r=n(5);e.exports=a,r(a.prototype),a.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},a.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},a.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},a.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},a.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},a.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},a.prototype.onPacket=function(e){this.emit("packet",e)},a.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){function a(e,n){return n("b"+t.packets[e.type]+e.data.data)}function i(e,n,a){if(!n)return t.encodeBase64Packet(e,a);var i=e.data,r=new Uint8Array(i),o=new Uint8Array(1+i.byteLength);o[0]=h[e.type];for(var s=0;s<r.length;s++)o[s+1]=r[s];return a(o.buffer)}function r(e,n,a){if(!n)return t.encodeBase64Packet(e,a);if(_)return function(e,n,a){if(!n)return t.encodeBase64Packet(e,a);var i=new FileReader;return i.onload=function(){t.encodePacket({type:e.type,data:i.result},n,!0,a)},i.readAsArrayBuffer(e.data)}(e,n,a);var i=new Uint8Array(1);return i[0]=h[e.type],a(new v([i.buffer,e.data]))}function o(e,t,n){for(var a=new Array(e.length),i=u(e.length,n),r=function(e,n,i){t(n,function(t,n){a[e]=n,i(t,a)})},o=0;o<e.length;o++)r(o,e[o],i)}var s,c=n(20),d=n(21),l=n(22),u=n(23),f=n(24);"undefined"!=typeof ArrayBuffer&&(s=n(25));var p="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),m="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),_=p||m;t.protocol=3;var h=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},b=c(h),g={type:"error",data:"parser error"},v=n(26);t.encodePacket=function(e,t,n,o){"function"==typeof t&&(o=t,t=!1),"function"==typeof n&&(o=n,n=null);var s=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&s instanceof ArrayBuffer)return i(e,t,o);if(void 0!==v&&s instanceof v)return r(e,t,o);if(s&&s.base64)return a(e,o);var c=h[e.type];return void 0!==e.data&&(c+=n?f.encode(String(e.data),{strict:!1}):String(e.data)),o(""+c)},t.encodeBase64Packet=function(e,n){var a,i="b"+t.packets[e.type];if(void 0!==v&&e.data instanceof v){var r=new FileReader;return r.onload=function(){var e=r.result.split(",")[1];n(i+e)},r.readAsDataURL(e.data)}try{a=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var o=new Uint8Array(e.data),s=new Array(o.length),c=0;c<o.length;c++)s[c]=o[c];a=String.fromCharCode.apply(null,s)}return i+=btoa(a),n(i)},t.decodePacket=function(e,n,a){if(void 0===e)return g;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(a&&!1===(e=function(e){try{e=f.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return g;var i=e.charAt(0);return Number(i)==i&&b[i]?e.length>1?{type:b[i],data:e.substring(1)}:{type:b[i]}:g}i=new Uint8Array(e)[0];var r=l(e,1);return v&&"blob"===n&&(r=new v([r])),{type:b[i],data:r}},t.decodeBase64Packet=function(e,t){var n=b[e.charAt(0)];if(!s)return{type:n,data:{base64:!0,data:e.substr(1)}};var a=s.decode(e.substr(1));return"blob"===t&&v&&(a=new v([a])),{type:n,data:a}},t.encodePayload=function(e,n,a){"function"==typeof n&&(a=n,n=null);var i=d(e);return n&&i?v&&!_?t.encodePayloadAsBlob(e,a):t.encodePayloadAsArrayBuffer(e,a):e.length?void o(e,function(e,a){t.encodePacket(e,!!i&&n,!1,function(e){a(null,function(e){return e.length+":"+e}(e))})},function(e,t){return a(t.join(""))}):a("0:")},t.decodePayload=function(e,n,a){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,a);var i;if("function"==typeof n&&(a=n,n=null),""===e)return a(g,0,1);for(var r,o,s="",c=0,d=e.length;c<d;c++){var l=e.charAt(c);if(":"===l){if(""===s||s!=(r=Number(s)))return a(g,0,1);if(s!=(o=e.substr(c+1,r)).length)return a(g,0,1);if(o.length){if(i=t.decodePacket(o,n,!1),g.type===i.type&&g.data===i.data)return a(g,0,1);if(!1===a(i,c+r,d))return}c+=r,s=""}else s+=l}return""!==s?a(g,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){return e.length?void o(e,function(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})},function(e,t){var a=t.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),i=new Uint8Array(a),r=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var a=new Uint8Array(e.length),o=0;o<e.length;o++)a[o]=e.charCodeAt(o);n=a.buffer}i[r++]=t?0:1;var s=n.byteLength.toString();for(o=0;o<s.length;o++)i[r++]=parseInt(s[o]);for(i[r++]=255,a=new Uint8Array(n),o=0;o<a.length;o++)i[r++]=a[o]}),n(i.buffer)}):n(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,n){o(e,function(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var a=new Uint8Array(e.length),i=0;i<e.length;i++)a[i]=e.charCodeAt(i);e=a.buffer,t[0]=0}var r=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),o=new Uint8Array(r.length+1);for(i=0;i<r.length;i++)o[i]=parseInt(r[i]);if(o[r.length]=255,v){var s=new v([t.buffer,o.buffer,e]);n(null,s)}})},function(e,t){return n(new v(t))})},t.decodePayloadAsBinary=function(e,n,a){"function"==typeof n&&(a=n,n=null);for(var i=e,r=[];i.byteLength>0;){for(var o=new Uint8Array(i),s=0===o[0],c="",d=1;255!==o[d];d++){if(c.length>310)return a(g,0,1);c+=o[d]}i=l(i,2+c.length),c=parseInt(c);var u=l(i,0,c);if(s)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(e){var f=new Uint8Array(u);for(u="",d=0;d<f.length;d++)u+=String.fromCharCode(f[d])}r.push(u),i=l(i,c)}var p=r.length;r.forEach(function(e,i){a(t.decodePacket(e,n,!0),i,p)})}},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var a in e)n.call(e,a)&&t.push(a);return t}},function(e,n,a){var i=a(7),r=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===r.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===r.call(File);e.exports=function e(n){if(!n||"object"!=typeof n)return!1;if(i(n)){for(var a=0,r=n.length;a<r;a++)if(e(n[a]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||o&&n instanceof Blob||s&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return e(n.toJSON(),!0);for(var c in n)if(Object.prototype.hasOwnProperty.call(n,c)&&e(n[c]))return!0;return!1}},function(e,t){e.exports=function(e,t,n){var a=e.byteLength;if(t=t||0,n=n||a,e.slice)return e.slice(t,n);if(t<0&&(t+=a),n<0&&(n+=a),n>a&&(n=a),t>=a||t>=n||0===a)return new ArrayBuffer(0);for(var i=new Uint8Array(e),r=new Uint8Array(n-t),o=t,s=0;o<n;o++,s++)r[s]=i[o];return r.buffer}},function(e,t){function n(){}e.exports=function(e,t,a){function i(e,n){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(r=!0,t(e),t=a):0!==i.count||r||t(null,n)}var r=!1;return a=a||n,i.count=e,0===e?t():i}},function(e,t){function n(e){for(var t,n,a=[],i=0,r=e.length;i<r;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<r?56320==(64512&(n=e.charCodeAt(i++)))?a.push(((1023&t)<<10)+(1023&n)+65536):(a.push(t),i--):a.push(t);return a}function a(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function i(e,t){return u(e>>t&63|128)}function r(e,t){if(0==(4294967168&e))return u(e);var n="";return 0==(4294965248&e)?n=u(e>>6&31|192):0==(4294901760&e)?(a(e,t)||(e=65533),n=u(e>>12&15|224),n+=i(e,6)):0==(4292870144&e)&&(n=u(e>>18&7|240),n+=i(e,12),n+=i(e,6)),n+u(63&e|128)}function o(){if(l>=d)throw Error("Invalid byte index");var e=255&c[l];if(l++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function s(e){var t,n;if(l>d)throw Error("Invalid byte index");if(l==d)return!1;if(t=255&c[l],l++,0==(128&t))return t;if(192==(224&t)){if((n=(31&t)<<6|o())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if((n=(15&t)<<12|o()<<6|o())>=2048)return a(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(n=(7&t)<<18|o()<<12|o()<<6|o())>=65536&&n<=1114111)return n;throw Error("Invalid UTF-8 detected")}var c,d,l,u=String.fromCharCode;e.exports={version:"2.1.2",encode:function(e,t){for(var a=!1!==(t=t||{}).strict,i=n(e),o=i.length,s=-1,c="";++s<o;)c+=r(i[s],a);return c},decode:function(e,t){var a=!1!==(t=t||{}).strict;c=n(e),d=c.length,l=0;for(var i,r=[];!1!==(i=s(a));)r.push(i);return function(e){for(var t,n=e.length,a=-1,i="";++a<n;)(t=e[a])>65535&&(i+=u((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=u(t);return i}(r)}}},function(e,t){!function(e){"use strict";t.encode=function(t){var n,a=new Uint8Array(t),i=a.length,r="";for(n=0;n<i;n+=3)r+=e[a[n]>>2],r+=e[(3&a[n])<<4|a[n+1]>>4],r+=e[(15&a[n+1])<<2|a[n+2]>>6],r+=e[63&a[n+2]];return i%3==2?r=r.substring(0,r.length-1)+"=":i%3==1&&(r=r.substring(0,r.length-2)+"=="),r},t.decode=function(t){var n,a,i,r,o,s=.75*t.length,c=t.length,d=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var l=new ArrayBuffer(s),u=new Uint8Array(l);for(n=0;n<c;n+=4)a=e.indexOf(t[n]),i=e.indexOf(t[n+1]),r=e.indexOf(t[n+2]),o=e.indexOf(t[n+3]),u[d++]=a<<2|i>>4,u[d++]=(15&i)<<4|r>>2,u[d++]=(3&r)<<6|63&o;return l}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},function(e,t){function n(e){return e.map(function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e})}function a(e,t){t=t||{};var a=new r;return n(e).forEach(function(e){a.append(e)}),t.type?a.getBlob(t.type):a.getBlob()}function i(e,t){return new Blob(n(e),t||{})}var r=void 0!==r?r:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,o=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),s=o&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),c=r&&r.prototype.append&&r.prototype.getBlob;"undefined"!=typeof Blob&&(a.prototype=Blob.prototype,i.prototype=Blob.prototype),e.exports=o?s?Blob:i:c?a:void 0},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),a=0,i=n.length;a<i;a++){var r=n[a].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){"use strict";function n(e){var t="";do{t=r[e%o]+t,e=Math.floor(e/o)}while(e>0);return t}function a(){var e=n(+new Date);return e!==i?(c=0,i=e):e+"."+n(c++)}for(var i,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,s={},c=0,d=0;d<o;d++)s[r[d]]=d;a.encode=n,a.decode=function(e){var t=0;for(d=0;d<e.length;d++)t=t*o+s[e.charAt(d)];return t},e.exports=a},function(e,t,n){function a(){}function i(e){r.call(this,e),this.query=this.query||{},c||(c=s.___eio=s.___eio||[]),this.index=c.length;var t=this;c.push(function(e){t.onData(e)}),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){t.script&&(t.script.onerror=a)},!1)}var r=n(17),o=n(28),s=n(15);e.exports=i;var c,d=/\n/g,l=/\\n/g;o(i,r),i.prototype.supportsBinary=!1,i.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},i.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},i.prototype.doWrite=function(e,t){function n(){a(),t()}function a(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(e){i.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+i.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=i.iframeId,r.src="javascript:0"}r.id=i.iframeId,i.form.appendChild(r),i.iframe=r}var i=this;if(!this.form){var r,o=document.createElement("form"),s=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=c,o.method="POST",o.setAttribute("accept-charset","utf-8"),s.name="d",o.appendChild(s),document.body.appendChild(o),this.form=o,this.area=s}this.form.action=this.uri(),a(),e=e.replace(l,"\\\n"),this.area.value=e.replace(d,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===i.iframe.readyState&&n()}:this.iframe.onload=n}},function(e,n,a){function i(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=r&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(f=o),s.call(this,e)}var r,o,s=a(18),c=a(19),d=a(27),l=a(28),u=a(29);if(a(3)("engine.io-client:websocket"),"undefined"!=typeof WebSocket?r=WebSocket:"undefined"!=typeof self&&(r=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{o=a(32)}catch(e){}var f=r||o;e.exports=i,l(i,s),i.prototype.name="websocket",i.prototype.supportsBinary=!0,i.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={};this.isReactNative||(n.agent=this.agent,n.perMessageDeflate=this.perMessageDeflate,n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new f(e,t):new f(e):new f(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},i.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},i.prototype.write=function(e){var n=this;this.writable=!1;for(var a=e.length,i=0,r=a;i<r;i++)!function(e){c.encodePacket(e,n.supportsBinary,function(i){if(!n.usingBrowserWebSocket){var r={};e.options&&(r.compress=e.options.compress),n.perMessageDeflate&&("string"==typeof i?t.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(r.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,r)}catch(e){}--a||(n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0))})}(e[i])},i.prototype.onClose=function(){s.prototype.onClose.call(this)},i.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},i.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=d.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},i.prototype.check=function(){return!(!f||"__initialize"in f&&this.name===i.prototype.name)}},function(e,t){},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var a=0;a<e.length;++a)if(e[a]===t)return a;return-1}},function(e,t,n){"use strict";function a(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n(4),o=n(5),s=n(35),c=n(36),d=n(37),l=(n(3)("socket.io-client:socket"),n(27)),u=n(21);e.exports=a;var f={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=o.prototype.emit;o(a.prototype),a.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[c(e,"open",d(this,"onopen")),c(e,"packet",d(this,"onpacket")),c(e,"close",d(this,"onclose"))]}},a.prototype.open=a.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.reconnecting||this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},a.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},a.prototype.emit=function(e){if(f.hasOwnProperty(e))return p.apply(this,arguments),this;var t=s(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:u(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},a.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},a.prototype.onopen=function(){if("/"!==this.nsp)if(this.query){var e="object"===i(this.query)?l.encode(this.query):this.query;this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},a.prototype.onclose=function(e){this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},a.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===r.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},a.prototype.onevent=function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},a.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var a=s(arguments);t.packet({type:u(a)?r.BINARY_ACK:r.ACK,id:e,data:a})}}},a.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])},a.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},a.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},a.prototype.ondisconnect=function(){this.destroy(),this.onclose("io server disconnect")},a.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},a.prototype.close=a.prototype.disconnect=function(){return this.connected&&this.packet({type:r.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},a.prototype.compress=function(e){return this.flags.compress=e,this},a.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t){for(var n=[],a=(t=t||0)||0;a<e.length;a++)n[a-t]=e[a];return n}},function(e,t){"use strict";e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var a=n.call(arguments,2);return function(){return t.apply(e,a.concat(n.call(arguments)))}}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}}])}).call(this,n(3453).Buffer)}],Array(74),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("floodgate.appId")},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"TsInstrumentationProvider.key",loader:new i.t(function(){return n.e(528).then(n.bind(null,4137)).then(function(e){return e.resourceKey})})})}],Array(48),[function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(2202),i=n(142),r=function(){function e(e,t){this._itemProvider=t.itemProvider}return e.prototype.updateItemSetPostUpload=function(e,t,n){if(e&&t&&t.length>0){var a=e.item.peek().key,i=this._itemProvider.computeProjectedItemSet(a+"&state=postUpload",e,{parentKey:a,itemSetProjections:{PostUpload:{uploadedItems:t,group:n}}},!0);i&&e.content({groupings:i.content.peek().groupings,items:i.content.peek().items})}},e}(),o=Object(i.r)("PostUploadProjectionHelper",r,{itemProvider:a.resourceKey})}],Array(134),[function(e,t,n){"use strict";n.d(t,"S",function(){return it}),n.d(t,"x",function(){return dt}),n.d(t,"C",function(){return ft}),n.d(t,"k",function(){return pt.e}),n.d(t,"I",function(){return mt.e}),n.d(t,"O",function(){return _t.e}),n.d(t,"w",function(){return Ct}),n.d(t,"D",function(){return jn}),n.d(t,"a",function(){return Vn}),n.d(t,"v",function(){return zn}),n.d(t,"t",function(){return Gn}),n.d(t,"y",function(){return Kn}),n.d(t,"g",function(){return Wn}),n.d(t,"L",function(){return qn}),n.d(t,"M",function(){return wt}),n.d(t,"n",function(){return At}),n.d(t,"i",function(){return Qn}),n.d(t,"f",function(){return Ht}),n.d(t,"d",function(){return jt}),n.d(t,"e",function(){return Yn}),n.d(t,"u",function(){return en}),n.d(t,"s",function(){return an}),n.d(t,"c",function(){return fn}),n.d(t,"l",function(){return pn.e}),n.d(t,"A",function(){return Jn}),n.d(t,"E",function(){return Xn}),n.d(t,"p",function(){return $n}),n.d(t,"m",function(){return vn}),n.d(t,"_",function(){return yn}),n.d(t,"h",function(){return Mn}),n.d(t,"b",function(){return Tn}),n.d(t,"r",function(){return Hn}),n.d(t,"o",function(){return Nn});var a=n(0),i=n("react-lib"),r=n(330),o=n(969),s=n(2),c=n(57),d=n(80),l=n(12),u=n(55),f=n(37),p=n(1),m=n(295),_=n(7),h=n(45),b=n(31),g=n(121),v=n(14),y=Object(l.e)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(178).then(n.bind(null,5717))];case 1:return[2,e.sent().EditNewMenuAction]}})})},function(e,t){var n=t.itemKey;if(n){var a=e.demandItemFacet(b.e,n),i=a&&e.demandItemFacet(p.We,g.e.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl})),r=Object(h.e)(e,n),o=e.demandItemFacet(p.St,n),s=f.t.hasItemPermission({permissions:o},f.t.editListItems),c=Object(u.e)(e).itemsScopeItemKey,d=e.demandItemFacet(m.e,c);return!!r&&!r.isAnonymousGuestUser&&!(d&&d[_.n.queryParamKey])&&s&&!!i&&i.templateType!==v.t.webPageLibrary&&!!i.newWOPIDocumentEnabled}return!1})),S=n(5),D=Object(l.r)()(Object(l.a)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(171).then(n.bind(null,5718))];case 1:return[2,e.sent().AddToQuickLaunchAction]}})})},function(e,t){var n=t.itemKey;if(n){var a=e.demandItemFacet(S.m,n),i=e.demandItemFacet(p.mt,n),r=e.demandItemFacet(b.e,n);return!!a&&".aspx"===a.extension&&!i&&!!r&&-1!==r.listFullUrl.toLowerCase().indexOf("sitepages")}return!1}))),I=n(311),x=n(2408),C=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.OpenInOfficeOnlineAction))}),O=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.OpenInOfficeClientAction))}),w=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.ReportAbuseAction))}),E=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.RequestReviewAction))}),A=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.AddToBundleAction))}),L=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.RemoveFromBundleAction))}),k=Object(l.r)()(Object(l.a)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(183).then(n.bind(null,5719))];case 1:return[2,e.sent().MakeHomePageAction]}})})},function(e,t){var n=t.itemKey;if(n){var a=e.demandItemFacet(b.e,n),i=a&&e.demandItemFacet(p.We,g.e.serialize(a)),r=e.demandItem({permissions:p.St,isCheckedOut:S.y},n),o=r.permissions,s=r.isCheckedOut,c=f.t.hasItemPermission({permissions:o},f.t.manageWeb);return!!i&&i.templateType===v.n.webPageLibrary&&c&&!!s&&!s.byYou}return!1}))),M=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.RotateAction))}),P=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.OrderPrintsAction))}),T=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.EmbedAction))}),U=n(3085),F=n(2959);function H(e){return Object(U.e)(function(t){var n=t.consume(I.e);return new(t.injected(n.VaultAction))({actionType:e})})}var R=H(F.e.Unlock),N=H(F.e.Lock),B=H(F.e.ShowFiles),j=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.SurveyAction))({actionType:1})}),V=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.SurveyAction))({actionType:2})}),z=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.SurveyAction))({actionType:3})}),G=n(425),K=function(e){return function(t){var n=t.consume(I.e);return new(t.injected(n.CreateDocumentAction))({docType:e})}},W=Object(x.createItemsScopeActionFromKnockout)(K(G.e.Word)),q=Object(x.createItemsScopeActionFromKnockout)(K(G.e.Excel)),Q=Object(x.createItemsScopeActionFromKnockout)(K(G.e.PowerPoint)),Y=Object(x.createItemsScopeActionFromKnockout)(K(G.e.OneNote)),J=Object(x.createItemsScopeActionFromKnockout)(K(G.e.ExcelSurvey)),X=Object(x.createItemsScopeActionFromKnockout)(K(G.e.Text)),Z=n(2020),$=n(23),ee=n(22),te=n(173),ne=n(87),ae=n(47),ie=n(118),re=n(1264),oe=n(5099),se=n(62),ce=Object(ne.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(211)]).then(n.bind(null,5945))];case 1:return[2,e.sent().ReactListFormPanel]}})})}),de=Object(l.r)()(Object(ae.t)(function(e,t){var n,r=t.itemKeys,o=t.interActiveSave,s=t.resources,c=1===r.length?r[0]:void 0,d=e.demandItemFacet(S.f,c),l=e.demandItemFacet(b.e,c);e.dispatch(oe.e);var u,f,m,_=new Array;if(l&&(f=l.webAbsoluteUrl,m=l.listFullUrl,u=g.e.serialize({webAbsoluteUrl:f,listFullUrl:m})),n=e.dispatch(Object(ie.e)(function(e){return{contentTypes:(e.demandItemFacet(p.b,u)||[]).map(function(t){return e.demandItemFacet(p.vn,t)})}})),n)for(var h=n.contentTypes,v=0;v<h.length;v++){var y=h[v],D={displayName:y.displayName,templateUrl:y.templateUrl,contentTypeId:y.contentTypeId,requiredFields:y.requiredFields,Fields:y.Fields,cTypeId:y.cTypeId,description:y.description,iconUrl:y.iconUrl,ClientFormCustomFormatter:y.ClientFormCustomFormatter};_.push(D)}var I=e.dispatch(Object(ie.e)(function(e){return e.demandItemFacet(p.We,u)})),x=e.demandItemFacet(re.e,c),C=re.e.evaluate(x)(e,{itemKey:c}).getPropertiesForm,O=Object(ee.o)(function(e){return i.createElement(ce,Object(a.__assign)({},e,{contentTypes:_,onDismiss:function(){e.reject(new te.e)},itemKey:c,displayName:d,getPropertiesForm:C,isDisplayForm:o,listProps:{webAbsoluteUrl:f,listFullUrl:m,listId:I&&I.id,itemName:I&&I.title},resources:s}))});return i.createElement($.e,{onExecute:O,engagement:{name:"ReactLaunchListFormPanel",isIntentional:!0}})}));function le(e){var t=Object(se.n)();return i.createElement(de,Object(a.__assign)({resources:t},e))}var ue,fe=n(3815),pe=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.CreateMountPointAction))}),me=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.RemoveMountPointAction))}),_e=n(89),he=n(337),be=n(214),ge=n(279),ve=n(3),ye=Object(l.n)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(180).then(n.bind(null,5721))];case 1:return[2,e.sent().LaunchFormatViewPaneAction]}})})},function(e,t){var n=t.itemKey;if(n){var a=e.demandItemFacet(_e.e,n),i=a&&g.e.serialize(a),r=e.demandItemFacet(p.We,i);if(r&&r.templateType===v.t.mySiteDocumentLibrary)return!1;var o=!!r&&r.permissions,s=o&&!(!o.manageLists&&!o.managePersonalViews),c=Object(be.e)(e)===ge.e;if(a&&a.viewKey){var d=he.e.serialize(a.viewKey),l=e.demandItemFacet(p.g,d);if(Object(ve.Jr)(ve.Yt)){if(l&&s)return!0}else if(l&&s&&!c)return!0}}return!1})),Se=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.ApproveRejectAction))}),De=n(778),Ie=n(327),xe=n(269),Ce=n(73),Oe=n(426),we=n(43),Ee=n(134),Ae=n(805),Le=n(1682),ke=n(1683),Me=n(1687),Pe=n(270),Te=n(41),Ue=n(25),Fe=n(167),He=n(8),Re=n(142),Ne=new He.t({name:"".concat("FormatViewPaneAction.key",".executeFormatViewPaneActionResourceKey"),loader:new Re.t(function(){return Promise.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-datasources"),n.e("deferred.office-ui-fabric-react"),n.e(294)]).then(n.bind(null,5722))).then(function(e){return e.executeFormatViewPaneActionResourceKey})})}),Be=n(733),je=n(3728),Ve=n(593),ze=((ue={})[Ue.n.kanban]=!0,ue);function Ge(e){var t=this,n=Object(se.n)();return i.createElement($.e,{onExecute:function(){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.consumeAsync(Ne)];case 1:return[4,e.sent()({customizeCard:{designerState:je.e.TemplateEditor,selectedTemplateId:Ve.u}})];case 2:return e.sent(),[2]}})})}})}var Ke=Object(ae.t)(function(e){var t=Object(Te.e)(e),n=Object(Fe.e)(e,{itemSetKey:t}),a=e.demandItemFacet(p.Rn,n);return a&&ze[a]?i.createElement(Be.e,null,i.createElement(Ge,null)):null}),We=n(174),qe=n(152),Qe=n(148),Ye=n(611),Je=n(5091),Xe=n(489),Ze=n(399),$e=n(28),et=n(213),tt=Object(ae.t)(function(e,t){var n=t.itemKey,r=t.resources,s=e.demandItemFacet(p.Ye,n),c=Object(h.e)(e,n),d=c?c.layoutsUrl:"",l=c&&c.listId||"",u=c?c.webAbsoluteUrl:"",m="".concat(u,"/").concat(d,"/CreateDocSetVersion.aspx?")+Object(Xe.t)({list:l,ID:s||"",IsDlg:1}),_=function(e,t){var n=t.itemKey,a=t.resources;if(!n||!a)return!1;var i=Object(h.e)(e,n),r=e.demandItemFacet(p.St,n),o=e.demandItemFacet(Ze.e,n);if(!i||i.isEmailAuthenticationGuestUser||!f.e.hasItemPermission({permissions:r},f.e.editListItems)||o===et.e.ConditionalAccessBlocked||o===et.e.ConditionalAccessViewOnly)return!1;var s=e.demandItemFacet(b.e,n),c=s&&g.e.serialize(s),d=e.demandItemFacet(p.We,c);if(!(!!d&&!!d.enableVersions))return!1;var l=a.consume(Qe.c.optional);if(l){var u=e.demandItemFacet(S.i,n);if(l.getUrlParts({path:u}).isCrossDomain)return!1}var m=e.demandItemFacet(p.x,n),_=e.demandItemFacet(p.Ye,n);return!!(Object(we.isFeatureEnabled)(we.DocumentSetsModernView)&&Object(we.isFeatureEnabled)(we.UseItemsScopeInTeamSites)&&_&&m)}(e,{itemKey:n,resources:r}),v=Object(ee.o)(function(e){return i.createElement(Je.e,{url:m,heightOffset:.7,dialogContentProps:{title:o.CaptureVersion},onDismiss:function(){e&&e.resolve&&e.resolve()},onLoad:nt})});return i.createElement($.e,Object(a.__assign)({isAvailable:_,onExecute:v},Object($e.t)(e,{itemKey:n,engagement:{name:"CaptureVersion",isIntentional:!0}})))});function nt(e){new Ye.e(void 0).setTimeout(function(){if(e&&e.contentDocument){var t=e.contentDocument.body.clientHeight;t>0&&(e.style.height=t+"px")}},10)}var at=Object(l.r)()(Object(l.a)()(tt)),it={key:new s.e("CaptureVersion").id,name:o.CaptureVersion,action:i.createElement(function(){var e=Object(se.n)();return i.createElement(at,{resources:e})},null),iconProps:{iconName:"StackIndicator"}},rt=n(1599),ot=n(1600),st=(Object(a.__assign)(Object(a.__assign)({},ot.e),{action:i.createElement(Be.e,null,i.createElement(rt.e,null)),automationId:"detailsCommand"}),n(2019)),ct=n(65),dt={key:n(1069).e,name:o.Details,ariaLabel:ct.f,action:i.createElement(st.ShowInfoPaneAction,null),automationId:"detailsMenuCommand"},lt=n(1601),ut=n(1603),ft=Object(a.__assign)(Object(a.__assign)({},ut.e),{action:i.createElement(lt.e,null)}),pt=n(1564),mt=n(1565),_t=n(1275),ht=n(865),bt=Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(170).then(n.bind(null,5723))];case 1:return[2,e.sent().AddToOneDriveAction]}})})},function(e,t){var n=t.itemKey;return!!n&&!!e.demandItemFacet(S.h,n)}),gt=Object(l.r)()(Object(l.a)()(bt));new s.e("AddToOneDrive").id,o.CreateMountPoint,i.createElement(c.t,null,i.createElement(function(){var e=Object(se.n)();return i.createElement(gt,{resources:e})},null)),ht.e.Image,window.require.toUrl("odsp-media/images/addtoonedrive/a2od.svg");var vt=n(77),yt=n(58),St=Object(yt.e)("LaunchBusinessAppsSetupWizardCommand"),Dt=n(1659),It=Object(ne.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("deferred.office-ui-fabric-react"),n.e(380)]).then(n.bind(null,5724))];case 1:return[2,e.sent().LaunchBusinessAppsSetupWizardCoachmarkCommand]}})})}),xt={key:St,automationId:"launchBusinessAppsSetupWizardCommand",name:ct.D,action:i.createElement(Dt.e,null),iconProps:{iconName:"Warning"}},Ct=Object(a.__assign)(Object(a.__assign)({},xt),{commandBarButtonAs:Object(vt.e)().merge(It,xt.commandBarButtonAs)}),Ot=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.PreviewAction))}),wt={key:n(1689).e,name:o.Preview,automationId:"Preview",action:i.createElement(Ot,null)},Et=n(404),At={key:new s.e("ComplianceDetails").id,name:o.ComplianceDetails,action:i.createElement(fe.t,null),automationId:"complianceDetails",facets:Object(a.__assign)({},Et.e.pack(!0))},Lt=n(310),kt=n(1475),Mt=n(38),Pt=Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(177).then(n.bind(null,5725))];case 1:return[2,e.sent().CreateShortcutAction]}})})},function(e,t){var n=t.itemKey;if(!t.resources||!n)return!1;var a=e.demandItemFacet(b.e,n);if(a){var i=Lt.e.serialize({listFullUrl:a.listFullUrl,webAbsoluteUrl:a.webAbsoluteUrl}),r=e.demandItemFacet(p.St,n),o=f.t.hasItemPermission({permissions:r},f.t.insertListItems),s=e.demandItemFacet(p.Sn,i),c=Object(u.e)(e).itemsScopeItemKey,d=Object(Te.e)(e,c);if(d){var l=Object(kt.e)(e,d);return!!s&&!s.isAnonymousGuestUser&&!s.isEmailAuthenticationGuestUser&&Object(ve.Jr)(ve.fi)&&Object(ve.Jr)(ve.Si)&&o&&l===Mt.e.Files}}return!1}),Tt=Object(l.i)()(Pt),Ut=Object(l.e)()(Pt),Ft={key:n(1684).e,name:o.CreateShortcut,action:i.createElement(c.e,null,i.createElement(function(){var e=Object(se.n)();return i.createElement(Tt,{resources:e})},null)),iconProps:{iconName:"Globe"},facets:Object(a.__assign)({},p.Tt.pack(We.r))},Ht=Object(a.__assign)(Object(a.__assign)({},Ft),{action:i.createElement(function(){var e=Object(se.n)();return i.createElement(Ut,{resources:e})},null)}),Rt=n(2652),Nt=n(42),Bt=Object(l.r)()(Object(l.a)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(185).then(n.bind(null,5726))];case 1:return[2,e.sent().OpenInPowerBIAction]}})})},function(e,t){var n=t.itemKey;if(n){var a=e.demandItem({fileName:S.m,itemStatus:Ze.e,openUrl:S.L,permissions:p.St},n),i=a.fileName,r=a.itemStatus,o=a.openUrl,s=a.permissions,c=f.t.hasItemPermission({permissions:s},f.t.openItems),d=Object(u.e)(e).itemsScopeItemKey,l=Object(Te.e)(e,d);if(l){var m=Object(kt.e)(e,l);return Object(ve.Jr)(ve.it)&&!!i&&!!i.extension&&!!o&&(Object(Rt.e)(i.extension)===G.e.Excel||".csv"===i.extension.toLowerCase())&&r!==et.t.ConditionalAccessViewOnly&&r!==et.t.ConditionalAccessBlocked&&c&&!Object(Nt.w)(m)}}return!1}))),jt={key:n(1686).e,name:o.OpenInPowerBI,action:i.createElement(Bt,null),iconProps:{iconName:"PowerBILogo16"}},Vt=n(133);function zt(e){var t=this,i=e.isAvailable,r=e.getKnockoutAction,o=e.isToggled;return Object(d.e)(function(){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred.odsp-common"),n.e(808)]).then(n.bind(null,2408))];case 1:return[2,(0,e.sent().createItemsScopeActionFromKnockout)(r,{isExecutorOnly:!0})]}})})},i,o)}var Gt=n(177),Kt=n(106),Wt=n(15),qt=n(1351),Qt=n(115),Yt=n(107),Jt=n(594),Xt=n(6),Zt=new Xt.e("openInTextEditorAction",{isAvailable:Xt.t}),$t=zt({isAvailable:function(e,t){var n=Object(Vt.e)(e);if(1!==n.length)return!1;var a=n[0],i=e.demandItemFacet(Kt.e,a),r=e.demandItemFacet(Zt,Wt.c),o=Zt.evaluate(r)(e,{itemKey:a}).isAvailable;if(!i)return!1;var s=Object(Yt.e)(e);return!e.demandItemFacet(Jt.e,s)&&!!function(e,t){var n=e.demandItemFacet(S.m,t),a=null==n?void 0:n.extension;if(a)return!!Object(qt.t)(a)}(e,a)&&!Object(Qt.e)()&&!function(e){var t=e.demandItemFacet(Wt.u,Wt.c);if(t)return t.consume(Gt.e).isMobile}(e)&&o&&function(e,t){var n=e.demandItemFacet(Ze.e,t);return n!==et.t.ConditionalAccessViewOnly&&n!==et.t.ConditionalAccessBlocked}(e,a)},getKnockoutAction:function(e,t){var n=e.consume(I.e);return new(e.injected(n.OpenInTextEditorAction))}}),en={key:n(1685).e,name:o.OpenInTextEditor,action:i.createElement($t,null),iconProps:{iconName:"Edit"}},tn=n(4440),nn=zt({isAvailable:function(e,t){var n=Object(Vt.e)(e)[0];if(n){var a=e.demandItem({fileName:S.m},n).fileName;return Object(tn.e)(a)}return!1},getKnockoutAction:function(e,t){var n=e.consume(I.e);return new(e.injected(n.OpenInClipChampAction))}}),an={key:Object(yt.e)("openInClipChamp"),name:o.OpenInClipChamp,action:i.createElement(nn,null)},rn=n(108),on=n(464),sn=n(11),cn=n(126),dn=new rn.e,ln=Object(ae.t)(function(e,t){var r=t.itemKey,o=Object(h.e)(e,r),s=!sn.e.isActivated("2155219B-D6C5-409E-A5A2-45340C720D12","09/01/2021","Edge view in file explorer")&&o&&o.viewInFileExplorer,c=dn.isIE||s,d=!1,l=void 0;if(c){var u=e.demandItemFacet(b.e,r),f=u&&g.e.serialize(u),m=f&&e.demandItemFacet(p.We,f),_=e.demandItemFacet(p.he,r);u&&_&&(l=s?"viewinfileexplorer:".concat(new cn.e(u.listFullUrl).authority).concat(_):"".concat(u.listFullUrl,"?").concat(Object(on.e)({rootFolder:_,ExplorerWindowUrl:_}))),c=!(!l||!m||!m.isDocumentLibrary||m.templateType===v.n.webPageLibrary||!o||o.viewOnlyExperienceEnabled||o.blockDownloadsExperienceEnabled),d=!!m&&m.templateType===v.n.mySiteDocumentLibrary}return i.createElement($.e,Object(a.__assign)({isAvailable:c,onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(184).then(n.bind(null,5727))];case 1:return(0,e.sent().openInExplorerExecutor)({isODB:d,explorerWindowUrl:l,useEdgeProtocolHandler:s}),[2]}})})}},Object($e.t)(e,{itemKey:r,engagement:{name:"OpenInExplorer",isIntentional:!0}})))}),un=Object(l.e)()(ln),fn={key:new s.e("OpenInExplorer").id,name:o.OpenInExplorer,action:i.createElement(un,null),iconProps:{iconName:void 0,styles:{root:{display:"none!important"}}}},pn=n(1575),mn=n(3165),_n=Object(l.r)()(Object(l.a)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(190).then(n.bind(null,5728))];case 1:return[2,e.sent().TeamChannelAction]}})})},function(e,t){var n=t.itemKey,a=Object(u.e)(e).itemsScopeItemKey,i=Object(Te.e)(e,a),r=e.demandItemFacet(_e.e,i),o=e.demandItemFacet(b.e,n);if(!r)return!1;if(Object(Qt.n)())return!1;var s=b.e.serialize({itemId:o?o.itemId:"",listFullUrl:r.listFullUrl,rootFolder:r.rootFolder,webAbsoluteUrl:r.webAbsoluteUrl}),c=e.demandItemFacet(p.Pt,s)||"",d=Lt.e.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl}),l=e.demandItemFacet(p.Sn,d);return Object(mn.t)(l)?Object(mn.n)():Object(mn.n)()&&Object(mn.e)(c)}))),hn=n(434),bn=n(5182),gn=n(1301),vn={key:gn.t,name:o.Channel,action:i.createElement(_n,null),iconProps:Object(a.__assign)(Object(a.__assign)({},Object(hn.t)({extension:"",brand:"teams",size:16})),{styles:{root:{width:"16px",height:"16px",selectors:{img:{width:"16px",height:"16px",display:"block"}}}}})},yn={key:gn.e,name:o.Channel,action:i.createElement(bn.e,null),iconProps:Object(a.__assign)(Object(a.__assign)({},Object(hn.t)({extension:"",brand:"teams",size:16})),{styles:{root:{width:"16px",height:"16px",selectors:{img:{width:"16px",height:"16px",display:"block"}}}}})},Sn=n(459),Dn=n(1328),In=n(387),xn=n(94),Cn=n(734),On=n(317),wn=new rn.e;function En(e,t){var n=Object(On.e)(e);if(n&&t.itemKey){var a=function(e,t){var n=t.itemKey,a=e.demandItemFacet(Sn.e,n)||e.demandItemFacet(Cn.e,n)||e.demandItemFacet(_e.e,n)||e.demandItemFacet(b.e,n);if(!a)return{};var i=Object(On.e)(e);return i&&i.webAbsoluteUrl===a.webAbsoluteUrl?{}:{itemKey:Sn.e.serialize(a)}}(e,{itemKey:t.itemKey}).itemKey;if(a){var i=Sn.e.deserialize(a).webAbsoluteUrl;return new In.e({},{pageContext:n}).getUrlParts({webUrl:i}).geoRelation===xn.e.crossGeo}}return!1}var An=Object(l.i)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(191).then(n.bind(null,5729))];case 1:return[2,e.sent().UploadFileAction]}})})},function(e,t){return wn.isHtml5FileUploadSupported&&Object(Dn.e)(e,t)&&!En(e,t)})),Ln=Object(l.i)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(191).then(n.bind(null,5729))];case 1:return[2,e.sent().UploadFolderAction]}})})},function(e,t){return wn.isFolderUploadSupported&&Object(Dn.e)(e,t)&&!En(e,t)})),kn=n(1304),Mn=Object(a.__assign)(Object(a.__assign)({},kn.e),{name:o.UploadFile,action:i.createElement(c.e,null,i.createElement(An,null))}),Pn=n(1713),Tn=Object(a.__assign)(Object(a.__assign)({},Pn.e),{name:o.UploadFolder,action:i.createElement(c.e,null,i.createElement(Ln,null))}),Un=n(4221),Fn=Object(l.r)()(Object(l.a)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(175).then(n.bind(null,5730))];case 1:return[2,e.sent().CreateFileRequestAction]}})})},function(e,t){if(!Object(we.isFeatureEnabled)(we.FileRequestUI))return!1;var n=t.itemKey,a=e.demandItemFacet(b.e,n);if(!a)return!1;var i=Object(Te.e)(e);if(!e.demandItemFacet(_e.e,i))return!1;if(e.demandItemFacet(p.it,n))return!1;if(!e.demandItemFacet(S.h,n))return!1;var r=g.e.serialize(a),o=e.demandItemFacet(p.We,r);if(!o)return!1;if(o.templateType!==v.n.mySiteDocumentLibrary)return!1;var s=Object(h.e)(e,n);if(!s)return!1;if(Object(we.isFeatureEnabled)(we.PreferIsMySiteOwner)?!s.isMySiteOwner:!s.isSiteOwner)return!1;if(s.isEmailAuthenticationGuestUser)return!1;if(s.farmSettings&&s.farmSettings.ExternalService_filerequestenable&&"0"===s.farmSettings.ExternalService_filerequestenable)return!1;if(Object(we.isFeatureEnabled)(we.EnableRequestFilesLink)){if(!s.requestFilesLinkEnabled)return!1}else if(!s.isShareByLinkEnabled||s.FolderAnonymousLinkPermission!==Un.e.Uninitialized&&s.FolderAnonymousLinkPermission!==Un.e.AnonymousEdit)return!1;return!0}))),Hn={key:new s.e("FileRequest").id,name:o.CreateFileRequest,action:i.createElement(Fn,null),iconProps:{iconName:"FileRequest"}},Rn=n(552),Nn={key:n(1688).e,name:o.ManageAccess,action:i.createElement(c.t,null,i.createElement(Rn.ManageAccessAction,null)),iconProps:{iconName:"PlayerSettings"},automationId:"manageAccessCommand"},Bn={iconName:void 0,styles:{root:{display:"none!important"}}},jn={key:new s.e("CopyField").id,name:o.CopyField,action:i.createElement(Z.CopyFieldAction,null),preferMenuTargetAsEventTarget:!0,automationId:"copyFieldCommand"},Vn=Ee.n.isFeatureEnabled(we.ReactEditItemPanel)?{key:new s.e("ReactEditProperties").id,name:o.editProperties,action:i.createElement(le,null),iconProps:{iconName:"Edit"},automationId:"ReactEditProperties"}:{key:Ae.n,name:o.editProperties,action:i.createElement(Z.EditItemAction,null),iconProps:{iconName:"Edit"},automationId:"editProperties",facets:Object(a.__assign)({},p.Tt.pack(We.s))},zn=Ee.n.isFeatureEnabled(we.ReactEditItemPanel)?{key:new s.e("ReactEditProperties").id,name:"Open",action:i.createElement(le,{interActiveSave:!0}),iconProps:{iconName:"Edit"},automationId:"ReactEditProperties"}:{key:Ae.i,name:o.Open,action:i.createElement(Z.ViewItemAction,null),automationId:"viewItemCommand"},Gn={key:Ae.t,name:o.commentCommandText,action:i.createElement(Z.ViewItemAction,{preferredSection:"comments"}),iconProps:{iconName:"Comment"},engagement:{name:"CommentItemCommand",isIntentional:!0,usageType:"Click"},automationId:"CommentItemCommand",facets:Object(a.__assign)({},p.Tt.pack(We.t))},Kn={key:Ae.e,name:o.viewProperties,action:i.createElement(Z.EditItemAction,{isBulkEdit:!0}),iconProps:{iconName:"Edit"},facets:Object(a.__assign)({},p.Tt.pack(qe.g))},Wn={key:Ae.a,name:o.viewProperties,action:i.createElement(Z.ViewItemAction,null),iconProps:{iconName:"Edit"},facets:Object(a.__assign)({},p.Tt.pack(qe.g))},qn={key:new s.e("MakeHomePage").id,name:o.MakeHomepage,action:i.createElement(k,null),iconProps:{iconName:"Home"}},Qn=(new s.e("rotate").id,o.rotate,i.createElement(M,null),new s.e("orderPrints").id,o.OrderPrints,i.createElement(P,null),new s.e("embed").id,o.Embed,i.createElement(T,null),new s.e("vaultLock").id,o.LockVault,i.createElement(c.t,null,i.createElement(N,null)),new s.e("vaultUnlock").id,o.unlock,i.createElement(R,null),new s.e("vaultShowFiles").id,o.unlock,i.createElement(B,null),new s.e("createMountPoint").id,o.CreateMountPoint,i.createElement(pe,null),new s.e("removeMountPoint").id,o.RemoveMountPoint,i.createElement(me,null),new s.e("addToBundle").id,o.addToBundle,i.createElement(A,null),new s.e("removeFromBundle").id,o.removeFromBundle,i.createElement(L,null),new s.e("reportAbuse").id,o.reportConcern,i.createElement(w,null),new s.e("requestReview").id,o.requestReview,i.createElement(E,null),new s.e("ApproveReject").id,o.ApproveReject,i.createElement(Se,null),{key:new s.e("EditRenditions").id,name:o.EditRenditions,action:i.createElement(fe.n,null)}),Yn=(new s.e("createWord").id,xe.c,i.createElement(c.e,null,i.createElement(W,null)),Object(Ie.e)({extension:"docx",size:16}),new s.e("createExcel").id,xe.e,i.createElement(c.e,null,i.createElement(q,null)),Object(Ie.e)({extension:"xlsx",size:16}),new s.e("createPowerPoint").id,xe.o,i.createElement(c.e,null,i.createElement(Q,null)),Object(Ie.e)({extension:"pptx",size:16}),new s.e("createOneNote").id,xe.r,i.createElement(c.e,null,i.createElement(Y,null)),Object(Ie.e)({extension:"onetoc",size:16}),new s.e("createExcelSurvey").id,xe.a,i.createElement(c.e,null,i.createElement(J,null)),Object(Ie.e)({type:r.e.form,size:16}),new s.e("createTextFile").id,o.CreateText,i.createElement(c.e,null,i.createElement(X,null)),Object(Ie.e)({extension:"txt",size:16}),new s.e("shareSurvey").id,o.shareSurvey,i.createElement(c.e,null,i.createElement(j,null)),new s.e("viewSurvey").id,o.viewSurvey,i.createElement(c.e,null,i.createElement(V,null)),new s.e("editSurvey").id,o.editSurvey,i.createElement(c.e,null,i.createElement(z,null)),new s.e("survey").id,{key:Me.e,name:o.AddToQuickLaunch,action:i.createElement(D,null),iconProps:{iconName:"Pin"}}),Jn=(new s.e("openInOfficeOnline").id,i.createElement(C,null),Object(a.__assign)({},Ce.t.pack(!0)),new s.e("openInOfficeClient").id,i.createElement(O,null),Object(a.__assign)({},Ce.t.pack(!0)),Oe.e.key,Oe.e.automationId,Object(a.__assign)({},Ce.t.pack(!0)),{key:Le.e,name:o.FormatView,action:i.createElement(ye,null),iconProps:Bn,automationId:"launchFormatViewPaneCommand",facets:Object(a.__assign)(Object(a.__assign)({},Pe.t.pack(!0)),Pe.n.pack(!0))}),Xn={key:ke.e,name:o.CustomizeCard,action:i.createElement(c.e,null,i.createElement(Ke,null)),iconProps:Bn,automationId:"launchCustomizeCardPaneCommand",facets:Object(a.__assign)(Object(a.__assign)({},Pe.t.pack(!0)),Pe.n.pack(!0))},Zn={key:De.e,name:o.editNewMenu,action:i.createElement(c.e,null,i.createElement(y,null)),iconProps:{iconName:"Edit"},facets:Object(a.__assign)({},p.Tt.pack(We.c))},$n=Object(a.__assign)(Object(a.__assign)({},Zn),{action:i.createElement(y,null)})}],Array(26),[function(e,t,n){"use strict";n.r(t),n.d(t,"useOneUpTextEditorResourceKey",function(){return j}),n.d(t,"supportsOneUpResourceKey",function(){return V}),n.d(t,"resourceKey",function(){return G});var a,i=n(0),r=n(1203),o=n(38),s=n(91),c=n(489),d=n(40),l=n(101);!function(e){e[e.iosappstore=0]="iosappstore"}(a||(a={}));var u=a,f=n(79),p=n(37),m=n(7),_=n(4805),h=n(43),b=n(3846),g=n(1214),v=n(3444),y=n(1914),S=n(157),D=n(76),I=n(393),x=n(2424),C=n(148),O=n(147),w=n(177),E=n(846),A=n(2714),L=n(8),k=n(142),M=n(2192),P=n(302),T=n(42),U=n(11),F=n(1715),H=n(4420),R=n(158),N=n(93),B=n(197),j=new L.t({name:"".concat("UrlDataSource",".useOneUpTextEditor"),factory:new L.e(Object(h.isFeatureEnabled)(h.UseOneUpTextEditor))}),V=new L.t({name:"".concat("UrlDataSource",".supportsOneUp"),factory:new L.e(!0)}),z=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.navigation,r=void 0===i?a.resources.consume(O.e):i,o=n.platform,s=void 0===o?a.resources.consume(w.e):o,l=n.pageContext,u=void 0===l?a.resources.consume(d.f):l,f=n.itemUrlHelper,p=void 0===f?a.resources.consume(C.c):f,_=n.itemParentHelper,h=void 0===_?a.resources.consume(M.e):_,b=n.useOneUpTextEditor,g=void 0===b?a.resources.consume(j):b,v=n.supportsOneUp,y=void 0===v?a.resources.consume(V):v,S=n.urlDataSourceLite,D=void 0===S?a.resources.consume(P.resourceKey):S,I=n.getDefaultClickUrl,x=void 0===I?a.resources.consume(F.e):I;return a._navigation=r,a._platform=s,a._pageContext=u,a._itemUrlHelper=p,a._itemParentHelper=h,a._useOneUpTextEditor=g,a._supportsOneUp=y,a._urlDataSourceLite=D,a._getDefaultClickUrl=x,Object(N.d)()||Object(N.l)()||function(e,t){void 0===t&&(t=R.e);var n=(new H.e).removeState(m.n.windowNameJsonKey);n&&(t.logData({name:"Picker.UpdateViewParamsFromWindowName"}),e.navigateTo("?".concat(Object(c.t)(n))),e.updateViewParams(n,{ignoreHistory:!0,clearOtherParams:!1}))}(a._navigation),a}return Object(i.__extends)(t,e),t.getKey=function(e,t){return P.default.getKey(e,t)},t.getKeyParams=function(e){return P.default.getKeyParams(e)},t.getQueryUrl=function(e,t){var n={};return e!==s.e.Files&&(n[m.n.pageParamKey]=e),n[m.n.queryTypeParamKey]="".concat(t||""),"#"+c.t(n,null,!0)},t.prototype.getDefaultRootItemId=function(){return this._urlDataSourceLite.getDefaultRootItemId()},t.prototype.getQueryType=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(T.b)(e)},t.prototype.getDisableQueryAlteration=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(T.n)(e)},t.prototype.getMetadataSearchId=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(T.m)(e)},t.prototype.getPageType=function(e){return void 0===e&&(e=this._navigation.viewParams),this._urlDataSourceLite.getPageType(e)},t.prototype.isCurrentQuery=function(e,t){return void 0===t&&(t=this._navigation.viewParams),e===this.getQueryType(t)},t.prototype.isRecycleBin=function(e){return Object(T.w)(e)},t.prototype.getKey=function(e){return this._urlDataSourceLite.getKey(e)},t.prototype.getKeyParams=function(e){return t.getKeyParams(e)},t.prototype.getFocusItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(T.o)(e)||null},t.prototype.getViewerType=function(e){return function(e){var t=e[m.n.viewerKey];switch(t){case"3d":case"Audio":case"Error":case"FileHandler":case"Html":case"OnePlayerVideo":case"OnePlayerAudio":case"Other":case"Panorama":case"Image360":case"Pdf":case"MSPdf":case"Photo":case"TextFile":case"Thumbnail":case"Video":case"WAC":case"Wrs":case"Zip":return t}}(e)},t.prototype.saveViewerType=function(e){return function(e){var t;return(t={})[m.n.viewerKey]=e,t}(e)},t.prototype.getCurrentItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),this._urlDataSourceLite.getCurrentItemKey(e)},t.prototype.areKeysEqual=function(e,t){var n=this.getKeyParams(e),a=this.getKeyParams(t);return delete n[m.n.listUrlKey],delete a[m.n.listUrlKey],delete n[m.n.uniqueParamKey],delete a[m.n.uniqueParamKey],this.getKey(n)===this.getKey(a)},t.prototype.getRootItemKey=function(e){return void 0===e&&(e=o.e.Files),this._urlDataSourceLite.getRootItemKey(e)},t.prototype.getQueryUrl=function(e,n){return t.getQueryUrl(e,n)},t.prototype.getSearchQueryUrl=function(e){return Object(T.S)(e)},t.prototype.getQueryParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e[m.n.queryParamKey]},t.prototype.getIdParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e[m.n.idParamKey]},t.prototype.getListUrlParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(T.p)(e)},t.prototype.getSearchScopeParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(T.D)(e)},t.prototype.getCommentIdParamValue=function(e){void 0===e&&(e=this._navigation.viewParams)},t.prototype.isItemCrossList=function(e){return Object(C.i)(e,this._itemUrlHelper)},t.prototype.getSearchItemId=function(e){return Object(C.a)(e,this._itemUrlHelper)},t.prototype.isSearchItemOdbRoot=function(e){return Object(C.s)(e,this._itemUrlHelper)},t.prototype.isSPSiteRoot=function(e){return Object(C.o)(e,this._itemUrlHelper)},t.prototype.isSPListRoot=function(e){return Object(C.r)(e,this._itemUrlHelper)},t.prototype.getLayoutContentType=function(e){return void 0===e&&(e=this._navigation.viewParams),""},t.prototype.getItemTypeFilter=function(e){return Object(T.d)(e)},t.prototype.saveItemTypeFilter=function(e){void 0===e&&(e={filters:[]});for(var t=[],n=0,a=e.filters;n<a.length;n++){var i=a[n];"string"==typeof i?t.push(i):t.push(I.e[i])}var r=t.join(","),o={};return r&&(o[m.n.typeFiltersKey]=r),o},t.prototype.getUsersFilter=function(e){var t=e[m.n.userFiltersKey];return t&&t.split(";#")},t.prototype.saveUsersFilter=function(e){var t={};return t[m.n.userFiltersKey]=e&&e.join(";#"),t},t.prototype.getDateDurationFilter=function(e){return e[m.n.dateFilterKey]},t.prototype.saveDateDurationFilter=function(e){var t={},n="string"==typeof e?e:x.e[e];return t[m.n.dateFilterKey]=n,t},t.prototype.getOwnerId=function(){return""},t.prototype.getRootUrl=function(){return this._pageContext&&this._pageContext.listUrl||"/"},t.prototype.getSharedByUrl=function(e,t,n){return""},t.prototype.getExternalUrl=function(e){return"/externalredirector?alias="+u[e]},t.prototype.getAppSubfolder=function(){return"odb"},t.prototype.getUploadStorageUrl=function(e,t){return""},t.prototype.getTaggingOptionsUrl=function(){return""},t.prototype.getAllPhotosForPlaceUrl=function(e,t){return""},t.prototype.getSearchFilterQueryUrl=function(e){return""},t.prototype.isSearchFilterApplied=function(e){return!1},t.prototype.isSearchPassThrough=function(){return!1},t.prototype.getItemHintRedirectViewParams=function(e){return e},t.prototype.getDefaultClickUrl=function(e,t){var n,a=this;if(void 0===t&&(t={}),!e||!e.key)return"";var r=t.viewParams,o=void 0===r?this._navigation.viewParams:r,s=t.urlType,d=t.itemSet,l=t.parentItem,u=t.page,f=void 0===u?this.getPageType(o):u,p={},h=this._itemUrlHelper.getItemUrlParts(e.key),b=this._itemUrlHelper.getUrlParts({path:o[m.n.idParamKey],listUrl:o[m.n.listUrlKey]}),g=h.fullListUrl!==b.fullListUrl;if(!U.e.isActivated("EDCD3724-11E2-4CD4-A7E2-607D9D0B8440","10/26/2021","Copy view params")&&(U.e.isActivated("81A798A6-1C14-40C3-BD52-2A60351DCF87","11/8/2021","Only preserve view id when navigating within same list")||!g))for(var v=0,y=Object.keys(o);v<y.length;v++){var S=y[v];(m.a.test(S)||S===m.n.viewIdKey||S===m.n.sortFieldKey||S===m.n.groupByKey)&&(p[S]=o[S])}!Object(T.O)()&&this._isSearchView(o)&&(p=Object(i.__assign)(Object(i.__assign)({},p),this._getAdditionalSearchFilterParams(o))),t.additionalViewParams&&Object(B.e)(p,t.additionalViewParams);var D=Object(T.g)(o);if(D){var I=null===(n=D.remoteSpItem)||void 0===n?void 0:n.webAbsoluteUrl;I&&h.fullWebUrl===I&&(e=Object(i.__assign)(Object(i.__assign)({},e),{key:c.t(Object(i.__assign)(Object(i.__assign)({},c.e(e.key)),Object(T.E)(D)))}))}var x,C=this._getItemQueryParams(e.key,{viewParams:o}),O=d&&d.item.peek();x=l||O&&O.key!==e.key&&O||e.UNSAFE_parent,!Object(T.O)()&&p&&Object(B.e)(C,p);var w=Object(_.e)(e)?this.getOpenInOfficeOnlineUrl(e,o,{}):void 0,E={itemKey:e.key,viewParams:o,itemUrlHelper:this._itemUrlHelper,pageContext:this._pageContext,useOneUpTextEditor:this._useOneUpTextEditor,isDocSet:e.isDocSet,listId:this._listContext()&&this._listContext().listId,listItemId:e.properties&&e.properties.ID,itemType:e.type,itemList:e.list,itemOpenUrl:e.openUrl,itemOpenInOfficeOnlineUrl:w,itemPreviewIFrameUrl:e.previewIFrameUrl,itemQueryType:e.queryType,itemOfficeBundle:e.officeBundle,itemContentTypeId:e.contentTypeId,itemUrls:e.urls,itemSubsite:e.subsite,itemExtension:e.extension,itemFSObjType:e.properties&&e.properties.FSObjType,itemTranslationLanguages:e.properties&&e.properties._SPTranslatedLanguages,isUnifiedAppSupportedFile:Object(_.e)(e),welcomePageCustomized:e.properties&&e.properties.WelcomePageCustomized,getMediaUrl:function(){return a._getMediaUrl(e,{params:C,parentItem:x,page:f,isSearch:a._isSearchView(o)})},parentItemKey:x&&x.key,parentItemLink:e.parentLink,supportsOneUp:this._supportsOneUp,urlType:s,defaultRootItemId:this.getDefaultRootItemId(),additionalViewParams:p,page:f};return this._getDefaultClickUrl(E)},t.prototype.getTagUrl=function(e){return""},t.prototype.getRecycleBinQueryUrl=function(){return"".concat(this._pageContext.webAbsoluteUrl,"/").concat(this._pageContext.layoutsUrl,"/AdminRecycleBin.aspx?mysite=1")},t.prototype.getRecentQueryUrl=function(){return this.getQueryUrl(this.getPageType(),o.e.Recent)},t.prototype.getDateTimeControlIframeUrl=function(){return"".concat(Object(S.s)(this._pageContext),"/").concat(this._pageContext.layoutsUrl,"/iframe.aspx")},t.prototype.getNewFormRichTextEditorIFrameUrl=function(e,t,n){var a=t?"&ContentTypeId="+t:"",i=n?this.getKeyParams(n)[m.n.idParamKey]:this._navigation.viewParams.RootFolder,r=i?"&RootFolder="+D.e.encodeURIComponent(i):"";return"".concat(this._listContext().listUrl,"/NewForm.aspx?OnlyIncludeOneField=").concat(e)+"&ClientFormOverwriteSave=1&IsDlg=1".concat(a).concat(r)},t.prototype.getEditFormRichTextEditorIFrameUrl=function(e,t,n){var a=n?this.getKeyParams(n)[m.n.idParamKey]:this._navigation.viewParams.RootFolder,i=a?"&RootFolder="+D.e.encodeURIComponent(a):"";return"".concat(this._listContext().listUrl,"/EditForm.aspx?OnlyIncludeOneField=").concat(e)+"&ID=".concat(t,"&IsDlg=1").concat(i)},t.prototype.getEditFormUrl=function(e){return this._getListItemFormUrl(this._listContext().editFormUrl,e)},t.prototype.getDisplayFormUrl=function(e){return this._getListItemFormUrl(this._listContext().displayFormUrl,e)},t.prototype.getOneDriveAppsUrl=function(){return"https://www.onedrive.com/download"},t.prototype.handleFatalErrorDuringViewLoad=function(){},t.prototype.getAutoActionType=function(e){return v.t.none},t.prototype.getPhotoType=function(e){return null},t.prototype.getItemUrl=function(e){void 0===e&&(e="");var t=this._itemUrlHelper.getItemUrlParts(e);return E.e(t.fullItemUrl)},t.prototype.qualifyUrl=function(e){var t;if(0===e.indexOf("#")){var n=e.substring(1);t="".concat(this.getCurrentPageBaseUrl()).concat(window.location.pathname).concat(n?"?".concat(n):"")}else t=e;return t},t.prototype.getNavLinkClickUrl=function(e){return""},t.prototype.getApiName=function(){return"Vroom"},t.prototype.getApiBaseUrl=function(e){return this._urlDataSourceLite.getApiBaseUrl(e)},t.prototype.getSearchByDateFilterQueryUrl=function(e){return""},t.prototype.isSearchByDateFilterApplied=function(e){return!1},t.prototype.getResourcePreloadUrl=function(){return""},t.prototype.getHipCheckUrl=function(){return""},t.prototype.getVerifyAccountUrl=function(){return""},t.prototype.getCurrentPageBaseUrl=function(){return Object(T.t)()},t.prototype.getCurrentSiteUrl=function(){return this._pageContext.webAbsoluteUrl},t.prototype.getOpenInOfficeOnlineUrl=function(e,t,n){void 0===n&&(n={});var a,i=n.useDefaultAction,r=void 0!==i&&i,o=A.n(e),s=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return a="ms-word"!==(e.appMap?e.appMap.toLowerCase():void 0)?Object(_.e)(e)?y.e.GetWopiDocEditUrl(o,s&&s.list.id||"",this._pageContext.env):!r&&y.e.GetWopiFrameEditUrl(o):Object(_.e)(e)?!r&&y.e.GetWopiDocEditUrl(o,s&&s.list.id||"",this._pageContext.env):!r&&y.e.GetWopiFrameEditUrl(o),this._ensureLayouts15(a||e.openUrl)},t.prototype.getOpenInOfficeClientUrl=function(e,t,n){var a=e.appMap,i=e.properties&&e.properties.path||this.getItemUrl(e.key),r=e.extension||"",s=-1!==[".jpg",".jpeg",".bmp",".png",".gif",".onetoc2",".one",".odc"].indexOf(r.toLowerCase()),c=e.queryType===o.e.SharedWithMe&&("ms-word"===e.appMap||"ms-powerpoint"===e.appMap),d=p.e.hasItemPermission(e,p.e.editListItems)&&!s&&(!g.e(e)||g.n(e,this._pageContext.userId))||c;return b.e(a,i,d?b.t.Edit:b.t.View,"",this._platform.isChrome&&this._platform.isMac,this._pageContext.isSPO)},t.prototype.getOpenTemplateInOfficeClientUrl=function(e,t){return b.e(e,t,b.t.Edit,"",this._platform.isChrome&&this._platform.isMac,this._pageContext.isSPO)},t.prototype.getNewInOfficeClientUrl=function(e,t,n){return b.e(e,t,b.t.New,n,this._platform.isChrome&&this._platform.isMac,this._pageContext.isSPO)},t.prototype.getNewPlaceholderItemKey=function(){var e;return c.t(((e={})[m.n.idParamKey]="placeHolder ".concat(t.placeholderId++),e))},t.prototype.getWACResourcesPreloadUrl=function(){return"".concat(this.getWebUrl(),"/").concat(this.getLayoutsUrl(),"/wopihiddenframe.aspx")},t.prototype.getWopiDocUrl=function(){return"".concat(this.getWebUrl(),"/").concat(this.getLayoutsUrl(),"/doc.aspx")},t.prototype.getMyRestorePageUrl=function(){var e=this;return this.resources.consumeAsync(l.ve).then(function(e){return e.getMyOneDriveUrl()}).then(function(t){return"".concat(t,"/").concat(e.getLayoutsUrl(),"/onedrive.aspx?p=").concat(s.e.Restore)})},t.prototype.getTextEditorItemUrl=function(e,t){var n=t.parentItem,a=t.viewParams,i=this._getItemQueryParams(e.key,{viewParams:a}),r=n||e.UNSAFE_parent,o=c.e(r&&r.key||""),d=o[m.n.idParamKey];if("root"===d){var l=c.e(e.key)[m.n.listUrlKey];l&&(d=l)}i[m.n.parentIdParamKey]=d,i[m.n.parentQueryTypeParamKey]=o[m.n.queryTypeParamKey],i[m.n.pageParamKey]=s.e.TextFileEditor,delete i[m.n.queryTypeParamKey];var u="";return!this._supportsOneUp&&e.parentLink?(delete i[m.n.parentQueryTypeParamKey],u=e.parentLink,"".concat(e.parentLink,"?").concat(c.t(i,null,!0))):(Number(a[m.n.pageParamKey])!==s.e.TextFileEditor&&(u=this.getCurrentPageBaseUrl()+window.location.pathname),"".concat(u).concat(u?"?":"#").concat(c.t(i,null,!0)))},t.prototype.getClipChampUrl=function(e){var t=this._pageContext.webAbsoluteUrl,n="".concat(t,"/_layouts/15/videoeditor.aspx?action=edit");if(!e)return n;var a=this._itemUrlHelper.getItemUrlParts(e.key);return"".concat(n,"&id=").concat(a.serverRelativeItemUrl)},t.prototype.getCanonicalUrl=function(e){return this.getItemUrl(e)},t.prototype.getLayoutsUrl=function(){return this._pageContext.layoutsUrl},t.prototype._listContext=function(){var e=this.resources.consume(d.o);return this._listContext=function(){return e},e},t.prototype.getWebUrl=function(){return this._pageContext.webAbsoluteUrl},t.prototype._getListItemFormUrl=function(e,t){if(!this._listContext().listUrl||!e)return"";var n,a,i;t&&t.properties&&(n=t.properties.ID,a=t.properties.ContentTypeId,i=this.getKeyParams(t.parentKey)[m.n.idParamKey]);var r={Source:D.e.encodeURIComponent(window.location.href),RootFolder:D.e.encodeURIComponent(i||this._listContext().folderPath)};n&&(r[m.n.listItemIdKey]=n),a&&(r[m.n.contentTypeId]=a);var o=new f.t(e);for(var s in r)r.hasOwnProperty(s)&&o.setQueryParameter(s,r[s]);return o.toString()},t.prototype._ensureLayouts15=function(e){return e&&-1!==e.toLowerCase().indexOf("/_layouts/doc.aspx?")&&(e=(e=e.toLowerCase()).replace("/_layouts/doc.aspx","/_layouts/15/doc.aspx")),e},t.prototype._getItemQueryParams=function(e,t){var n=t.viewParams,a=void 0===n?this._navigation.viewParams:n,r=(t.currentViewId,c.e(e));delete r[m.n.uniqueParamKey];var s=Object(i.__assign)({},a);return delete s[m.n.idParamKey],delete s[m.n.rootFolderParamKey],delete s[m.n.queryTypeParamKey],delete s[m.n.queryParamKey],delete s[m.n.listUrlKey],delete s[m.n.typeFiltersKey],Object(T.O)()||(delete s[m.n.dateFilterKey],delete s[m.n.userFiltersKey]),delete s[m.n.remoteItem],Object(B.e)(s,r),delete s[m.n.parentIdParamKey],delete s[m.n.parentQueryTypeParamKey],delete s[m.n.pageParamKey],r[m.n.idParamKey]===this.getDefaultRootItemId()&&(delete s[m.n.idParamKey],delete s[m.n.rootFolderParamKey]),s[m.n.listUrlKey]===a[m.n.listUrlKey]&&this.getQueryType(r)===o.e.Files&&(this._pageContext.viewId||"").replace("{","").replace("}","")!==s[m.n.viewIdKey]||delete s[m.n.viewIdKey],s[m.n.newTargetListUrlKey]===this._pageContext.listUrl&&(delete s[m.n.newTargetListUrlKey],delete s[m.n.viewPathKey]),delete s[m.n.metadataSearchIdKey],s},t.prototype._getMediaUrl=function(e,t){var n,a=t.params,r=void 0===a?{}:a,d=Object(i.__rest)(r,[]),l=t.itemSet,u=t.parentItem,f=t.page,p=t.isSearch;if(!this._supportsOneUp){var _=this._itemUrlHelper.getItemUrlParts(e.key),h=_.serverRelativeItemUrl,b=((n={})[m.n.idParamKey]=h,n[m.n.parentIdParamKey]=h.substring(0,h.lastIndexOf("/")),n);return"".concat(_.fullListUrl,"?").concat(c.t(b,null))}var g=u||(l?l.item.peek():e.UNSAFE_parent);if(!g)return"";var v=g&&g.key||"",y=c.e(v);for(var S in d[m.n.parentIdParamKey]=y[m.n.idParamKey],!Object(T.O)()&&p?(delete d[m.n.queryTypeParamKey],d[m.n.parentQueryTypeParamKey]=o.e.Search):d[m.n.parentQueryTypeParamKey]=y[m.n.queryTypeParamKey],delete y[m.n.idParamKey],delete y[m.n.queryTypeParamKey],delete y[m.n.uniqueParamKey],d){var D=d[S];(null==D||""===D&&S.indexOf("FilterValue")<0)&&delete d[S]}return!U.e.isActivated("AB4098F9-F6D7-4E52-B8EE-AE705A509AE3","2/2/2021","Stay in current page for OneUp")&&f&&f!==s.e.Files&&(d[m.n.pageParamKey]=f),"#"+c.t(d,y,!1)},t.prototype._getAdditionalSearchFilterParams=function(e){for(var t={},n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];(m.a.test(i)||i===m.n.dateFilterKey||i===m.n.typeFiltersKey||i===m.n.userFiltersKey||i===m.n.metadataSearchIdKey||i===m.n.queryParamKey)&&(t[i]=e[i])}return t[m.n.queryTypeParamKey]=o.e.Search,t},t.prototype._isSearchView=function(e){return this.getQueryType(e)===o.e.Search},t.dependencies=Object(i.__assign)(Object(i.__assign)({},r.default.dependencies),{navigation:O.e,platform:w.e,pageContext:d.f,itemUrlHelper:C.c,itemParentHelper:M.e,useOneUpTextEditor:j,supportsOneUp:V,urlDataSourceLite:P.resourceKey,getDefaultClickUrl:F.e}),t.placeholderId=0,t}(r.default),G=(t.default=z,Object(k.r)("UrlDataSource",z))}],Array(13),[function(e,t,n){"use strict";var a=n(0),i=n("knockout-lib"),r=n(1203),o=n(3718),s=function(e){function t(t){var n=e.call(this,t)||this;return n._itemSet=t.itemSet,n._itemsStore=t.itemsStore,n._spotlightDataSource=t.spotlightDataSource,n._cacheUpdatesObservable=n._spotlightDataSource.getCacheUpdatesObservable(),n._spotlightItems=i.observable([]),n._spotlightChangedTextObservable=i.observable(""),n._spotlightChangedTextObservable.extend({notify:"always"}),n._currentView=t.currentView,n.createComputed(n._updateSpotlightItemsOnItemSetChange),n}return Object(a.__extends)(t,e),t.prototype.editSpotlight=function(e){var t=this;return this._preemptSpotlightChange(e),this._spotlightDataSource.editSpotlight(e).then(function(n){return t._handleEditSpotlightResult(e,n)},function(n){var a={resultEnum:o.e.UnknownServerResult,order:null};return t._handleEditSpotlightResult(e,a)})},t.prototype.getSpotlightItems=function(){return this._spotlightItems},t.prototype.getSpotlightChangedTextObservable=function(){return this._spotlightChangedTextObservable},t.prototype._updateSpotlightItemInfo=function(e,t){var n=[];if(e.viewId){if(t.length>0){var a={};a[e.item.properties.ID]=e.item.key;for(var i=this._spotlightItems.peek(),r=null,o=0;o<i.length;o++){var s=i[o].peek();a[s.properties.ID]||(a[s.properties.ID]=s.key)}for(o=0;o<t.length;o++)a[t[o]]&&(r=this._itemsStore.getItem(a[t[o]]))&&n.push(r)}this._spotlightDataSource.cacheSpotlightItems(this._itemSet.peek().item,e.viewId,n)}},t.prototype._handleEditSpotlightResult=function(e,t){var n=!1;t.order?(this._updateSpotlightItemInfo(e,t.order),n=!0):this._updateSpotlightItemsOnItemSetChange();var a=t.resultEnum;return a!==o.e.Success||n?a:o.e.UnknownServerResult},t.prototype._updateSpotlightItemsOnItemSetChange=function(){this._cacheUpdatesObservable();var e=this._currentView(),t=this._itemSet().item().key;if(e){var n=this._spotlightDataSource.getSpotlightItems(t,e.id),a=this._spotlightItems.peek();if(n)if(a){if(n.length!==a.length)this._spotlightItems(n);else for(var i=0;i<n.length;i++)if(n[i].peek().key!==a[i].peek().key)return void this._spotlightItems(n)}else this._spotlightItems(n);else a&&!a.length||this._spotlightItems([])}},t.prototype._preemptSpotlightChange=function(e){if(e.item.UNSAFE_parent){var t=this._itemsStore.getItem(e.item.UNSAFE_parent.key);if(t){var n=[],a=this._spotlightDataSource.getSpotlightItems(t.peek().key,e.viewId)||[],i=e.item.properties.ID,r=!1,o=e.isAdd?this._itemsStore.getItem(e.item.key):null,s=o&&e.afterItem?e.afterItem.key:null;o&&!s&&(n.push(o),r=!0);for(var c=0;c<a.length;c++)a[c].peek().properties.ID!==i&&n.push(a[c]),o&&!r&&a[c].peek().key===s&&(n.push(o),r=!0);o&&!r&&n.unshift(o),n.length<=3&&this._spotlightDataSource.cacheSpotlightItems(t,e.viewId,n)}}},t}(r.default);t.e=s}],Array(31),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"HubLeftNavHandler.key",loader:new i.t(function(){return n.e(701).then(n.bind(null,5276)).then(function(e){return e.typeResourceKey.local})})})},,,function(e,t,n){"use strict";n.d(t,"t",function(){return u});var a=n(0),i=n(4755),r=n(253),o=n(14),s=n(7),c=n(79),d=n(142),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getAppSubfolder=function(e){return e?"odb":"splist"},t.prototype.getDefaultClickUrl=function(t,n){return void 0===n&&(n={}),t?Object(o.r)(this._listContext().listTemplateType)&&t.type===r.e.File?this.getDisplayFormUrl(t):e.prototype.getDefaultClickUrl.call(this,t,n):""},t.prototype.getRecycleBinQueryUrl=function(){return"".concat(this.getWebUrl(),"/").concat(this.getLayoutsUrl(),"/RecycleBin.aspx")},t.prototype.getUriWithAdjustForCurrentRootFolder=function(e){var t=new c.t(e),n=this.getCurrentItemKey();if(n){var a=this.getKeyParams(n)[s.n.idParamKey];t.setQueryParameter("RootFolder",a)}return t},t.prototype.getNewFormUrl=function(t){var n=e.prototype._getListItemFormUrl.call(this,this._listContext().newFormUrl),a=this.getUriWithAdjustForCurrentRootFolder(n);return t&&a.setQueryParameter("ContentTypeId",t),a.toString()},t.prototype.getQuickLaunchSettingsUrl=function(){return"".concat(this.getWebUrl(),"/").concat(this.getLayoutsUrl(),"/quiklnch.aspx")},t.prototype.getAreaNavigationSettingsUrl=function(){return"".concat(this.getWebUrl(),"/").concat(this.getLayoutsUrl(),"/AreaNavigationSettings.aspx")},t.prototype.getTopNavSettingsUrl=function(){return"".concat(this.getWebUrl(),"/").concat(this.getLayoutsUrl(),"/topnav.aspx")},t.prototype.getWACResourcesPreloadUrl=function(){return e.prototype.getWACResourcesPreloadUrl.call(this)},t.prototype.getWopiDocUrl=function(){return e.prototype.getWopiDocUrl.call(this)},t.prototype.getSitePagesUrl=function(){return"".concat(this.getWebUrl(),"/SitePages/Forms/AllPages.aspx")},t.prototype.getMyRestorePageUrl=function(){return Promise.resolve("")},t.prototype.getNavLinkClickUrl=function(e){return this._urlDataSourceLite.getNavLinkClickUrl(e)},t}(i.default);t.e=l;var u=Object(d.r)("UrlDataSource",l)},function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(43);function i(e){return!!(e&&e.openUrl&&e.appMap)}function r(e){var t=function(e,t){var n=e.appMap?e.appMap.toLowerCase():void 0;return"ms-powerpoint"===n||"ms-word"===n||"ms-visio"===n||"ms-excel"===n||!1}(e);return t&&i(e)&&!Object(a.isFeatureEnabled)(a.EnablePdfCoversionForAllTypes)}new Set(["WacFailed.DocumentIsIRMProtected","WacFailed.5243086","WacFailed.5243055","5374037","5373972","5373968","5373967","5373965","5373961","5243101","29"])},,function(e,t,n){"use strict";var a=n(0),i=n(2229),r=n(2236),o=n(4422),s=n(54),c=n(1203),d=n(5168),l=n(4423),u=function(e){function t(t){var n=e.call(this,t)||this;return n.operations=t.operations,n.name="",n.iconName="",n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)},n.batch=t.batch,n.error=n.createObservable(),n.count=n.createObservable(0),n._initializeType(),n.payloads=n.createPureComputed(n._computePayloads),n.actions=n.createObservable({}),n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0}),n._initializeOperations(),n.state=n.createPureComputed(n._computeState),n.visibility=n.createPureComputed(n._computeVisibility),n}return Object(a.__extends)(t,e),t.prototype._initializeType=function(){var e=this.addDisposable(l.e.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||i.e.multiple})},t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}},t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n=e.createPureComputed(function(){return r.e[t.state()]}),a=e.addDisposable(d.t(t.progress.minimum,e.progress.minimum)),i=e.addDisposable(d.t(t.progress.maximum,e.progress.maximum)),o=e.addDisposable(d.t(t.progress.current,e.progress.current)),s=e.addDisposable(d.e(n,e.states)),c=e.addDisposable(d.n(t.error,e.error)),l=e.addDisposable(d.t(t.count,e.count)),u=e.createComputed(function(){var n=!1,a=e.actions.peek();for(var i in t.actions())i in a||(a[i]=e._initializeAction(i),n=!0);n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){n.dispose(),a.dispose(),i.dispose(),o.dispose(),s.dispose(),u.dispose(),c.dispose(),l.dispose()}}}}))},t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?r.e.started:e.created?r.e.created:e.failed?r.e.failed:e.completed?r.e.completed:e.canceled?r.e.canceled:r.e.expired},t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)},t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new o.e({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return s.n.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||s.n.wrap()}))}}))},t}(c.default);t.e=u},function(e,t,n){"use strict";var a=n(0),i=n(2175),r=n("knockout-lib"),o=function(e){function t(t){var n=e.call(this,t)||this,a=n.valueAccessor(),i=n._getComponentBindingContext(),o=i.$parentContext;return function(e){return"function"==typeof e}(a)?a({bindingContext:o,templateNodes:n.bindingContext.$componentTemplateNodes}):(r.applyBindingsToDescendants(n.bindingContext.extend({$componentParentContext:i}),n.element),n.controlsDescendantBindings=!0),n}return Object(a.__extends)(t,e),t.prototype._getComponentBindingContext=function(){for(var e=this.bindingContext.$component,t=this.bindingContext;t.$data!==e&&t.$parentContext;)t=t.$parentContext;return t},t.supportsVirtualElements=!0,t}(i.t);t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(34),i=n(277);function r(){return Object(i.e)({eventName:"OnePlayerAndECSLogExposure,",shortEventName:"OnePlayerAndECSLogExposure"},{experimentId:{isPrefixingDisabled:!0,type:a.e.Number},variant:{isPrefixingDisabled:!0,type:a.e.Number},isAATest:{isPrefixingDisabled:!0,type:a.e.Boolean},isOverride:{isPrefixingDisabled:!0,type:a.e.Boolean},correlationId:{isPrefixingDisabled:!0,type:a.e.String},cloudType:{isPrefixingDisabled:!0,type:a.e.String}})}function o(e,t){e.logData(t)}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(197),r=n(15),o=n(186),s=n(885),c=n(343);function d(e,t,n,d){return function(l){var u;d.refreshClientForm=!0,t&&t.listUrl&&d.listId&&t.listId&&d.listId.toUpperCase()===t.listId.toUpperCase()?(i.e(e,t),n&&l(Object(o.e)({items:(u={},u[r.c]=Object(a.__assign)({},r.f.pack({itemKey:n})),u)}))):(e.listUrl=d.listUrl,e.listId=d.listId,e.listTitle=d.listTitle,e.listBaseTemplate=d.listTemplateType),Object(s.n)(void 0,{listId:Object(c.i)(d.listId)}),e.serverRequestPath=void 0}}},,,function(e,t,n){"use strict";var a=n(0),i=n(1203),r=n(197),o=n(460),s=n(388),c=function(e){function t(t,n){var a=e.call(this,void 0,n)||this;a._pageContext=t||a.resources.consume(s.e);var i=null==n?void 0:n.dataRequestorType;return a._makeDataRequestor=i?function(e){return new i(e)}:function(e){return new o.e(e,{pageContext:a._pageContext})},a.dataRequestor=a._makeDataRequestor({qosName:a.getDataSourceName()}),a}return Object(a.__extends)(t,e),t.prototype.getDataSourceName=function(){return"DataSource"},t.prototype.updateContext=function(e){r.e(this._pageContext,e),this.dataRequestor=this._makeDataRequestor({qosName:this.getDataSourceName()})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{dataRequestorType:o.n}),t}(i.default);t.e=c},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Uninitialized:0,Direct:1,OrganizationView:2,OrganizationEdit:3,AnonymousView:4,AnonymousEdit:5,Flexible:6}},,,function(e,t,n){"use strict";var a=n(0),i=n(3416),r=n(4821),o=n(4825),s=n(4826),c=n(1206);function d(e,t){return r.e(e,function(){return t().then(c.e)})}var l=function(e){function t(){var t=e.call(this)||this;return t.DefaultClickAction=o.e,t.OpenInExplorerAction=s.e,t.OpenInSharePointAction=d("./OpenInSharePointAction",function(){return n.e(305).then(n.bind(null,4594))}),t.EditSmartTemplateAction=d("./EditSmartTemplateAction/EditSmartTemplateAction",function(){return n.e(290).then(n.bind(null,5295))}),t.DeleteSmartTemplateWithProgressAction=d("./deleteSmartTemplate/DeleteSmartTemplateWithProgressAction",function(){return n.e(320).then(n.bind(null,5296))}),t.PublishSmartTemplateWithProgressAction=d("./publishSmartTemplate/PublishSmartTemplateWithProgressAction",function(){return n.e(322).then(n.bind(null,5297))}),t.UnPublishSmartTemplateWithProgressAction=d("./unpublishSmartTemplate/UnpublishSmartTemplateWithProgressAction",function(){return n.e(324).then(n.bind(null,5298))}),t.AddExistingAppViewAction=d("./AddExistingAppViewAction",function(){return n.e(274).then(n.bind(null,4595))}),t.AddToQuickLaunchAction=d("./AddToQuickLaunchAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(275)]).then(n.bind(null,4596))}),t.AddToSpotlightAction=d("./AddToSpotlightAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(276)]).then(n.bind(null,4597))}),t.ApproveRejectAction=d("./ApproveRejectAction",function(){return n.e(277).then(n.bind(null,4598))}),t.CancelEditAction=d("./CancelEditAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(278)]).then(n.bind(null,3203))}),t.ChangeAppViewVisibilityAction=d("./ChangeAppViewVisibilityAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(279)]).then(n.bind(null,3771))}),t.ClearFilterAction=d("./ClearFilterAction",function(){return n.e(280).then(n.bind(null,4599))}),t.ComplianceDetailsAction=d("./ComplianceDetailsAction",function(){return n.e(281).then(n.bind(null,4600))}),t.CopyFieldAction=d("../CopyFieldAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(764)]).then(n.bind(null,4749))}),t.CopyFormAction=d("../copyForm/CopyFormAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(765)]).then(n.bind(null,4601))}),t.CreateAppViewAction=d("./CreateAppViewAction",function(){return n.e(282).then(n.bind(null,3772))}),t.CreateColumnAction=d("./CreateColumnAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(766)]).then(n.bind(null,4602))}),t.CreateItemAction=d("./CreateItemAction",function(){return n.e(283).then(n.bind(null,4603))}),t.CustomClientFormPaneAction=d("../customClientFormPane/CustomClientFormPaneAction",function(){return n.e(767).then(n.bind(null,4604))}),t.CustomizeClientFormAction=d("../customizeClientForm/CustomizeClientFormAction",function(){return n.e(768).then(n.bind(null,4605))}),t.CustomizeFormsNavigationAction=d("./CustomizeFormsNavigationAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(769)]).then(n.bind(null,4777))}),t.CustomizeViewAction=d("./CustomizeViewAction",function(){return n.e(284).then(n.bind(null,4606))}),t.DeleteViewAction=d("./DeleteViewAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(287)]).then(n.bind(null,3773))}),t.DeleteTemplateAction=d("./DeleteTemplateAction",function(){return n.e(285).then(n.bind(null,4607))}),t.EditItemAction=d("./EditItemAction",function(){return n.e(771).then(n.bind(null,3389))}),t.EditItemCancelAction=d("./EditItemCancelAction",function(){return n.e(772).then(n.bind(null,4608))}),t.EditItemSaveAction=d("./EditItemSaveAction",function(){return n.e(773).then(n.bind(null,4609))}),t.EditNewAppViewAction=d("./EditNewAppViewAction",function(){return n.e(288).then(n.bind(null,3774))}),t.EditNewMenuAction=d("../editNewMenu/EditNewMenuAction",function(){return n.e(133).then(n.bind(null,4610))}),t.EditNewMenuPaneAction=d("../editNewMenu/EditNewMenuPaneAction",function(){return n.e(134).then(n.bind(null,4611))}),t.EditRenditionsAction=d("./EditRenditionsAction",function(){return n.e(289).then(n.bind(null,4612))}),t.ExportListAction=d("./ExportListAction",function(){return n.e(292).then(n.bind(null,4613))}),t.FilterAction=d("./FilterAction",function(){return n.e(293).then(n.bind(null,4614))}),t.InvokeFirstRunExperienceAction=d("./InvokeFirstRunExperienceAction",function(){return n.e(295).then(n.bind(null,4615))}),t.LaunchApprovalDetailsDialogAction=d("../launchHubSettingsPanel/LaunchApprovalDetailsDialogAction",function(){return n.e(196).then(n.bind(null,5299))}),t.LaunchChangeTheLookPanelAction=d("../launchChangeTheLookPanel/LaunchChangeTheLookPanelAction",function(){return n.e(198).then(n.bind(null,4616))}),t.LaunchCreateAppViewPanelAction=d("./LaunchCreateAppViewPanelAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(296)]).then(n.bind(null,4736))}),t.LaunchColumnCustomizationPaneAction=d("./LaunchColumnCustomizationPaneAction",function(){return Promise.all([n.e("deferred"),n.e("deferred.odsp-common"),n.e(774)]).then(n.bind(null,3575))}),t.LaunchFilterPanelAction=d("./LaunchFilterPanelAction",function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(297)]).then(n.bind(null,4617))}),t.LaunchFormatViewPaneAction=d("./LaunchFormatViewPaneAction",function(){return n.e(298).then(n.bind(null,4618))}),t.LaunchGroupMembershipPanelAction=d("../launchGroupMembershipPanel/LaunchGroupMembershipPanelAction",function(){return n.e(205).then(n.bind(null,4619))}),t.LaunchHubSettingsPanelAction=d("../launchHubSettingsPanel/LaunchHubSettingsPanelAction",function(){return n.e(209).then(n.bind(null,4620))}),t.LaunchListFormAction=d("../launchListForm/LaunchListFormAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e("deferred.odsp-common"),n.e("deferred.odsp-datasources"),n.e(777)]).then(n.bind(null,4621))}),t.LaunchDocLibSettingPanelAction=d("../launchDocLibSettingPanel/LaunchDocLibSettingPanelAction",function(){return n.e(201).then(n.bind(null,5302))}),t.LaunchSitePermissionsPanelAction=d("../launchSitePermissionsPanel/LaunchSitePermissionsPanelAction",function(){return n.e(214).then(n.bind(null,4622))}),t.LaunchSiteSettingsPanelAction=d("../launchSiteSettingsPanel/LaunchSiteSettingsPanelAction",function(){return n.e(216).then(n.bind(null,4623))}),t.LaunchGlobalNavSettingsPanelAction=d("../launchGlobalNavSettingsPanel/LaunchGlobalNavSettingsPanelAction",function(){return n.e(203).then(n.bind(null,4624))}),t.LaunchWebTemplatesGalleryAction=d("../launchWebTemplatesGallery/LaunchWebTemplatesGalleryAction",function(){return n.e(222).then(n.bind(null,4625))}),t.LaunchVivaConnectionsSettingsPanelAction=d("../launchVivaConnectionsSettingsPanel/LaunchVivaConnectionsSettingsPanelAction",function(){return n.e(220).then(n.bind(null,4626))}),t.ListFormActivityPaneToggleAction=d("./ListFormActivityPaneToggleAction",function(){return n.e(779).then(n.bind(null,4627))}),t.MakeHomepageAction=d("./MakeHomepageAction",function(){return n.e(299).then(n.bind(null,4628))}),t.ModifyColumnAction=d("./ModifyColumnAction",function(){return n.e(300).then(n.bind(null,2715))}),t.ModifyShowInFiltersPaneAction=d("./ModifyShowInFiltersPaneAction",function(){return n.e(780).then(n.bind(null,4629))}),t.MoveLeftSpotlightAction=d("./MoveLeftSpotlightAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(301)]).then(n.bind(null,4630))}),t.MoveRightSpotlightAction=d("./MoveRightSpotlightAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(302)]).then(n.bind(null,4631))}),t.OpenHyperlinkAction=d("./OpenHyperlinkAction",function(){return n.e(304).then(n.bind(null,4632))}),t.OpenNeedsAttentionViewAction=d("./OpenNeedsAttentionViewAction",function(){return n.e(307).then(n.bind(null,4633))}),t.PublishAction=d("./PublishAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(308)]).then(n.bind(null,4750))}),t.RemoveFromSpotlightAction=d("./RemoveFromSpotlightAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(309)]).then(n.bind(null,4634))}),t.RenameColumnAction=d("./RenameColumnAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(784)]).then(n.bind(null,4635))}),t.SaveViewAction=d("./SaveViewAction",function(){return n.e(310).then(n.bind(null,2716))}),t.SeeAllAppsAction=d("./SeeAllAppsAction",function(){return n.e(311).then(n.bind(null,4636))}),t.SetUpApprovalFlowAction=d("../flow/SetUpApprovalFlowAction",function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(141)]).then(n.bind(null,4778))}),t.SetDefaultViewAction=d("./SetDefaultViewAction",function(){return n.e(312).then(n.bind(null,4637))}),t.ShowFiltersAction=d("./ShowFiltersAction",function(){return n.e(874).then(n.bind(null,4638))}),t.SwitchViewAction=d("./SwitchViewAction",function(){return n.e(313).then(n.bind(null,3777))}),t.SynchronizeAppViewAction=d("./SynchronizeAppViewAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(314)]).then(n.bind(null,4639))}),t.ToggleAction=d("./ToggleAction",function(){return n.e(315).then(n.bind(null,3970))}),t.TriggerSignoffFlowAction=d("../flow/TriggerSignoffFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(149)]).then(n.bind(null,4779))}),t.TriggerExtractFileMetadataFlowAction=d("../flow/TriggerExtractFileMetadataFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(144)]).then(n.bind(null,4640))}),t.UnPublishAction=d("./UnPublishAction",function(){return n.e(316).then(n.bind(null,4641))}),t.UploadAction=d("./UploadAction",function(){return n.e(875).then(n.bind(null,3778))}),t.UploadTemplateAction=d("./UploadTemplateAction",function(){return n.e(317).then(n.bind(null,4642))}),t.ViewItemAction=d("./ViewItemAction",function(){return n.e(318).then(n.bind(null,4643))}),t.WorkflowAction=d("./WorkflowAction",function(){return n.e(787).then(n.bind(null,4644))}),t.ShowVersionHistoryAction=d("../odb/ShowVersionHistoryAction",function(){return n.e(239).then(n.bind(null,3779))}),t.OpenChatAction=d("./OpenChatAction",function(){return n.e(303).then(n.bind(null,5303))}),t}return Object(a.__extends)(t,e),t}(i.e);t.e=l},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(2184),r=n(54),o=n(383),s=n(2403),c=n(421),d=function(e){function t(t){var n=this,a=t.load,i=t.actionParams,s=(n=e.call(this,i)||this).resources.consume(c.e.optional);n.isQosLogged=!1,n.name="Deferred".concat(t.modulePath).replace(/Action|\.|\//g,""),n._action=n.createObservable();var d=new o.e;return(s?s.waitForPLT().then(a):r.n.resolve(a())).done(function(e){return d.complete(e)},function(e){return d.error(e)}),n._getActionPromise=n.trackPromise(d.getPromise().then(function(e){return new(n.managed(e))(i)})),n._getActionPromise.done(function(e){return n._action(e)}),n.inputType=n.createPureComputed(n._computeInputType),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!!this._action()&&this._action().isAvailable()},t.prototype.onIsToggled=function(){return!!this._action()&&this._action().isToggled()},t.prototype.onExecute=function(e,t){return this._getActionPromise.then(function(t){return t.execute(e)})},t.prototype._computeInputType=function(){var e=this._action();return e&&e.inputType?e.inputType():s.e.none},t}(i.e);function l(e,t){var n;function i(){return n||(n=t())}return function(t){function n(n){return t.call(this,{load:i,modulePath:e,actionParams:n})||this}return Object(a.__extends)(n,t),n}(d)}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"".concat("SharedRecentEvents.key",".sharedRecentEvents"),loader:new i.t(function(){return n.e(535).then(n.bind(null,5305)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";var a=n(0),i=n(1203),r=n(7),o=n(14),s=n(147),c=n(177),d=n(2192),l=n(148),u=n(489),f=n(101),p=n(213),m=n(2193),_=n(11),h=function(e){function t(t){var n=e.call(this,t)||this;return n._navigation=n.resources.consume(s.e),n._platformDetection=n.resources.consume(c.e),n._urlDataSource=n.resources.consume(f.ue),n._selectionHelper=new(n.child(m.e))({canFallback:!1,allowMultiSelect:!0}),n._currentItem=n._selectionHelper.currentItem,n._itemParentHelper=n.resources.consume(d.e),n._itemUrlHelper=n.resources.consume(l.c),n}return Object(a.__extends)(t,e),t.prototype.canOpenInExplorer=function(){var e=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._currentItem(),"list"));return!!e&&!!e.list.isDocumentLibrary&&e.list.templateType!==o.n.webPageLibrary&&e.itemStatus!==p.t.ConditionalAccessBlocked&&e.itemStatus!==p.t.ConditionalAccessViewOnly&&this._platformDetection.isIE},t.prototype.navigateToClassic=function(){var e=this._currentItem.peek(),t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=this._urlDataSource.getKeyParams(e.key)[r.n.idParamKey],a=this._itemUrlHelper.getItemUrlParts(t.key),i={ExplorerWindowUrl:n};_.e.isActivated("5924661A-1CC2-43BB-B508-25B4BEF86C42","10/20/2020","Navigate to the specific folder in case of list view threshold throttling")||(i.rootFolder=n);var o="".concat(a.fullItemUrl,"?").concat(u.t(i));this._navigation.navigateTo({url:o,frameId:"_blank"})},t}(i.default);t.e=h},function(e,t,n){"use strict";var a=n(0),i=n(54),r=n(1203),o=n(2379),s=n(2258),c=n(2236),d=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._operationProvider=n.resources.consume(s.resourceKey),n.state=n.createPureComputed(n._computeState),n}return Object(a.__extends)(t,e),t.prototype._computeState=function(){return{isAvailable:this._operationProvider.overall.state()!==c.e.expired,isToggled:this._operationProvider.isLocked()}},t}(r.default),l=Object(o.e)({name:"ShowOperations",source:{moduleDefinition:{path:"./ShowOperationsExecutor",getModule:function(){return i.n.resolve(Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(266)]).then(n.bind(null,5489)))}}},handlerType:d});t.e=l},function(e,t,n){"use strict";var a=n(0),i=n(5103),r=n(101),o=n(311),s=n(253),c=n(14),d=function(e){function t(t){var n=e.call(this,t)||this;return n._urlDataSource=n.resources.consume(r.ue),n._actionMap=n.resources.consume(o.e),n}return Object(a.__extends)(t,e),t.prototype.onComputeAction=function(){var t=this.item(),n=this.unwrapObservable(this.itemParentHelper.getFacetedAncestorOrSelf(t,"list"));return n&&Object(c.r)(n.list.templateType)&&t.type===s.e.File?new(this.managed(this._actionMap.LaunchListFormAction))({type:3,item:t,url:this._urlDataSource.getDefaultClickUrl(t,{})}):e.prototype.onComputeAction.call(this)},t.prototype.onIsAvailable=function(){var t=this.item(),n=this.unwrapObservable(this.itemParentHelper.getFacetedAncestorOrSelf(t,"list"));return!(!n||!Object(c.r)(n.list.templateType)&&n.list.templateType!==c.t.customGrid||t.type!==s.e.File)||e.prototype.onIsAvailable.call(this)},t}(i.e);t.e=d},function(e,t,n){"use strict";var a=n(0),i=n(54),r=n(2184),o=n(70),s=n(4823),c=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="OpenInExplorer",n._helper=new(n.managed(s.e)),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){return this.onIsAvailable()?(this._helper.navigateToClassic(),i.n.wrap({resultType:o.e.Success})):i.n.wrap({resultType:o.e.ExpectedFailure})},t.prototype.onIsAvailable=function(){return this._helper.canOpenInExplorer()},t}(r.e);t.e=c},function(e,t,n){"use strict";var a=function(){function e(){}return e.mainContentLoadComplete="SPOApp.mainContentLoadComplete",e.deferredResourcesInitialized="SPOApp.deferredResourcesLoaded",e}();t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(8),i=n(142),r=n(4223);n.d(t,"t",function(){return r.e});var o=new a.t({name:"ListItemsDataSource.key",loader:new i.t(function(){return n.e(797).then(n.bind(null,5467)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"DownloadDataSource.key",loader:new i.t(function(){return n.e(456).then(n.bind(null,5480)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"".concat("MoveCopyDataSource.key",".MoveCopyDataSource"),loader:new i.t(function(){return n.e(468).then(n.bind(null,5498)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";var a=n(0),i=n(54),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getBundles=function(){var e;return(e={})[1]={path:"../../../bundles/odb/DeferredControls",getModule:function(){return i.n.resolve(n.e(740).then(n.bind(null,5306)))},isLoaded:this.createObservable(!1)},e},t}(n(1203).default);t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(43),i=new(n(8).t)({name:"MoveCopyCapabilities",factory:{dependencies:{},create:function(){return{instance:{supportsMoveCopy:!0,supportsMoveCopyOnShared:!1,supportsMoveCopyFilterParams:!0,supportsCopyCrossSite:Object(a.isFeatureEnabled)(a.CopyCrossSiteFromTeamSite),supportsMoveCrossSite:Object(a.isFeatureEnabled)(a.MoveCrossSite),supportsThrottling:!0,supportsProgressCaching:!0}}}}})},function(e,t,n){"use strict";var a=n(0),i=n(3100),r=n(1203),o=n(177),s="OfflineClientInstalled",c="SharePoint.OfflineClient",d="application/x-sharepoint-webkit",l="macSharePointPlugin",u=function(e){function t(t){var n=e.call(this,t)||this;return n._platform=n.resources.consume(o.e),n}return Object(a.__extends)(t,e),t.IsBrowserPluginInstalled=function(e){var t=navigator.mimeTypes&&navigator.mimeTypes[e];return!!t&&!!t.enabledPlugin},t.prototype.TryUseOfflineClient=function(e,t,n,a,i,r,o){if(this._initOfflineClient()){try{if(!this._isOfflineAllowedByClient(e,t,a,i))return!1;this._offlineClient.TakeOffline(e,t,n,a,i,r,o)}catch(e){return!1}return!0}return!1},t.prototype._isOfflineAllowedByClient=function(e,t,n,a){return this._offlineClient.IsOfflineAllowed(e,t,n,a)},t.prototype._initOfflineClient=function(){try{if(!this._platform.isWindows7)return!1;if(!this._offlineClient)if(-1===document.cookie.indexOf(s))this._isSupportedMacBrowser()?this._offlineClient=this._createMacPlugin():this._offlineClient=new ActiveXObject(c),i.set(s,"1");else{if("1"!==i.get(s))return!1;this._isSupportedMacBrowser()?this._offlineClient=this._createMacPlugin():this._offlineClient=new ActiveXObject(c)}if(this._offlineClient&&void 0!==this._offlineClient&&void 0!==this._offlineClient.IsOfflineAllowed&&void 0!==this._offlineClient.TakeOffline)return!0}catch(e){i.set(s,"0"),this._offlineClient=null}return!1},t.prototype._isSupportedMacBrowser=function(){return this._platform.isMac&&(this._platform.isFirefox||this._platform.isSafari||this._platform.isChrome)},t.prototype._createMacPlugin=function(){var e=null;if(this._isSupportedMacBrowser()&&!this._platform.isChrome&&null===(e=document.getElementById(l))&&this._isMacPluginInstalled()){var n;n=this._platform.isSafari&&t.IsBrowserPluginInstalled(d)?d:t.MAC_PLUGIN_MIME_TYPE;var a=document.createElement("object");a.id=l,a.type=n,a.width="0",a.height="0",a.style.visibility="hidden",document.body.appendChild(a),e=document.getElementById(l)}return e},t.prototype._isMacPluginInstalled=function(){var e=t.IsBrowserPluginInstalled(d),n=t.IsBrowserPluginInstalled(t.MAC_PLUGIN_MIME_TYPE);return!(!this._platform.isSafari||!e)||n},t.MAC_PLUGIN_MIME_TYPE="application/x-sharepoint",t}(r.default);t.e=u},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(1203),r=n(147),o=n(142),s=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._navigation=n.navigation,a}return Object(a.__extends)(t,e),t.prototype.updateSort=function(e,t){var n,a=this._navigation,i=((n={}).sortField=e,n.isAscending=t,n);a.updateViewParams(i)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{navigation:r.e}),t}(i.default),c=Object(o.r)("SortManager",s)},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"Error.key",loader:new i.t(function(){return Promise.all([n.e("deferred.resx-deferred"),n.e("deferred"),n.e(349)]).then(n.bind(null,2985)).then(function(e){return e.resourceKey.local})})})},function(e,t,n){"use strict";var a=n(0),i=n(226),r="metadatanavsettings=",o=function(e){function t(){var t=e.call(this,"SmartFiltersStore")||this;return t._filterSectionInfoStoreKeys=[],t}return Object(a.__extends)(t,e),t.prototype.setFilterSectionInfos=function(e){var t=this._getStoreKey(e.parentKey,e.viewId,e.viewParams);-1===this._filterSectionInfoStoreKeys.indexOf(t)&&this._filterSectionInfoStoreKeys.push(t),this.setValue(t,e)},t.prototype.getFilterSectionInfos=function(e,t,n){return this.getValue(this._getStoreKey(e,t,n))},t.prototype.updateFilterSectionInfos=function(e,t,n,a){var i=!1,r=this._getStoreKey(e,t,n),o=this.getValue(r);if(o&&o.sectionInfos){for(var s=0;s<o.sectionInfos.length;s++){var c=a[o.sectionInfos[s].fieldName];c&&(o.sectionInfos[s]=c,i=!0)}this.setValue(r,o)}return i},t.prototype.setMetadataNavigationSettings=function(e,t){var n=r+e;this.setValue(n,t)},t.prototype.getMetadataNavigationSettings=function(e){var t=r+e;return this.getValue(t)},t.prototype.invalidate=function(e){for(var t=0,n=this._filterSectionInfoStoreKeys;t<n.length;t++){var a=n[t],i=this.getValue(a);i&&i.parentKey&&i.parentKey===e&&this.remove(a)}},t.prototype.invalidateAll=function(){for(var e=0,t=this._filterSectionInfoStoreKeys;e<t.length;e++){var n=t[e];this.remove(n)}},t.prototype._getStoreKey=function(e,t,n){return e+t},t}(i.e);t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("correlationId")},function(e,t,n){"use strict";function a(e){return e.indexOf("&web=1")>=0||e.indexOf("?web=1")>=0?e:e.indexOf("?")>=0?"".concat(e,"&web=1"):"".concat(e,"?web=1")}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"n",function(){return v});var a=n(0),i=n(157),r=n(16),o=n(1946),s={id:"spListFolder",name:o.t},c={id:"spList",name:o.r},d={id:"spDocLibFolder",name:o.t},l={id:"spDocLib",name:o.i},u={id:"spSiteSite",name:o.o},f={id:"spHubSite",name:o.a},p={id:"spSiteHub",name:o.e},m={id:"spHubHub",name:o.n},_={id:"org",name:o.D},h=[u,p],b=[u],g=[f,m];function v(e,t,n,o,u,f){void 0===o&&(o=i.i.Default),void 0===u&&(u=!1);var p=u?[_]:function(e,t,n,o){var s,c=r.t.isActivated("318eed5c-1325-48a3-8743-35c69f2daf95","10/07/2021","Remove whole org scope option from scoping control when user is guest");switch(e){case i.i.Default:s=t?g:n?h:b;break;case i.i.Site:s=n?h:b;break;case i.i.Hub:s=g;break;case i.i.Tenant:s=[];break;default:throw new Error("Invalid SearchScopeType")}return o&&!c?s:Object(a.__spreadArray)(Object(a.__spreadArray)([],s,!0),[_],!1)}(o,t,n,f);switch(e){case"spListFolder":return[s,c].concat(p);case"spList":return[c].concat(p);case"spDocLibFolder":return[d,l].concat(p);case"spDocLib":return[l].concat(p);default:throw new Error("Invalid scope")}}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(7);function i(e){var t=e[a.n.metadataSearchIdKey];if(t){var n=sessionStorage.getItem(t);if(n)return JSON.parse(n)}}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("TextViewerHelper")},function(e,t,n){"use strict";var a=n(272);Object(a.n)(JSON.parse('[{"rawString":".messageBarContainer{margin-bottom:40px}"},{"rawString":".Text_fb8593ab{font-weight:600}"},{"rawString":".od-ListState-button{display:inline-block;vertical-align:middle;width:20px;height:28px}[dir=ltr] .od-ListState-button{margin-left:10px}[dir=rtl] .od-ListState-button{margin-right:10px}.od-ListState-button.isSPList{height:34px;padding-top:9px}.xlg .od-ListState-button.isSPList,.xxlg .od-ListState-button.isSPList,.xxxlg .od-ListState-button.isSPList,.xxxxlg .od-ListState-button.isSPList{margin-top:10px}.od-ListState-button.isErrorStatus{height:25px}.od-ListState-button.insideBreadcrumb{margin:0 3px;width:20px}.od-ListState-icon{font-size:small;cursor:default;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-ListState-icon.isListHome{vertical-align:-webkit-baseline-middle}.od-ListState-icon:hover{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-ListState-icon.hasAction{cursor:pointer;color:#d47500}@media print{.od-ListState-button{display:none}}"},{"rawString":".od-TopBar{position:relative}@media screen and (-ms-high-contrast:active){.od-TopBar{border-top:1px solid "},{"theme":"white","defaultValue":"#fff"},{"rawString":";border-bottom:1px solid "},{"theme":"white","defaultValue":"#fff"},{"rawString":"}}@media screen and (-ms-high-contrast:black-on-white){.od-TopBar{border-top:1px solid "},{"theme":"black","defaultValue":"#000"},{"rawString":";border-bottom:1px solid "},{"theme":"black","defaultValue":"#000"},{"rawString":"}}.lg .od-TopBar,.md .od-TopBar,.sm .od-TopBar{border-bottom:1px solid "},{"theme":"bodyDivider","defaultValue":"#edebe9"},{"rawString":"}.od-TopBar-item{background-color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":";height:44px}[dir=ltr] .od-TopBar-item--winApp{margin-left:228px!important}[dir=rtl] .od-TopBar-item--winApp{margin-right:228px!important}html[dir=ltr] .od-TopBar-item{float:left}html[dir=rtl] .od-TopBar-item{float:right}.md .od-TopBar-item,.sm .od-TopBar-item{height:48px}.od-theme--darkTransparent .od-TopBar-item{background-color:rgba(0,0,0,.7)}.od-TopBar-search{height:auto;background-color:transparent;width:228px}.lg .od-TopBar-search,.md .od-TopBar-search,.sm .od-TopBar-search{width:auto}[dir=ltr] .lg .od-TopBar-search,[dir=ltr] .md .od-TopBar-search,[dir=ltr] .sm .od-TopBar-search{margin-right:0}[dir=rtl] .lg .od-TopBar-search,[dir=rtl] .md .od-TopBar-search,[dir=rtl] .sm .od-TopBar-search{margin-left:0}[dir=ltr] .md .od-TopBar-search,[dir=ltr] .sm .od-TopBar-search{margin-right:4px}[dir=rtl] .md .od-TopBar-search,[dir=rtl] .sm .od-TopBar-search{margin-left:4px}.od-TopBar-search .od-SearchBox{transition:width 367ms cubic-bezier(.1, .9, .2, 1),background-color 0s cubic-bezier(.1, .9, .2, 1) 0s}.od-TopBar-search .od-SearchBox .od-SearchBox--active{transition-delay:0s,0s}.od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox{transition-delay:0s,367ms}.od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active){overflow:hidden;border-width:0;width:49px;border-color:transparent}.od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active) .od-SearchBox-search:after{visibility:hidden}.lg .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active),.xlg .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active),.xxlg .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active),.xxxlg .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active),.xxxxlg .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active){width:180px}.od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox.od-SearchBox--active{transition-delay:0s,0s}.lg .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox.od-SearchBox--active{width:165px}.md .od-TopBar-search.od-TopBar-search--isCollapsed,.sm .od-TopBar-search.od-TopBar-search--isCollapsed{width:50px}.md .od-TopBar-search.od-TopBar-search--isCollapsed .od-Search,.sm .od-TopBar-search.od-TopBar-search--isCollapsed .od-Search{position:absolute;z-index:1;visibility:hidden}.md .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox,.sm .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox{visibility:visible}.md .od-TopBar-search.od-TopBar-search--isCollapsed .od-Search--active,.sm .od-TopBar-search.od-TopBar-search--isCollapsed .od-Search--active{left:0;right:0}.lg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox,.xlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox,.xxlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox,.xxxlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox,.xxxxlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox{transition:background-color 0s cubic-bezier(.1, .9, .2, 1) 0s}.lg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox:not(.od-SearchBox--active),.xlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox:not(.od-SearchBox--active),.xxlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox:not(.od-SearchBox--active),.xxxlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox:not(.od-SearchBox--active),.xxxxlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox:not(.od-SearchBox--active){width:auto}.sm .od-TopBar-search{width:50px}.xlg .od-TopBar-header,.xxlg .od-TopBar-header,.xxxlg .od-TopBar-header,.xxxxlg .od-TopBar-header{width:100%}html[dir=ltr] .xlg .od-TopBar-header,html[dir=ltr] .xxlg .od-TopBar-header,html[dir=ltr] .xxxlg .od-TopBar-header,html[dir=ltr] .xxxxlg .od-TopBar-header{float:right}html[dir=rtl] .xlg .od-TopBar-header,html[dir=rtl] .xxlg .od-TopBar-header,html[dir=rtl] .xxxlg .od-TopBar-header,html[dir=rtl] .xxxxlg .od-TopBar-header{float:left}html[dir=ltr] .od-TopBar-commandBar{float:none}html[dir=rtl] .od-TopBar-commandBar{float:none}html[dir=ltr] .xlg .od-TopBar-commandBar,html[dir=ltr] .xxlg .od-TopBar-commandBar,html[dir=ltr] .xxxlg .od-TopBar-commandBar,html[dir=ltr] .xxxxlg .od-TopBar-commandBar{clear:right}html[dir=rtl] .xlg .od-TopBar-commandBar,html[dir=rtl] .xxlg .od-TopBar-commandBar,html[dir=rtl] .xxxlg .od-TopBar-commandBar,html[dir=rtl] .xxxxlg .od-TopBar-commandBar{clear:left}.od--hasSelection .od-TopBar-item{transition:background-color 467ms cubic-bezier(.1, .9, .2, 1);background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-theme--darkTransparent .od--hasSelection .od-TopBar-item{background-color:rgba(0,0,0,.7)}.od--hasSelection .od-TopBar-search:hover{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}html[dir=ltr] .od-TopBar-leftNavExpander+.od-TopBar-search .od-SearchBox{border-right-width:0}html[dir=rtl] .od-TopBar-leftNavExpander+.od-TopBar-search .od-SearchBox{border-left-width:0}"},{"rawString":".lg .od-Search-overlay .od-SearchResults,.xlg .od-Search-overlay .od-SearchResults,.xxlg .od-Search-overlay .od-SearchResults,.xxxlg .od-Search-overlay .od-SearchResults,.xxxxlg .od-Search-overlay .od-SearchResults{position:absolute;top:45px}.od-Search--maximized{position:absolute;left:0;right:0;bottom:0;overflow:auto}.od-Search--maximized .od-SearchBox{border-color:transparent}"},{"rawString":".od-SearchBox{width:100%;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";border-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";position:relative;box-sizing:border-box;height:44px}html[dir=ltr] .od-SearchBox{border-right-width:0}html[dir=rtl] .od-SearchBox{border-left-width:0}@media screen and (-ms-high-contrast:active){.od-SearchBox{border-color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":";z-index:304}}@media screen and (-ms-high-contrast:black-on-white){.od-SearchBox{border-color:"},{"theme":"black","defaultValue":"#000"},{"rawString":"}}.od-SearchBox .ms-Icon--Cancel,.od-SearchBox .ms-Icon--Search{margin-top:14px;font-family:FabricMDL2Icons}.od-SearchBox button.ms-Icon{background:0 0;padding:0;border:none;line-height:16px}.od-SearchBox button.ms-Icon::-moz-focus-inner{padding:0;border:0}html[dir=ltr] .od-SearchBox{border-right-style:solid}html[dir=rtl] .od-SearchBox{border-left-style:solid}html[dir=ltr] .od-SearchBox{border-right-width:1px}html[dir=rtl] .od-SearchBox{border-left-width:1px}.md .od-SearchBox,.sm .od-SearchBox{height:44px}.md .od-SearchBox .ms-Icon--Search,.sm .od-SearchBox .ms-Icon--Search{margin-top:12px;line-height:20px}.sm .od-SearchBox{height:44px}.lg .od-SearchBox,.md .od-SearchBox,.sm .od-SearchBox{height:44px}.xlg .od-SearchBox,.xxlg .od-SearchBox,.xxxlg .od-SearchBox,.xxxxlg .od-SearchBox{background-color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":";height:45px}.xlg .od-SearchBox:not(.od-SearchBox--active),.xxlg .od-SearchBox:not(.od-SearchBox--active),.xxxlg .od-SearchBox:not(.od-SearchBox--active),.xxxxlg .od-SearchBox:not(.od-SearchBox--active){background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-SearchBox-search{display:block;box-sizing:border-box;height:100%;position:relative}.od-SearchBox-search:after{content:\'\';display:block;position:absolute;height:0;left:0;right:0;bottom:0;border-bottom:1px solid "},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":";margin:0}input.od-SearchBox-input[type=text]{display:block;width:100%;padding:8px 8px 8px 41px;background-color:transparent;box-sizing:border-box;outline:0;line-height:22px;border:none;-webkit-appearance:none;-webkit-border-radius:0;height:44px;font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:"},{"theme":"mediumFontWeight","defaultValue":"400"},{"rawString":";padding:8px 8px 8px 48px}html[dir=rtl] input.od-SearchBox-input[type=text]{padding:8px 41px 8px 8px}html[dir=rtl] input.od-SearchBox-input[type=text]{padding:8px 48px 8px 8px}input.od-SearchBox-input[type=text]::-ms-clear{display:none}input.od-SearchBox-input[type=text]::placeholder{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";opacity:1;font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:"},{"theme":"mediumFontWeight","defaultValue":"400"},{"rawString":"}input.od-SearchBox-input[type=text]:placeholder{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";opacity:1;font-size:14px}.md input.od-SearchBox-input[type=text],.sm input.od-SearchBox-input[type=text]{height:48px}.od-SearchBox-iconSearchWrapper{display:block;top:0}[dir=ltr] .od-SearchBox-iconSearchWrapper{padding-left:17px}[dir=rtl] .od-SearchBox-iconSearchWrapper{padding-right:17px}[dir=ltr] .od-SearchBox-iconSearchWrapper{padding-right:6px}[dir=rtl] .od-SearchBox-iconSearchWrapper{padding-left:6px}[dir=ltr] .md .od-SearchBox-iconSearchWrapper,[dir=ltr] .sm .od-SearchBox-iconSearchWrapper{padding-left:15px}[dir=rtl] .md .od-SearchBox-iconSearchWrapper,[dir=rtl] .sm .od-SearchBox-iconSearchWrapper{padding-right:15px}.od-SearchBox-iconArrowWrapper{display:none;top:12px}[dir=ltr] .od-SearchBox-iconArrowWrapper{padding-left:16px}[dir=rtl] .od-SearchBox-iconArrowWrapper{padding-right:16px}[dir=ltr] .od-SearchBox-iconArrowWrapper{padding-right:7px}[dir=rtl] .od-SearchBox-iconArrowWrapper{padding-left:7px}.od-SearchBox-iconClearWrapper{display:none;top:0}[dir=ltr] .od-SearchBox-iconClearWrapper{padding-left:11px}[dir=rtl] .od-SearchBox-iconClearWrapper{padding-right:11px}[dir=ltr] .od-SearchBox-iconClearWrapper{padding-right:12px}[dir=rtl] .od-SearchBox-iconClearWrapper{padding-left:12px}[dir=ltr] .od-SearchBox-iconClearWrapper{right:0}[dir=rtl] .od-SearchBox-iconClearWrapper{left:0}.od-SearchBox--active{background-color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":"}.od-SearchBox--active,.od-SearchBox:hover{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}.od-SearchBox--active .od-SearchBox-search:before{content:\'\';position:absolute;top:0;bottom:0;left:0;right:0;margin:6px 0}html[dir=ltr] .od-SearchBox--active .od-SearchBox-search:before{border-right:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}html[dir=rtl] .od-SearchBox--active .od-SearchBox-search:before{border-left:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.lg .od-SearchBox--active .od-SearchBox-search:after,.md .od-SearchBox--active .od-SearchBox-search:after,.sm .od-SearchBox--active .od-SearchBox-search:after{border-bottom:0}[dir=ltr] .od-SearchBox--active .od-SearchBox-input{padding-left:16px}[dir=rtl] .od-SearchBox--active .od-SearchBox-input{padding-right:16px}[dir=ltr] .od-SearchBox--active.od-SearchBox--hasBack .od-SearchBox-input{padding-left:48px}[dir=rtl] .od-SearchBox--active.od-SearchBox--hasBack .od-SearchBox-input{padding-right:48px}.od-SearchBox--active .od-SearchBox-iconSearchWrapper{display:none}[dir=ltr] .od-SearchBox--active.od-SearchBox--hasText .od-SearchBox-input{padding-right:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--hasText .od-SearchBox-input{padding-left:40px}.od-SearchBox--active.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{display:block}.od-SearchBox--active.od-SearchBox--searchIconLeft .od-SearchBox-iconSearchWrapper{display:block}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft .od-SearchBox-input{padding-left:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft .od-SearchBox-input{padding-right:40px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-input{padding-left:73px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-input{padding-right:73px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{margin-left:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{margin-right:40px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{padding-left:10px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{padding-right:10px}.od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{display:block}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{right:0}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{left:0}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-left:11px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-right:11px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-right:12px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-left:12px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-input{padding-right:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-input{padding-left:40px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-input{padding-right:68px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-input{padding-left:68px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{margin-right:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{margin-left:40px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-left:6px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-right:6px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-right:5px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-left:5px}.od-SearchBox--active.od-SearchBox--hasBack .od-SearchBox-iconArrowWrapper{display:block}.od-SearchBox-iconWrapper{height:45px;cursor:pointer;position:absolute;z-index:1}.od-SearchBox-iconWrapper button{cursor:pointer}.sm .od-SearchBox-iconWrapper{height:44px}.od-SearchBox .ms-Icon::before{font-size:16px;color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}.md .od-SearchBox .ms-Icon::before,.sm .od-SearchBox .ms-Icon::before{font-size:20px}"},{"rawString":".od-SearchResults-suggestion{display:flex;align-items:center;margin:0 -16px;padding:8px 16px;min-height:30px;cursor:pointer}.od-SearchResults-suggestion .od-SearchResults-result-glyph,.od-SearchResults-suggestion .od-SearchResults-result-icon{flex:0 0 48px;height:48px;margin:0;text-align:center;line-height:48px}.sm .od-SearchResults-suggestion .od-SearchResults-result-glyph,.sm .od-SearchResults-suggestion .od-SearchResults-result-icon{flex:0 0 20px;height:20px;line-height:20px}.od-SearchResults-suggestion .od-IconGlyph{color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";font-size:34px}.sm .od-SearchResults-suggestion .od-IconGlyph{font-size:20px}.od-SearchResults-suggestion .od-SearchResults-result-title{position:static;display:flex;flex-direction:column;justify-content:center;margin:0 0 0 16px}html[dir=rtl] .od-SearchResults-suggestion .od-SearchResults-result-title{margin:0 16px 0 0}[dir=ltr] .od-SearchResults-suggestion .od-SearchResults-result-title{padding-left:0}[dir=rtl] .od-SearchResults-suggestion .od-SearchResults-result-title{padding-right:0}.od-SearchResults-suggestion .od-SearchResults-result-title-text{display:inline;font-size:14px;font-weight:400}.od-SearchResults-suggestion .od-SearchResults-result-metadata{display:flex;font-size:12px;font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}[dir=ltr] .od-SearchResults-suggestion .od-SearchResults-result-metadata{padding-left:0}[dir=rtl] .od-SearchResults-suggestion .od-SearchResults-result-metadata{padding-right:0}.od-SearchResults-suggestion .ms-dotSeparatorBefore{margin-left:4px}.od-SearchResults{background-color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":";border:1px solid transparent;padding:0 16px;box-sizing:border-box;box-shadow:0 0 5px 0 "},{"theme":"blackTranslucent40","defaultValue":"rgba(0,0,0,.4)"},{"rawString":";width:432px;overflow-y:auto}.md .od-SearchResults,.sm .od-SearchResults{width:100%}.od-SearchResults-hasStatus>.od-SearchResults-status{font-size:15px;font-weight:400;display:block}.od-SearchResults-status{display:none;margin:10px auto}.od-SearchResults-hasStatus>.od-SearchResults-resultsBox{display:none}.od-SearchResults-resultsBox{box-sizing:border-box;width:100%}.od-SearchResults-result{text-decoration:none;position:relative;margin-bottom:2px}.od--isNonMobile .od-SearchResults-result-link:hover,.od--isNonMobile .od-SearchResults-suggestion:hover{background:"},{"theme":"themeLighterAlt","defaultValue":"#e6f2fb"},{"rawString":";outline:1px solid transparent}.od--isNonMobile .od-SearchResults-result-link:hover.is-selected,.od--isNonMobile .od-SearchResults-suggestion:hover.is-selected{background:"},{"theme":"themeLightAlt","defaultValue":"#beddf4"},{"rawString":"}.od-SearchResults-result-link--focused{background:"},{"theme":"themeLighter","defaultValue":"#d7eaf9"},{"rawString":"}.od-focus--enabled .od-SearchResults-result-link--focused{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px dashed transparent}.od-SearchResults-expanded-result i,.od-SearchResults-result-highlight{font-weight:600;font-weight:600}.od-SearchResults-expanded-result i{font-style:normal}.od-SearchResults-result-icon{height:24px;width:24px;margin-top:5px;display:inline-block;position:relative}.od-SearchResults-result-parentFolder{display:inline-block;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}.od-SearchResults-result-title{font-size:15px;font-weight:400;box-sizing:border-box;pointer-events:none}[dir=ltr] .od-SearchResults-result-title{padding-left:40px}[dir=rtl] .od-SearchResults-result-title{padding-right:40px}.od-SearchResults-result-metadata,.od-SearchResults-result-summary{box-sizing:border-box}[dir=ltr] .od-SearchResults-result-metadata,[dir=ltr] .od-SearchResults-result-summary{padding-left:52px}[dir=rtl] .od-SearchResults-result-metadata,[dir=rtl] .od-SearchResults-result-summary{padding-right:52px}.od-SearchResults-result-metadata,.od-SearchResults-result-title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-SearchResults-result-title{position:absolute;top:0;width:100%}[dir=ltr] .od-SearchResults-result-title{left:0}[dir=rtl] .od-SearchResults-result-title{right:0}.od-SearchResults-result-title-text{vertical-align:top;display:inline-block;overflow:hidden;text-overflow:ellipsis;max-width:100%}[dir=ltr] .od-SearchResults-result-title-text{margin-right:6px}[dir=rtl] .od-SearchResults-result-title-text{margin-left:6px}.od-SearchResults-result-link{text-decoration:none;display:block;height:34px;line-height:34px;margin:0 -16px;padding:0 16px;cursor:pointer}.od-SearchResults-result-folderLink{text-decoration:none}.od-SearchResults-upscope-result{text-align:center;margin-bottom:0}.od-SearchResults-upscope-result .od-SearchResults-result-link{display:inline-block;width:100%;height:48px;line-height:48px}.od-SearchResults-upscope-result .ms-Icon--Search{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir=ltr] .od-SearchResults-upscope-result .ms-Icon--Search{margin-right:8px}[dir=rtl] .od-SearchResults-upscope-result .ms-Icon--Search{margin-left:8px}.od-SearchResults-upscope-result .od-SearchResults-result-title{position:relative;top:-2px}[dir=ltr] .od-SearchResults-upscope-result .od-SearchResults-result-title{padding-left:0}[dir=rtl] .od-SearchResults-upscope-result .od-SearchResults-result-title{padding-right:0}.od-SearchResults-progressBox{position:absolute;width:100%;top:2px}[dir=ltr] .od-SearchResults-progressBox{left:0}[dir=rtl] .od-SearchResults-progressBox{right:0}.od-SearchResults-separator-line{margin:0 -16px;border:0;border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.ms-noList ol,.ms-noList ul,ol.ms-noList,ul.ms-noList{list-style-type:none;margin-top:0;margin-bottom:0}[dir=ltr] .ms-noList ol,[dir=ltr] .ms-noList ul,[dir=ltr] ol.ms-noList,[dir=ltr] ul.ms-noList{padding-left:0}[dir=rtl] .ms-noList ol,[dir=rtl] .ms-noList ul,[dir=rtl] ol.ms-noList,[dir=rtl] ul.ms-noList{padding-right:0}.ms-dotSeparatorAfter::after{content:\'\\\\a0\\\\b7\'}.ms-dotSeparatorBefore::before{content:\'\\\\b7\\\\a0\'}.ms-enquote::before{content:open-quote}.ms-enquote::after{content:close-quote}"},{"rawString":".od-ImageFrame{display:block;position:absolute;top:0;left:0;bottom:0;right:0}"},{"rawString":".od-ImageStack{display:block;position:absolute;top:0;left:0;bottom:0;right:0;overflow:hidden}.od-ImageStack-tile{display:block;position:absolute;top:0;left:0;bottom:0;right:0;opacity:0}.od-ImageStack-tile--isLoaded{opacity:1}.od-ImageStack--fade .od-ImageStack-tile--isLoaded{transition:opacity 217ms linear 50ms}"},{"rawString":".od-ImageTile{display:block;position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.od-ImageTile img{display:block}.od-ImageTile--cover .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:cover;background-repeat:no-repeat;background-position:center}.od-ImageTile--fit .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:contain;background-repeat:no-repeat;background-position:center}.od-ImageTile-image{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile-image,a .od-ImageTile-image{border:none}.od-ImageTile-background{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:0}}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isCustom .od-ImageTile-image{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned .od-ImageTile-image{opacity:1}}.od-ImageTile--isRotating .od-ImageTile-image{transition:transform 167ms cubic-bezier(.1, .25, .75, .9)}"},{"rawString":".ProgressSpinnerFlat{position:relative;box-sizing:border-box;padding:2px 0;overflow:hidden;height:6px;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";font-size:15px}.ProgressSpinnerFlat>div{position:relative;line-height:0;cursor:default;animation:progress 3.4s infinite cubic-bezier(0,.75,1,.25)}[dir=ltr] .ProgressSpinnerFlat>div{left:-50px}[dir=rtl] .ProgressSpinnerFlat>div{right:-50px}[dir=rtl] .ProgressSpinnerFlat>div{animation:progressRtl 3.4s infinite cubic-bezier(0,.75,1,.25)}.ProgressSpinnerFlat>div:first-child{animation-delay:.1s}[dir=ltr] .ProgressSpinnerFlat>div:first-child{margin-left:40px}[dir=rtl] .ProgressSpinnerFlat>div:first-child{margin-right:40px}.ProgressSpinnerFlat>div:nth-child(2){animation-delay:.2s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(2){margin-left:30px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(2){margin-right:30px}.ProgressSpinnerFlat>div:nth-child(3){animation-delay:.3s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(3){margin-left:20px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(3){margin-right:20px}.ProgressSpinnerFlat>div:nth-child(4){animation-delay:.4s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(4){margin-left:10px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(4){margin-right:10px}.ProgressSpinnerFlat>div:nth-child(5){animation-delay:.5s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(5){margin-left:0}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(5){margin-right:0}@keyframes progress{from{left:-50px}25%{left:-50px}to{left:100%}}@keyframes progressRtl{from{right:-50px}25%{right:-50px}to{right:100%}}"},{"rawString":".od-Overlay{height:0;width:0;overflow:hidden}"},{"rawString":".od-ListGroupHeader{height:32px;line-height:32px;margin-top:20px;font-size:21px;font-weight:100;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";position:relative;padding:4px 0}.od-ListGroupHeader:hover{background-color:"},{"theme":"themeLighterAlt","defaultValue":"#e6f2fb"},{"rawString":"}.od-ListGroupHeader:hover .od-ListGroupHeader-check{opacity:1}.od-ListGroupHeader.is-focused{background:"},{"theme":"themeLighter","defaultValue":"#d7eaf9"},{"rawString":";box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}.od-ListGroupHeader.is-focused .od-ListGroupHeader-check{opacity:1}[dir=ltr] .od-ListGroupHeader.showCheckbox{padding-left:0}[dir=rtl] .od-ListGroupHeader.showCheckbox{padding-right:0}.od-ListGroupHeader.dropping{box-shadow:inset 0 0 0 3px "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.od-ListGroupHeader-title{display:inline-block;cursor:pointer;outline:0}[dir=ltr] .od-ListGroupHeader-title{padding-left:14px}[dir=rtl] .od-ListGroupHeader-title{padding-right:14px}[dir=ltr] .od-ListGroupHeader-title{margin-left:-6px}[dir=rtl] .od-ListGroupHeader-title{margin-right:-6px}.od-ListGroupHeader-loading{padding:0 20px}.od-ListGroupExpandButton.ms-Icon{height:32px;line-height:32px;text-align:center;transform:rotate(-180deg);transform-origin:50% 50%;width:32px;vertical-align:top;padding:4px 0;margin-top:-4px;outline:0}.od-ListGroupExpandButton.ms-Icon:hover{background-color:"},{"theme":"themeLightAlt","defaultValue":"#beddf4"},{"rawString":"}.od-ListGroupHeader.is-collapsed .od-ListGroupExpandButton{transform:rotate(0)}.od-ListGroupHeader-check{display:inline-block;vertical-align:top;padding:7px 14px 7px 8px;font-size:14px;font-weight:400;opacity:0}html[dir=rtl] .od-ListGroupHeader-check{padding:7px 8px 7px 14px}.od-ListGroupHeader-check:hover{opacity:1}"},{"rawString":".ItemCheck{display:none;position:relative;width:18px;height:18px;cursor:default;-webkit-touch-callout:none;-ms-user-select:none;user-select:none}.can-select .ItemCheck{display:block}.ItemCheck:before{background:"},{"theme":"white","defaultValue":"#fff"},{"rawString":";content:\'\';width:16px;height:16px;position:absolute;border-radius:50%;left:1px;top:1px}.ItemCheck-circle{font-size:18px;position:absolute;left:0;top:0;width:18px;height:18px;line-height:18px;color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.ItemCheck-check{font-size:16px;position:absolute;left:1.5px;top:0;color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";opacity:0;width:16px;height:16px;line-height:16px}.od--isNonMobile .ItemCheck:hover .ItemCheck-check{opacity:1}.is-selected .ItemCheck:before{background:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.is-selected .ItemCheck .ItemCheck-circle{color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":"}.is-selected .ItemCheck .ItemCheck-check{color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":";opacity:1}"},{"rawString":".od-ListGroupSeeMore{font-size:14px;line-height:34px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-ListGroupSeeMore.needPadding{padding:0 80px}.od-ListGroupSeeMore.is-focused{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}.od-ListGroupSeeMore span{padding:4px 8px;cursor:pointer}"},{"rawString":"#obf-TPromptContainer:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}#obf-ToastContainer{background-color:"},{"theme":"menuBackground","defaultValue":"#fff"},{"rawString":";border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}#obf-ToastContainer #obf-TFormComment{background-color:"},{"theme":"menuBackground","defaultValue":"#fff"},{"rawString":"}#obf-ToastContainer #obf-TFormTitle,#obf-ToastContainer #obf-TPromptTitle{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}#obf-ToastContainer .obf-ChoiceGroup input[type=radio]:checked+label>.obf-ChoiceGroupIcon>span{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}#obf-ToastContainer .obf-ChoiceGroup input[type=radio]:checked+label>.obf-ChoiceGroupIcon{border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}#obf-ToastContainer #obf-TFormRating,#obf-ToastContainer #obf-TPromptText,#obf-ToastContainer #obf-ToastCancel svg path{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";fill:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}#obf-ToastContainer .obf-Link{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}#obf-ToastContainer .obf-TextInput{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}#obf-ToastContainer .obf-TextInput::placeholder{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}#obf-ToastContainer .obf-Link:focus,#obf-ToastContainer .obf-SubmitButton:focus{outline-color:"},{"theme":"black","defaultValue":"#000"},{"rawString":"}#obf-ToastContainer .obf-ChoiceGroup input:focus+label{outline-color:"},{"theme":"black","defaultValue":"#000"},{"rawString":"}#obf-ToastContainer .obf-SubmitButton[disabled],#obf-ToastContainer .obf-SubmitButton[disabled]:active,#obf-ToastContainer .obf-SubmitButton[disabled]:focus,#obf-ToastContainer .obf-SubmitButton[disabled]:hover{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":";color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}"},{"rawString":".od-Banner{display:flex;position:relative;border:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-Banner.od-Banner-hide{display:none}.od-Banner-imageContainer{display:flex;flex-direction:column;align-items:center}.od-Banner-imageContainer.od-Banner-imageBottom{justify-content:flex-end}.od-Banner-imageContainer.od-Banner-imageCenter{justify-content:center}.sm .od-Banner-imageContainer{display:none}.md .od-Banner-imageContainer{display:none}.od-Banner-messageContainer{padding:15px}.od-Banner-messageContainer--vertical{display:flex;width:100%}.od-Banner-header{margin:5px 0;font-size:21px;font-weight:100}.od-Banner-message{font-size:14px;font-weight:400}.od-Banner-message--vertical{position:absolute;transform:translate(0,-50%);top:50%}.od-Banner-button--horizontal{margin-top:10px}[dir=ltr] .od-Banner-button--vertical{margin-left:auto}[dir=rtl] .od-Banner-button--vertical{margin-right:auto}.od-Banner-close.ms-Button.ms-Button--icon{position:absolute;top:12px;padding:0}[dir=ltr] .od-Banner-close.ms-Button.ms-Button--icon{right:12px}[dir=rtl] .od-Banner-close.ms-Button.ms-Button--icon{left:12px}.od-Banner-icon{margin:auto 5px auto 0;vertical-align:-3px}html[dir=rtl] .od-Banner-icon{margin:auto 0 auto 5px}"},{"rawString":".od-TeamChannelBanner{display:flex;margin:auto;animation-name:ms-fadeIn;animation-duration:367ms;animation-timing-function:cubic-bezier(0.1,0.9,0.2,1);animation-fill-mode:both;animation-timing-function:cubic-bezier(0.455,0.03,0.515,0.955);animation-duration:1.1s}@media (prefers-reduced-motion:reduce){.od-TeamChannelBanner{animation:none}}"},{"rawString":".IFrameDialog_15529515 .ms-Dialog-main{width:100%;max-width:600px}.IFrameDialog_15529515 iframe{border:none;width:100%}"},{"rawString":".librariesDropdown_bddb0aff{font-size:16px;display:inline-flex;outline:transparent;background-color:"},{"theme":"themeLighter","defaultValue":"#deecf9"},{"rawString":";color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";border:none;border-radius:2px;padding-top:4px;padding-bottom:4px;padding-left:6px;padding-right:6px;margin-right:4px}.librariesDropdownWithFocus_bddb0aff:focus{outline:1px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":";box-shadow:none!important}.librariesDropdownNotOpen_bddb0aff:hover{background-color:"},{"theme":"themeLight","defaultValue":"#c7e0f4"},{"rawString":";color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}.librariesDropdownOpen_bddb0aff,.librariesDropdown_bddb0aff:active{background-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}.librariesDropdownOpen_bddb0aff .librariesDropdownChevron_bddb0aff,.librariesDropdown_bddb0aff:active .librariesDropdownChevron_bddb0aff{color:"},{"theme":"black","defaultValue":"#000"},{"rawString":"}.librariesDropdownOpen_bddb0aff .librariesDropdownIcon_bddb0aff,.librariesDropdown_bddb0aff:active .librariesDropdownIcon_bddb0aff{color:"},{"theme":"black","defaultValue":"#000"},{"rawString":"}.librariesDropdownChevron_bddb0aff{font-size:12px;margin-top:2px}[dir=ltr] .librariesDropdownChevron_bddb0aff{margin-left:5px}[dir=rtl] .librariesDropdownChevron_bddb0aff{margin-right:5px}"}]'))},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"AuthTokenMonitor.key",loader:new i.t(function(){return Promise.resolve().then(n.bind(null,5329)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"t",function(){return u});var a=n(142),i=n(43),r=n(40),o=n(14),s=n(72),c=n(4845),d=n(1432),l=function(){function e(e,t){this._pageContext=t.pageContext,this._listContext=t.listContext,this._rumoneHelper=t.rumoneHelper}return e.arePowerAppsFormsEnabled=function(){var t=Object(i.isFeatureEnabled)(i.PowerAppListForms)&&Object(i.isFeatureEnabled)(i.PowerApps);return e.arePowerAppsFormsEnabled=function(){return t},t},e.prototype.isPowerAppsSupportedScenario=function(){var t=Number(this._pageContext.webTemplate)===s.t.mySite;if(!e.arePowerAppsFormsEnabled()||!this._checkPowerAppState())return!1;switch(Number(this._pageContext.listBaseTemplate)){case o.n.documentLibrary:return!t;case o.n.genericList:default:return!0}},e.prototype.mayHavePowerAppsForm=function(){return this._checkPowerAppState()},e.prototype.ensurePowerAppSdkPreloaded=function(){var t=e.arePowerAppsFormsEnabled();if(!this._powerAppSdkLoaded&&t){var n="PowerappPreloadLastTime";if(c.resourceNeedsPreload(n,864e5))if(c.setPreloadDone(n),this._rumoneHelper.rumone.addEUPLBreakdown("powerAppSdkPreload",{data:!0,needFlatten:!0}),Object(i.isFeatureEnabled)(i.PowerAppsAndAndProcessSimpleTestEnvironment))c.preload("https://apps.test.powerapps.com/sdk/preload");else{var a=this._pageContext.farmSettings&&this._pageContext.farmSettings.ExternalService_powerappsappshostname;a||(a="apps.powerapps.com"),c.preload("https://".concat(a,"/sdk/preload"))}this._powerAppSdkLoaded=!0}},e.prototype._checkPowerAppState=function(){return!Object(i.isFeatureEnabled)(i.CustomActionPreFetch)||!this._listContext||!1!==this._listContext.checkPowerAppState},e.dependencies={pageContext:r.f,rumoneHelper:d.n,listContext:r.o.optional},e}(),u=Object(a.r)("PowerAppsVerifier",l)},function(e,t,n){"use strict";n.r(t),n.d(t,"resourceNeedsPreload",function(){return c}),n.d(t,"setPreloadDone",function(){return d}),n.d(t,"preload",function(){return l});var a=n(216),i=n(226),r=n(113),o=new a.e,s=new i.e("ResourceReloader");function c(e,t){var n=s.getValue(e,r.e.local);return void 0===n||Date.now()-n>t}function d(e){s.setValue(e,Date.now(),r.e.local)}function l(e,t,n){void 0===t&&(t=1e4),void 0===n&&(n="scriptPreloadingHelper"),o.setTimeout(function(){var t=document.createElement("iframe");t.id=n,t.name=n,t.style.visibility="hidden",t.style.position="absolute",t.style.top=t.style.left=t.style.height=t.style.width="0",document.body.appendChild(t),(t=document.getElementById(n)).src=e},t)}},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(186),r=n(129),o=n(15),s=n(4852),c=Object(r.t)(function(e){return function(t){var n;t(Object(i.e)({items:(n={},n[o.c]=Object(a.__assign)({},s.e.pack({bannerState:e.bannerState})),n)}))}})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("localModelCreationWarning")},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(4854),r=n(142),o=n(40),s=function(e){function t(t,n){return e.call(this,n.pageContext)||this}return Object(a.__extends)(t,e),t}(i.e),c=Object(r.r)("MicroserviceEndPointDataSource.key",s,{pageContext:o.f})},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"KOToItemCacheOperationProvider.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred.odsp-common"),n.e(808)]).then(n.bind(null,5047)).then(function(e){return e.resourceKey})})})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return U});var a=n(0),i=n("react-lib"),r=n(41),o=n(89),s=n(121),c=n(31),d=n(1),l=n(771),u=n(231),f=n(616),p=n(107),m=n(691),_=n(339),h=n(47),b=n(14),g=n(45),v=n(987),y=n(22),S=n(87),D=n(118),I=n(61),x=n(3),C=n(23),O=n(207),w=n(28),E=n(4242),A=Object(u.t)(function(){return{type:"file",extFilters:Object(x.Jr)(x.y)?[".docx",".dotx"]:[".docx"],selectionMode:"single"}})(l.e),L=Object(S.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(167).then(n.bind(null,5336))];case 1:return[2,e.sent().SmartTemplateFilePickerWrapper]}})})}),k=Object(S.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(165).then(n.bind(null,4680))];case 1:return[2,e.sent().AddSmartTemplateErrorDialog]}})})});function M(e){var t=e.onContinue,n=e.onCancel,r=Object(a.__rest)(e,["onContinue","onCancel"]),o=i.useState(),s=o[0],c=o[1];return s?i.createElement(k,{errorText:s.message,onRetryClick:function(){c(void 0)},onCancelClick:function(){n()}}):i.createElement(A,Object(a.__assign)({},r,{onContinue:function(e){for(var n=!0,a=0,i=e;a<i.length;a++){var r=i[a];".docx"===r.name.slice(r.name.length-5)||Object(x.Jr)(x.y)&&".dotx"===r.name.slice(r.name.length-5)||(n=!1)}n?t(e):c(new Error(E.e.invalidFileErrorDescription))},onCancel:n}))}var P=Object(h.e)(function(){return{fileSelector:M}})(f.e),T=Object(m.n)({uploadItemsAction:_.e}),U=Object(h.t)(function(e,t){var n,l=Object(r.e)(e),u=Object(p.e)(e),f=Object(g.e)(e,l);if(!u||!l||!f)return null;var m=e.demandItemFacet(o.e,l),_=m&&s.e.serialize(m),h=e.demandItemFacet(d.We,_),v=m?m.webAbsoluteUrl:"",y=(null==m?void 0:m.listFullUrl)?m.listFullUrl:"",S=(null==h?void 0:h.id)?h.id.replace("{","").replace("}",""):"",D=f.canUserUseSyntex;if(!(y&&v&&S&&h&&h.isDocumentLibrary&&h.templateType===b.t.documentLibrary&&(null===(n=null==h?void 0:h.permissions)||void 0===n?void 0:n.manageLists)&&h.newWOPIDocumentEnabled&&D))return null;var I=e.demandItemFacet(c.e,u);if(!I)return null;var x=I.listFullUrl;if(!x)return null;var C=new O.e("".concat(x,"/Forms")).path,E=c.e.serialize(Object(a.__assign)(Object(a.__assign)({},I),{rootFolder:C}));return i.createElement(F,Object(a.__assign)({currentItemKey:u,currentItemSetKey:l,pageContext:f,formsItemKey:E,isFREShown:t.isFREShown||!1},Object(w.t)(e,{itemKey:u,engagement:{name:"AddSmartTemplate"}})))});function F(e){var t=this,n=Object(v.e)(),r=n[0],o=n[1];if(e.currentItemKey)return i.createElement(i.Fragment,null,r,i.createElement(C.e,Object(a.__assign)({onExecute:function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,s=this;return Object(a.__generator)(this,function(c){switch(c.label){case 0:return t=function(t){return Object(a.__awaiter)(s,void 0,void 0,function(){var r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=function(){return{targetItemKey:e.formsItemKey,onItemUploaded:function(e){return function(n){var a=e.progressItemKey,i=n(Object(D.e)(function(e){var t;return null===(t=e.demandItemFacet(I.r,a))||void 0===t?void 0:t.itemKey}));t(i)}}}},[4,o(i.createElement(T,{value:{uploadItemsAction:r}},i.createElement(P,{itemKey:e.currentItemKey})),n)];case 1:return a.sent(),[2]}})})},r=function(n){return Object(a.__awaiter)(s,void 0,void 0,function(){return Object(a.__generator)(this,function(r){switch(r.label){case 0:return[4,Object(y.o)(function(n){return i.createElement(L,Object(a.__assign)({},e,{wizardProps:n,executeUploadFilePickerAction:t}))})(n)];case 1:return r.sent(),[2]}})})},[4,r(n)];case 1:return c.sent(),[2]}})})}},e)))}},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(186),r=n(129),o=n(15),s=n(4866),c=Object(r.t)(function(e){return function(t){var n;t(Object(i.e)({items:(n={},n[o.c]=Object(a.__assign)({},s.e.pack(e.modelPublishDetails)),n)}))}})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("modelPublishedBanner")}],Array(28),[function(e,t,n){"use strict";var a=n(0),i=n(136),r=function(){function e(){}return e.isOpenDebugWindowEvent=function(e){return!(e.keyCode!==i.e.graveAccent||!e.ctrlKey&&!e.altKey||e.shiftKey)},e.isOpenSimplePerfDashboardEvent=function(e){return!(e.keyCode!==i.e.f8||!e.ctrlKey&&!e.altKey||e.shiftKey)},e.initSimplePerfDashboard=function(t){e._perfDashboardOpen||(e._markPerfDashboardOpen(!0),n.e(685).then(n.bind(null,4687)).then(function(n){n.show(t,e._markPerfDashboardOpen)}))},e.isInitialized=function(){return e._initialized},e.init=function(t){e._initialized||Object(a.__awaiter)(this,void 0,void 0,function(){var i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,n.e(571).then(n.bind(null,5354))];case 1:return i=a.sent().default,e._initialized||(e._initialized=!0,i.init(t)),[2]}})})},e.enableAutoOpen=function(e){},e._markPerfDashboardOpen=function(t){e._perfDashboardOpen=t},e.AutoOpenSessionKey="DebugWindow_AutoOpen",e}();t.e=r},,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(1614),i=n(142),r=n(40),o=Object(i.r)("PageContextEngagementHandler",a.e,{pageContext:r.f})},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"CoachmarkProvider.key",loader:new i.t(function(){return Promise.resolve().then(n.bind(null,2924)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(8),i=n(142),r=new a.t({name:"PowerAppHostLoader.key",loader:new i.t(function(){return Promise.resolve().then(n.bind(null,5481)).then(function(e){return e.resourceKey.local})})})}],Array(149),[function(e,t,n){"use strict";n.d(t,"e",function(){return $});var a=n(0),i=n(1203),r=n(7),o=n(849),s=n(3714),c=n(38),d=n(79),l=["AverageRating","RatedBy","Ratings","LikesCount","LikedBy"],u=n(972),f=n(846),p=n(2383),m=n(2429),_=n(2299),h=n(8),b=n(142),g=new h.t({name:"ListItemTrendingStatusProcessor.key",loader:new b.t(function(){return n.e(729).then(n.bind(null,5670)).then(function(e){return e.resourceKey})})}),v=n(213),y=n(253),S=n(1331),D=n(1316),I=n(4434),x=n(2634),C=n(3164),O=n(43),w=n(2621),E=n(3715),A=n(76),L=n(52),k=n(14),M=n(101),P=n(4435),T=n(40),U=n(4436),F=n(147),H=n(2274),R=n(1334),N=n(148),B=n(1422),j=n(990),V=n(197),z=n(2132),G=n(1358),K=n(90),W=n(1385),q=n(3572),Q=n(37),Y=n(1234),J=n(11).e.isActivated("D6DFF276-FF92-454E-AC05-F916D87BD82F","03/08/2022","Update the openUrl for items in a links list with the correct URL from server"),X=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageContext=n.pageContext,a._urlDataSource=n.urlDataSource,a._listContext=n.listContext,a._navigation=n.navigation,a._microServiceDataSource=n.microServiceDataSource,a._vroomUrlHelper=n.vroomUrlHelper,a._itemUrlHelper=n.itemUrlHelper,a._vroomDataContext=n.vroomDataContext,a._shortcutLinkDataSource=n.shortcutLinkDataSource,a._allowWrsVisio=!1,a._htmlDecodeDiv=document.createElement("textarea"),a}return Object(a.__extends)(t,e),t.prototype.getItemResult=function(e){try{return this._getItemResult(e)}catch(e){throw K.e.log(e,"ListItemBuilder.getItemResult"),e}},t.prototype._getItemResult=function(e){var t,n,i,l,h,b=e.itemFromServer;if(!b)return null;var I,M=e.microServiceDataSource||this._microServiceDataSource,T=this._urlDataSource,U=e.requestKey,F=e.parentItemKey,N=e.queryType,B=void 0===N?T.getQueryType():N,j=e.groupBy,K=e.itemGroups,W=e.contentTypes,Y=e.supportsNestedGroups,X=e.isItemDataOnly,$=e.listTemplateType,ee=void 0===$?this._listContext.listTemplateType:$,te=e.observer,ne=e.isMetaDataSearch,ae=T.getKeyParams(U),ie=this._itemUrlHelper.getUrlParts({path:b.id||b.FileRef||b.ServerRelativeUrl,listUrl:ae[r.n.listUrlKey]});(t={})[r.n.idParamKey]=ie.serverRelativeItemUrl,t[r.n.listUrlKey]=ie.normalizedListUrl,I=t;var re=b.File_x0020_Type,oe=re?"."+re:"",se=this._parseMediaServiceMetadata(b.MediaServiceFastMetadata),ce=this._parseMediaServiceMetadata(b.MediaServiceMetadata),de=this._getItemType({itemFromServer:b,listTemplateType:ee,microServiceDataSource:M,mediaServiceFastMetadata:se});if(de===y.e.Folder){var le=ae[r.n.idParamKey]===I[r.n.idParamKey],ue=T.getItemTypeFilter(ae),fe={};le?((n={})[r.n.queryTypeParamKey]=ae[r.n.queryTypeParamKey],n[r.n.queryParamKey]=ae[r.n.queryParamKey],n[r.n.typeFiltersKey]=ae[r.n.typeFiltersKey],fe=n):(B!==c.e.Search&&((i={})[r.n.queryTypeParamKey]=B,fe=i),ue&&V.e(fe,T.saveItemTypeFilter(ue))),V.e(I,fe),ne&&V.e(I,((l={})[r.n.metadataSearchIdKey]=ae[r.n.metadataSearchIdKey],l))}var pe=T.getKey(I),me={key:pe,extension:oe},_e=b.id||b.FileRef;me.id=_e;var he,be,ge=C.t.fromHexString(b.PermMask),ve=Q.e.hasPermission(ge,Q.e.openItems),ye=this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled||!ve,Se=b[".spItemUrl"];if(Se){var De=this._vroomUrlHelper.getUrlParts(Se);he=De.itemId,be=De.driveId}else he=b["name.FileSystemItemId"]||(b.isRootFolder?"root":void 0);this._vroomDataContext&&he&&this._vroomDataContext.setFileSystemIdMapping(he,_e);var Ie=b[".etag"];Ie&&(me.eTag=Ie),me.itemId=R.optional(he);var xe=ee===k.t.mySiteDocumentLibrary;me.graph=R.optional(he&&{itemId:he,driveId:be,driveType:ee?xe?"business":"documentLibrary":void 0});var Ce=Number(b._ip_UnifiedCompliancePolicyUIAction)||_.e.none;"1"===this._navigation.viewParams[r.n.pseudoPolicyTipKey]&&(Ce=Number(b.ID)%6),me.policyTip=R.optional(Ce);var Oe=Object(P.t)(oe);if((Oe||".ai"===oe||".eps"===oe||".psd"===oe)&&M.getThumbnail({fileExtension:oe,item:b,itemKey:pe,mediaServiceMetadata:se})&&(de=y.e.Media),q.t(oe)?me.htmlConversion={}:q.e(oe)&&(we=M.getHtmlConversionUrl({fileExtension:oe,item:b,mediaServiceMetadata:se}))&&(de=y.e.Media,me.htmlConversion={url:"".concat(we,"&inlineImages=true")}),Object(O.isFeatureEnabled)(O.EnableZipFilePreviewing)&&(".zip"===oe||".rar"===oe)){var we=M.getZipMetaDataUrl({fileExtension:oe,item:b,mediaServiceMetadata:se}),Ee=M.getDownloadZipContentsUrl(b);we&&Ee&&(de=y.e.Media,me.zip={zipMetaDataUrl:we,downloadZipContentsUrl:Ee})}var Ae,Le,ke,Me,Pe,Te,Ue={},Fe=M.getDownloadAsZipUrl(b),He=Object(O.isFeatureEnabled)(O.EnableOpenInImmersiveReader)&&M.getImmersiveReaderUrl({fileExtension:oe,item:b});Fe&&(Ue[o.t.downloadAsZip]=Fe),He&&(Ue[o.t.immersiveReaderUrl]=He),Se&&(Ue[o.t.itemUrl]=Se);var Re=this._listContext,Ne=Number(b.File_x0020_Size)||Number(b.FileSizeDisplay)||void 0,Be=se&&se.video,je=".ts"===oe&&Ne<1<<19&&!Be;je&&(de=y.e.File);var Ve=se&&se.media,ze=ie.fullItemUrl,Ge=ze?f.e(ze):void 0;if(de===y.e.Folder)Ae=b.ProgId&&"sharepoint.documentset"===b.ProgId.toLowerCase();else if(de!==y.e.Media&&!se||Object(k.o)(ee))de===y.e.File&&Re&&void 0!==Re.isDocLib&&!Re.isDocLib&&(Le={});else{var Ke=u.n(oe),We=se&&se.photo||(Oe||"photo"===Ke?{}:void 0),qe=Be||("video"===Ke?{}:void 0),Qe=se&&se.audio||("audio"===Ke?{}:void 0);We&&(ke={originalUrl:R.optional("photo"===Ke?Ge:void 0),width:We.width||0,height:We.height||0},Object(O.isFeatureEnabled)(O.Image360Viewer)&&he&&(Me=this._getImage360(b,se,We,ce))),qe&&(Pe={fourCC:R.optional(qe.fourCC||(".mp4"===oe.toLowerCase()?"H264":void 0)),bitrate:R.optional(qe.encodingBitrate),width:qe.frameWidth||0,height:qe.frameHeight||0,duration:Z(Ve&&Ve.duration),audioFormat:R.optional(Qe&&Qe.format),manifestMetadata:qe.manifestMetadata,altManifestMetadata:qe.altManifestMetadata}),Qe&&(Te={duration:Z(Ve&&Ve.duration)})}var Ye=Ve&&Ve.title;me.caption=R.optional(Ye),me.photo=R.optional(ke),me.image360=R.optional(Me),me.video=R.optional(Pe),me.audio=R.optional(Te),me.listItem=R.optional(Le),F&&(me.parentKey=F),me.isDocSet=R.optional(Ae),ie.serverRelativeItemUrl===ie.serverRelativeListUrl&&(me.isRootFolder=!0);var Je,Xe=z.e.getItemName(b,de,Re);me.name=R.optional(Xe),me.displayName=R.optional(Xe);var Ze,$e=!0;if(b.Modified&&"21"===this._pageContext.webTemplate&&Object(O.isFeatureEnabled)(O.RequestDatesInUtc))try{var et=new Date(b.Modified);me.dateModifiedTime=et,me.dateModifiedValue=et.getTime(),Je=Object(S.s)(et),$e=!1}catch(e){}if($e&&(me.dateModifiedValue=R.optional(b.Modified),Je=b["Modified.FriendlyDisplay"]?Object(D.e)(b["Modified.FriendlyDisplay"]):b.Modified?"".concat(b.Modified):""),me.dateModified=R.optional(Je||void 0),me.permissions=R.optional(ge),K&&j&&j.length>0)if(Y){K[0]||(K[0]=[]);var tt=K[0]&&K[0].length>0?K[0][K[0].length-1]:null,nt=j[0],at=j[1];if(nt&&"1"===b[nt+".newgroup"]){var it=tt?tt.startIndex+tt.count:0,rt=Object(G.t)(Re,b,nt,0,!1,it),ot=this._convertToODNGroup(rt);K[0].push(ot),tt=ot}if(at&&"1"===b[at+".newgroup"]){var st=tt&&tt.children&&tt.children.length>0?tt.children[tt.children.length-1]:null;it=st?st.startIndex+st.count:tt?tt.startIndex:0,Object(G.t)(Re,b,at,1,!1,it,tt);var ct=tt.children.pop();tt.children.push(this._convertToODNGroup(ct))}}else for(var dt=0;dt<j.length;dt++){var lt=j[dt];if(lt){var ut=K[dt]&&K[dt].length>0?K[dt][K[dt].length-1]:null;"1"===b[lt+".newgroup"]&&(it=ut?ut.startIndex+ut.count:0,ot=Object(G.t)(Re,b,lt,dt,!1,it),K[dt]||(K[dt]=[]),K[dt].push(this._convertToODNGroup(ot)))}}if(W&&W.length>0&&b.ContentTypeId)for(var ft=0,pt=W;ft<pt.length;ft++){var mt=pt[ft];if(b.ContentTypeId===mt.contentTypeId&&(Ze=!1,mt.requiredFields))for(var _t=0,ht=mt.requiredFields.split(",");_t<ht.length;_t++){var bt=b[ht[_t]];if(!bt||Array.isArray(bt)&&0===bt.length){Ze=!0;break}}}me.hasMissingMetadata=R.optional(Ze),me.contentTypeId=R.optional(b.ContentTypeId);var gt,vt,yt,St,Dt,It=b.folder,xt=[];if(It){if(me.folder={},me.isDropEnabled=!0,gt=[],It.children){for(var Ct=0,Ot=It.children,wt=Ot.length,Et=0,At=0;At<wt;At++){var Lt=this.getItemResult({requestKey:U,queryType:B,itemFromServer:Ot[At],groupBy:j,itemGroups:xt,contentTypes:W,listTemplateType:ee,supportsNestedGroups:Y,isItemDataOnly:X,observer:te,isMetaDataSearch:ne,pageContext:e.pageContext});Lt&&(gt[At]=Lt.item,Et<10&&Lt.itemType===y.e.Media&&Ct++,Et++)}wt>0&&(Ct>=10||Ct>=wt)&&(me.displayType=c.e.Photos)}}else{if(yt=(yt=b["serverurl.progid"])?yt.substring(1):J||ee!==k.t.links?Ge:b.URL,Ue[o.t.original]=yt,Object(O.isFeatureEnabled)(O.ShortcutLink)&&x.e.isShortcutItem({key:pe,extension:oe})&&(de=y.e.Shortcut,b._ShortcutUrl?(me.shortcutInfo={shortcutLinkRewritten:!0},Ue[o.t.shortcutTarget]=this._shortcutLinkDataSource.generateShortcutsOpenUrl(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl,b._ShortcutUrl,b._ShortcutSiteId,b._ShortcutWebId,b._ShortcutUniqueId),b._ShortcutUniqueId&&(vt=s.previewImageUrl({url:b._ShortcutUrl,siteId:b._ShortcutSiteId,webId:b._ShortcutWebId,uniqueId:b._ShortcutUniqueId},this._pageContext.webAbsoluteUrl,this._pageContext))):(me.shortcutInfo=R.backup({shortcutLinkRewritten:!1}),this._shortcutLinkDataSource.enqueueParseShortcut(pe,e.itemFromServer.ID),Ue[o.t.shortcutTarget]=d.t.concatenate(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl)+"/ShortcutLink.aspx?shortcut="+A.e.encodeURIComponent(b.FileRef))),Ue[o.t.open]=yt,St=b["File_x0020_Type.mapapp"]||b["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],ie.isCrossDomain&&ie.isCrossList){var kt=b[".fileType"],Mt=w.s(kt||"");St=void 0===Mt?kt?void 0:St:Mt,"OneNote.Notebook"===b.HTML_x0020_File_x0020_Type&&(St="onenote|UsePlain"),"pdf"===b.File_x0020_Type&&(St=void 0)}me.size=R.optional(Ne),me.totalSize=R.optional(Number(b.SMTotalSize)||void 0),vt||(vt=this._getThumbnail({itemFromServer:b,listTemplateType:ee,extension:oe,key:pe,type:de,mediaServiceFastMetadata:se,microServiceDataSource:M,pageContext:e.pageContext})),me.openUrl=yt;var Pt=b["IconOverlay.mapoly"];Pt&&(me.overlayUrl="/"+this._pageContext.layoutsUrl+"/images/"+Pt),me.thumbnail=vt;var Tt=this._getPdfConversionFacet({extension:oe,blockDownload:ye,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:se});Tt&&(me.pdfConversion=Tt);var Ut=this._get3dFacet({extension:oe,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:se});if(Ut&&(me.model3d=Ut),de===y.e.Folder){var Ft=Number(b.ItemChildCount)+Number(b.FolderChildCount);me.childCount=Ft;var Ht=Number(b.SMTotalFileCount);me.folder={totalCount:Ht>0?Ht:Ft,childCount:Ft},me.isDropEnabled=!0}var Rt=b.ServerRedirectedEmbedUrl;Rt&&(this._itemUrlHelper.getUrlParts({path:Rt}).isCrossDomain||(Dt=Rt))}me.previewIFrameUrl=Dt,me.type=de,me.appMap=R.optional(St),this._pageContext.blockDownloadsExperienceEnabled&&(me.type===y.e.Media||yt&&St)?me.itemStatus=v.t.ConditionalAccessViewOnly:this._pageContext.blockDownloadsExperienceEnabled&&de!==y.e.Folder?me.itemStatus=v.t.ConditionalAccessBlocked:this._pageContext.viewOnlyExperienceEnabled&&(me.itemStatus=v.t.ConditionalAccessViewOnly);var Nt={};for(var Bt in b)b.hasOwnProperty(Bt)&&(Nt[Bt]=b[Bt]);var jt=L.e.normalizeLower(b.UniqueId)||void 0;jt&&(Nt.uniqueId=jt);var Vt=b.RemoteItem;me.remoteItem=Vt&&JSON.parse(Vt),me.reputationProperties=this.getReputationProperties(b);var zt,Gt=Xe;oe&&(Gt=Xe.substring(0,Xe.toLowerCase().lastIndexOf(oe.toLowerCase()))),me.sharingRole=p.e.Owner,zt=Number(b.PrincipalCount)>0?m.e.Shared:void 0===b.PrincipalCount?O.isOneDrive?void 0:m.e.Unknown:m.e.Private,me.sharingType=R.optional(zt),Nt.FileName=Gt;var Kt=u.a({extension:oe,isDocSet:Ae,listItem:Le,sharingType:zt,type:de,textEditorMimeType:je?"text/typescript":void 0,panorama:Me,isMountPoint:!!Vt});me.iconName=Kt;var Wt,qt,Qt="ms-powerpoint"===St,Yt="ms-visio"===St,Jt="ms-word"===St;if(yt&&(Jt||"ms-excel"===St||Qt||Yt)){var Xt=this._getOfficeBundleFacet({isWord:Jt,extension:oe,itemUrlParts:ie,isPowerPoint:Qt,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:se});!Xt||Yt&&!this._allowWrsVisio||(me.officeBundle=Xt),Xt&&(Jt||Qt)&&(Ue[o.t.viewInBrowser]=M.getPdfConversionUrl({fileExtension:oe,item:b,mediaServiceMetadata:se},!0)),me.wopiFrameUrl=yt}me.defaultSubText=E.e(E.t(b.Editor)),me.isPlaceholder=!b.PermMask,me.queryType=B,me.displayType=R.backup(me.queryType),me.isDraggable=me.queryType===c.e.Files,b.folder||(Nt.modifiedByUser=E.a(b.Editor)),Nt.MediaServiceOCR=E.i(b.MediaServiceOCR),me.properties=Nt,me.lifeCycleStatus=R.optional(this._getItemLifeCycleStatus(b)),me.comments={settings:(Wt=b._CommentFlags,qt={},qt.isCommentDisabled=function(e){return void 0===e||null==e||(1&e)>0}(Wt),qt)},me.urls=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},Ue),this._getVideoUrl({extension:oe,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:se})),((h={})[o.t.mediaBaseUrl]=M.getMediaBaseUrl({fileExtension:oe,item:b,mediaServiceMetadata:se}),h)),me.searchProperties={isMetadataSearch:ne},null==te||te.update([new H.e(pe).succeed({item:me})]),te&&Object(O.isFeatureEnabled)(O.ItemAnalytics)&&Object(O.isFeatureEnabled)(O.EnableTrendingSignalInListView)&&pe&&this.resources.consumeAsync(g).then(function(e){e.queueNewItem(pe)});var Zt=this._getGroupings({itemFromServer:b,supportsNestedGroups:Y,groupBy:j,groups:xt}),$t=Zt.groupings,en=Zt.totalChildren;return{item:{key:pe},itemPatch:me,itemType:de,children:gt,groupings:$t,totalChildren:en,nextRequestToken:b.nextRequestToken}},t.prototype._getItemLifeCycleStatus=function(e){var t={};1===Number(e["Created_x0020_Date.ifnew"])&&(t.isNew=!0);var n=Number(e._VirusStatus)||0;return 0!==n&&3!==n&&(t.isMalwareDetected=!0),t},t.prototype._getGroupings=function(e){var t=this,n=e.itemFromServer,a=e.supportsNestedGroups,i=e.groupBy,r=e.groups,o=null,s=this._listContext.groupLevel,c=n.folder?n.folder.childCount:0;if(n.folder&&n.folder.children&&i&&"__ItemType"===i[0])o=this._getItemTypeGroupings({itemFromServer:n});else if(-1!==s)if(n.groups){var d=[],l=0;if(a){var u=Object(G.e)(n.groups,this._listContext,i),f=u.groups,p=u.totalCount;d=f.map(function(e){return t._convertToODNGroup(e)}),l=p}else for(var m=0,_=n.groups;m<_.length;m++){var h=_[m],b=i[s];if(h[b+".newgroup"]){var g=Object(G.t)(this._listContext,h,b,s,!0,l);d.push(this._convertToODNGroup(g)),l+=g.count}}d&&d.length>0&&(o=[{name:void 0,itemGroups:d,isAllCollapsed:this.createObservable(!0)}],c=l)}else r&&r.length>0&&r[s]&&r[s].length>0&&(o=[{name:void 0,itemGroups:r[s],isAllCollapsed:this.createObservable(!1)}]);return{groupings:o,totalChildren:c}},t.prototype._getItemTypeGroupings=function(e){for(var t,n=e.itemFromServer,a=[],i=n.folder.children,r=n.nextRequestToken?2:0,o=i.length+r,s=0;s<o;s++){var c=i[s];if(c&&this._getItemTypeOneNoteOrFolder(c)!==y.e.Folder){t=s;break}}return(void 0===t&&o>0||t>0)&&a.push({count:void 0!==t?t:o,groupingId:"folder",startIndex:0,state:this.createObservable({isCollapsed:!1})}),void 0!==t&&a.push({count:o-t,startIndex:t,groupingId:"document",state:this.createObservable({isCollapsed:!1})}),a.length?[{name:"FoldersDocumentsPhotos",itemGroups:a,isAllCollapsed:this.createObservable(!1)}]:void 0},t.prototype._getImage360=function(e,t,n,a){var i,r=t&&t.panorama,o=!1;if(r&&"equirectangular"===r.projectionType?(i={projectionType:r.projectionType},o=!0):e.FileLeafRef&&-1!==e.FileLeafRef.indexOf(".360")?i={projectionType:"equirectangular"}:n.width>0&&n.height>0&&n.width/n.height==2&&(o=!0),o&&a){var s=a.panorama;if(s)i={projectionType:R.optional(r.projectionType||void 0),croppedAreaImageHeightPixels:R.optional(s.croppedAreaImageHeightPixels||void 0),croppedAreaImageWidthPixels:R.optional(s.croppedAreaImageWidthPixels||void 0),croppedAreaLeftPixels:R.optional(s.croppedAreaLeftPixels||void 0),croppedAreaTopPixels:R.optional(s.croppedAreaTopPixels||void 0),fullPanoHeightPixels:R.optional(s.fullPanoHeightPixels||void 0),fullPanoWidthPixels:R.optional(s.fullPanoWidthPixels||void 0),initialHorizontalFOVDegrees:R.optional(s.initialHorizontalFOVDegrees||void 0),initialVerticalFOVDegrees:R.optional(s.initialVerticalFOVDegrees||void 0),initialViewHeadingDegrees:R.optional(s.initialViewHeadingDegrees||void 0),initialViewPitchDegrees:R.optional(s.initialViewPitchDegrees||void 0),initialViewRollDegrees:R.optional(s.initialViewRollDegrees||void 0),poseHeadingDegrees:R.optional(s.poseHeadingDegrees||void 0),posePitchDegrees:R.optional(s.posePitchDegrees||void 0),poseRollDegrees:R.optional(s.poseRollDegrees||void 0)};else{var c=a.photo;if(c&&c.cameraModel){var d=c.cameraModel.toLowerCase();["gopro fusion 360","kodak pixpro - 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(d)>=0&&(i={projectionType:"equirectangular"})}}}return i},t.prototype.getReputationProperties=function(e){for(var t={},n=0,a=l;n<a.length;n++){var i=a[n];t[i]=R.optional(e[i])}return t},t.prototype._getPdfConversionFacet=function(e){var t,n={fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata};if(t=e.blockDownload&&Y.t(e.extension)?e.microServiceDataSource.getPassthroughUrl(n):e.microServiceDataSource.getPdfConversionUrl(n))return{url:t}},t.prototype._get3dFacet=function(e){if(this._pageContext.isSPO){var t=e.microServiceDataSource.getFbxConversionUrl({fileExtension:e.extension,item:e.itemFromServer}),n=W.t(e.extension);if(t||n)return{canConvert:!0,canRenderNative:n,conversionUrl:t&&t.replace("/bxf?","/glb?")}}},t.prototype._getOfficeBundleFacet=function(e){var t=e.isWord,n=e.extension,a=e.itemUrlParts,i=e.isPowerPoint,r=e.itemFromServer,o=e.microServiceDataSource,s=e.mediaServiceFastMetadata,c=a.isCrossDomain;if(!c&&("21"===this._pageContext.webTemplate||Object(O.isFeatureEnabled)(O.EnableWrsPreviewOutsideODB))){var d,l,u,f=!c&&(t&&Object(O.isFeatureEnabled)(O.EnableWordWrsPreview)||i&&Object(O.isFeatureEnabled)(O.EnablePowerPointWrsPreview)),p=t||i?o.getOfficeBundleGenerateUrl({fileExtension:n,item:r,mediaServiceMetadata:s}):"",m=o.getOfficeBundleGetFragmentUrl({fileExtension:n,item:r,mediaServiceMetadata:s}),_=!1,h="",b=r[".ctag"],g=s&&s.officeBundle;return g&&(d=g.ctag,u=g.version,_=g.fatalError||!1,g.generationTime&&(l=new Date(g.generationTime)),h=g.errorInfo||""),{officeBundleGenerateUrl:p,officeBundleGetFragmentUrl:m,bundleCTag:d,bundleVersion:u,hasBundleGenerationFailed:_,bundleErrorInfo:h,generationTime:l,cTag:b,enableDefaultClick:f}}},t.prototype._getThumbnail=function(e){if(e.type!==y.e.Folder){var t=e.itemFromServer;if(Object(k.o)(e.listTemplateType))return{url:t.BackgroundImageLocation,width:0,height:0};var n=e.microServiceDataSource.getThumbnail({fileExtension:e.extension,allowCookieAuth:e.listTemplateType===k.t.mySiteDocumentLibrary,itemKey:e.key,item:t,mediaServiceMetadata:e.mediaServiceFastMetadata});if(n)return n;if(Object(P.e)(e.extension)){if(this._listContext.remoteParentWeb){var a=new d.t(this._listContext.remoteParentWeb.serverRelativeUrl).getLeftPart(d.e.authority),i=encodeURI(t.FileRef);return s.previewImageUrlFromUrl(A.e.encodeURIComponent(a+i),this._pageContext.webAbsoluteUrl,this._pageContext)}var r=e.pageContext;return r&&r.webAbsoluteUrl&&r.siteId&&r.webId?s.previewImageUrlFromProps(r.siteId,r.webId,t.UniqueId,r.webAbsoluteUrl,r):s.previewImageUrl(t,this._pageContext.webAbsoluteUrl,this._pageContext)}}},t.prototype._getVideoUrl=function(e){var t=e.microServiceDataSource.getVideoUrl({fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata}),n={};return t&&(n[o.t.video]=t),n},t.prototype._getItemType=function(e){var t=e.itemFromServer,n=e.listTemplateType,a=e.microServiceDataSource,i=e.mediaServiceFastMetadata,r=this._getItemTypeOneNoteOrFolder(t);if(r===y.e.Unknown){var o=t.File_x0020_Type,s=o?".".concat(o):"";if(Object(O.isFeatureEnabled)(O.ShortcutLink)&&x.e.isShortcutFileType(o))return y.e.Shortcut;if(Object(O.isFeatureEnabled)(O.UseWebPdfViewer)&&("pdf"===o||this._getPdfConversionFacet({itemFromServer:t,extension:s,mediaServiceFastMetadata:i,blockDownload:!0,microServiceDataSource:a})))return y.e.Media;if(this._get3dFacet({itemFromServer:t,extension:s,microServiceDataSource:a,mediaServiceFastMetadata:i}))return y.e.Media;if("audio"===u.n(s))return y.e.Media;if(i)return y.e.Media;if((r=u.i(s))===y.e.Unknown)return Object(k.r)(n)?y.e.File:Object(k.o)(n)?y.e.Media:r}return r||y.e.File},t.prototype._getItemTypeOneNoteOrFolder=function(e){var t;if(e.folder)t=y.e.Folder;else if("1"===e.FSObjType||e.RemoteItem){var n=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],a=e["File_x0020_Type.mapapp"];t=a&&"onenote"===a.substring(0,7)||n&&-1!==n.indexOf("onenote")?y.e.OneNote:y.e.Folder}else t=y.e.Unknown;return t},t.prototype._convertToODNGroup=function(e){var t=this,n=e;return n.state=this.createObservable({isCollapsed:e.isCollapsed}),n.children&&n.children.length>0&&(n.children=e.children.map(function(e){return t._convertToODNGroup(e)})),n},t.prototype._parseMediaServiceMetadata=function(e){if(e&&"{}"!==e)try{var t=e;return"&"===e[1]&&(this._htmlDecodeDiv.innerHTML=e,t=this._htmlDecodeDiv.innerText),JSON.parse(t)}catch(e){}finally{this._htmlDecodeDiv.innerHTML=""}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{pageContext:T.f,urlDataSource:M.ue,listContext:T.o,navigation:F.e,microServiceDataSource:j.e,vroomUrlHelper:B.e,itemUrlHelper:N.c,vroomDataContext:U.e.optional,shortcutLinkDataSource:I.e}),t}(i.default);function Z(e){return"number"==typeof e?e/1e4:e}var $=Object(b.r)("ListItemBuilder",X)},,function(e,t,n){"use strict";var a=n("knockout-lib"),i=n(5057),r=n(2174),o=n(0),s=n(5311),c=function(e){function t(t){var n=e.call(this,t)||this;return n.seeMoreText=s.e,n.needPadding=t.needPadding,n.seeMoreAriaLabel=s.e,n}return Object(o.__extends)(t,e),t.prototype.onSeeMore=function(t,n){return e.prototype.filterByGroupAndExpand.call(this,t,event)},t}(n(4323).e),d=(r.e({tagName:"ms-listGroup-seeMore",template:'<div class="od-ListGroupSeeMore" data-bind="css:{needPadding:needPadding,\'is-focused\':isFocused},attr:{tabindex:tabindex,\'aria-label\':seeMoreAriaLabel},delayedHasFocus:isFocused,click:onSeeMore,keyboard:{mappings:{Enter:onSeeMore},context:$data}"><span data-bind="text:seeMoreText"></span></div>',viewModel:c,synchronous:!0}),function(){function e(){}return e.getGroup=function(t,n){var a;if(t&&t.length&&t[0].itemGroups)for(var i=0,r=t[0].itemGroups;i<r.length;i++){var o=r[i];if(o){var s=o.startIndex+o.count-1;if(o.startIndex<=n&&s>=n){if(o.children)return e.getGroup([{name:"",itemGroups:o.children}],n);a=o;break}}}return a},e.getHeaderDetails=function(t,n,r,o,s){var c="",d=null,l=20,u="";return t&&"SPListGroup"===t.groupingType&&(l=60,u="header-"+t.groupingId+"_"+t.count+"_itemcount_"+t.startIndex,c=i.e.tagName,d={group:t,cellsInGroup:n,resources:r,isGrid:s,requiredGroup:o,isSelected:a.observable(!1),isFocused:a.observable(!1),key:e.normalizeHeaderKey(u)}),{viewType:c,viewData:d,headerHeight:l,key:u}},e.shouldFetchNextGroup=function(t,n,a,i){var r=t.peek().content.peek().groupings,o=t.peek().content.peek().items;if(r&&r.length&&r[0].itemGroups){var s=e._getLastGroup(r[0].itemGroups);if(n&&n.groupingId===s.groupingId){var c=a===i||a===n.count,d=o&&void 0===o[o.length-1];return c&&d}}return!1},e.getNextGroup=function(t,n){if(t&&t.length&&t[0].itemGroups){var a=e._getLastGroup(t[0].itemGroups);return{groupingId:"__next__",startIndex:a.startIndex+a.count,count:n}}return null},e.updateHeader=function(e,t){e.viewData.cellsInGroup=t,e.key=e.key.replace("itemcount",String(t))},e.normalizeHeaderKey=function(e){var t=e.indexOf("_");return e.substring(0,t-1)},e.getSeeMoreComponent=function(e,t,n,a,i,r,o){var s="seeMore-"+e.groupingId;return{key:s,item:null,cellIndex:n||-1,index:-1,viewType:"ms-listGroup-seeMore",viewData:{group:e,key:s,resources:t,needPadding:o},left:a||0,top:i||0,width:r||0,height:36}},e._getLastGroup=function(e){var t=e[e.length-1];return t.isPlaceholder&&(t=e[e.length-2]),t},e}());t.e=d},,,,function(e,t,n){"use strict";n(2914);var a=n(2174),i=n(0),r=n("knockout-lib"),o=n(5310),s=n(311),c=n(488),d=n(2613),l=n(20),u=n(2612),f=function(e){function t(t){var n=e.call(this,t)||this;n._requiredGroup=t.requiredGroup;var a=n.group.name?n.group.name:o.s;n.headerText=l.format(o.a,a,n.group.count),n.loadingText=o.o,n._cellsInGroup=t.cellsInGroup,n._itemSet=n.resources.consume(s.s),n.isCollapsed=n.createComputed(function(){return!!n.group.state&&n.group.state().isCollapsed}),n._itemsLoaded=n.createComputed(function(){return!!n._itemSet().content().items[n.group.startIndex]}),n.showLoading=n.createComputed(function(){return!n._itemsLoaded()&&!n.isCollapsed()});var i=l.pluralSelect(n.group.count,l.format(o.r,n.group.count),l.format(o.i,n.group.count));n.headerAriaLabel=l.format(o.e,a,i,n.isCollapsed.peek()?o.t:o.n),n.isDroppingTarget=r.observable(!1),n.isDroppable=r.observable(n._canDropItems()),n._dropHelper=n.resources.consume(d.e);var f=n.resources.consume(c.t);return n._parentItem=f.item,n.isDroppable.peek()&&n.addBindingHandlers({dragAndDrop:u.e}),n.showCheckbox=!t.isGrid,n._itemSet=n.resources.consume(s.s),n}return Object(i.__extends)(t,e),t.prototype.onToggleCollapse=function(e,t){return e._toggleGroup(),t.stopPropagation(),t.preventDefault(),!1},t.prototype.onToggleSelect=function(e,t){return e._toggleSelect(),t.stopPropagation(),t.preventDefault(),!1},t.prototype.enterGroup=function(t,n){return e.prototype.filterByGroupAndExpand.call(this,t,event)},t.prototype.onFocusChange=function(e){e&&this._toggleSelect()},t.prototype.onKeyLeftRight=function(e,t){return e.onToggleCollapse(e,t)},t.prototype.onReceiveDrop=function(e){return this.group.state.peek().isCollapsed&&this._toggleGroup(!0),e.metadata={group:this.group},e.itemSet=this._itemSet.peek(),this._dropHelper.processDrop(e,this._parentItem.peek(),!0)},t.prototype.onMayReceiveDrop=function(e){var t=null;return 1!==e.type&&0!==e.type||(t={targetName:this.group.name}),t},t.prototype.onRemoveDropLocation=function(){this.isDroppingTarget(!1)},t.prototype._toggleGroup=function(e){var t=this.group;if(t.state){var n=!e&&!t.state.peek().isCollapsed;t.state({isCollapsed:n}),n||this._itemsLoaded.peek()||this._requiredGroup(t)}},t.prototype._toggleSelect=function(){for(var e=this._itemSet.peek().content.peek().items,t=this.group.startIndex;t<this.group.startIndex+this._cellsInGroup;t++)e[t]&&this.selectionModel.setItemSelected(e[t],!0)},t.prototype._canDropItems=function(){var e="TRUE"===this.group.fieldSchema.ReadOnly,t=null!==this.group.fieldValue;return!e&&t},t}(n(4323).e),p=a.e({tagName:"ms-listGroup-header",template:'<div class="od-ListGroupHeader" data-bind="css:{dropping:isDroppingTarget,\'is-collapsed\':isCollapsed,showCheckbox:showCheckbox,\'is-focused\':isFocused},attr:{tabindex:tabindex,\'aria-label\':headerAriaLabel},delayedHasFocus:isFocused,click:onToggleSelect,keyboard:{mappings:{Left:onKeyLeftRight,Right:onKeyLeftRight,Enter:enterGroup},context:$data},dragAndDrop:{mayReceiveDrop:onMayReceiveDrop,isDragging:isDroppingTarget,receiveDrop:onReceiveDrop}">\x3c!--ko if:showCheckbox--\x3e<ms-item-check class="od-ListGroupHeader-check can-select" data-bind="css:{\'is-selected\':isFocused}"></ms-item-check>\x3c!--/ko--\x3e<i class="od-ListGroupExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true,click:onToggleCollapse,attr:{tabindex:-1}"></i><div class="od-ListGroupHeader-title" href="#" data-bind="text:headerText,click:enterGroup,attr:{tabindex:-1}"></div><span class="od-ListGroupHeader-loading" data-bind="visible:showLoading,text:loadingText"></span></div>',viewModel:f,synchronous:!0});t.e=p},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n("react-lib"),i=n(0),r=n(15),o=n(62),s=n(40),c=n(87),d=n(3273),l=n(101),u=n(90),f=n(12),p=n(47),m=n(5),_=n(23),h=n(22),b=Object(p.t)(function(e,t){var o,f,p,b,g=e.demandItemFacet(r.u,r.c),v=e.dispatch,y=t.itemKey,S=(null===(f=null===(o=e.demandItem({fileName:m.m},y))||void 0===o?void 0:o.fileName)||void 0===f?void 0:f.name)||"",D=(null===(b=null===(p=e.demandItem({fileName:m.m},y))||void 0===p?void 0:p.fileName)||void 0===b?void 0:b.extension)||"";if(!g)return null;var I=t.resources.consume(s.f),x=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var e,a,r,o,s,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,Promise.resolve().then(n.bind(null,863))];case 1:return e=i.sent().getSessionToken,[4,v(e({scopes:["InformationProtection.Read.All"],endpoint:t}))];case 2:return[2,null==(a=i.sent())?void 0:a.accessToken];case 3:return r=i.sent(),u.e.logError(r,{eventName:"fetchGraphToken",feature:"CreateModelPanel",errorCode:null===(o=null==r?void 0:r.errorData)||void 0===o?void 0:o.code,correlationId:null===(s=null==r?void 0:r.errorData)||void 0===s?void 0:s.correlationId,status:null===(c=null==r?void 0:r.errorData)||void 0===c?void 0:c.status}),[2,""];case 4:return[2]}})})},C=Object(h.o)(function(e){var t=Object(c.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e("deferred.office-ui-fabric-react"),n.e("deferred.odsp-common"),n.e("deferred.odsp-datasources"),n.e(570)]).then(n.bind(null,4756))];case 1:return[2,e.sent().default]}})})});function r(){e&&e.resolve&&e.resolve(),g&&g.consumeAsync(l.k).then(function(e){e.invalidateCurrentItemSet()})}return a.createElement(t,{isCopyModel:!0,modelName:S,extension:D,getAuthToken:x,screenReaderAlert:d.e.alert,pageContext:I,onDismiss:r,onComplete:r})});return a.createElement(_.e,{engagement:{isIntentional:!0,name:"CopyModelPanelOpen",currentPage:"ModelListPage"},isAvailable:!!y,onExecute:C})}),g=Object(f.r)()(Object(f.a)()(b)),v=n(969),y=n(58),S=Object(y.e)("copyModel"),D=n(57),I={key:S,name:v.CopyModelText,action:a.createElement(D.t,null,a.createElement(function(){var e=Object(o.n)();return a.createElement(g,{resources:e})},null)),iconProps:{iconName:"Copy"}}},function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n("react-lib"),i=n(969),r=n(58),o=Object(r.e)("renameModel"),s=n(0),c=n(62),d=n(40),l=n(87),u=n(3273),f=n(12),p=n(47),m=n(5),_=n(15),h=n(101),b=n(1),g=n(23),v=n(22),y=Object(p.t)(function(e,t){var i,r,o,c,f=e.demandItemFacet(_.u,_.c),p=t.itemKey,y=(null===(r=null===(i=e.demandItem({fileName:m.m},p))||void 0===i?void 0:i.fileName)||void 0===r?void 0:r.name)||"",S=(null===(c=null===(o=e.demandItem({fileName:m.m},p))||void 0===o?void 0:o.fileName)||void 0===c?void 0:c.extension)||"";if(!f)return null;var D=e.demandItemFacet(b.Ye,p),I=t.resources.consume(d.f),x=Object(v.o)(function(e){var t=Object(l.e)(function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e("deferred.office-ui-fabric-react"),n.e("deferred.odsp-common"),n.e("deferred.odsp-datasources"),n.e(570)]).then(n.bind(null,4756))];case 1:return[2,e.sent().default]}})})});function i(){e&&e.resolve&&e.resolve(),f&&f.consumeAsync(h.k).then(function(e){e.refreshItemsInCurrentItemSet([D||""])})}return a.createElement(t,{isRenameModel:!0,modelName:y,extension:S,screenReaderAlert:u.e.alert,pageContext:I,onDismiss:i,onComplete:i})});return a.createElement(g.e,{engagement:{isIntentional:!0,name:"RenameModelPanelOpen",currentPage:"ModelListPage"},isAvailable:!!p,onExecute:x})}),S=Object(f.r)()(Object(f.a)()(y)),D=n(57),I={key:o,name:i.RenameModel,action:a.createElement(D.t,null,a.createElement(function(){var e=Object(c.n)();return a.createElement(S,{resources:e})},null)),iconProps:{iconName:"rename"}}},,function(e,t,n){"use strict";n.d(t,"e",function(){return S});var a=n(0),i=n("react-lib"),r=n(358),o=n(1203),s=n(421),c=n(2924),d=n(2170),l=n(4292),u=n(62),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._target=Object(i.createRef)(),t._onMenuClicked=function(e,n){var a=t.props,i=a.hideCoachmark,r=a.onMenuClick;r&&r(e,n),i&&i()},t._onClick=function(e,n){var a,i=t.props,r=i.hideCoachmark,o=i.onClick;return o&&(a=o(e,n)),r&&r(),a},t._getCoachmark=function(){var e=t.props,n=e.isCoachmarkVisible,a=e.teachingBubbleCampaign,r=e.onCoachmarkAnimationOpen,o=e.onDismissTeachingBubble;if(n)return i.createElement(l.e,{target:t._target.current,teachingBubbleCampaign:a,onDismiss:o,onAnimationOpenStart:r,onTeachingBubbleSeen:t._onTeachingBubbleSeen})},t._onTeachingBubbleSeen=function(){var e=t.props.resources.consume(s.D.optional);e&&e.markBubbleAsSeen(t.props.teachingBubbleCampaign);var n=t.props.onTeachingBubbleSeen;n&&n()},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=void 0===t?d.e:t,r=Object(a.__rest)(e,["defaultRender"]),o=n;return i.createElement(i.Fragment,null,i.createElement("div",{ref:this._target},i.createElement(o,Object(a.__assign)({},r,{onClick:this._onClick,onMenuClick:this._onMenuClicked}))),this._getCoachmark())},t}(i.PureComponent),p=Object(u.i)()(f),m=n(2258),_=n(158),h=n(977),b=n(47),g=n(231),v=function(e){function t(t){var n=e.call(this,t)||this;n._hideCoachmark=function(){var e=n.state.teachingBubble;e&&n._observables.wrap(e.isVisible)(!1)},n._onDismissTeachingBubble=function(){var e=n.state.teachingBubble;e&&(n._hideCoachmark(),n._isReminderFlowCoachmark&&_.e.logData({name:"ReminderFlowCoachmark.Close"}),n._teachingBubbleProvider.markBubbleAsDismissed(e.campaign()))},n._getCurrentTeachingBubble=function(){return n._observables.unwrap(n._coachmarkProvider.getCurrentTeachingBubble())},n._hideToastNotifications=function(){var e=n.props.resources.consume(m.resourceKey.optional);e&&e.cleanup(!0)},n._onTeachingBubbleSeen=function(){n._isReminderFlowCoachmark()&&_.e.logData({name:"ReminderFlowCoachmark.Rendered"})},n._isReminderFlowCoachmark=function(){var e=n.state.teachingBubble;if(!e)return!1;var t=e.campaign();return t&&t.campaignGuid===h.FLOW_REMIND_ME.campaignGuid};var a=t.resources;return n._scope=new r.e,n._coachmarkProvider=a.consume(c.resourceKey.optional),n._observables=n._scope.attach(new(a.consume(o.observablesFactoryTypeResourceKey))({owner:n})),n.state={isCoachmarkVisible:!1,teachingBubble:n._getCurrentTeachingBubble()},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.state,t=e.isCoachmarkVisible,n=e.teachingBubble;return i.createElement(p,Object(a.__assign)({isCoachmarkVisible:t,teachingBubbleCampaign:n&&n.campaign(),hideCoachmark:this._hideCoachmark,onCoachmarkAnimationOpen:this._hideToastNotifications,onDismissTeachingBubble:this._onDismissTeachingBubble,onTeachingBubbleSeen:this._onTeachingBubbleSeen},this.props))},t.prototype.componentWillUnmount=function(){this._scope.dispose()},t.prototype.componentDidMount=function(){var e=this;this._observables.compute(function(){e._observables.unwrap(e._coachmarkProvider.getCurrentTeachingBubble())&&e._computeShowCoachmark()})},t.prototype._computeShowCoachmark=function(){var e=this,t=this._getCurrentTeachingBubble();if(t){var n=this._observables.unwrap(t.isVisible),a=t.campaign(),i=this.state.isCoachmarkVisible;this._isCampaignCompatible(a)?(this._teachingBubbleProvider||(this._teachingBubbleProvider=this.props.resources.consume(s.D.optional)),this._teachingBubbleProvider&&this._teachingBubbleProvider.shouldBubbleBeAdded(a,!1).then(function(a){e.setState({isCoachmarkVisible:a&&n,teachingBubble:t})})):i&&this.setState({isCoachmarkVisible:!1})}},t.prototype._isCampaignCompatible=function(e){var t=this.props.coachmarkCampaign;return t===e||t===(e&&e.compatibleCampaign)},t}(i.Component),y=Object(u.i)()(v);function S(e,t){var n=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n._update=function(t,a){if(t.doesCoachmarkApply!==a.doesCoachmarkApply){var i=n.props.coachmarkProvider;t.doesCoachmarkApply?i.isVisible.peek()||i.setCampaign(e):i.isVisible.peek()&&e===i.currentCampaign.peek()&&i.hideCampaign()}},n}return Object(a.__extends)(n,t),n.prototype.componentDidMount=function(){this._update(this.props,{doesCoachmarkApply:!1})},n.prototype.render=function(){return i.createElement(y,Object(a.__assign)({},this.props))},n.prototype.componentDidUpdate=function(e){this._update(this.props,e)},n}(i.PureComponent),r=Object(b.e)(function(e){return{doesCoachmarkApply:t(e,{})}})(function(e){return function(t){return Object(u.i)()(Object(g.t)(function(t){return{coachmarkCampaign:e,coachmarkProvider:t.resources.consume(c.resourceKey.optional)}})(t))}}(e)(n));return r}},,function(e,t,n){"use strict";var a=n(0),i=n(54),r=n(1203),o=n(216),s=n(383),c=n(1103),d=n(138),l=n(70),u=[1,0],f=new o.e,p=function(){function e(){this._started=!1,this._done=!1,this._bundleGroups={},this._queuedBundles=[]}return Object.defineProperty(e.prototype,"hasStarted",{get:function(){return this._started},enumerable:!1,configurable:!0}),e.prototype.start=function(){var e=this;this._started||(this._started=!0,f.setTimeout(function(){return e._next()},1e3))},e.prototype.queueLoad=function(e,t,n){var a=this._getGroup(e,n),i=this._generateModuleRequest(a,e,t,n);return this._queueBundle(a),i.signal.getPromise()},e.prototype.waitFor=function(e,t){var n=this._getGroup(e,t);return this._generateModuleRequest(n,e,0,t).signal.getPromise()},e.prototype.loadNow=function(e,t){var n=this._getGroup(e,t),a=this._generateModuleRequest(n,e,0,t);return n.isResolved||this._requestBundle(n).done(),a.signal.getPromise()},e.prototype._getGroup=function(e,t){var n=window.require.toUrl(e),a=this._bundleGroups[n];return a||(a=this._createGroup(e,n,t),this._bundleGroups[n]=a),a},e.prototype._createGroup=function(e,t,n){var a=window.require.specified(t),i={bundleUrl:t,requestedPath:e,getModule:n,modules:a?null:{},isResolved:a,isQueued:!1};if(!a)for(var r=0,o=u;r<o.length;r++){var s=o[r];i.modules[s]=[]}return i},e.prototype._createModuleRequest=function(e,t){return{path:e,getModule:t,signal:new s.e,isResolved:!1}},e.prototype._addNewModule=function(e,t,n,a){var i=this._createModuleRequest(t,a);return e.modules[n].push(i),i},e.prototype._generateModuleRequest=function(e,t,n,a){var i;return e.isResolved?(i=this._createModuleRequest(t,a),this._resolveModule(i)):i=this._addNewModule(e,t,n,a),i},e.prototype._queueBundle=function(e){e.isQueued||(this._queuedBundles.push(e),e.isQueued=!0,this._done&&(this._done=!1,this._next()))},e.prototype._next=function(){var e=this;if(this._started){var t=this._getNextGroup();if(t){var n=this._requestBundle(t);n&&n.then(function(){f.setTimeout(function(){return e._next()},500)}).done()}}},e.prototype._getNextGroup=function(){for(var e=this._queuedBundles.shift();e;){if(!e.isResolved)return e;e=this._queuedBundles.shift()}this._done=!0},e.prototype._processBundlePriorityLevel=function(e,t){if(!e.modules)return i.n.wrap();for(var n=[],a=0,r=e.modules[t];a<r.length;a++){var o=r[a];this._resolveModule(o),n.push(o.signal.getPromise())}return i.n.all(n).then(function(){},function(){})},e.prototype._processBundle=function(e){for(var t=this,n=function(n,a){return a.then(function(){return t._processBundlePriorityLevel(e,n)})},a=i.n.wrap(),r=0,o=u;r<o.length;r++)a=n(o[r],a);return a.then(function(){e.isResolved=!0,e.modules=null})},e.prototype._requestBundle=function(e){var t=this,n=new d.e({name:"DeferredBundleLoad"});return Object(c.e)({path:e.requestedPath,getModule:e.getModule}).then(function(){return n.end({resultType:l.e.Success,extraData:{path:e.requestedPath,url:e.bundleUrl}}),t._processBundle(e)},function(t){n.end({resultType:l.e.Failure,error:t,extraData:{path:e.requestedPath,url:e.bundleUrl}})})},e.prototype._resolveModule=function(e){e.isResolved=!0,e.path&&Object(c.e)({path:e.path,getModule:e.getModule}).then(function(t){e.signal.complete(t)})},e}(),m=n(101),_=n(90),h=function(e){function t(t){var n=e.call(this,t)||this;return n._resources=[],n._finished=new s.e,n.finishedProcessing=n._finished.getPromise(),n.isLoaded=n.createObservable(!1),n.createBackgroundComputed(n._computeShouldProcess),n}return Object(a.__extends)(t,e),t.prototype.expose=function(e,t){this._resources.push({key:e,getModule:t}),this.isLoaded.peek()&&this._processResources()},t.prototype._processResources=function(){for(var e=this,t=i.n.resolve(),n=0,a=this._resources;n<a.length;n++){var r=a[n];t=this._processResource(t,r)}t.then(function(){e._resources.length=0,e._finished.complete()})},t.prototype._processResource=function(e,t){var n=this;return e.then(function(){return t.getModule()}).then(function(e){try{var a=new(n.managed(e.default))({});n.resources.expose(t.key,a)}catch(n){_.e.logError(n,{rawResult:"(".concat(typeof e,"): ").concat(e.default),resourceKey:"(".concat(t.key.id,"): ").concat(t.key.name)})}})},t.prototype._computeShouldProcess=function(){this.isLoaded()&&this._processResources()},t}(r.default),b=n(74),g=n(272),v=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._queue=new p;var a=n._pageLoadMonitor=n.resources.consume(b.e),i=n.isPageLoaded=n.observables.create(a.isPageLoaded),r=n.isPageRenderingComplete=n.observables.create(a.isPageRenderingComplete);if(a.isPageLoaded?n._onPageLoaded():a.waitForPLT().then(function(){i(a.isPageLoaded),n._onPageLoaded()}),a.isPageRenderingComplete||a.waitForPageRenderingComplete().then(function(){r(a.isPageRenderingComplete)}),n.resources.isExposed(m.i)){var o=n.resources.consume(m.i);n._bundles=o.getBundles()}else n._bundles={};return n}return Object(a.__extends)(t,e),t.prototype.pageLoaded=function(e){Object(g.e)(0),this._pageLoadMonitor.pageLoaded(e)},t.prototype.pageRenderingIsComplete=function(e){this._pageLoadMonitor.pageRenderingIsComplete(e)},t.prototype.queueLoad=function(e,t){return this._queue.queueLoad(e,0,t)},t.prototype.queueBundle=function(e,t){var n=this.getBundleInfo(e);this.queueLoad(n.path,t||n.getModule).then(function(){n.isLoaded(!0)})},t.prototype.createDeferredContext=function(e){var t=this.getBundleInfo(e),n=new(this.managed(h))({});return t.path&&this._queue.queueLoad(t.path,1,t.getModule).then(function(){n.finishedProcessing.then(function(){t.isLoaded(!0)}),n.isLoaded(!0)}),n},t.prototype.waitFor=function(e,t){return this._queue.waitFor(e,t)},t.prototype.loadNow=function(e,t){return this._queue.loadNow(e,t)},t.prototype.getBundleInfo=function(e){if(e){var t=this._bundles[e];return t||(t={path:"",getModule:function(){return i.n.as(void 0)},isLoaded:this.createObservable(!1)},this._bundles[e]=t),t}},t.prototype.waitForPLT=function(){return this._pageLoadMonitor.waitForPLT()},t.prototype.waitForPageRenderingComplete=function(){return this._pageLoadMonitor.waitForPageRenderingComplete()},t.prototype._onPageLoaded=function(){this._queue.hasStarted||this._queue.start()},t}(r.default);t.e=v}],Array(19),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("searchBoxDataSource")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("scopingControlDataSource")},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(658);function i(e,t){t?e.updateViewParams(t,{clearOtherParams:!0}):(delete e.viewParams[a.n.queryTypeParamKey],delete e.viewParams[a.n.queryParamKey],delete e.viewParams[a.n.searchScopeKey],delete e.viewParams[a.n.metadataSearchIdKey],e.updateViewParams({}))}},,,,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="Unsupported",t}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!1},t}(n(2184).e),r=i;t.e=function(){this.AddCoverPhotoAction=r,this.AddExistingAppViewAction=r,this.AddFlowAction=r,this.AddPhotosToAlbumAction=r,this.EditSmartTemplateAction=r,this.DeleteSmartTemplateAction=r,this.DeleteSmartTemplateWithProgressAction=r,this.PublishSmartTemplateAction=r,this.PublishSmartTemplateWithProgressAction=r,this.UnPublishSmartTemplateAction=r,this.UnPublishSmartTemplateWithProgressAction=r,this.ActivateUniversalAnnotationAction=r,this.AddToAlbumAction=r,this.AddToBundleAction=r,this.AddToFolderAction=r,this.AddToFolderAction=r,this.AddToQuickLaunchAction=r,this.AddToSharedListAction=r,this.AddToSpotlightAction=r,this.AlertAction=r,this.ApplyOfficeLensAction=r,this.ApproveRejectAction=r,this.AuthenticationPolicyWarningAction=r,this.AutoExecuteAction=r,this.CancelEditAction=r,this.ChangeAppViewVisibilityAction=r,this.ChangeFolderTypeAction=r,this.CheckInAction=r,this.CheckOutAction=r,this.ClearFilterAction=r,this.ClearSelectionAction=r,this.ComplianceDetailsAction=r,this.ContentTypeNavigationAction=r,this.LaunchConfigureFlowsPanelAction=r,this.CopyFieldAction=r,this.CopyFormAction=r,this.CreateAlbumAction=r,this.CreateAlbumFromFolderAction=r,this.CreateAppViewAction=r,this.CreateColumnAction=r,this.CreateCustomDocumentAction=r,this.CreateDocumentAction=r,this.CreateFileRequestAction=r,this.CreateFolderAction=r,this.CreateItemAction=r,this.CreateMountPointAction=r,this.CreateNewFolderAction=r,this.CreateSitePageAction=r,this.CustomActionNavigationAction=r,this.CustomizeClientFormAction=r,this.CustomizeFormsNavigationAction=r,this.CustomizeViewAction=r,this.DefaultClickAction=r,this.DeleteAction=r,this.DeleteTemplateAction=r,this.DeleteAppAction=r,this.DeleteViewAction=r,this.DiscardAutoAlbumAction=r,this.DownloadAction=r,this.OpenSWAAction=r,this.DownloadZipContentsAction=r,this.EditAction=r,this.EditItemAction=r,this.EditItemCancelAction=r,this.EditItemSaveAction=r,this.EditNewAppViewAction=r,this.EditNewMenuAction=r,this.EditNewMenuPaneAction=r,this.EditPdfAction=r,this.EditRenditionsAction=r,this.EditTagsAction=r,this.EmbedAction=r,this.EmptyRecycleBinAction=r,this.ExportListAction=r,this.ExternalNavigateAction=r,this.FeedbackAction=r,this.FileHandlerOpenAction=r,this.FilterAction=r,this.FilterSearchAction=r,this.FilterSearchByDateAction=r,this.GetLinkAction=r,this.GroupItemsAction=r,this.ImplicitSaveAutoAlbumAction=r,this.InvokeFirstRunExperienceAction=r,this.LanguagePickerAction=r,this.LaunchApprovalDetailsDialogAction=r,this.LaunchChangeTheLookPanelAction=r,this.LaunchColumnCustomizationPaneAction=r,this.LaunchColumnManagementPanelAction=r,this.LaunchCreateAppViewPanelAction=r,this.LaunchCreateGroupPanelAction=r,this.LaunchCreateListDialog=r,this.LaunchCreateShortcutPanel=r,this.LaunchDocLibSettingPanelAction=r,this.LaunchFilterPanelAction=r,this.LaunchFlowWidgetPanelAction=r,this.LaunchFormatViewPaneAction=r,this.LaunchGroupifyPanelAction=r,this.LaunchGroupMembershipPanelAction=r,this.LaunchListCreationPanelAction=r,this.LaunchListFormAction=r,this.LaunchMoveCopyPanelAction=r,this.LaunchPdfExtractionAction=r,this.LaunchSitePermissionsPanelAction=r,this.LaunchSiteSettingsPanelAction=r,this.LaunchGlobalNavSettingsPanelAction=r,this.LaunchWebTemplatesGalleryAction=r,this.LaunchUserExpirationPanelAction=r,this.LaunchVivaConnectionsSettingsPanelAction=r,this.ListFormActivityPaneToggleAction=r,this.MakeHomepageAction=r,this.VaultAction=r,this.ModifyColumnAction=r,this.ModifyShowInFiltersPaneAction=r,this.MoveCopyAction=r,this.MoveLeftSpotlightAction=r,this.MoveRightSpotlightAction=r,this.NavigateToItemAction=r,this.NavigateToSharePointHomeAction=r,this.NavigationAction=r,this.OneDriveSortAction=r,this.OpenAction=r,this.OpenChatAction=r,this.OpenAppAction=r,this.OpenDocSetAction=r,this.OpenHyperlinkAction=r,this.OpenInExplorerAction=r,this.OpenInfoPathAction=r,this.OpenInImageEditorAction=r,this.OpenInOfficeClientAction=r,this.OpenInOfficeOnlineAction=r,this.OpenInImmersiveReaderAction=r,this.OpenInSharePointAction=r,this.OpenInDesktopAction=r,this.OpenInTextEditorAction=r,this.OpenInHtmlViewerAction=r,this.OpenInClipChampAction=r,this.OpenNeedsAttentionViewAction=r,this.OpenPdfInBrowserAction=r,this.OpenInPowerBIAction=r,this.OpenShortcutAction=r,this.OpenSiteAction=r,this.OrderPrintsAction=r,this.PinToMruAction=r,this.PlayAudioAction=r,this.PlaySlideShowAction=r,this.PolicyTipAction=r,this.PreviewAction=r,this.PrintPdfAction=r,this.PublishAction=r,this.RedeemAction=r,this.RedeemCodeAction=r,this.RemoveCoverPhotoAction=r,this.RemoveFromAlbumAction=r,this.RemoveFromBundleAction=r,this.RemoveFromRecentAction=r,this.RemoveFromSharedListAction=r,this.RemoveFromSpotlightAction=r,this.RemoveMountPointAction=r,this.RemoveOfficeLensAction=r,this.RemoveTagAction=r,this.RemoveTagFromItemAction=r,this.RenameAction=r,this.RenameColumnAction=r,this.ReportAbuseAction=r,this.RequestReviewAction=r,this.RestoreAction=r,this.RestoreAllAction=r,this.RestoreFilesAction=r,this.RotateAction=r,this.SaveAction=r,this.SaveAutoAlbumAction=r,this.SaveSortOrderAction=r,this.SaveViewAction=r,this.SeeAllAppsAction=r,this.SelectAction=r,this.SelectAllAction=r,this.SetAlbumCoverPhotoAction=r,this.SetDefaultViewAction=r,this.SetFocusAction=r,this.SetPhotosRootAction=r,this.SetUpApprovalFlowAction=r,this.SetUpReminderFlowAction=r,this.ShareAction=r,this.ShareByLinkAction=r,this.ShowExistingFlowsAction=r,this.ShowFiltersAction=r,this.ShowItemAnalyticsAction=r,this.ShowSuggestedFilesAction=r,this.ShowKeyPointsAction=r,this.ShowKeyboardMapAction=r,this.ShowMalwareDetectedAction=r,this.ShowOperationsAction=r,this.ShowPermissionsAction=r,this.ShowPropertiesAction=r,this.ShowRunReportAction=r,this.ShowSelectionAction=r,this.ShowVersionHistoryAction=r,this.SignOutAction=r,this.StopSlideShowAction=r,this.SurveyAction=r,this.SwitchPhotoFolderLayoutTypeAction=r,this.SwitchSharingLinkAction=r,this.SwitchViewAction=r,this.SyncAction=r,this.SynchronizeAppViewAction=r,this.LaunchTeamChannelAction=r,this.ToggleAction=r,this.ToggleDebugWindowAction=r,this.ToggleIsLeftNavUserExpandedAction=r,this.ToggleListLayoutAction=r,this.ToggleSelectionModeAction=r,this.TriggerFlowAction=r,this.TriggerFlowByIdAction=r,this.TriggerODBConvertToPdfFlowAction=r,this.TriggerODBRequestSignOffFlowAction=r,this.TriggerSignoffFlowAction=r,this.TriggerExtractFileMetadataFlowAction=r,this.UndoCheckOutAction=r,this.UnPublishAction=r,this.UpdateCaptionAction=r,this.UpdatePermissionsAction=r,this.UploadAction=r,this.UploadTemplateAction=r,this.QuotaBlockAction=r,this.ViewInFolderAction=r,this.ViewItemAction=r,this.ViewOriginalAction=r,this.WorkflowAction=r}},function(e,t,n){"use strict";var a=n(0),i=n(177),r=n(2184),o=n(70),s=n(311),c=n(253),d=n(101),l=n(421),u=n(54),f=n(971),p=n(91),m=n(2193),_=n(2498),h=n(4439),b=n(2697),g=n(535),v=new b.e("Open",b.t.intent),y=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="DefaultClick",a.isQosLogged=!1;var i=t.item,r=t.userInvokedItem,o=void 0!==r&&r,c=t.hideIfDefaultIsDownload,u=void 0!==c&&c,p=t.sourceEngagement,_=void 0===p?"":p,h=a,g=h.resources,y=h.observables;return g.expose(b.n,g.consume(b.n).withPart(v)),a._itemSelectionHelper=new(a.child(m.e))({overrideItem:i,allowMultiSelect:!1,canFallback:!1}),a.item=a._itemSelectionHelper.firstItem,a.sourceEngagement=_,a.userInvokedItem=o,a.hideIfDefaultIsDownload=u,a.actionMap=g.consume(s.e),a.urlDataSource=g.consume(d.ue),a.viewParams=g.consume(s.P),a._isFilePickerPage=y.pureCompute(a._computeIsFilePickerPage),a._action=y.pureCompute(a._computeAction),a._action.equalityComparer=f.n,a._instrumentationProvider=g.consume(l.r),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.observables.peekUnwrap(this._action);return!!e&&e.isAvailable()},t.prototype.onExecute=function(e){var t=this.observables,n=t.peekUnwrap(this.item);this._logEngagement(n,e);var a=this._instrumentationProvider;a&&n&&a.userClickItem(n);var i=t.peekUnwrap(this._action);return i&&i.execute(e)||u.n.resolve({resultType:o.e.ExpectedFailure})},t.prototype.onComputeAction=function(){return new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item})},t.prototype._computeIsFilePickerPage=function(){return this.urlDataSource.getPageType(this.viewParams())===p.e.FilePicker},t.prototype._computeAction=function(){var e,t=this._lastAction;t&&(t.dispose(),this._lastAction=void 0);var n=this.item();return this._isFilePickerPage()&&n&&n.type!==c.e.Folder||(e=this.onComputeAction()),this._lastAction=e,e},t.prototype._logEngagement=function(e,t){var n=this.sourceEngagement;if(n){var a;if(e)switch(e.type){case c.e.File:a="FileOpen.".concat(n);break;case c.e.Folder:a="FolderOpen.".concat(n);break;case c.e.App:a="AppOpen.".concat(n);break;case c.e.Subsite:a="SubsiteOpen.".concat(n);break;default:a="Open.".concat(n)}else a="Open.".concat(n);this.resources.consume(g.e).withPart(h.e).withPart(_.e,{item:e}).logData({name:a,extraData:{action:t?t.type:"unknown"}})}},t}(r.e),S=n(2192),D=n(213),I=n(38),x=n(43),C=n(40),O=n(2634),w=n(2360),E=n(4805),A=n(115),L=n(3266),k=n(93),M=n(4440),P=function(e){function t(t){var n=e.call(this,t)||this;return n._pageContext=n.resources.consume(C.f),n.itemParentHelper=n.resources.consume(S.e),n._defaultClickType=n.createPureComputed(n._computeDefaultClickType),n._fileHandlerProvider=n.resources.consume(w.e.optional),n._isOneDriveWinApp=Object(A.e)(),n._isTeamsPageApp=Object(k.d)(),n._isPWA=n.resources.consume(i.e).isPWA,n}return Object(a.__extends)(t,e),t.prototype.onComputeAction=function(){var t,n=this._defaultClickType();switch(n){case 1:t=new(this.managed(this.actionMap.OpenShortcutAction))({item:this.item});break;case 2:t=new(this.managed(this.actionMap.OpenInOfficeClientAction))({item:this.item,retryWithWac:!0});break;case 14:t=new(this.managed(this.actionMap.OpenInTeamsPreviewAction))({openRelation:2,item:this.item});break;case 3:t=new(this.managed(this.actionMap.OpenInOfficeOnlineAction))({useDefaultAction:!0,item:this.item});break;case 4:t=new(this.managed(this.actionMap.OpenSiteAction))({item:this.item});break;case 5:t=new(this.managed(this.actionMap.AuthenticationPolicyWarningAction));break;case 8:t=new(this.managed(this.actionMap.ExternalNavigateAction))({item:this.item});break;case 6:case 11:var a=new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item,urlType:"focus"});t=6===n?a:new(this.managed(this.actionMap.OpenInfoPathAction))({fallbackOpenAction:a,item:this.item});break;case 7:t=new(this.managed(this.actionMap.FileHandlerOpenAction))({item:this.item});break;case 9:t=new(this.managed(this.actionMap.OpenHyperlinkAction))({item:this.item});break;case 10:t=new(this.managed(this.actionMap.ShowMalwareDetectedAction))({item:this.item});break;case 12:t=new(this.managed(this.actionMap.OpenInDesktopAction))({openRelation:2,item:this.item,actionType:L.e.DefaultClick});break;case 13:t=new(this.managed(this.actionMap.OpenPdfInBrowserAction))({item:this.item});break;case 15:t=new(this.managed(this.actionMap.OpenDocSetAction))({item:this.item});break;case 16:t=new(this.managed(this.actionMap.OpenInClipChampAction))({item:this.item});break;case 0:t=e.prototype.onComputeAction.call(this)}return t},t.prototype._computeDefaultClickType=function(){return this.item()?this._malwareDetected()?10:this._blockedByConditionalAccess()?5:this._openInOneDriveWinApp()?12:this._openInTeamsPreview()?14:this._openAsShortcut()?1:this._openAsSite()?4:this._openInClient()?2:this._openInOfficeOnline()?3:this._external()?8:this._infoPath()?11:this._nativePdf()?13:this._preview()?6:this._openWithFileHandler()?7:this._openAsHyperlink()?9:this._openDocSet()?15:this._openInClipchamp()?16:0:0},t.prototype._openAsShortcut=function(){var e=this.item();return Object(x.isFeatureEnabled)(x.ShortcutLink)&&O.e.isShortcutItem(e)},t.prototype._openAsHyperlink=function(){var e=this.item(),t=this.unwrapObservable(this.itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=t&&t.list;return n&&n.isPromotedLinks},t.prototype._openInClient=function(){if(!this._openInOffice())return!1;var e=this.item(),t=this.unwrapObservable(this.itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return!!t&&(t.list.openInClient||"ms-project"===e.appMap||"ms-publisher"===e.appMap)},t.prototype._openInOfficeOnline=function(){if(this._isOneDriveWinApp||this._isTeamsPageApp||this._isPWA)return!1;var e=this.item();return Object(E.e)(e)},t.prototype._openInOffice=function(){var e=this.item();return Object(E.t)(e)},t.prototype._openAsSite=function(){var e=this.item();return!!e&&e.subsite&&this._pageContext.isNoScriptEnabled},t.prototype._blockedByConditionalAccess=function(){var e=this.item();return e.itemStatus===D.t.ConditionalAccessBlocked&&e.type!==c.e.Folder},t.prototype._external=function(){var e=this.item();return!(this._isOneDriveWinApp||e.appMap&&".pdf"!==e.extension||!e.external)},t.prototype._infoPath=function(){var e=this.item(),t=e.properties&&e.properties.ProgId;return!!t&&0===t.toLowerCase().indexOf("infopath.document")},t.prototype._nativePdf=function(){var e=this.item(),t=e&&e.extension;return!!t&&".pdf"===t.toLowerCase()&&Object(x.isFeatureEnabled)(x.DefaultPdfToNative)},t.prototype._preview=function(){var e=this.item();if(this._isOneDriveWinApp&&e&&e.type!==c.e.Folder)return!0;if(e.preview)return!0;var t=this._fileHandlerProvider;return!!t&&!!t.getDefaultPreviewHandler(e.extension)},t.prototype._openWithFileHandler=function(){var e=this._fileHandlerProvider;if(!e)return!1;var t=this.item();return!!t.graph&&!!e.getDefaultOpenHandler(t.extension)},t.prototype._malwareDetected=function(){var e=this.item();return e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected},t.prototype._openInOneDriveWinApp=function(){var e=this.item();if(Object(x.isFeatureEnabled)(x.EnableOneUpInSwmPwa)){if(this._isOneDriveWinApp){if(e.type===c.e.Folder&&e.queryType===I.e.SharedWithMe||e.queryType===I.e.Search||e.queryType===I.e.DetailsPane)return!0;if(e.type===c.e.Shortcut)return!0}return!1}return this._isOneDriveWinApp&&(e.type===c.e.Shortcut||e.queryType!==I.e.Files&&e.queryType!==I.e.SharedByMe&&e.queryType!==I.e.Recent)},t.prototype._openInTeamsPreview=function(){if(this._isTeamsPageApp){var e=this.item();return e.type!==c.e.Folder&&e.type!==c.e.Shortcut&&e.queryType!==I.e.DetailsPane}return!1},t.prototype._openDocSet=function(){var e=this.item();return e.isDocSet&&e.properties&&e.properties.WelcomeViewId},t.prototype._openInClipchamp=function(){var e=this.item();return Object(M.e)(e)},t}(y);t.e=P}],Array(71),[function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(3716),r=n(2233),o=n(72),s=n(157),c=n(590),d=n(2698),l=n(2717),u=n(43),f=n(54),p=n(3317),m=n(4221),_=n(2665),h=n(2383),b=n(76),g=n(253),v=n(2559),y=n(5173),S=n(5174),D=v.n,I=v.f,x=v.c,C=function(e){function t(t){var n=e.call(this,t)||this;n._apiUrlHelper=n.resources.consume(c.e),n._sharingDataSourceHelper=new(n.managed(p.e));var a=Object(s.s)(n._pageContext);return n._getPermissionsUrl=a+"/_api/SP.ObjectSharingInformation.GetObjectSharingInformationByUrl?$expand=SharedWithUsersCollection",n._getSharingSettingsUrl=a+"/_api/SP.Web.GetObjectSharingSettings?$expand=ObjectSharingInformation,SharePointSettings,SharePointSettings/PickerProperties,ObjectSharingInformation/SharedWithUsersCollection",n}return Object(a.__extends)(t,e),t.prototype.getRawResponse=function(e){var t,n=e.item,a="GetSharingInformationOld",i={};return this._sharingDataSourceHelper.canUseSecurable(n)?t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n).segment("GetSharingInformation").oDataParameter("$Expand","permissionsInformation,pickerSettings").toString():(t=this._getSharingSettingsUrl,i.useSimplifiedRoles=!0,i.objectUrl=this._sharingDataSourceHelper.getFileUrl(n),a="SP.Web.GetObjectSharingSettings"),this.dataRequestor.getData({url:t,parseResponse:function(e){return JSON.parse(e).d},qosName:a,additionalPostData:JSON.stringify(i),method:"POST",noRedirect:!0})},t.prototype.getSettings=function(e){var t=this;return e.getRawResponse().then(function(n){return t._parseSettings(n,e.item)},function(e){return t._parseError(e)})},t.prototype.getPermissions=function(e){var t=this;return this._sharingDataSourceHelper.canUseSecurable(e.item)?e.getRawResponse().then(function(n){return t._parsePermissions(n,e.item)}):this._getPermissions(e.item).then(function(n){return t._parsePermissions(n,e.item)})},t.prototype.getBestSharingLink=function(e,t){var n=this;return e.getLinks().then(function(e){return e&&e.length>0?f.n.wrap(n._getDefaultSharingLink(e,t)):null},function(e){return null})},t.prototype.getLinks=function(e){var t=this;return e.getRawResponse().then(function(n){return t._parseLinks(n,e.item)})},t.prototype.doSharingScopesContainLinks=function(){return!1},t.prototype.mappingSharingRole=function(e){var t;switch(e){case 0:t=h.e.None;break;case 3:t=h.e.Owner;break;case 5:t=h.e.Submitter;break;default:t=e}return t},t.prototype.getDataSourceName=function(){return"SharingDataDataSource"},t.prototype._getPermissions=function(e){var t,n,a=this._sharingDataSourceHelper.canUseSecurable(e);return t=a?this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e).segment("GetObjectSharingInformation").oDataParameter("$Expand","SharedWithUsersCollection").toString():this._getPermissionsUrl,this.dataRequestor.getData({url:t,parseResponse:function(e){return JSON.parse(e).d},qosName:"GetItemPermissions",additionalPostData:(n={excludeCurrentUser:!1,excludeSiteAdmin:!1,excludeSecurityGroups:!1,retrieveAnonymousLinks:!0,retrieveUserInfoDetails:!0,checkForAccessRequests:!0,retrievePermissionLevels:!0},a||(n.objectUrl=this._sharingDataSourceHelper.getFileUrl(e)),JSON.stringify(n)),method:"POST",noRedirect:!0})},t.prototype._parsePermissions=function(e,t){var n=[],a=[];this._sharingDataSourceHelper.canUseSecurable(t)?n=this._processAllPrincipals(e,t,e.canAddExternalPrincipal||e.canAddInternalPrincipal):(e.SharedWithUsersCollection&&e.SharedWithUsersCollection.results&&(a=e.SharedWithUsersCollection.results),n=this._processPeople(a,t,e.CanManagePermissions));for(var i=0,r=n;i<r.length;i++){var o=r[i];o.entityType===l.e.group&&o.email&&(o.image=this._getGroupImage(o.email))}var s=this.mappingSharingRole(e.currentRole)===h.e.Owner&&t.type!==g.e.Folder&&t.type!==g.e.OneNote;return[{item:t,people:n,hasPendingAccessRequests:e.HasPendingAccessRequests,pendingAccessRequestsLink:e.PendingAccessRequestsLink,canUnshare:e.CanBeUnshared||s}]},t.prototype._getGroupImage=function(e){return e?Object(i.t)({userLoginName:e}):null},t.prototype._parseError=function(e){var t={};return t.sharingApiErrorMessage=e.message.value,t},t.prototype._parseSettings=function(e,t){var n={};if(n.canSendEmail=e.canSendEmail,n.pickerProperties={},n.itemUrl=this._sharingDataSourceHelper.getFileUrl(t),n.networkLinksEnabled=!1,n.mailSettings={defaultCharacterLimit:500},this._sharingDataSourceHelper.canUseSecurable(t)){n.itemId=t.properties.ID||t.properties.uniqueId,n.itemName=t.displayName,n.canManagePermissions=this.mappingSharingRole(e.currentRole)===h.e.Owner,n.canManageReadWriteLink=this._isLinkKindEnabled(m.e.AnonymousEdit,e.permissionsInformation.links),n.canManageOrganizationalReadWriteLink=this._isLinkKindEnabled(m.e.OrganizationEdit,e.permissionsInformation.links),n.canManageLinks=this._isLinkKindEnabled(m.e.AnonymousEdit,e.permissionsInformation.links)||this._isLinkKindEnabled(m.e.OrganizationEdit,e.permissionsInformation.links)||this._isLinkKindEnabled(m.e.AnonymousView,e.permissionsInformation.links)||this._isLinkKindEnabled(m.e.OrganizationView,e.permissionsInformation.links),n.canSendLink=this._isLinkKindEnabled(m.e.AnonymousView,e.permissionsInformation.links)||this._isLinkKindEnabled(m.e.AnonymousEdit,e.permissionsInformation.links),n.supportsSharingPropagation=t.type===g.e.Folder,n.anonymousLinksEnabled=this._isLinkKindEnabled(m.e.AnonymousView,e.permissionsInformation.links),n.organizationLinksEnabled=this._isLinkKindEnabled(m.e.OrganizationView,e.permissionsInformation.links),n.showAdditionalExternalWarning=e.showExternalSharingWarning,n.sharedWithMany=this._isSharedWithMany(e),n.hasInheritedLink=e&&e.permissionsInformation&&e.permissionsInformation.hasInheritedLinks,n.blockPeoplePickerAndSharing=e.blockPeoplePickerAndSharing,n.canCurrentUserShareExternally=e.canAddExternalPrincipal,n.defaultLinkType=e.defaultLinkKind,e.permissionsInformation&&e.permissionsInformation.principals&&e.permissionsInformation.principals.results&&(n.sharedWith=this._processAllPrincipals(e,t,n.canManagePermissions));var a=t.properties.listId||this._sharingDataSourceHelper.getParentListId(t),i=[e.webUrl],r=t.properties.ID;null!==r&&(r=t.properties.ID.toString()),this._setAdvancedLink(a,i,r,n),e.pickerSettings&&this._setPickerProperties(e.pickerSettings,e.pickerSettings.PrincipalAccountType,n);var o=[],s={};s.name=D,s.value="role:1073741827",o.push(s);var c={};if(c.name=I,c.value="role:1073741826",o.push(c),Object(u.isFeatureEnabled)(u.ReviewPermissionUI)&&t.appMap&&"ms-word"===t.appMap){var d={};d.name=x,d.value="roletype:Reviewer",o.push(d)}n.sharingRoles=o,this._setAnonymousLinkExpirationInDays(e.anonymousLinkExpirationRestrictionDays,n)}else{if(n.itemId=e.ItemId,n.itemName=e.ItemName,n.canManagePermissions=e.ObjectSharingInformation.CanManagePermissions,n.canManageLinks=this._canManageLinks(e),n.canManageReadWriteLink=e.CanCurrentUserManageReadWriteLink,n.canManageOrganizationalReadWriteLink=e.CanCurrentUserManageOrganizationReadWriteLink,n.canSendEmail=e.CanSendEmail,n.canSendLink=e.CanSendLink,n.pickerProperties={},n.supportsSharingPropagation=e.SupportsAclPropagation,n.anonymousLinksEnabled=e.CanCurrentUserRetrieveReadonlyLink,n.organizationLinksEnabled=e.CanCurrentUserRetrieveOrganizationReadonlyLink,n.showAdditionalExternalWarning=e.ShowExternalSharingWarning,n.sharedWithMany=e.ObjectSharingInformation.IsSharedWithSecurityGroup||e.ObjectSharingInformation.IsSharedWithMany,n.blockPeoplePickerAndSharing=e.BlockPeoplePickerAndSharing,n.canCurrentUserShareExternally=e.CanCurrentUserShareExternally,n.defaultLinkType=this._getMostPermissiveLinkKind(n,e.DefaultShareLinkType),e.ObjectSharingInformation&&e.ObjectSharingInformation.SharedWithUsersCollection&&e.ObjectSharingInformation.SharedWithUsersCollection.results&&(n.sharedWith=this._processPeople(e.ObjectSharingInformation.SharedWithUsersCollection.results,t,e.CanManagePermissions)),i=[e.WebUrl],this._setAdvancedLink(e.ListId,i,e.ItemId,n),e.SharePointSettings&&e.SharePointSettings.PickerProperties&&this._setPickerProperties(e.SharePointSettings.PickerProperties,e.SharePointSettings.PickerProperties.PrincipalAccountType,n),o=[],e.SimplifiedRoles&&e.SimplifiedRoles.results)for(var l=0;l<e.SimplifiedRoles.results.length;l++){var f={};f.name=e.SimplifiedRoles.results[l].Key,f.value=e.SimplifiedRoles.results[l].Value,o.push(f)}n.sharingRoles=o,this._setAnonymousLinkExpirationInDays(e.RequiredAnonymousLinkExpirationInDays,n)}return n.showAdvanced=n.canManagePermissions,n},t.prototype._setAnonymousLinkExpirationInDays=function(e,t){var n=parseInt(e,10);t.requiredAnonymousLinkExpirationInDays=NaN!==n?n:0},t.prototype._setPickerProperties=function(e,t,n){n.pickerProperties=e,n.pickerProperties.PrincipalAccountType=this._convertPrincipalType(t)},t.prototype._setAdvancedLink=function(e,t,n,a){t.push("/_layouts/15/user.aspx"),t.push("?List="+b.e.encodeURIComponent(e)),e&&t.push("&obj=",b.e.encodeURIComponent(e),",",b.e.encodeURIComponent(n),",LISTITEM"),Number(this._pageContext.webTemplate)===o.t.group&&(t.push("&noredirect=true"),a.advancedUrlOpenInPlace=!0),a.advancedUrl=t.join("")},t.prototype._getMostPermissiveLinkKind=function(e,t){var n=t,a=(n=n===m.e.Uninitialized?m.e.AnonymousEdit:n)===m.e.AnonymousEdit||n===m.e.AnonymousView,i=n===m.e.OrganizationEdit||n===m.e.OrganizationView;if(a){if(e.anonymousLinksEnabled&&e.canManageReadWriteLink)return n;if(e.organizationLinksEnabled&&e.canManageOrganizationalReadWriteLink)return m.e.OrganizationEdit}else if(i&&e.organizationLinksEnabled&&e.canManageOrganizationalReadWriteLink)return n;return m.e.Direct},t.prototype._parseLinks=function(e,t){var n=this,a=[];if(e.permissionsInformation&&e.permissionsInformation.links){[{linkDetails:{Url:e.directUrl,IsActive:!0,LinkKind:m.e.Direct}}].concat(e.permissionsInformation.links.results).forEach(function(e){if(!e.isInherited){var i=n._initSharingLinkFromServerData(e.linkDetails);i.item=t,i.isInherited=e.isInherited,i.linkMembers=n._convertPrincipalToPeople(e.linkMembers),i.shareId=e.linkDetails?e.linkDetails.ShareId:"",i.kind=e.linkDetails?e.linkDetails.LinkKind:y.e.uninitialized,i.linkInvitees=n._getLinkInvitees(e.linkDetails),a.push(i)}});var i=e.canAddExternalPrincipal||e.canAddInternalPrincipal;a=a.filter(function(e){return!!((n.mappingSharingRole(e.role)!==h.e.Edit||i)&&(n.mappingSharingRole(e.role)!==h.e.View||i)||e.url&&e.isActive)&&!!(i||e.url&&e.isActive)&&!(n.mappingSharingRole(e.role)===h.e.View&&e.type===_.e.View&&!i||n.mappingSharingRole(e.role)===h.e.Edit&&e.type===_.e.Edit&&!i)})}return a},t.prototype._getLinkInvitees=function(e){var t=this,n=e.Invitations;if(!n)return[];for(var a=[],i=0,r=n.results;i<r.length;i++){var o=r[i];a.push(o.invitee)}return a.map(function(e){return{userId:e.userId,name:e.name,email:e.email,image:t._getGroupImage(e.email),isExternal:e.isExternal}})},t.prototype._processPeople=function(e,t,n){var a=this;return e.map(function(e){var t={userId:e.LoginName,name:e.Name,email:e.Email,job:e.JobTitle,department:e.Department,image:e.Picture,sip:e.SipAddress,isExternal:e.isExternal};0===t.image.length&&(t.image=a._placeholderImage);var i={};return e.IsSiteAdmin?i.role=h.e.Owner:void 0!==e.CustomRoleNames&&""!==e.CustomRoleNames?(i.role=h.e.Custom,i.customRole=e.CustomRoleNames):e.HasEditPermission?i.role=h.e.Edit:e.HasViewPermission&&(i.role=h.e.View),i.isChangeable=n,t.sharingInfo=i,e.IsDomainGroup?t.entityType=l.e.group:e.IsExternalUser&&(t.entityType=l.e.externalUser),t})},t.prototype._getAllSharedUsers=function(e){for(var t=e.permissionsInformation.siteAdmins.results,n=e.permissionsInformation.principals.results,a={},i=0,r=t;i<r.length;i++)a[(c=r[i]).principal.loginName]=!0;for(var o=0,s=n;o<s.length;o++){var c;a[(c=s[o]).principal.loginName]||t.push(c)}return t},t.prototype._processAllPrincipals=function(e,t,n){var a=this;return this._getAllSharedUsers(e).map(function(e){var t=e.principal,i={userId:t.loginName,name:t.name,email:t.email,job:t.jobTitle,image:a._getGroupImage(t.email),principalType:t.principalType,isExternal:t.isExternal},o={};return o.role=a.mappingSharingRole(e.role),o.isChangeable=n,i.sharingInfo=o,t.principalType===r.e.securityGroup||t.principalType===r.e.sharePointGroup?i.entityType=l.e.group:t.isExternal&&(i.entityType=l.e.externalUser),i})},t.prototype._convertPrincipalType=function(e){if(!e)return 0;for(var t=0,n=0,a=e.split(",");n<a.length;n++){var i=a[n];"User"===i?t|=1:"DL"===i?t|=2:"SecGroup"===i?t|=4:"SPGroup"===i&&(t|=8)}return t},t.prototype._convertPrincipalToPeople=function(e){var t=this;return(e&&e.results||[]).map(function(e){return{userId:e.loginName,name:e.name,email:e.email,job:e.jobTitle,image:t._getGroupImage(e.email)}})},t.prototype._initSharingLinkFromServerData=function(e){if(!e)return null;var t={};switch(e.LinkKind){case m.e.Direct:t={type:_.e.Direct,role:h.e.None,displayPriority:0,tag:"Direct",supportsExpiration:!1};break;case m.e.OrganizationView:t={type:_.e.Organization,role:h.e.View,displayPriority:1,tag:"OrganizationView",supportsExpiration:!1,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case m.e.OrganizationEdit:t={type:_.e.Organization,role:h.e.Edit,displayPriority:2,tag:"OrganizationEdit",supportsExpiration:!1,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case m.e.AnonymousView:t={type:_.e.View,role:h.e.View,displayPriority:3,tag:"AnonymousView",supportsExpiration:!0,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case m.e.AnonymousEdit:t={type:_.e.Edit,role:h.e.Edit,displayPriority:4,tag:"AnonymousEdit",supportsExpiration:!0,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case m.e.Flexible:var n=h.e.None;n=e.IsEditLink?h.e.Edit:e.IsReviewLink?h.e.Review:h.e.View,t={type:_.e.Edit,role:n,displayPriority:5,tag:"Flexible",supportsExpiration:!0,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case m.e.Uninitialized:default:t={}}return t.audience=this._getSharingLinkAudience(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership),Object(a.__assign)({role:h.e.None,url:e.Url,isActive:e.IsActive,expiration:t.supportsExpiration?this._sharingDataSourceHelper.getExpirationFromSharingLinkInfo(e.Expiration):null},t)},t.prototype._getSharingLinkAudience=function(e,t,n){return e===y.e.anonymousEdit||e===y.e.anonymousView?S.e.anyone:e===y.e.organizationEdit||e===y.e.organizationView?S.e.organization:e===y.e.direct?S.e.specificPeople:e===y.e.flexible?t?S.e.anyone:!1===n?S.e.organization:S.e.specificPeopleFlex:void 0},t.prototype._getDefaultSharingLink=function(e,t){if(!e||e.length<1)return null;var n,a,i;t===m.e.Direct?(a=_.e.Direct,i=h.e.None):t===m.e.OrganizationView?(a=_.e.Organization,i=h.e.View):t===m.e.OrganizationEdit?(a=_.e.Organization,i=h.e.Edit):t===m.e.AnonymousView?(a=_.e.View,i=h.e.View):t===m.e.AnonymousEdit&&(a=_.e.Edit,i=h.e.Edit);for(var r=0,o=e;r<o.length;r++){var s=o[r];if(s.type===_.e.Direct&&(n=s),s.type===a&&s.role===i)return s}return n},t.prototype._isLinkKindEnabled=function(e,t){return t.results.some(function(t){return t.linkDetails.LinkKind===e})},t.prototype._canManageLinks=function(e){return e.CanCurrentUserManageReadWriteLink||e.CanCurrentUserManageOrganizationReadWriteLink||e.CanCurrentUserManageReadonlyLink||e.CanCurrentUserManageOrganizationReadonlyLink},t.prototype._isSharedWithMany=function(e){if(this._getAllSharedUsers(e).length>30)return!0;for(var t=0,n=e;t<n.length;t++){var a=n[t];if(a.principal.principalType===r.e.securityGroup||a.principal.principalType===r.e.sharePointGroup)return!0}return!1},t}(d.e);t.default=C},function(module,__webpack_exports__,__webpack_require__){"use strict";var LoggingContext=function(){function LoggingContext(){this._root={}}return LoggingContext.prototype.set=function(e,t,n){this._root[e]||(this._root[e]={}),this._root[e][t]=n},LoggingContext.prototype.delete=function(bucket,property){var toDeleteString='this._root["'+bucket+'"]';property&&(toDeleteString+='["'+property+'"]');try{eval("delete "+toDeleteString)}catch(e){}},LoggingContext.prototype.get=function(e){var t=this,n={};if(e)e.forEach(function(e){t._root[e]&&i(t._root,e,n)});else for(var a in this._root)i(this._root,a,n);return n;function i(e,t,n){for(var a in e[t])n[t+"_"+a]=e[t][a]}},LoggingContext}();__webpack_exports__.e=LoggingContext},function(e,t,n){"use strict";n.r(t);var a=n(0),i=n("knockout-lib"),r=n(226),o="userInfo",s=function(e){function t(){return e.call(this,"UserInfoStore")||this}return Object(a.__extends)(t,e),t.prototype.getUserInfo=function(){var e=this.getValue(o);return e||(e=i.observable(null),this.setValue(o,e)),e},t}(r.e);t.default=s},,,,,,function(e,t){!function(e){"use strict";if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,a="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,r="ArrayBuffer"in e;if(r)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=function(e){return e&&DataView.prototype.isPrototypeOf(e)},c=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};m.prototype.append=function(e,t){e=u(e),t=f(t);var n=this.map[e];this.map[e]=n?n+","+t:t},m.prototype.delete=function(e){delete this.map[u(e)]},m.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},m.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},m.prototype.set=function(e,t){this.map[u(e)]=f(t)},m.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},m.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),p(e)},m.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),p(e)},m.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),p(e)},n&&(m.prototype[Symbol.iterator]=m.prototype.entries);var d=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},v.call(y.prototype),v.call(D.prototype),D.prototype.clone=function(){return new D(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new m(this.headers),url:this.url})},D.error=function(){var e=new D(null,{status:0,statusText:""});return e.type="error",e};var l=[301,302,303,307,308];D.redirect=function(e,t){if(-1===l.indexOf(t))throw new RangeError("Invalid status code");return new D(null,{status:t,headers:{location:e}})},e.Headers=m,e.Request=y,e.Response=D,e.fetch=function(e,t){return new Promise(function(n,i){var r=new y(e,t),o=new XMLHttpRequest;o.onload=function(){var e,t,a={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new m,e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),a=n.shift().trim();if(a){var i=n.join(":").trim();t.append(a,i)}}),t)};a.url="responseURL"in o?o.responseURL:a.headers.get("X-Request-URL");var i="response"in o?o.response:o.responseText;n(new D(i,a))},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request failed"))},o.open(r.method,r.url,!0),"include"===r.credentials&&(o.withCredentials=!0),"responseType"in o&&a&&(o.responseType="blob"),r.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send(void 0===r._bodyInit?null:r._bodyInit)})},e.fetch.polyfill=!0}function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function f(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function m(e){this.map={},e instanceof m?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function _(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function b(e){var t=new FileReader,n=h(t);return t.readAsArrayBuffer(e),n}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(a&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(i&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(r&&a&&s(e))this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!r||!ArrayBuffer.prototype.isPrototypeOf(e)&&!c(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=g(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=_(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?_(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(b)}),this.text=function(){var e,t,n,a=_(this);if(a)return a;if(this._bodyBlob)return e=this._bodyBlob,n=h(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),a=0;a<t.length;a++)n[a]=String.fromCharCode(t[a]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}function y(e,t){var n,a,i=(t=t||{}).body;if(e instanceof y){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new m(e.headers)),this.method=e.method,this.mode=e.mode,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new m(t.headers)),this.method=(a=(n=t.method||this.method||"GET").toUpperCase(),d.indexOf(a)>-1?a:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function S(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),a=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(a),decodeURIComponent(i))}}),t}function D(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new m(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)},,,function(e,t,n){"use strict";t.byteLength=function(e){var t=d(e),n=t[0],a=t[1];return 3*(n+a)/4-a},t.toByteArray=function(e){var t,n,a=d(e),o=a[0],s=a[1],c=new r(function(e,t,n){return 3*(t+n)/4-n}(0,o,s)),l=0,u=s>0?o-4:o;for(n=0;n<u;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;return 2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,c[l++]=255&t),1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,r=[],o=16383,s=0,c=n-i;s<c;s+=o)r.push(l(e,s,s+o>c?c:s+o));return 1===i?(t=e[n-1],r.push(a[t>>2]+a[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],r.push(a[t>>10]+a[t>>4&63]+a[t<<2&63]+"=")),r.join("")};for(var a=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=o.length;s<c;++s)a[s]=o[s],i[o.charCodeAt(s)]=s;function d(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,r,o=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(a[(r=i)>>18&63]+a[r>>12&63]+a[r>>6&63]+a[63&r]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,a,i){var r,o,s=8*i-a-1,c=(1<<s)-1,d=c>>1,l=-7,u=n?i-1:0,f=n?-1:1,p=e[t+u];for(u+=f,r=p&(1<<-l)-1,p>>=-l,l+=s;l>0;r=256*r+e[t+u],u+=f,l-=8);for(o=r&(1<<-l)-1,r>>=-l,l+=a;l>0;o=256*o+e[t+u],u+=f,l-=8);if(0===r)r=1-d;else{if(r===c)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,a),r-=d}return(p?-1:1)*o*Math.pow(2,r-a)},t.write=function(e,t,n,a,i,r){var o,s,c,d=8*r-i-1,l=(1<<d)-1,u=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=a?0:r-1,m=a?1:-1,_=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+u>=1?f/c:f*Math.pow(2,1-u))*c>=2&&(o++,c/=2),o+u>=l?(s=0,o=l):o+u>=1?(s=(t*c-1)*Math.pow(2,i),o+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,i),o=0));i>=8;e[n+p]=255&s,p+=m,s/=256,i-=8);for(o=o<<i|s,d+=i;d>0;e[n+p]=255&o,p+=m,o/=256,d-=8);e[n+p-m]|=128*_}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}}],Array(46),[function(e,t,n){"use strict";n.r(t),n.d(t,"UserExpirationUtils",function(){return l}),n.d(t,"resourceKey",function(){return u});var a=n(0),i=n(40),r=n(7),o=n(147),s=n(1206),c=n(1203),d=n(142),l=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageContext=n.pageContext,a._navigation=n.navigation,a}return Object(a.__extends)(t,e),t.prototype.autoOpenPanelBaseOnQueryParams=function(){this._checkPermissions()&&this._urlContainsUserExpirationParam()&&(this._openUserExpirationPanel(),this._removeUserExpirationUrlParam())},t.prototype._urlContainsUserExpirationParam=function(){return!(!this._navigation.viewParams||!this._navigation.viewParams[r.n.userExpirationPanelKey]&&!this._navigation.viewParams[r.n.userExpirationPanelKey.toLowerCase()])},t.prototype._checkPermissions=function(){return this._pageContext.isSiteAdmin},t.prototype._removeUserExpirationUrlParam=function(){if(this._navigation.viewParams){var e=Object(a.__assign)({},this._navigation.viewParams);(e[r.n.userExpirationPanelKey]||e[r.n.userExpirationPanelKey.toLowerCase()])&&(delete e[r.n.userExpirationPanelKey],delete e[r.n.userExpirationPanelKey.toLowerCase()],this._navigation.updateViewParams(e,{ignoreHistory:!0,clearOtherParams:!0}))}},t.prototype._openUserExpirationPanel=function(){var e=this;Promise.resolve(Promise.all([n.e("deferred"),n.e(591)]).then(n.bind(null,4564))).then(s.e).then(function(t){new(e.resources.injected(t))({}).execute(null)})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},c.default.dependencies),{pageContext:i.f,navigation:o.e}),t}(c.default),u=Object(d.r)("UserExpirationUtils",l)}],Array(57),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return s});var a=n(40),i=n(2777),r=n(142),o=n(5673),s=Object(r.r)("GraphUserInfoDataSource",o.e,{oAuthTokenProvider:i.e,pageContext:a.f})}],Array(35),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return h});var a=n(0),i=n(1203),r=n(142),o=n(1e3),s=n(2777),c=n(2238),d=n(997),l=n(40),u=n(43),f=18e5,p=108e5,m=Object(u.isFeatureEnabled)(u.UseSelfIssuedTokenForSPOWebAuth)&&Object(u.isFeatureEnabled)(u.UseIdentityAuthForVroom),_=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._authTokenFetcher=n.authTokenFetcher,a._itemsStore=n.itemsStore,a._pageContext=n.pageContext,a._tokenList=new Set,a._callTimesCount=0,a._serverLocalTimeDelta=0,setInterval(a._cleanCallTimesCount.bind(a),216e5),a}return Object(a.__extends)(t,e),t.prototype.trackListToken=function(e){if(!m){if(!this._tokenList.has(e)&&(this._tokenList.add(e),!this._serverLocalTimeDelta)){var t=this._getAccessToken(e);this._serverLocalTimeDelta=this._computeClockSkew(t)}this._scheduleListTokenCheck()}},t.prototype._scheduleListTokenCheck=function(){var e=this;if(this._pageContext.isSPO){var t=this._getRecentExpire();this.async.clearTimeout(this._timeoutId),this._timeoutId=this.async.setTimeout(function(){e._checkListToken()},t)}},t.prototype._getRecentExpire=function(){var e=this,t=p;return this._tokenList.forEach(function(n){var a=e._getAccessToken(n),i=a?1e3*Number(Object(o.a)(a).exp)-e._getCurrentServerTime()-f:p;t=Math.min(i,t)}),t},t.prototype._checkListToken=function(){var e=this;this._tokenList.forEach(function(t){var n=e._itemsStore.getItem(t),a=n&&n.peek(),i=Object(o.a)(a&&a.graph&&a.graph.sessionToken&&a.graph.sessionToken.accessToken);i&&1e3*Number(i.exp)-e._getCurrentServerTime()<f?e._callTimesCount<10&&(e._updateListToken(t),e._callTimesCount=Number(e._callTimesCount)+1):e._scheduleListTokenCheck()})},t.prototype._updateListToken=function(e){var t=this;this._authTokenFetcher.getAuthToken(e).then(function(){t._scheduleListTokenCheck()})},t.prototype._getAccessToken=function(e){var t=this._itemsStore.getItem(e),n=t&&t.peek();return n&&n.graph&&n.graph.sessionToken&&n.graph.sessionToken.accessToken},t.prototype._computeClockSkew=function(e){return e?1e3*Number(Object(o.a)(e).nbf)-Date.now():0},t.prototype._getCurrentServerTime=function(){return Date.now()+this._serverLocalTimeDelta},t.prototype._cleanCallTimesCount=function(){this._callTimesCount=0},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{authTokenFetcher:d.e,oAuthTokenProvider:s.e,itemsStore:c.t,pageContext:l.f}),t}(i.default);t.default=_;var h=Object(r.r)("AuthTokenMonitor",_)}],Array(27),[function(e,t,n){"use strict";n.r(t),n.d(t,"TeamChannelHeaderBase",function(){return b}),n.d(t,"TeamChannelHeader",function(){return g});var a=n(0),i=n("react-lib"),r=n(311),o=n(12),s=n(3165),c=n(47),d=n(1),l=n(2756),u=n(62),f=n(147),p=n(42),m=n(91),_=n(11),h=n(3),b=function(e){function t(t){return e.call(this,t)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.progId,n=e.resources,a=n.consume(r.e),o=!1;if(Object(h.Jr)(h.H))return null;if(!_.e.isActivated("0951DA6B-4128-449F-A9B1-98173899A776","01/21/2021","Hide TeamChannelHeader for file picker ")){var c=n.consume(f.e.optional);o=!!c&&Object(p._)(c.viewParams)===m.e.FilePicker}return!o&&Object(s.e)(t)?i.createElement(l.default,{actionMap:a,resources:n}):null},t}(i.PureComponent),g=Object(o.e)()(Object(c.e)(function(e,t){return{progId:e.demandItemFacet(d.Pt,t.itemKey)}})(Object(u.i)()(b)))}],Array(99),[function(e,t,n){"use strict";n.r(t),n.d(t,"loadTransitionResources",function(){return Hi}),n.d(t,"resourceKey",function(){return Ri});var a,i,r,o=n(0),s=n("knockout-lib"),c=(n(2533),n(2994),n(40)),d=n(311),l=n(101),u=n(856),f=n(488),p=n(421),m=n(1412),_=n(5492),h=n(5175),b=n(1203),g=n(157),v=n(4819),y=n(1942),S=n(1949),D=n(138),I=n(70),x=n(79),C=n(37),O=n(72),w=n(2604),E=n(2648),A=n(3707),L=n(3836),k=n(4801),M=n(54),P=n(8),T=n(142),U=new P.t({name:"TeamsProvider.key",loader:new T.t(function(){return Promise.resolve().then(n.bind(null,5672)).then(function(e){return e.resourceKey})})}),F=n(535),H=n(1206),R=n(93),N=n(43),B=n(16),j=n(4414),V=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=n,i=a.observables,r=a.resources,o=n._pageContext=r.consume(c.f);n._notificationLinks=i.createArray([]),n._linkGroupsInitialized=!1,n._linkGroups=i.createArray([]),n._actionMap=n.resources.consume(d.e),n._isAdminRecycleBin=!B.t.isActivated("c84ba3b3-db41-43d4-adbb-15f9d87a9c68")&&(null==o?void 0:o.isSiteAdmin),n._addSharedWithUsNode=Object(g.l)(o)&&!!o.listUrl&&!Object(N.isFeatureEnabled)(N.RemoveSharedWithUs),n._isLeftNavOpenInNewWindowEnabled=Object(N.isFeatureEnabled)(N.LeftNavOpenInNewWindow),n._isLinkTargetKSActivated=Object(E.a)(),n.useReactLeftNav=!0;var s=r.consume(l.S).getIdentity();n.isEditable=i.create(C.e.hasIdentityPermission(s,C.e.manageLists)),n.isEditable.peek()&&new w.default(o).getReadOnlyState().then(function(e){return n.isEditable(!e)});var u=!(o.viewOnlyExperienceEnabled||o.blockDownloadsExperienceEnabled||o.disableBackToClassic||t.disableBackToClassic||Object(R.l)());return B.t.isActivated("bf798799-2196-49a2-964e-fe917af19943")||(u=u&&Number(o.webTemplate)!==O.t.sitePagePublishing),u&&n._notificationLinks.push({text:v.e,url:"#",action:new(n.managed(n._actionMap.BackToClassicAction))({resources:r,url:t.backToClassicUrl||i.create(""),cookieName:"splnu",cookieValue:o.listId}),isActive:i.create(!1),isFocused:i.create(!1),engagementName:"BackToClassic",renderAs:6,altText:v.t}),Object(g.l)(o)&&r.consume(p.e).waitForPageRenderingComplete().then(function(){return M.n.resolve(r.consumeAsync(U))}).then(function(e){return n._teamsProvider=e,e.getTeamsUrl()}).then(function(e){e?(n._teamsUrl=e,n._tryAddTeamsCoachmark()):n._tryAddTeamifyBanner()}),n}return Object(o.__extends)(t,e),t.prototype.getNotificationLinks=function(){return this._notificationLinks},t.prototype.getHandlerTypeKeys=function(){return this._pageContext.hubSiteId?[k.e]:[]},t.prototype.getReactLinkGroups=function(){var e=this;if(!this._linkGroupsInitialized){var t=new D.e({name:"LeftNav.DataSource"}),n={links:this._getLeftNavNodes(!0),key:L.n.quickLaunch,hasEditLink:this.isEditable.peek(),augmentLinks:function(t){e._augmentQuickLaunch(t)}};t.end({resultCode:"Success",resultType:I.e.Success});var a=[n];if(!this._pageContext.isHubSite){var i=new D.e({name:"TopNav.DataSource"});a.push({links:this._getLeftNavNodes(!1),key:L.n.globalNav,hideAbove:"Large"}),i.end({resultCode:"Success",resultType:I.e.Success})}this._linkGroups(a),this._linkGroupsInitialized=!0,this._tryAddTeamsCoachmark()}return this._linkGroups},t.prototype.addSharedWithUsNode=function(e){this._linkGroupsInitialized||this.getReactLinkGroups();var t=this._linkGroups.peek().filter(function(e){return e.key===L.n.quickLaunch})[0];if(t)for(var n=t.links,a=new x.t(e).getPath(),i=0;i<n.length;i++)if(-1!==n[i].url.indexOf(a)){var r={name:y.c,key:A.t.clientSharedWithUs,url:"#view=3",engagementName:"SharedWithUs",altText:S.u};n.splice(i+1,0,r),this._linkGroups.valueHasMutated();break}},t.prototype._getLeftNavNodes=function(e){var t=this._pageContext.navigationInfo;if(t){if(e){var n=this._getNavLinks(t.quickLaunch);return this._augmentQuickLaunch(n),n}var a=this._getNavLinks(t.topNav);return this._augmentGlobalNav(a),a}return[]},t.prototype._getNavLinks=function(e,t){var n=this;return e&&e.length?e.map(function(e){var t=n._getLink({name:e.Title,url:e.Url,key:e.Id.toString(),isDocLib:e.IsDocLib,listTemplateType:e.ListTemplateType,audiences:e.AudienceIds||void 0,openInNewWindow:e.OpenInNewWindow});return e.Children&&(t.links=n._getNavLinks(e.Children,!0)),t}):[]},t.prototype._augmentQuickLaunch=function(e,t){if(e){for(var n=this._pageContext,a=Object(g.s)(n),i=a+"".concat(this._isAdminRecycleBin?"/_layouts/15/AdminRecycleBin.aspx":"/_layouts/15/RecycleBin.aspx"),r=0;r<e.length;r++){var o=e[r];o.key===A.t.quickLaunchHome&&Number(n.webTemplate)===O.t.group&&n.groupId&&!n.groupHasHomepage&&(o.url=a+"/_layouts/15/groupstatus.aspx?target=home"),o.key!==A.t.quickLaunchRecent?this._augmentQuickLaunch(o.links,!0):(e.splice(r,1),r--)}if(!t&&e.length){this._addSharedWithUsNode&&e.splice(3,0,this._getLink({name:y.c,key:A.t.clientSharedWithUs,url:"#view=3",engagementName:"SharedWithUs",altText:S.u}));var s=e[e.length-1],c=n&&Number(n.webTemplate)===O.t.sitePagePublishing,d=B.t.isActivated("16da45d2-f27f-4d40-b0fb-63520cb5589d")||!c;if(!Object(j.e)(e)&&d){var l=s.key===A.t.clientEdit?e.length-1:e.length;e.splice(l,0,this._getLink({name:y.o,url:i,key:A.t.clientRecycleBin,automationId:"RecycleBin",title:S.d}))}}}},t.prototype._augmentGlobalNav=function(e,t){if(e){t||(t=this._getSubsitesUrls());for(var n=0;n<e.length;n++){var a=e[n],i=a.key===A.t.globalNavHome,r=-1!==t.indexOf(a.url);i||r?(e.splice(n,1),n--):this._augmentGlobalNav(a.links,t)}}},t.prototype._getSubsitesUrls=function(){var e=this._pageContext.navigationInfo,t=e&&e.quickLaunch;if(t)for(var n=0,a=t;n<a.length;n++){var i=a[n];if(i.Id===Number(A.t.subsites))return(i.Children||[]).map(function(e){return e.Url})}return[]},t.prototype._getLink=function(e){var t=this._isLeftNavOpenInNewWindowEnabled?e.openInNewWindow:void 0,n=this._isLinkTargetKSActivated?E.t.isRelativeUrl:E.t.shouldLinkOpenInSameWindow;return Object(o.__assign)({isExpanded:!1,target:(null!=t?t:n(e.url))?"":"_blank"},e)},t.prototype._tryAddTeamifyBanner=function(){var e=this;this._teamsProvider.canTeamify().then(function(t){t&&M.n.resolve(Promise.resolve().then(n.bind(null,2773))).then(H.e).then(function(t){M.n.resolve(Promise.resolve().then(n.bind(null,5671))).then(function(n){var a={pageContext:e._pageContext,className:"LeftNav-teamifyBanner",teamifyStrings:n.teamifyStrings};e._notificationLinks.unshift({isActive:e.observables.create(!1),isFocused:e.observables.create(!1),renderAs:10,component:{name:t.tagName,params:a}})})})})},t.prototype._tryAddTeamsCoachmark=function(){var e=this,t=this._teamsProvider;if(t&&this._teamsUrl){var n=this._linkGroups.peek().filter(function(e){return e.key===L.n.quickLaunch})[0];n&&n.links&&n.links.length&&t.shouldShowTeamsCoachmark().then(function(a){if(a){var i=t.findTeamsLink(n.links,e._teamsUrl);i&&(i.id="TeamsNavLink",i.coachmarkProps={id:i.id,teachingBubbleHeadline:v.a,teachingBubbleContent:v.n,onDismiss:function(){e.resources.consume(F.e).logData({name:"TeamsTeachingBubble.Dismiss.Click",isIntentional:!0}),t.setTeamsBubbleFlag(!0),i.coachmarkProps=void 0}},e._linkGroups.valueHasMutated())}})}},t}(b.default),z=V,G=function(e){function t(t){var n=e.call(this,t)||this;return n._connectionUrl="",n._connectionUrl=Object(g.s)(n._pageContext)+"/_api/Site/ShareByLinkEnabled",n}return Object(o.__extends)(t,e),t.prototype.getShareByLinkInfo=function(){return this.dataRequestor.getData({url:this._connectionUrl,parseResponse:function(e){var t=JSON.parse(e);return t&&t.d?{isExternalSharingTipEnabled:!!t.d.ShareByLinkEnabled}:null},qosName:"GetShareByLinkInfo"})},t.prototype.getDataSourceName=function(){return"ShareByLinkDataSource"},t}(n(2698).e),K=n(590),W=n(148),q=n(1340),Q=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._dataRequestor=new(n.child(q.t))({qosName:"FolderItemCountDataSource"}),n._apiUrlHelper=n.resources.consume(K.e),n._itemUrlHelper=n.resources.consume(W.c),n}return Object(o.__extends)(t,e),t.prototype.getFolderItemCountInfo=function(e){return this._dataRequestor.getData({url:this._getQueryUrl(e),qosName:"GetFolderItemCountInfo"}).then(function(e){var t=(void 0===e?{}:e).d,n=(void 0===t?{}:t).ItemCount,a=void 0===n?void 0:n;return"number"==typeof a?{itemCount:a}:void 0})},t.prototype._getQueryUrl=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(t).method("GetFolderByServerRelativeUrl",t.serverRelativeItemUrl).segment("ItemCount").toString()},t}(b.default),Y=n(4438),J=n(2192),X=n(3717),Z=n(14),$=n(46),ee=n(111),te=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(o.__extends)(t,e),t.prototype.createActivityColumn=function(){return{key:"activity",name:ee.ActivityColumnName,fieldType:$.t.Activity,minWidth:140,width:300,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,isIcon:!1,sortable:!1,filterable:!1,isSorted:!1,isFocused:this.observables.create(!1),isAscending:!1}},t}(b.default),ne=Object(T.r)("ActivityColumnBuilder",te,Object(o.__assign)({},b.default.dependencies)),ae=n(1513),ie=n(38),re=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._itemParentHelper=n.itemParentHelper,a._activityColumnBuilder=n.activityColumnBuilder,a._isActivityFieldEnabled=n.isActivityFieldEnabled,a._isActivityFieldVisible=n.isActivityFieldVisible,a._pageContext=n.pageContext,a}return Object(o.__extends)(t,e),t.prototype.postProcessSchema=function(e,t){var n=this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return n&&n.list.isDocumentLibrary&&e.queryType===ie.e.Files&&(Object(X.e)(t)||n.list.templateType===Z.n.mySiteDocumentLibrary||Number(this._pageContext.webTemplate)===O.t.mySite)&&this._isActivityFieldEnabled&&this._isActivityFieldVisible()&&(t=Object(o.__spreadArray)(Object(o.__spreadArray)([],t,!0),[this._activityColumnBuilder.createActivityColumn()],!1)),t},t}(b.default),oe=Object(T.r)("DetailsListSchemaDataSource",re,Object(o.__assign)(Object(o.__assign)({},b.default.dependencies),{itemParentHelper:J.e,activityColumnBuilder:ne,isActivityFieldEnabled:ae.e,isActivityFieldVisible:ae.t.lazy,pageContext:c.f})),se=n(2666),ce=n(1651),de=n(1654),le=n(2477),ue=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._dataSource=n.resources.consume(l.$),n}return Object(o.__extends)(t,e),t.prototype.getShareByLinkInfo=function(){return this._dataSource.getShareByLinkInfo().then(function(e){return e})},t}(b.default),fe=n(1578),pe=n(1418),me=n(1572),_e=n(5176),he=n(147),be=n(5177),ge=n(985),ve=n(1657),ye=n(364),Se=n(4436),De=n(4804),Ie=n(7),xe=n(1551),Ce=n(4820),Oe=n(851),we=n(1591),Ee=function(){function e(){}return e.shouldAddGroupsFeatures=function(e){return Object(g.l)(e)},e.loadAndInitGroupsResources=function(e){e.isDefined(Oe.e)||e.exposeFactory(Oe.e,new T.e(we.e));var t=M.n.resolve(e.consumeAsync(Oe.e));return e.isExposed(Oe.t)||e.expose(Oe.t,t),t.then(function(e){return{groupsProvider:e}})},e}(),Ae=n(4827),Le=n(4444),ke=n(4145),Me=n(4769),Pe=n(2238),Te=n(188),Ue=n(4447),Fe=n(2178),He=n(4226),Re=n(2632),Ne=n(4835),Be=function(e){function t(t){var n=e.call(this,t)||this;return n.id=t.id,n._onViewChanged=t.onViewChanged||null,n}return Object(o.__extends)(t,e),t.prototype.initialize=function(e){var t=this;this.pageResources=e;var n=e.resourceScope,a=e.appResources.pageContext,i=e.commandSet;ke.e.exposeResources({resourceScope:n,pageContext:a,viewId:a.viewId}),this.useItemsScope=n.consume(Re.e),this.dataManager=n.consume(f.t),this._error=this.observables.create();var r=n.consume(d.P);n.expose(d.a,this.dataManager.canModifySchema);var c=n.consume(f.n);this._registerPageLoadCompleteEvent(this.dataManager,c),this._setupViewChangeEventHandler(n),n.expose(f.a.isArrangeControlVisible,s.observable(!1));var u={};n.isExposed(l.re)&&Object(N.isFeatureEnabled)(N.Spotlight)&&!this.useItemsScope.peek()&&(u=this._setupSpotlight(n));var p=Object(o.__assign)({topCommandSet:i,showViewCommandSet:!0,isCustomList:!0,breadcrumbBuilder:this.dataManager.getCrumbs.bind(this.dataManager)},u);this._initializeItemsScopeManager(),this.controlSpecification=this._getListSpecification(p),this.observables.backgroundCompute(function(){r(),t._error(void 0)})},t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.prototype._registerPageLoadCompleteEvent=function(e,t){var n=this;this.events.on(e,"pageLoadComplete",function(){Te.t.raise(t,Ae.e.mainContentLoadComplete),n.events.off(e,"pageLoadComplete")})},t.prototype._setupViewChangeEventHandler=function(e){if(this._onViewChanged){var t=e.consume(d.l);this.observables.subscribe(t,this._onViewChanged)}},t.prototype._setupSpotlight=function(e){e.expose(p.g,new(e.injected(Me.e))({itemSet:e.consume(d.s),itemsStore:e.consume(Pe.t),spotlightDataSource:e.consume(l.re),currentView:e.consume(d.l)}));var t=e.consume(p.g).getSpotlightItems(),n=s.pureComputed(function(){return t.peek().length>0||t().length>0}),a=s.observable(),i=s.observable(!1),r={spotlightCommandSet:a,isSpotlightActive:i,isSpotlightVisible:n,boundingElementClass:"StandaloneList-content"};return{subcomponentSpecification:Object(Fe.i)(Ue.e,r),subcomponentCommandSet:a,isSubcomponentActive:i,isSubcomponentVisible:n}},t.prototype._getListSpecification=function(e){var t=this,n=Object(Fe.i)(Le.e.bypass,e),a=Object(Fe.i)(He.e.bypass,{props:{},error:this._error});return this.observables.pureCompute(function(){return t._error()?Object(Fe.i)(Ne.e,{error:t._error.peek()}):t.useItemsScope()?a:n})},t.prototype._initializeItemsScopeManager=function(){var e=this;this.observables.backgroundCompute(function(){e.useItemsScope.peek()?e.pageResources.resourceScope.consumeAsync(m.e):e.useItemsScope()})},t}(b.default),je=function(){function e(){}return e.prototype.addGroupsFeatures=function(e){var t=this,n=e.getPageSettings,a=e.initializeScenario;e.initializeScenario=function(e){a(e),t.synchronousInitialize(e)},e.getPageSettings=function(){var e=n();return t._configurePageSettings(e),e}},e.prototype.synchronousInitialize=function(e){Ee.loadAndInitGroupsResources(e.resourceScope)},e.prototype._configurePageSettings=function(e){e.route=new Be({id:"List"})},e}(),Ve=n(4434),ze=n(2633),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getAction=function(e){if(this.resources.isExposed(c.o)){var t=this.resources.consume(c.o),n=t.listUrl?t.listUrl:t.folderPath;if(n)return{text:ze.m,url:n}}return{text:null,url:null,hideButton:!0}},t}(b.default),Ke=Ge,We=new P.t({name:"PublishDataSource.key",loader:new T.t(function(){return n.e(480).then(n.bind(null,5699)).then(function(e){return e.resourceKey})})}),qe=new P.t({name:"PublishProvider.key",loader:new T.t(function(){return n.e(527).then(n.bind(null,5700)).then(function(e){return e.resourceKey})})}),Qe=n(357),Ye=function(){function e(e,t){this._pageContext=t.pageContext}return e.prototype.getCurrentLanguage=function(){return Qe.t.language},e.prototype.getCurrentLanguageCode=function(){return this._pageContext.currentUICultureName},e}(),Je=Object(T.r)("LanguageDataSource",Ye,{pageContext:c.f}),Xe=n(20),Ze=n(158),$e=n(4227),et=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t)||this;return a._footerLinks=s.observable([]),a._searchFooterLinkId="upscopeSearchLink",a}return Object(o.__extends)(t,e),t.prototype.showLanguageLink=function(){return!1},t.prototype.showConfidentialText=function(){return!1},t.prototype.getLanguageText=function(){return""},t.prototype.getFooterLinks=function(){var e=this;return this.async.setTimeout(function(){var t=document.getElementById(e._searchFooterLinkId);t&&e.events.on(t,"click",Ze.e.logData.bind(e,{name:"Expand.Search.Click"}))}.bind(this),100),this._footerLinks()},t.prototype.setSearchFooterLink=function(e){if(e){var t=$e.t,n=this._searchFooterLinkId,a=Xe.format($e.n,'<a id="'.concat(n,'" title="').concat(t,'" href="').concat(e,'" target="_blank">').concat(t,"</a>"));this._searchFooterLink=[{encodedText:a}],this._footerLinks(this._searchFooterLink)}else this._footerLinks([])},t}(b.default),tt=et,nt=(Object(T.r)("SPListFooterDataSource",et),function(){function e(){}return e.prototype.getEncoding=function(){return null},e}()),at=new P.t({name:"VideoItemDataSource.key",loader:new T.t(function(){return n.e(486).then(n.bind(null,6009)).then(function(e){return e.resourceKey})})}),it=n(4448),rt=n(2950),ot=new P.t({name:"NeedsAttentionViewHelper.key",loader:new T.t(function(){return n.e(534).then(n.bind(null,5701)).then(function(e){return e.resourceKey})})}),st=n(2449),ct=function(e){void 0===e&&(e={});var t=e.behavior;this.behavior=t},dt=n(2864),lt=n(2582),ut=n(2791),ft=n(3101),pt=n(4449),mt=n(2699),_t=n(2999),ht=!B.e.isActivated("2f9bdd69-14dc-4f06-8a20-7caedf41c80a","05/24/2022","Enable using new embed dialog in ODB and SPO."),bt=!B.e.isActivated("78ce42b1-dcef-438a-824c-c7808018f95e","10/03/2022","checks for viewListItems permissions if item doesnt contain openItems perimissions and allows view access,this could fix view access restriction for blockDownload items"),gt=((a={})[lt.i.id]=!0,a[lt.e.id]=!0,a[ut.e.id]=!0,a[ut.a.id]=!0,a[lt.n.id]=!0,a[ft.e.id]=!0,a[ft.t.id]=!0,a[ft.n.id]=!0,a[ft.r.id]=!0,a[_t.t.id]=!0,a[lt.f.id]=!0,a[mt.a.id]=!0,a[ut.t.id]=!0,a[ut.n.id]=!0,a[ut.r.id]=!1,a[dt.t.id]=!0,a[dt.e.id]=!0,a[mt.n.id]=!0,a),vt=((i={})[ut.e.id]=!0,i[lt.n.id]=!0,i[_t.t.id]=!0,i[dt.t.id]=!0,i[dt.e.id]=!0,i[ft.n.id]=!0,i[ut.i.id]=!0,i[ut.n.id]=!0,i[mt.t.id]=!0,i),yt=((r={})[lt.a.id]=!0,r),St=function(){function e(e,t){this._pageContext=t.pageContext}return e.prototype.getCommand=function(e,t){var n,a;switch(t){case lt.p:a=this._isRestoreEnabled(e);break;case lt.r:a=!this._pageContext.isAnonymousGuestUser||C.e.hasItemPermission(e,C.e.openItems)||bt&&C.e.hasItemPermission(e,C.e.viewListItems);break;case pt.e:a=!this._pageContext.blockDownloadsExperienceEnabled&&!this._pageContext.viewOnlyExperienceEnabled&&C.e.hasItemPermission(e,C.e.openItems);break;case mt.n:a=Object(N.isFeatureEnabled)(N.EnableEmbedDialog)&&ht;break;case ut.i:case ut.a:case ut.t:case ut.e:case ut.n:case lt.e:case lt.i:case lt.f:case lt.l:case lt.c:case lt.o:case lt.s:case lt.d:case lt.t:case lt.u:case ft.n:case ft.i:case ft.a:case ft.e:case ft.t:case ft.r:case mt.a:case mt.t:case mt.e:case lt.n:case _t.t:case _t.n:case _t.e:case ut.r:case dt.t:case dt.e:a=!0}return(this._pageContext.isAnonymousGuestUser&&gt[t.id]||this._pageContext.isEmailAuthenticationGuestUser&&vt[t.id])&&(a=!1),e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected&&(a=a&&yt[t.id]),a&&(n=new ct),n},e.prototype._isRestoreEnabled=function(e){return!!e.recycleBinProperties.itemState},e}(),Dt=Object(T.r)("ItemCommandDataSource",St,{pageContext:c.f}),It=function(e){function t(t){var n=e.call(this,t)||this;return n._fileSystemItemIdMapping={},n}return Object(o.__extends)(t,e),t.prototype.getPathFromItemId=function(e){return this._fileSystemItemIdMapping[e]},t.prototype.setFileSystemIdMapping=function(e,t){this._fileSystemItemIdMapping[e]=t},t}(b.default),xt=n(4836),Ct=new P.t({name:"PushChannelDataSource.key",loader:new T.t(function(){return n.e(481).then(n.bind(null,6010)).then(function(e){return e.resourceKey})})}),Ot=n(4228),wt=n(2892),Et=n(4450),At=new P.t({name:"ItemAutoRefreshDataSource.key",loader:new T.t(function(){return n.e(458).then(n.bind(null,5702)).then(function(e){return e.resourceKey})})}),Lt=new P.t({name:"ItemAutoRefreshProvider.key",loader:new T.t(function(){return n.e(587).then(n.bind(null,5703)).then(function(e){return e.resourceKey})})}),kt=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(o.__extends)(t,e),t.prototype.initialize=function(){this._dataPromise=null},t.prototype.getCustomActionData=function(){return this._dataPromise||(this._dataPromise=M.n.resolve(this.resources.consumeAsync(l.o)).then(function(e){return e.getCustomActionData()})),this._dataPromise},t.prototype.isGroup=function(e){return"children"in e},t}(n(292).e),Mt=n(177),Pt=function(){function e(e,t){var n=t.platformDetection;this._wordAction=n.isMobile&&!n.isIPad?"mobileview":"embedview"}return e.prototype.getWopiFrameUrl=function(e,t){var n="ms-word"===e.appMap,a=e.wopiFrameUrl,i=n?this._wordAction:"embedview",r=a&&a.replace(/action=([^&]+)/,"action=".concat(i,"&wdnc=1&nobg=1"));return r?r.replace(/\/_layouts\/[^?]+/i,"/_layouts/15/".concat(t?"WopiEmbedFrame":"doc",".aspx")):void 0},e}(),Tt=Object(T.r)("WopiFrameDataSource",Pt,{platformDetection:Mt.e}),Ut=new P.t({name:"WrsDataSource.key",loader:new T.t(function(){return n.e(488).then(n.bind(null,5704)).then(function(e){return e.resourceKey})})}),Ft=n(1404),Ht=n(4224),Rt=new P.t({name:"SearchDataSource.key",loader:new T.t(function(){return Promise.all([n.e("deferred.resx-deferred"),n.e("deferred"),n.e("deferred.odsp-datasources"),n.e("deferred.odsp-common"),n.e("deferred.items-view"),n.e(753)]).then(n.bind(null,5916)).then(function(e){return e.resourceKey})})}),Nt=n(4217),Bt=n(44),jt=function(){function e(e){this._pageContext=e;var t=(e&&new Bt.e(e.webAbsoluteUrl)).authority;this._itemUrlBase=t+this._pageContext.listUrl}return e.prototype.getActivityItemUrl=function(e){var t=e&&e.driveItem;return t&&t.webUrl?t.webUrl:t&&e&&void 0!==e.relativePath?this._itemUrlBase+e.relativePath:void 0},e.prototype.getPageContextForRenderUser=function(){return this._pageContext},e}(),Vt=new P.t({name:"ItemActivityFeedHelper.key",loader:new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(752)]).then(n.bind(null,6011)).then(function(e){return e.resourceKey})})}),zt=new P.t({name:"ItemActivityFeedSharingHelper.key",loader:new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(703)]).then(n.bind(null,6012)).then(function(e){return e.resourceKey})})}),Gt=new P.t({name:"ItemCommentsDataSource.key",loader:new T.t(function(){return n.e(742).then(n.bind(null,5917)).then(function(e){return e.resourceKey})})}),Kt=n(4837),Wt=new P.t({name:"RestoreOperationDataSource.key",loader:new T.t(function(){return n.e(745).then(n.bind(null,6013)).then(function(e){return e.resourceKey})})}),qt=new P.t({name:"RestoreActivitiesDataSource.key",loader:new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(744)]).then(n.bind(null,5942)).then(function(e){return e.resourceKey})})}),Qt=new P.t({name:"MruRecentDataSource.key",loader:new T.t(function(){return n.e(478).then(n.bind(null,4983)).then(function(e){return e.resourceKey})})}),Yt=new P.t({name:"MruRecentProvider.key",loader:new T.t(function(){return n.e(520).then(n.bind(null,4984)).then(function(e){return e.resourceKey})})}),Jt=n(5069),Xt=n(4828),Zt=n(3694),$t=n(5089),en=n(3446),tn=n(217),nn=n(1933),an=n(372),rn=n(3),on=n(2962),sn=n(1946),cn=n("react-lib"),dn=cn.lazy(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(558)]).then(n.bind(null,2775))});function ln(e){return cn.createElement("div",null,cn.createElement(cn.Suspense,{fallback:cn.createElement("div",null)},cn.createElement(dn,Object(o.__assign)({},e))))}var un=new P.t({name:"PeoplePickerProvider.key",loader:new T.t(function(){return n.e(526).then(n.bind(null,2374)).then(function(e){return e.resourceKey})})}),fn=n(2281),pn=function(){function e(e,t,n,a,i,r,o){this._id=t,this.rx=o,this._resources=e,this._pageContext=n,this._getViewParams=i,this._submitSearch=r,this._rootItemId=a}return e.prototype.getId=function(){return this._id},e.prototype.createStream=function(e){var t=this;return this.rx.Observable.fromPromise(this._getPropsPromise(e)).selectMany(function(e){return t.rx.Observable.fromArray(e)})},e.prototype._getPropsPromise=function(e){return Object(o.__awaiter)(this,void 0,void 0,function(){var t,a=this;return Object(o.__generator)(this,function(i){switch(i.label){case 0:return this._searchProvider?[3,2]:[4,n.e(731).then(n.bind(null,6023))];case 1:t=i.sent().MetadataSearchProvider,this._searchProvider=new t({getViewParams:this._getViewParams,rootItemId:this._rootItemId},{dataSource:this._resources.consume(en.e),pageContext:Object(rn.Jr)(rn.x)?this._pageContext:void 0}),i.label=2;case 2:return this._searchProvider.searchBoxText=e,[2,this._resources.consumeAsync(un).then(function(e){return[{id:"metadataSearchForm",provider:a._searchProvider,pageContext:a._pageContext,getIconUrl:function(e,t){return Object(fn.e)(a._resources,e,t)},peoplePickerProvider:e,ariaRole:"dialog",ariaLabel:sn.d,ariaModal:!0,submitSearch:a._submitSearch}]})]}})})},e}();function mn(e,t,n,a,i,r){return{id:"metadataFormUpdater",groupUpdaters:[{groupId:"file",createUpdater:function(){var o=pn.bind(null,e,"SuiteNavSearchBox.MetadataSearchFormProvider",t,n,i,r);return o.__parameters=[{index:0,name:"rxjs"}],{providers:function(e){return[o]},component:function(e){return a||ln},heading:function(e){return""},optimalCount:function(e){return 1},ariaLabel:function(e){return sn.d}}}}]}}var _n=n(4230),hn=n(4451),bn=new P.t("searchUpscopeDataSource"),gn=n(5098),vn=n(848),yn=n(5178);function Sn(){var e="alertInPageSearchResults",t=document.getElementById(e);t&&t.parentElement&&t.parentElement.removeChild(t),(t=document.createElement("div")).id=e,t.className="ms-accessible",t.innerText=yn.e,t.setAttribute("role","alert"),document.body.appendChild(t)}var Dn=n(126),In=n(489),xn=n(2634),Cn=new P.t({name:"ShortcutProvider.key",loader:new T.t(function(){return Promise.resolve().then(n.bind(null,2961)).then(function(e){return e.resourceKey})})}),On=n(2621),wn=n(11),En=n(4838),An=wn.e.isActivated("891196BA-98FA-4623-ABD1-371612730330","10/10/2022","fix oneNote results and suggestions url");function Ln(e,t){return e.sPWebUrl&&Object(rn.Jr)(rn.fi)&&xn.e.isShortcutFileType(e.fileExtension)?function(e,t,n){return n.consumeAsync(Cn).then(function(n){return n.getShortcutTargetData(e,!0,void 0,t).then(function(e){return e.isInternal?Object(En.e)(e.url):e.url})})}(e.url,e.sPWebUrl,t).then(function(e){return e}):Promise.resolve(Object(En.e)(e.url))}function kn(e){return e.url.toLowerCase().indexOf("docsethome.aspx")>=0}function Mn(e){return{id:"fileSuggestionClickUpdater",groupUpdaters:Pn(e)}}function Pn(e){return[{groupId:"file",createUpdater:Tn(e)},{groupId:"app",createUpdater:Tn(e)}]}function Tn(e){return function(){return{component:function(t){return function(n){return cn.createElement(t,Object(o.__assign)(Object(o.__assign)({},n),{onClick:function(t){!function(e,t,n){Object(o.__awaiter)(this,void 0,void 0,function(){var a;return Object(o.__generator)(this,function(i){switch(i.label){case 0:return n.engagement.logData({name:"InlineResult.Search.Click",isIntentional:!0}),t.onClick&&t.onClick(e),function(e){var t=e.fileExtension,n=e.fileType;return void 0===t&&"File"===n}(t)&&function(e,t){e.preventDefault(),e.stopPropagation(),window.open(t,"_blank")}(e,t.url),function(e){var t,n=!An&&("one"===e.fileExtension||-1!==(null===(t=e.url)||void 0===t?void 0:t.toLowerCase().indexOf("/doc.aspx?")));return!!e.fileType&&"folder"===e.fileType.toLowerCase()&&!kn(e)&&!n}(t)?(function(e,t,n){var a;e.preventDefault(),e.stopPropagation(),!n.pageContext.listUrl||function(e,t){return e.indexOf(t)>-1}(t.url,n.pageContext.listUrl)||(a=t.url.substring(0,t.url.lastIndexOf("/"))),n.navigation.updateViewParams(function(e,t,n){var a={},i=new Dn.e(e),r=i.path.indexOf("?"),o=i.path.substring(0,-1!==r?r:i.path.length);return a[Ie.n.idParamKey]=o,!n||(a[Ie.n.listUrlKey]=n),a}(t.url,0,a),{clearOtherParams:!0})}(e,t,n),[3,3]):[3,1];case 1:return!function(e,t){return!(!e.url||(a=e.url,!wn.e.isActivated("31d4a0b9-e9f7-4b89-a452-b27b0222793d")&&-1!==a.indexOf("/_layouts/15/"))||function(e,t){return!!e&&!!e.listTemplateType&&Object(Z.r)(e.listTemplateType)&&t.url.toLowerCase().indexOf("dispform.aspx")>=0}(t.listContext,e)||function(e){return("aspx"===e.fileExtension||!e.fileExtension)&&e.url.toLowerCase().indexOf(".aspx")>=0}(e)||(n=e.fileExtension,n&&Object(On.s)(n.toLowerCase()))||kn(e));var n,a}(t,n)||(o=(r=t.url).indexOf("?")>-1?Object(In.e)(r.substring(r.indexOf("?")+1)):void 0)&&o[Ie.n.idParamKey]&&o[Ie.n.parentIdParamKey]?[3,3]:(e.preventDefault(),e.stopPropagation(),[4,Ln(t,n.resources)]);case 2:a=i.sent(),window.open(a,"_blank"),i.label=3;case 3:return[2]}var r,o})})}(t,n,e)}}))}}}}}var Un=n(1384),Fn=n(2409),Hn=n(4220),Rn=n(216),Nn=n(428),Bn=n(2651),jn=n(235),Vn=new Rn.e,zn={delayQos:{},delayTimeoutState:{}},Gn=wn.e.isActivated("1FC858FB-0A27-4EFB-BA0A-C06CC9A2A436","08/23/2022","Fix url for files with # in the name inconsistent encoding"),Kn=wn.e.isActivated("891196BA-98FA-4623-ABD1-371612730330","10/10/2022","fix oneNote results and suggestions url"),Wn=function(){function e(e,t,n,a){var i=this;this._getSearchDataSource=function(){return Object(o.__awaiter)(i,void 0,void 0,function(){var e;return Object(o.__generator)(this,function(t){switch(t.label){case 0:return e=this._resources,Object(rn.Jr)(rn.Mr)?[4,e.consumeAsync(jn.e.optional)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,e.consumeAsync(l.J)]}})})},this._resources=e,this._id=t,this._getScope=n,this.rx=a}return e.prototype.getId=function(){return this._id},e.prototype.createStream=function(e){var t=this,n=1===e.length?"":e;return this.rx.Observable.fromPromise(this._updateDelayedQuery(n)).selectMany(function(e){return t.rx.Observable.fromArray(e)}).select(function(n){return t.transform(n,e)})},e.prototype._getSuggestionResultPromise=function(e){var t=this,n=e+"*",a=new D.e({name:this._id});return M.n.wrap(this._getSearchDataSource()).then(function(e){var i,r=null===(i=t._getScope())||void 0===i?void 0:i.id;return e.getItems(n,void 0,r).then(function(e){return a.end({resultType:I.e.Success}),e.containers[0]&&e.containers[0].results||void 0}).catch(function(e){throw a.end({resultType:I.e.Failure,error:e.message}),e})})},e.prototype._updateDelayedQuery=function(e){var t=this;return this._ensureDelayQos(),zn.delayTimeoutState.delayTimeoutId&&zn.delayTimeoutState.rejectQuery&&this._rejectPreviousSuggestion(),new M.n(function(n,a){zn.delayTimeoutState.delayTimeoutId=Vn.setTimeout(function(){t._resolveSuggestion(n,e)},400),zn.delayTimeoutState.rejectQuery=a})},e.prototype.transform=function(e,t){var n,a,i=Xe.format(Bn.b,e.lastModifiedBy,Object(Nn.n)(e.lastModifiedDate,Qe.t.language));if(e.rawTitleText)n=e.rawTitleText;else{var r=document.createElement("textarea");r.innerHTML=e.titleText,n=r.value}a=Kn?e.fileExtension||-1!==n.lastIndexOf(".")?n.substring(n.lastIndexOf(".")+1):"":e.fileExtension||(-1!==n.lastIndexOf(".")?n.substring(n.lastIndexOf(".")+1):"");var o=this._highlight(n,t);return i=this._highlight(i,t),{id:e.url,searchText:t,displayText:o,secondaryDisplayText:i,title:o,icon:e.iconUrl,iconUrl:e.iconUrl,lastModifiedBy:e.lastModifiedBy,lastModifiedTime:e.lastModifiedDate.toISOString(),url:this._fixUrl(e,n,a),fileExtension:a,fileType:this._getFileType(a,e.isContainer),sPWebUrl:e.siteUrl}},e.prototype._getFileType=function(e,t){return t&&(Kn||"one"!==e)?"folder":"file"},e.prototype._highlight=function(e,t){var n=new RegExp(t,"i");return e.replace(n,"<mark>$&</mark>")},e.prototype._fixUrl=function(e,t,n){var a=e.url,i=e.parentUrl?decodeURI(e.parentUrl):"";if(Gn){i=i&&i.replace("/Forms/AllItems.aspx","");var r=e.isContainer&&a.indexOf(t)<0&&-1===a.toLowerCase().indexOf("docsethome.aspx");(i&&n&&a.indexOf("/Forms/DispForm.aspx?ID=")>=0||r)&&(a="".concat(i,"/").concat(t))}else i=i&&Object(Hn.e)(i),a=Object(Hn.t)({filename:t,isContainer:e.isContainer,parentLink:i,path:a,fileExtension:n});return"loop"===n&&i&&(a="".concat(i,"/").concat(t,"?web=1")),a},e.prototype._ensureDelayQos=function(){zn.delayQos.qosEvent||(zn.delayQos.qosEvent=new D.e({name:"SuiteNavSearchBox.SearchDataSourceSuggestionProvider.delayed"}),zn.delayQos.numberOfCanceledQueries=0)},e.prototype._endDelayQos=function(e){var t;null===(t=zn.delayQos.qosEvent)||void 0===t||t.end({resultType:I.e.Success,extraData:{delayTimeInMs:400,numberOfCanceledQueries:zn.delayQos.numberOfCanceledQueries,characterCount:e}}),zn.delayQos={}},e.prototype._updateDelayQosCanceledQueries=function(){void 0!==zn.delayQos.numberOfCanceledQueries&&zn.delayQos.numberOfCanceledQueries++},e.prototype._rejectPreviousSuggestion=function(){Vn.clearTimeout(zn.delayTimeoutState.delayTimeoutId),zn.delayTimeoutState.rejectQuery(),this._updateDelayQosCanceledQueries(),zn.delayTimeoutState={}},e.prototype._resolveSuggestion=function(e,t){zn.delayTimeoutState={},this._endDelayQos(t.length),e(this._getSuggestionResultPromise(t))},e}();function qn(e,t){var n="SuiteNavSearchBox.ListItemSuggestionProvider";return{id:"listItemSuggestions",groupUpdaters:[{groupId:"file",createUpdater:Qn(e,n,t)},{groupId:"app",createUpdater:Qn(e,n,t)}]}}function Qn(e,t,n){return function(a,i){var r,o,s=Object(rn.Jr)(rn.M)||1===Object(tn.n)(90097,e.consume(c.f))?Wn.bind(null,e,t,n):Wn.bind(null,e,t,function(){});if(s.__parameters=[{index:0,name:"rxjs"}],B.t.isActivated("6fc4458a-0a18-4bb4-af1d-320fcce353e1","09/14/2020","Remove suggestions for site/hub/org scopes in SPO"))o=[s];else switch(null===(r=n())||void 0===r?void 0:r.id){case"spSiteSite":case"spSiteHub":case"spHubHub":case"spHubSite":case"org":o=[];break;default:o=[s]}return{providers:function(e){return o},heading:function(e){return Fn.f},ariaLabel:function(e){return Fn.f}}}}var Yn,Jn=B.t.isActivated("896cc49f-3f66-43b6-81d0-421a993d05d7","07/18/2022","get correct viewParamsBeforeSearch on submitting metadata search"),Xn=B.t.isActivated("b1812d22-1203-45a8-a32f-ff57c234ade3","08/04/2022","avoid mutating view params when clearing query param, make a copy instead"),Zn=function(){function e(e,t){this._deps=t,this._resources=t.resources,Object(_n.e)(this._deps.pageContext)&&(this._metadataSearchDataSource=this._resources.consume(en.e))}return e.prototype.getSuiteNavProviderKey=function(){return p.y},e.prototype.getTokenProviders=function(){return this._deps.searchBoxConfig.getTokenProviders()},e.prototype.getProviderConfigUpdaters=function(e,t){var n,a,i,r=this;return Object(_n.e)(this._deps.pageContext)&&(null===(n=this._metadataSearchDataSource)||void 0===n?void 0:n.isMetadataSearchMode)?[mn(this._resources,this._deps.pageContext,this._deps.urlDataSourceLite.getDefaultRootItemId(),(null===(a=this._deps.bootOptions)||void 0===a?void 0:a.chromeless)?null===(i=this._deps.bootOptions)||void 0===i?void 0:i.metadataSearchForm:void 0,t,function(){return r._submitMetadataSearchCallback(t)})]:(Object(rn.Jr)(rn.M)||1===Object(tn.n)(90097,this._deps.pageContext))&&e?[qn(this._resources,e),Mn(this._deps)]:[qn(this._resources,function(){}),Mn(this._deps)]},e.prototype.onSubmitSearchCallback=function(e,t,n,a){var i;B.t.isActivated("23ac5524-b1db-40a7-8049-18a7bd7ca57f","08/26/2022","log elapsed time from executing search to rendering results")||this._deps.instrumentationProvider.logStartSearchOnSubmit();var r,s,c=this._deps.pageContext.listItemCount,d=B.t.isActivated("89825f27-33e9-4ffd-aa68-b2b360b6c8dc","07/13/2022","use isPrimedLibrary passed from search box provider")?Object(on.e)(this._deps.listContext):this._isPrimedLibrary,l=Object(_n.e)(this._deps.pageContext);if(l&&(r=this._metadataSearchDataSource.getContentTypesCount(t(),!0)),this._isMetadataSearch())this._submitMetadataSearchCallback(t);else if(e){if(this._closeInfoPanel(),this._deps.engagement.logData({name:"InPage.Search.Click",isIntentional:!0,extraData:{listItemCount:c,isSyntexEnabled:d,contentTypesCount:r,isMetadataSearchEnabled:l}}),n&&("spSiteSite"===(s=n.id)||"spSiteHub"===s||"spHubHub"===s||"spHubSite"===s||"org"===s))return void function(e,t,n,a,i){switch(t.id){case"spSiteSite":case"spHubSite":case"spHubHub":var r="spHubHub"===t.id?"hub":"site";return n.getSiteSearchUpscopeUrl(e,r).then(function(e){Object(hn.e)(e,a,i)});case"spSiteHub":return n.getHubSearchUpscopeUrl(e,"hub").then(function(e){Object(hn.e)(e,a,i)});case"org":return n.getTenantUpscopeUrl(e).then(function(e){Object(hn.e)(e,a,i)});default:throw new Error("Unsupported scope ".concat(t.id))}}(e,n,this._deps.searchUpscopeDataSource,this._deps.navigation,a);var u=((i={})[Ie.n.queryTypeParamKey]=ie.e.Search,i[Ie.n.queryParamKey]=e,i);if(n){var f=this._deps.urlDataSourceLite.getKey(Object(o.__assign)({},t())),p=this._getSearchItemId(n.id,f);p&&(u[Ie.n.idParamKey]=p)}this._deps.navigation.updateViewParams(u),Sn()}else Object(gn.e)(this._deps.navigation)},e.prototype.onExitSearchCallback=function(e){!Jn&&this._isMetadataSearch()?Object(gn.e)(this._deps.navigation,this._viewParamsBeforeMetadataSearch):Object(gn.e)(this._deps.navigation,e),_n.e&&this._metadataSearchDataSource&&(this._metadataSearchDataSource.isMetadataSearchMode=!1)},e.prototype.isSearchResultsPage=function(){return Object(vn.e)(this._deps.urlDataSourceLite.getQueryType(this._deps.navigation.viewParams))},e.prototype.setIsPrimedLibrary=function(e){this._isPrimedLibrary=e},e.prototype._closeInfoPanel=function(){if(!B.t.isActivated("47752bad-5b7b-4604-b48f-8285858491cc","08/01/2022","close info panel before search")){var e=this._resources.consume(nn.resourceKey.optional);e&&e()&&e(!1)}},e.prototype._isMetadataSearch=function(){var e,t,n,a,i;return Object(_n.e)(this._deps.pageContext)&&(null===(e=this._metadataSearchDataSource)||void 0===e?void 0:e.isMetadataSearchMode)&&(!!(null===(n=null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.queryKQL)||void 0===n?void 0:n.kql)||!!(null===(i=null===(a=this._metadataSearchDataSource)||void 0===a?void 0:a.queryKQL)||void 0===i?void 0:i.query))},e.prototype._submitMetadataSearchCallback=function(e){var t;this._closeInfoPanel(),this.isSearchResultsPage()||(this._viewParamsBeforeMetadataSearch=null==e?void 0:e());var n=this._deps.urlDataSourceLite.getCurrentItemKey(),a=!this._deps.itemUrlHelper.getItemUrlParts(n).serverRelativeItemUrl,i="".concat(this._deps.urlDataSourceLite.getSearchItemId(n))||"",r=null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.getSearchQueryParams(i,a);if(this._logMetadataSearchFieldsEngagement(this._deps.navigation.viewParams),Xn)delete this._deps.navigation.viewParams[Ie.n.queryParamKey],this._deps.navigation.updateViewParams(r);else{var s=this._deps.navigation.viewParams,c=Ie.n.queryParamKey,d=(s[c],Object(o.__rest)(s,["symbol"==typeof c?c:c+""]));this._deps.navigation.updateViewParams(Object(o.__assign)(Object(o.__assign)({},d),r),{clearOtherParams:!0})}Sn()},e.prototype._getSearchItemId=function(e,t){var n=this._deps.itemUrlHelper.getItemUrlParts(t);switch(e){case"spListFolder":case"spDocLibFolder":return;case"spDocLib":case"spList":return n.serverRelativeListUrl;default:throw new Error('Invalid SearchBoxScope: "'.concat(e,'"'))}},e.prototype._logMetadataSearchFieldsEngagement=function(e){var t;this._deps.engagement.logData({name:"MetadataSearch.Search.Click",isIntentional:!0,extraData:null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.getSearchEnagementLogExtraData(e,this._isPrimedLibrary)})},e.dependencies={resources:P.r,navigation:he.e,engagement:F.e,searchBoxConfig:Un.e,listContext:c.o,pageContext:c.f,itemUrlHelper:W.c,urlDataSourceLite:l.fe,searchUpscopeDataSource:bn,bootOptions:an.e.optional,instrumentationProvider:p.r},e}(),$n=Object(T.r)("SPListSearchBoxDataSource",Zn),ea=n(5090),ta=n(1211),na=n(4839),aa=function(){function e(e,t){this._deps=t}return e.prototype.getInitialScope=function(){var e,t,n=this._deps.navigation.viewParams,a=this._deps.urlDataSourceLite.getKey(Object(o.__assign)({},n)),i=this._deps.itemUrlHelper.getItemUrlParts(a);return B.t.isActivated("f16521d4-c64b-4d9b-b82c-852401fed6ae","1/27/2021","Use INavLink targetLink to identify doclib")?(e=i.serverRelativeItemUrl===i.serverRelativeListUrl,t=Object(Z.a)(this._deps.pageContext.listBaseType)):(e=!i.listRelativeItemUrl,t=this._deps.onePageContext.targetLink?this._deps.onePageContext.targetLink.isDocLib:Object(Z.a)(this._deps.pageContext.listBaseType)),t?e?na.t:na.e:e?na.i:na.a},e.prototype.getAvailableScopes=function(){return B.t.isActivated("318eed5c-1325-48a3-8743-35c69f2daf95","10/07/2021","Remove whole org scope option from scoping control when user is guest")?Object(na.n)(this.getInitialScope().id,!!this._deps.pageContext.isHubSite,!!this._deps.pageContext.hubSiteId,this._deps.pageContext.searchScope,Number(this._deps.pageContext.webTemplate)===O.t.mySite||Object(ta.r)(this._deps.pageContext),!1):Object(na.n)(this.getInitialScope().id,!!this._deps.pageContext.isHubSite,!!this._deps.pageContext.hubSiteId,this._deps.pageContext.searchScope,Number(this._deps.pageContext.webTemplate)===O.t.mySite||Object(ta.r)(this._deps.pageContext),this._deps.pageContext.isAnonymousGuestUser||this._deps.pageContext.isExternalGuestUser)},e.prototype.setActiveScope=function(e){this._activeScope=e},e.prototype.getActiveScope=function(){return this._activeScope},e.prototype.isScopingControlEnabled=function(){return Object(rn.Jr)(rn.M)||1===Object(tn.n)(90097,this._deps.pageContext)},e.prototype.getScopeControlScenario=function(e,t){if(t)return"SPO.List.Search";switch(e){case na.a:return"SPO.List.Folder";case na.i:return"SPO.List.Root";case na.e:return"SPO.DocLib.Folder";case na.t:return"SPO.DocLib.Root";default:throw new Error('Unsupported scope: "'.concat(e.id,'"'))}},e.dependencies={navigation:he.e,pageContext:c.f,itemUrlHelper:W.c,urlDataSourceLite:l.fe,onePageContext:c.u},e}(),ia=Object(T.r)("SPListScopingControlDataSource",aa),ra=n(4231),oa=n(42),sa=function(){function e(e,t){this._searchUpscopeDataSource=t.searchUpscopeDataSource,this._pageContext=t.pageContext,this._navigation=t.navigation}return e.prototype.getUpscopeUrl=function(){var e,t=Number(this._pageContext.webTemplate)===O.e.mySite,n=this.getSearchText(),a=this._pageContext.searchScope;return t||Object(ta.r)(this._pageContext)||a===g.i.Tenant?this._searchUpscopeDataSource.getTenantUpscopeUrl(n):(e=this._pageContext.hubSiteId&&a!==g.i.Site&&this._pageContext.isHubSite?"hub":"site",this._searchUpscopeDataSource.getSiteSearchUpscopeUrl(n,e))},e.prototype.getSearchText=function(){return Object(oa.h)(this._navigation.viewParams)||""},e.prototype.getLabel=function(){return this._searchUpscopeDataSource.getLabel()},e.prototype.getAriaLabel=function(){return this._searchUpscopeDataSource.getAriaLabel()},e.prototype.getListTemplate=function(){return this._pageContext.listBaseTemplate},e.dependencies={searchUpscopeDataSource:bn,pageContext:c.f,navigation:he.e},e}(),ca=Object(T.r)("SearchUpscopeProvider",sa),da=n(1945),la=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._dataRequestor=new(a.child(q.t))({qosName:"SPOSearchUpscopeDataSource"}),a._pageContext=n.pageContext,a._sharepointUrl=n.sharepointUrl,a}return Object(o.__extends)(t,e),t.prototype.getSiteSearchUpscopeUrl=function(e,t){var n=this,a=this._pageContext.webAbsoluteUrl;return this._getUpscopeUrl(a).then(function(i){return i&&n._urlIsValidSearchResultsPage(i)?n._buildSearchUrl(i,e,t):n._getDefaultUrl(a,e,t)}).catch(function(){return n._getDefaultUrl(a,e,t)})},t.prototype.getHubSearchUpscopeUrl=function(e,t){var n=this;return this._getHubUrl().then(function(a){return n._getUpscopeUrl(a).then(function(i){return i&&n._urlIsValidSearchResultsPage(i)?n._buildSearchUrl(i,e,t):n._getDefaultUrl(a,e,t)})})},t.prototype.getTenantUpscopeUrl=function(e){var t=new Bt.e(this._getSharePointUrl()).authority;return Promise.resolve("".concat(t,"/").concat(this._pageContext.layoutsUrl,"/search.aspx?q=").concat(e))},t.prototype.getLabel=function(){return da.o},t.prototype.getAriaLabel=function(){return"".concat(da.o," ").concat(da.s)},t.prototype._getUpscopeUrl=function(e){var t=e+"/_api/search/resultspageaddress";return this._dataRequestor.getData({url:t,qosName:"SearchUpscopeDataSource.ResultsPageAddress",method:"GET",parseResponse:function(e){var t=e?JSON.parse(e):void 0;return t&&t.d&&t.d.resultspageaddress}})},t.prototype._getHubUrl=function(){if(this._pageContext.webAbsoluteUrl&&this._pageContext.hubSiteId){var e="".concat(this._pageContext.webAbsoluteUrl,"/_api/HubSites/GetById?hubSiteId='").concat(this._pageContext.hubSiteId,"'");return this._dataRequestor.getData({url:e,qosName:"SearchUpscopeDataSource.ResultsHubUrl",method:"GET",parseResponse:function(e){var t=e?JSON.parse(e):void 0;return t&&t.d&&t.d.SiteUrl}})}return Promise.reject(new Error("webAbsoluteUrl or hubSiteId is empty"))},t.prototype._buildSearchUrl=function(e,t,n){var a=new x.t(e);return a.setQueryParameter("q",t),a.setQueryParameter("k",t),a.setQueryParameter("scope",n),a.toString()},t.prototype._urlIsValidSearchResultsPage=function(e){if(!new Bt.e(e).authority)return!0;try{return new URL(e).hostname===new URL(this._pageContext.siteAbsoluteUrl).hostname}catch(e){return!1}},t.prototype._getDefaultUrl=function(e,t,n){var a=new x.t("".concat(e,"/_layouts/15/search.aspx/siteall"));return a.setQueryParameter("q",t),a.setQueryParameter("scope",n),a.toString()},t.prototype._getSharePointUrl=function(){return Number(this._pageContext.webTemplate)===O.t.mySite&&this._sharepointUrl?this._sharepointUrl.get():Object(g.c)(this._pageContext)},t.dependencies=Object(o.__assign)(Object(o.__assign)({},b.default.dependencies),{pageContext:c.f,sharepointUrl:Zt.t.optional}),t}(b.default),ua=Object(T.r)("SPOSearchUpscopeDataSource",la),fa=n(1),pa=n(89),ma=n(121),_a=n(41),ha=n(118),ba=n(3268),ga=n(52),va=n(390),ya=n(840),Sa=n(1094),Da=n(4840),Ia=function(){function e(e,t){this._isMetadataSearchMode=!1,this._deps=t,this._itemCacheStore=t.itemCacheStore,this._itemsScopeItemKey=t.itemsScopeItemKey,this._contentTypes=[],this._queryableFields=[],this._defaultFields=[],Object(rn.Jr)(rn.x)&&(this._defaultFields=Object(ba.n)(),this._cacheType="LocalStorage"),this._areExclusionQueriesSupported=Object(rn.Jr)(rn.P),this._isStronglyTypedFieldsSupported=Object(rn.Jr)(rn.P)&&this._deps.pageContext.isSearchQueryServedBySubstrate}return Object.defineProperty(e.prototype,"queryKQL",{get:function(){return this._queryKQL},set:function(e){this._queryKQL=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMetadataSearchMode",{get:function(){return this._isMetadataSearchMode},set:function(e){this._isMetadataSearchMode=e,e?this._startQoS():this._endQoS("Close")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isList",{get:function(){return this._isList},set:function(e){this._isList=e,this._defaultFields=Object(ba.n)(this._isList)},enumerable:!1,configurable:!0}),e.prototype.getDefaultFields=function(){return Object(ba.n)(this._isList)},e.prototype.getContentTypes=function(e){return this._setContentTypes(e),this._contentTypes},e.prototype.getContentTypesCount=function(e,t){t&&this._setContentTypes(e);var n=this._contentTypes.filter(function(e,t){var n=0===t;return!Object(ba.a)(e.contentTypeId,n)});return n.length?n.length+1:1},e.prototype.getSearchQueryParams=function(e,t){var n,a=((n={})[Ie.n.queryTypeParamKey]=ie.e.Search,n);if(t||(a[Ie.n.idParamKey]=e),this._queryKQL.query&&(a[Ie.n.queryParamKey]=this._queryKQL.query),this._queryKQL.kql||this._queryKQL.query){var i=this._generateID();sessionStorage.setItem(i,JSON.stringify(this._queryKQL)),a[Ie.n.metadataSearchIdKey]=i}return this._endQoS("Search"),a},e.prototype.getSearchEnagementLogExtraData=function(e,t){var n=!!e[Ie.n.useFiltersInViewXmlKey]&&!!e.FilterFields1,a=B.t.isActivated("89825f27-33e9-4ffd-aa68-b2b360b6c8dc","07/13/2022","use isPrimedLibrary passed from search box provider")?Object(on.e)(this._deps.listContext):t,i=this.getContentTypesCount(e);return Object(o.__assign)({isFilterView:n,listItemCount:this._deps.pageContext.listItemCount,isSyntexEnabled:a,contentTypesCount:i,queryLength:this._getQueryLength(),queryableFieldsCount:this._queryableFields.length},this._getSearchFieldsUsageData())},e.prototype.getMetadataStoredSession=function(e){return Object(Da.e)(e)},e.prototype.isMetadataSearchResultPage=function(e){return this._isSearchResultsPage(e)&&!!Object(oa.m)(e)},e.prototype.getAdditionalSearchFields=function(e){return this._getCustomColumnsInView(this._defaultFields.length,e)},e.prototype.getLastCachedQueryableFields=function(e){var t=sessionStorage.getItem(e);if(this._queryableFields=[],t){var n=JSON.parse(t);this._queryableFields=n}return this._queryableFields},e.prototype.getSiteColumns=function(){return Object(o.__awaiter)(this,void 0,M.e,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(477).then(n.bind(null,6014))];case 1:return[4,new(0,e.sent().QueryableFieldsFetchHelper)({pageContext:this._deps.pageContext,storageType:this._cacheType}).getSiteColumns(this._deps.pageContext.siteId,this._deps.pageContext.webId)];case 2:return[2,e.sent()]}})})},e.prototype.isStronglyTypedFieldsSupported=function(){return this._isStronglyTypedFieldsSupported},e.prototype.areExclusionQueriesSupported=function(){return this._areExclusionQueriesSupported},e.prototype._isSearchResultsPage=function(e){return Object(vn.e)(Object(Sa.e)(e))},e.prototype._getQueryLength=function(){var e=0;return this._queryKQL.query&&(e+=this._queryKQL.query.length),this._queryKQL.kql&&(e>0&&(e+=1),e+=this._queryKQL.kql.length),e},e.prototype._getSearchFieldsUsageData=function(){var e=this,t=0,n=[],a=0,i=new Map;this._queryKQL.query&&(t++,n.push("Keywords")),this._queryKQL.kqlFields&&this._queryKQL.kqlFields.forEach(function(r){if(r.isSystemField)t++,n.push(e._defaultFields[r.fieldId].kqlProperty);else if(Object(rn.Jr)(rn.x)){a++;var o=e._getCustomFieldType(r);i.has(o)?i.set(o,i.get(o)+1):i.set(o,1)}});var r={systemFieldCount:t,systemFields:n,customFieldCount:a};return i.forEach(function(e,t){r["".concat(ba.e[t],"CustomFieldCount")]=e}),r},e.prototype._getCustomFieldType=function(e){for(var t,n=0,a=this._queryableFields;n<a.length;n++){var i=a[n];if(i.fieldId===e.fieldId){t=i.fieldType;break}}return t},e.prototype._getCustomColumnsInView=function(e,t){return Object(o.__awaiter)(this,void 0,M.e,function(){var a,i,r,s,c,d,l,u,f,p=this;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return[4,this.getSiteColumns()];case 1:return a=o.sent(),this._queryableFields=[],a&&Object.keys(a).length>0?[4,n.e(476).then(n.bind(null,5705))]:[3,3];case 2:i=o.sent(),r=i.cacheLastQueryableFieldsToSessionStorage,s=i.getCustomChoiceFieldOption,c=i.getCustomFieldType,d=i.getCustomFieldManagedPropertyName,l=i.isSiteSystemField,u=[],f=e,this._deps.listContext.rawListSchema.Field.forEach(function(e){if(e.ID in a&&!l(e.Name)){var t=a[e.ID],n=e.FieldType,i=c(n,t,e.Unit);if(void 0!==i){var r=p._areExclusionQueriesSupported?d(t.name,n,p._isStronglyTypedFieldsSupported):'"'.concat(d(t.name,n,p._isStronglyTypedFieldsSupported),'"'),o={displayName:e.DisplayName,fieldType:i,isSystemField:!1,kqlProperty:r,fieldId:f++};i===ba.e.Dropdown&&(o.choices=s(e.Choices)),i===ba.e.ManagedMetadata&&(o.termSuggestionParams={lcid:p._deps.pageContext.currentLanguage||1033,sspList:e.SspId,termSetList:e.TermSetId,anchorId:e.AnchorId}),u.push(o)}}}),r(u,t),this._queryableFields=u,o.label=3;case 3:return[2,this._queryableFields]}})})},e.prototype._generateID=function(){return"metadataSearch-".concat(ga.e.generate())},e.prototype._startQoS=function(){this._metadataSearchCurrentQosEvent&&this._metadataSearchCurrentQosEvent.end({resultType:I.e.Failure}),this._metadataSearchCurrentQosEvent=new D.e({name:"MetadataSearch.Usage"})},e.prototype._endQoS=function(e){this._metadataSearchCurrentQosEvent&&(this._metadataSearchCurrentQosEvent.end({resultType:I.e.Success,resultCode:e}),this._metadataSearchCurrentQosEvent=void 0)},e.prototype._setContentTypes=function(e){var t=this,n=new D.e({name:"MetadataSearch.GetContentTypes"}),a=[];!this._isSearchResultsPage(e)&&this._itemCacheStore&&this._itemsScopeItemKey?a=this._itemCacheStore.dispatch(Object(ha.e)(function(e){var n=Object(_a.e)(e,t._itemsScopeItemKey),a=e.demandItemFacet(pa.e,n)||{},i=a.webAbsoluteUrl,r=void 0===i?void 0:i,o=a.listFullUrl,s=void 0===o?void 0:o,c=r&&s&&ma.e.serialize({webAbsoluteUrl:r,listFullUrl:s});return(e.demandItemFacet(fa.b,c)||[]).map(function(t){return e.demandItemFacet(fa.vn,t)})})):this._deps.contentTypes&&(a=this._deps.contentTypes.peek()),a.length>0?n.end({resultType:I.e.Success}):n.end({resultType:I.e.Failure,resultCode:"NoContentTypes"}),this._contentTypes=a},e.dependencies={pageContext:c.f,listContext:c.o,itemCacheStore:ya.e.optional,itemsScopeItemKey:va.e.optional,contentTypes:c.n.optional},e}(),xa=Object(T.r)("MetadataSearchDataSource",Ia),Ca=new P.t({name:"UserExpirationDataSource.key",loader:new T.t(function(){return n.e(750).then(n.bind(null,5706)).then(function(e){return e.resourceKey})})}),Oa=new P.t({name:"SmartFiltersDataSource.key",loader:new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(882)]).then(n.bind(null,5707)).then(function(e){return e.resourceKey})})}),wa=n(2963),Ea=n(3166),Aa=n(91),La=n(4445),ka={files:Object(La.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(508)]).then(n.bind(null,5840))}),embed:Object(La.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(496)]).then(n.bind(null,5843))}),oneUp:Object(La.e)(function(){return n.e(511).then(n.bind(null,5914))}),share:Object(La.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(516)]).then(n.bind(null,5943))}),restore:Object(La.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(495)]).then(n.bind(null,6015))}),base:Object(La.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(494)]).then(n.bind(null,5697))}),picker:Object(La.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(499)]).then(n.bind(null,5708))}),textEditor:Object(La.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(517)]).then(n.bind(null,5838))}),settings:Object(La.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(514)]).then(n.bind(null,5882))}),mobileUpsell:Object(La.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(510)]).then(n.bind(null,5940))}),error:Object(La.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(497)]).then(n.bind(null,5941))}),mobileUpsellInner:Object(La.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(509)]).then(n.bind(null,5071))}),settingsInner:Object(La.e)(function(){return n.e(513).then(n.bind(null,5891))}),restoreInner:Object(La.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(512)]).then(n.bind(null,5915))}),commands:Object(La.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-datasources"),n.e("deferred.items-view"),n.e("deferred.office-ui-fabric-react"),n.e("deferred.odsp-shared-react"),n.e(877)]).then(n.bind(null,5944))})},Ma=function(){function e(){}return e.prototype.getPageModuleLoader=function(e){if(e===Aa.e.MobileAppUpsell&&Object(N.isFeatureEnabled)(N.EnableMobileWebOfficeAppUpsell))return ka.mobileUpsell;switch(e){case Aa.e.FilePicker:return ka.picker;case Aa.e.Share:return ka.share;case Aa.e.Restore:return ka.restore;case Aa.e.Error:return ka.base;case Aa.e.Settings:return ka.settings;case Aa.e.TextFileEditor:return ka.textEditor;case Aa.e.Embed:return ka.embed;case Aa.e.OneUp:return ka.oneUp;default:return ka.files}},e.prototype.getInnerPageModuleLoader=function(e){switch(e){case Aa.e.MobileAppUpsell:return ka.mobileUpsellInner;case Aa.e.Settings:return ka.settingsInner;case Aa.e.Restore:return ka.restoreInner;case Aa.e.Error:default:return ka.error}},e.prototype.getCommandSetModuleLoader=function(){return ka.commands},e}(),Pa=new P.t({name:"ModuleLoaderDataSource",factory:new T.i(Ma)}),Ta=n(3860),Ua=n(4832),Fa=n(4218),Ha=n(4453),Ra=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.canSaveAsCopy=function(e){var t=e.item;return!!t&&C.e.hasItemPermission(t,C.e.insertListItems)},t.prototype.canSaveAsOriginal=function(e){var t=e.item;return!!t&&this.isWebFormat(t)&&C.e.hasItemPermission(t,C.e.insertListItems)&&C.e.hasItemPermission(t,C.e.editListItems)},t.dependencies={},t}(function(){function e(){}return e.prototype.canSave=function(e){return this.canSaveAsCopy(e)||this.canSaveAsOriginal(e)},e.prototype.isWebFormat=function(e){var t,n=null===(t=null==e?void 0:e.extension)||void 0===t?void 0:t.toLowerCase();return n&&(".png"===n||".jpeg"===n||".jpg"===n)},e}()),Na=Object(T.r)("ImageEditorDataSource",Ra),Ba=n(4841),ja=(n(1861),n(358)),Va=n(4829),za=n(4830),Ga=n(4833),Ka=n(3430),Wa=n(4834),qa=n(4164),Qa=n(4446),Ya=n(3102),Ja=n(2537),Xa=n(3162),Za=n(1333),$a=n(1428),ei=n(3340),ti=n(134),ni=n(4809),ai=n(656),ii=n(3264),ri=void 0,oi=void 0,si=new P.t({name:"".concat("OneUpOnePlayerFlightResourceKeys",".isOnePlayerEnabled"),factory:{dependencies:{pageContext:c.f.optional},create:function(e){var t=function(e,t){if(!e)return[!1,void 0];var n=Object(ai.e)(e);if(Object(ai.i)(n)||Object(ai.n)(n))return[!1,void 0];var a=Object(N.isFeatureEnabled)(N.EnableOnePlayerForGovCloud)||Object(N.isFeatureEnabled)(N.EnableOnePlayerForGovCloudForEmbedMicroservice);if(Object(ai.r)(n)&&!a)return[!1,void 0];var i=Object(N.isFeatureEnabled)(N.UseOnePlayer),r={experimentId:"number"==typeof N.UseOnePlayer.ODB?N.UseOnePlayer.ODB:1995,variant:i?1:0,isAATest:!1,isOverride:ti.n.isFeatureEnabled(N.UseOnePlayer),correlationId:e?e.CorrelationId:"",cloudType:e?String(e.cloudType):""},o=i?r:void 0,s=i;return void 0!==o&&void 0!==o.variant?[s,o=function(e,t){var n=ni.e();return void 0===e.variant||t&&JSON.stringify(t)===JSON.stringify(e)||(ni.t(n,e),t=e),t}(o,t)]:[s,void 0]}(e.pageContext,ri),n=t[0],a=t[1];return ri=a,{instance:n}}}}),ci=new P.t({name:"".concat("OneUpOnePlayerFlightResourceKeys",".isOnePlayerVroomTranscriptsEnabled"),factory:{dependencies:{pageContext:c.f.optional},create:function(e){var t=e.pageContext;return{instance:function(){var e=Object(ii.e)(N.OnePlayerGetTranscriptsFromVroom,90028,N.OnePlayerGetTranscriptsFromVroomGovClouds,t,oi),n=e[0],a=e[1];return oi=a,n}}}}}),di=n(4433),li=new P.t({name:"".concat("EnableNewOneUpCommandBarResourceKey",".enableNewOneUpCommandBarResourceKey"),factory:{dependencies:{pageContext:c.f.optional},create:function(e){var t=e.pageContext;if(!wn.e.isActivated("5902b772-cd42-40fa-80cf-a77f494d5df6","06/18/2021","Disable OneUp new command bar")){if(Object(N.isFeatureEnabled)(N.EnableNewOneUpCommandBar))return{instance:!0};if(t)return{instance:1===Object(tn.n)(90086,t)}}return{instance:!1}}}}),ui=n(4432),fi=new P.t({name:"".concat("EnableDarkThemeForOneUpMediaResourceKey",".enableDarkThemeForOneUpMedia"),factory:{dependencies:{pageContext:c.f.optional},create:function(e){var t=e.pageContext;if(!wn.e.isActivated("d30193ae-159f-40d8-af45-38df4cecd4ec","06/14/2021","Disable dark theme in light mode for OneUp media.")){if(Object(N.isFeatureEnabled)(N.EnableDarkThemeForOneUpMediaViewer))return{instance:!0};if(t)return{instance:1===Object(tn.n)(90091,t)}}return{instance:!1}}}}),pi=n(60),mi=n(451),_i=n(15),hi=n(186),bi=n(1013),gi=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=n.itemCacheStore.dispatch,r=n.itemCacheObservablesFactory.pureCompute(function(e){return!!e.demandItemFacet(bi.e,_i.c)});return a.isExpanded=a.observables.compute({read:function(){return r()},write:function(e){var t;i(Object(hi.e)({items:(t={},t[_i.c]=Object(o.__assign)({},bi.e.pack(e)),t)})),i(Object(mi.e)())},pure:!0}),a}return Object(o.__extends)(t,e),t}(b.default),vi=(Yn=Object(T.o)("isReactLeftNavExpandedHelper",gi,{itemCacheObservablesFactory:le.e,itemCacheStore:ya.e}),new P.t({name:"isReactLeftNavExpanded.key",factory:{dependencies:{isReactLeftNavExpandedType:Yn},create:function(e){var t=new e.isReactLeftNavExpandedType({});return{instance:t.isExpanded,disposable:t}}}}));function yi(e){return e.resourceKey}var Si=function(){function e(){}return e.prototype.exposeResources=function(e){var t=this,a=e.resourceScope,i=e.pageContext,r=e.navigation,o=e.viewParams,s=new ja.e,m=s.attach(new(a.consume(b.observablesFactoryTypeResourceKey)));this._pageContext=i,this._navigation=r,this._shouldAddGroupsFeatures()&&(new je).synchronousInitialize(e);var _=function(e,t){a.exposeAsync(e,new T.t(function(){return t().then(yi)}))};a.expose(Kt.e,i.CorrelationId),_(l.e,function(){return n.e(586).then(n.bind(null,5674))}),_(l.Z,function(){return n.e(482).then(n.bind(null,5675))}),_(l.M,function(){return n.e(462).then(n.bind(null,5676))}),_(l.Ce,function(){return n.e(489).then(n.bind(null,5996))}),this._urlDataSource=a.expose(l.ue,new(a.injected(De.e))),a.exposeFactory(Re.e,new T.e(Di)),a.exposeFactory(Xa.e,new T.e(Di)),a.expose(Se.e,new(a.injected(It))),a.expose(d.h,m.create(!1)),a.exposeFactory(l.ne,new T.e(Ve.e)),a.expose(u.e,new xt.e),a.expose(Nt.e,i.allowInfectedDownload),a.expose(d.C,m.create(!1)),a.expose(Fa.e,i.m365GroupsBlockDownloadsExperienceEnabled),Object(N.isFeatureEnabled)(N.MoveTransitionResourcesToKOResourceScope)||(a.expose(Zt.e,new $a.e(!1)),a.expose(Zt.t,new $a.e("")),a.expose(c.o,new(a.injected(xe.e))({listId:i.listId||this._navigation.viewParams[Ie.n.listIdKey],listRootFolderServerRelativeUrl:i.listUrl||this._navigation.viewParams[Ie.n.listUrlKey]}))),a.exposeFactory(l.v,new T.e(Xt.e)),a.exposeFactory(l.T,new T.e(Xt.e)),a.exposeFactory(l.s,new T.e(Xt.e)),a.exposeFactory(wa.e,new T.e(Oa)),a.exposeFactory(l.H,new T.e(rt.t)),a.exposeFactory(ye.n,new T.e(ot)),a.exposeFactory(Ha.e,new T.e(Na)),a.expose(d.e,new Ce.e),a.expose(l.f,new(a.injected(Ke))),a.exposeFactory(p.p,new T.e(qe)),a.exposeFactory(l.G,new T.e(We)),a.exposeFactory(l.U,new T.e(Je)),a.expose(l.l,new nt),a.expose(l.g,new(a.injected(tt))),a.exposeFactory(l.be,new T.e(at)),a.exposeFactory(l.E,new T.e(it.e)),_(l.ie,function(){return n.e(748).then(n.bind(null,4371))}),_(l.h,function(){return n.e(581).then(n.bind(null,5677))}),_(l.oe,function(){return n.e(483).then(n.bind(null,5678))}),a.exposeFactory(l.A,new T.e(Dt)),a.expose(d.v,m.create(!1)),a.expose(c.n,m.createArray()),a.expose(l.x,new jt(i)),a.exposeFactory(l.C,new T.e(Vt)),a.exposeFactory(l.O,new T.e(zt)),a.exposeFactory(l.L,new T.e(Gt)),a.expose(d.x,m.create(!1)),a.expose(c.l,m.create(null)),a.expose(c.p,{useEnableDynamicGroups:null!==i.groupId,setPathOnViewChange:!0}),Object(N.isFeatureEnabled)(N.MoveTransitionResourcesToKOResourceScope)||(a.exposeFactory(ea.e,new T.e(ia)),a.exposeFactory(l.J,new T.e(Rt)),a.exposeFactory($t.e,new T.e($n)),a.exposeFactory(bn,new T.e(ua)),a.exposeFactory(ra.e,new T.e(ca)),Object(_n.e)(this._pageContext)&&a.exposeFactory(en.e,new T.e(xa))),m.compute(function(){t._urlDataSource.getQueryType(o())!==ie.e.Search?a.consume(c.c).delete(st.e.Search):a.consume(c.c).set(st.e.Search,"isOn",!0)}),_(l.o,function(){return n.e(455).then(n.bind(null,5997))}),a.expose(p.t,new(a.resolved(kt))({})),_(l.ge,function(){return n.e(453).then(n.bind(null,5679))}),a.exposeAsync(l.a,new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(484)]).then(n.bind(null,5041)).then(function(e){return e.typeResourceKey})})),a.exposeAsync(Ba.e,new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(749)]).then(n.bind(null,5680)).then(yi)})),a.exposeFactory(wt.e,new T.e(Et.e)),_(l.p,function(){return Promise.resolve().then(n.bind(null,5681))}),_(l.z,function(){return n.e(479).then(n.bind(null,5682))}),_(l.t,function(){return n.e(452).then(n.bind(null,5683))}),_(ye.t,function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(139)]).then(n.bind(null,5684))}),_(l.y,function(){return n.e(741).then(n.bind(null,5685))}),Object(N.isFeatureEnabled)(N.EnablePushChannel)&&!Object(N.isFeatureEnabled)(N.UseItemsScopeInTeamSites)&&(a.exposeFactory(l.K,new T.e(Ct)),a.exposeFactory(l.w,new T.e(At)),a.consumeAsync(Object(N.isFeatureEnabled)(N.EnablePushChannelAutoRefresh)?Lt:Ot.e)),a.expose(p._,null),a.exposeFactory(l.q,new T.e(Wt)),a.exposeFactory(l.Q,new T.e(qt)),a.exposeFactory(l.De,new T.e(Tt)),a.exposeFactory(l.xe,new T.e(Ut)),a.exposeFactory(l.ve,new T.e(Ft.e)),a.exposeFactory(l.V,new T.e(Ht.e)),_(l.Ie,function(){return n.e(487).then(n.bind(null,5686))}),a.exposeFactory(l.N,new T.e(Qt)),a.exposeFactory(p.s,new T.e(Yt)),this._pageContext.isSiteAdmin&&a.exposeFactory(l.pe,new T.e(Ca)),a.exposeFactory(Ea.e,new T.e(Pa)),a.expose(p.e,new(a.injected(Jt.e))),a.exposeFactory(c.s,new T.e(Xt.e)),a.exposeFactory(l.r,new T.e(za.e)),a.exposeFactory(Ta.e,new T.e(Ua.e)),a.exposeFactory(ei.e,new T.e(si)),a.exposeFactory(ei.t,new T.e(ci)),a.exposeFactory(di.e,new T.e(li)),a.exposeFactory(ui.e,new T.e(fi)),a.exposeFactory(l.c,new T.e(Va.e)),a.exposeFactory(f.o,new T.e(Wa.e)),a.exposeFactory(f.e.leftNav.isLeftNavUserExpanded,new T.e(vi));var h=a.expose(f.t,new(a.injected(qa.e))({defaultViewId:i.viewId}));a.expose(f.a.layoutType,h.layoutType),a.expose(d.m,h.focusItem),a.expose(d._,h.focusItemSet);var g=new(a.injected(Qa.e));a.expose(d.d,g),a.expose(d.I,new(a.injected(Ka.e))({selectionModelGroup:g,enableSelectionResolution:!1}));var v=a.consume(Ya.e);s.attach(v.register(m.pureCompute(function(){var e=g.currentSelection();return!!e&&e.selectedCount()>0}))),s.attach(v.register(a.consume(Ja.t))),Object(N.isFeatureEnabled)(N.MoveTransitionResourcesToKOResourceScope)||a.expose(nn.resourceKey,m.create(!1)),a.expose(d.i,m.create(!0)),a.expose(ye.a,new(a.injected(Ga.e))),Object(N.isFeatureEnabled)(N.SPSearchItemsScope)&&(_(pi.k,function(){return n.e(825).then(n.bind(null,5687))}),_(pi.L,function(){return n.e(738).then(n.bind(null,5688))}))},e.prototype._shouldAddGroupsFeatures=function(){var e=window._spPageContextInfo;return Object(g.l)(e)},e}(),Di=new P.t({name:"DeferredResourceLoader",factory:{dependencies:{viewParams:d.P,observablesFactoryType:b.observablesFactoryTypeResourceKey,urlDataSource:l.ue,getIsItemsScopeEnabledInFilesPivot:Za.o.lazy},create:function(e){var t=e.viewParams,n=e.observablesFactoryType,a=e.urlDataSource,i=e.getIsItemsScopeEnabledInFilesPivot,r=new ja.e;return{instance:r.attach(new n).pureCompute(function(){if(!i())return!1;var e=t();if(!e[Ie.n.isPowerAppView]&&a){var n=a.getQueryType(e);return n===ie.e.Files||Object(N.isFeatureEnabled)(N.SPSearchItemsScope)&&n===ie.e.Search}return!1}),disposable:r}}}}),Ii=n(4454),xi=new P.t({name:"InfoPaneManager.key",loader:new T.t(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(800)]).then(n.bind(null,5842)).then(function(e){return e.typeResourceKey})})}),Ci=n(4232),Oi=n(2193),wi=n(2435),Ei=n(1605),Ai=n(473),Li=function(){function e(e){this._spoAppContextHandler=e}return e.prototype.get=function(){return!1},e.prototype.set=function(e){var t;this._spoAppContextHandler.update(((t={})[Ai.paneControls]={needsOverlayContent:e},t))},e.prototype.subscribe=function(e){return function(){}},e}(),ki=new P.t({name:"NeedsOverlayContent",factory:{dependencies:{spoAppContextHandler:Ei.e},create:function(e){var t=e.spoAppContextHandler;return{instance:{needsOverlayContent:new Li(t)}}}}}),Mi=(n(4842),n(3575)),Pi=function(e){function t(t){var n=e.call(this,t)||this;return n._embedDataSource=n.resources.consume(l.d),n}return Object(o.__extends)(t,e),t.prototype.getEmbedInfo=function(e){return this._embedDataSource.getEmbedInfo(e)},t.prototype.createEmbedLink=function(e){return this._embedDataSource.createEmbedLink(e)},t}(b.default),Ti=function(e){function t(){var t=e.call(this)||this;return t._sharingDataSource=t.resources.consume(l.ee),t}return Object(o.__extends)(t,e),t.prototype.getEmbedInfo=function(e){return this._sharingDataSource.getSharingInformation(e).then(function(e){return{embedUrl:(null==e?void 0:e.webUrl)+"/_layouts/15/embed.aspx"}})},t}(b.default),Ui=(Object(T.r)("EmbedDataSource",Ti),n(1712)),Fi=n(1674);function Hi(e,t){return Object(o.__awaiter)(this,void 0,void 0,function(){var n,a,i,r,v,y;return Object(o.__generator)(this,function(o){return window.__ko=s,n=t.attach(new(e.consume(b.observablesFactoryTypeResourceKey))({owner:this})),a=e.consume(f.n),i=e.consume(c.f),r=e.consume(he.e),e.exposeFactory(wi.e,new T.e(ki)),Object(rn.Jr)(rn.Fn)||e.expose(u.n,new ve.default),e.exposeFactory(d.P,new T.e(Ni)),e.expose(d.p,!0),e.expose(c.c,new _e.e),e.expose(l.$,new(e.injected(G))(i)),e.expose(p.b,new(e.injected(ue))),e.expose(l.b,new(e.injected(Q))),e.exposeFactory(Oi.e,new T.e(Ci.typeResourceKey)),Object(rn.Jr)(rn.Fn)||(e.expose(l.D,new(e.injected(de.e))),e.expose(p.r,new(e.injected(fe.e)))),e.exposeFactory(Ii.e,new T.e(xi)),e.expose(d.b,n.create(!0)),e.expose(c.i,n.create("")),e.exposeFactory(Y.e,new T.e(oe)),(new Si).exposeResources({resourceScope:e,navigation:r,pageContext:i,eventScope:a,viewParams:e.consume(d.P)}),e.expose(l.ee,new(e.injected(_.default))(i)),e.expose(l.te,new(e.injected(h.default))(i)),e.exposeFactory(l.j,new T.e(se.resourceKey)),v=function(e,t,n){var a=t.create(void 0);e.expose(d.n,a);var i=e.consume(d.l);return t.subscribe(i,function(e){if(e&&e.serverRelativeUrl){var t=e.serverRelativeUrl;e.isPersonal&&(t+="?PageView=Personal&ShowWebPart={".concat(e.id.toUpperCase(),"}")),a(x.t.concatenate(Object(g.c)(n),t))}else a(void 0)}),a}(e,n,i),e.expose(l.F,new(e.injected(z))({backToClassicUrl:v})),y=e.consume(f.e.leftNav.isLeftNavUserExpanded),e.expose(f.e.leftNav.toggleIsLeftNavUserExpanded,function(){var e=!y.peek();return y(e),e}),e.expose(f.e.columnCustomizationPane.isColumnCustomizationPaneExpanded,n.create(!1)),e.expose(f.e.columnCustomizationPane.columnToFormat,n.create(void 0)),e.expose(f.e.columnCustomizationPane.viewToFormat,n.create(void 0)),e.expose(Mi.isCustomizingCardResourceKey,n.create(void 0)),e.expose(d.S,n.create(!1)),e.expose(f.a.isArrangeControlVisible,s.observable(!1)),e.expose(l.d,new(e.injected(Ti))),e.expose(p.a,new(e.injected(Pi))),e.expose(u.t,new be.default),Object(rn.Jr)(rn.Fn)||(e.expose(l.me,new(e.injected(ce.default))),e.expose(p.x,new(e.injected(me.default))),e.exposeFactory(p.D,new T.e(pe.resourceKey))),t.trackPromise(M.n.resolve(e.consumeAsync(m.e.bypass))),[2]})})}var Ri=new P.t({name:"TransitionResourceLoader",factory:new P.e(Hi)}),Ni=new P.t({name:"TransitionResourceLoader",factory:{dependencies:{itemCacheObservable:le.e,itemsScopeItemKey:va.e,itemCacheStore:ya.e,observablesFactoryType:b.observablesFactoryTypeResourceKey},create:function(e){var t=e.itemCacheObservable,n=e.itemsScopeItemKey,a=e.itemCacheStore,i=e.observablesFactoryType,r=new ge.e,o=r.attach(new i),s=r.attach(a.dispatch(Object(Ui.e)({itemsScopeItemKey:n}))).evaluationContext,c=r.attach(t.pureCompute(function(e){return Object(Fi.e)(e)},{evaluationContext:s}));return{instance:o.pureCompute(function(){return c()}),disposable:r}}}})}],Array(23),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return m});var a=n(0),i=n(2173),r=n(311),o=n(1203),s=n(1206),c=n(2607),d=n(74),l=n(535),u=n(16).e.isActivated("E75FD3EC-1ECF-444B-87FB-B81B02F4E416","02/03/2022","Start the PowerApps host loader via React"),f=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this,i=n.currentItem;return a._pageLoadMonitor=n.pageLoadMonitor,a._engagement=n.engagement,a.isPowerappHostModuleLoaded=a.observables.create(!1),a._powerAppsStore=n.powerAppsStore,a.loadBackgroundPowerApp=a._powerAppsStore.loadPowerApp,a.loadBackgroundPowerApp(!1),c.default.arePowerAppsFormsEnabled()?(a._pageLoadMonitor.waitForPLT().then(function(){if(u){a._loadOrUpdatePowerAppModule();var e=i.peek().id;a.observables.subscribe(i,function(t){t.id&&e!==t.id&&(e=t.id,a._loadOrUpdatePowerAppModule(!0))})}else i.peek().id&&a._loadOrUpdatePowerAppModule()}),a):a}return Object(a.__extends)(t,e),t.prototype._loadOrUpdatePowerAppModule=function(e){return void 0===e&&(e=!1),Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return this._powerAppsStore.isPowerAppsSupportedScenario()?(this._engagement.logData({name:"CheckShouldLoadPowerAppModule",isIntentional:!1}),[4,this._powerAppsStore.hasPowerAppsForm(e)]):[2];case 1:return t.sent()&&(this._engagement.logData({name:"ShouldLoadPowerAppModule",isIntentional:!1}),this.isPowerappHostModuleLoaded.peek()?this._bootPowerApp():this._loadPowerAppHostModule()),[2]}})})},t.prototype._loadPowerAppHostModule=function(){var e=this;return this._powerAppsStore.ensurePowerAppSdkPreloaded(),Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred"),n.e("deferred.odsp-datasources"),n.e(606)]).then(n.bind(null,5918)).then(s.e).then(function(t){e.powerAppHostTagName=t.tagName,e.isPowerappHostModuleLoaded(!0),e._bootPowerApp()})},t.prototype._bootPowerApp=function(){this.loadBackgroundPowerApp(!1),this.loadBackgroundPowerApp(!0)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},o.default.dependencies),{currentItem:r.o,pageLoadMonitor:d.e,powerAppsStore:c.resourceKey,engagement:l.e}),t}(i.e),p=n(2178),m=Object(p.n)({name:"PowerAppHostLoader",template:"\x3c!--ko if:loadBackgroundPowerApp()&&isPowerappHostModuleLoaded()--\x3e\x3c!--ko component:{name:powerAppHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e",automationName:"ms-powerapp-host-loader",viewModelType:f});t.default=m},,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(5568),r=n(976),o=n(4816),s=n(190),c=n(681),d=n(157),l=n(54),u=n(4817),f=n(5565),p=n(4216),m=n(3318),_=n(72),h=n(14),b=n(76),g=n(1472),v=n(189),y=function(e){function t(t){var n=e.call(this,t)||this;n.resources&&(n._apiUrlHelper=n.resources.consume(r.e),n._sharingContextInformation=n.resources.consume(g.e.optional));var a=n._askParentForAuthToken,i=n._getSharingContextInformation();n._sharingDataSourceCommon=new m.e({pageContext:t,getParentListId:n._getParentListId.bind(n),apiUrlHelper:n._getApiUrlHelper(),sharingContextInformation:i,isItemUrlEncoded:!0},{tokenProvider:i&&i.hasTokenProvider?{getAuthToken:function(e){return a(e).then(function(e){return i.authToken=e,e})}}:void 0,pageContext:t});var o=Object(d.s)(n._pageContext);return n._createAnonymousLinkMethodName="CreateAnonymousLink",n._createAnonymousLinkUrl=o+"/_api/SP.Web."+n._createAnonymousLinkMethodName,n._createAnonymousLinkWithExpirationMethodName="CreateAnonymousLinkWithExpiration",n._createAnonymousLinkWithExpirationUrl=o+"/_api/SP.Web."+n._createAnonymousLinkWithExpirationMethodName,n._createOrganizationLinkMethodName="CreateOrganizationSharingLink",n._createOrganizationLinkUrl=o+"/_api/SP.Web."+n._createOrganizationLinkMethodName,n._disableAnonymousLinkMethodName="DeleteAnonymousLinkForObject",n._disableAnonymousLinkUrl=o+"/_api/SP.Web."+n._disableAnonymousLinkMethodName,n._disableOrganizationLinkMethodName="DestroyOrganizationSharingLink",n._disableOrganizationLinkUrl=o+"/_api/SP.Web."+n._disableOrganizationLinkMethodName,n._managePermissionsUrl=o+"/_api/SP.Sharing.DocumentSharingManager.UpdateDocumentSharingInfo",n._unshareUrl=o+"/_api/SP.Web.UnshareObject",n}return Object(a.__extends)(t,e),t.prototype.getSharingInformation=function(e,t,n,a,i,r){if(a){var o=a.method("Lists",this._getParentListId(this.convertToISPListItem(e))).method("GetItemById",i);return this._sharingDataSourceCommon.getSharingInformation(this.convertToISPListItem(e),t,n,o,r)}return this._sharingDataSourceCommon.getSharingInformation(this.convertToISPListItem(e),t,n,null,r)},t.prototype.getShareLinkApi=function(e,t,n){return t.method("Lists",this._getParentListId(this.convertToISPListItem(e))).method("GetItemById",n).segment("ShareLink")},t.prototype.emailWithoutPermissioning=function(e,t,n){return this._sharingDataSourceCommon.emailWithoutPermissioning(e,this.convertToISPListItem(t),n)},t.prototype.checkPermissions=function(e,t){return this._sharingDataSourceCommon.checkPermissions(e,this.convertToISPListItem(t))},t.prototype.share=function(e,t){var n=this,a={items:t.items.map(function(e){return n.convertToISPListItem(e)}),roleValue:t.roleValue,message:t.message,subject:t.subject,sendEmail:t.sendEmail,requireSignIn:t.requireSignIn,propagateSharing:t.propagateSharing,linkType:t.linkType,expiration:t.expiration};return this._sharingDataSourceCommon.share(e,a)},t.prototype.stopSharing=function(e,t){var n=this._pageContext.webAbsoluteUrl+"/_api/web/Lists(@a1)/GetItemById(@a2)/UnshareObject?@a1='"+b.e.encodeURIComponent(e)+"'&@a2='"+b.e.encodeURIComponent(t)+"'";return this.dataRequestor.getData({url:n,parseResponse:function(e){var n=JSON.parse(e).d,a={};return a.statusCode=n.StatusCode,a.errorMessage=n.ErrorMessage,a.itemId=t,a},qosName:"StopSharing",additionalPostData:JSON.stringify({})})},t.prototype.unshare=function(e){var t,n,a=this._getSharingDataSourceHelper().canUseSecurable(e);return t=a?this._getSharingDataSourceHelper().getApiRoot(this._getApiUrlHelper(),e).segment("UnshareObject").toString():this._unshareUrl,this.dataRequestor.getData({url:t,parseResponse:function(t){var n=JSON.parse(t).d,a={};return a.statusCode=n.StatusCode,a.errorMessage=n.ErrorMessage,a.itemId=e.id,a},qosName:"StopSharing",additionalPostData:(n={},a||(n.url=this._getSharingDataSourceHelper().getFileUrl(e)),JSON.stringify(n))})},t.prototype.updatePermissions=function(e,t,n){var a,i=this,r=this._getSharingDataSourceHelper().canUseSecurable(t);return a=r?this._getSharingDataSourceHelper().getApiRoot(this._getApiUrlHelper(),t).segment("UpdateDocumentSharingInfo").toString():this._managePermissionsUrl,this.dataRequestor.getData({url:a,parseResponse:function(e){var n=JSON.parse(e).d,a=[];n.UpdateDocumentSharingInfo&&n.UpdateDocumentSharingInfo.results&&(a=n.UpdateDocumentSharingInfo.results);var i={statusCode:0,errorMessage:null};return i.people=m.e.parsePeople(a),i.itemId=t.id,i},qosName:"ManagePermissions",additionalPostData:function(){var a,o=[];switch(n){case p.e.None:a=0;break;case p.e.View:a=1;break;case p.e.Review:a=6;break;case p.e.Edit:a=2;break;default:a=1}for(var d=0;d<e.length;d++){var l={UserId:e[d].userId,Role:a};o.push(l)}var u={userRoleAssignments:o,validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:t.type===v.t.Folder&&Object(s.t)(c.n)};return r||(u.resourceAddress=i._getSharingDataSourceHelper().getFileUrl(t)),JSON.stringify(u)}()})},t.prototype.updatePermissions2=function(e,t,n){return this._sharingDataSourceCommon.updatePermissions2(e,this.convertToISPListItem(t),n)},t.prototype.updatePermissionsMultiple=function(e,t,n,a,i){return this._sharingDataSourceCommon.updatePermissionsMultiple(e,this.convertToISPListItem(t),n,a,i)},t.prototype.parseRawSharingInformation=function(e,t){return this._sharingDataSourceCommon.parseRawSharingInformation(e,this.convertToISPListItem(t))},t.prototype.setAddressBarLinkCapability=function(e,t){return this._sharingDataSourceCommon.setAddressBarLinkCapability(this.convertToISPListItem(e),t)},t.prototype.manageSharingLinks=function(e,t){var n,a=this,r=this._createAnonymousLinkUrl,o="CreateAnonymousSharingLink",s=this._createAnonymousLinkMethodName;if(this._getSharingDataSourceHelper().canUseSecurable(e[0].item)){var c={items:[e[0].item],expiration:t.expiration,linkType:t.type,roleValue:t.role.toString()};return(t.create?this._getSharingLink.bind(this):this._deleteSharingLink.bind(this))(c,e[0],t.role)}return t.expiration&&(r=this._createAnonymousLinkWithExpirationUrl,o="CreateAnonymousSharingLinkWithExpiration",s=this._createAnonymousLinkWithExpirationMethodName),t.create||(r=this._disableAnonymousLinkUrl,o="DisableAnonymousSharingLink",s=this._disableAnonymousLinkMethodName),t.type===f.e.Organization&&(r=t.create?this._createOrganizationLinkUrl:this._disableOrganizationLinkUrl,o=t.create?"CreateOrganizationSharingLink":"DisableOrganizationSharingLink",s=t.create?this._createOrganizationLinkMethodName:this._disableOrganizationLinkMethodName),this.dataRequestor.getData({url:r,parseResponse:function(n){var i=JSON.parse(n).d,r=[],o={};return o.url=i[s]?a._getSharingDataSourceHelper().encodeSharingLink(i[s]):"",o.type=t.type,o.role=t.role,o.expiration=a._getSharingDataSourceHelper().getExpirationFromLink(o.url),o.isActive=!!o.url,e[0].setLink(o),i[s]&&r.push(o),r},qosName:o,additionalPostData:(n={url:a._getSharingDataSourceHelper().getFileUrl(e[0].item),isEditLink:t.role===p.e.Edit},t.expiration&&(n.expirationString=Object(i.e)(t.expiration)),JSON.stringify(n))})},t.prototype.unshareLink=function(e){var t={item:this.convertToISPListItem(e.item),kind:e.kind,shareId:e.shareId};return this._sharingDataSourceCommon.unshareLink(t)},t.prototype.shareLink=function(e){var t=this,n={emailData:e.emailData,emailSubject:e.emailSubject,items:e.items.map(function(e){return t.convertToISPListItem(e)}),recipients:e.recipients,settings:e.settings};return this._sharingDataSourceCommon.shareLink(n)},t.prototype.supportsExistingAccessOption=function(e){var t=!0;if(e){var n=this._getRootItem(e,"list");n&&(t=n.list.templateType===h.n.mySiteDocumentLibrary)}var a=Number(this._pageContext.webTemplate);return a===_.t.teamSite||a===_.t.group||!t},t.prototype.getClientId=function(){return this._sharingDataSourceCommon.getClientId()},t.prototype.getDataSourceName=function(){return"SharingDataSource"},t.prototype._getApiUrlHelper=function(){return this._apiUrlHelper},t.prototype._getSharingContextInformation=function(){return this._sharingContextInformation},t.prototype._deleteSharingLink=function(e,t,n){var a,i=this,r=this._getSharingDataSourceHelper().getApiRoot(this._getApiUrlHelper(),e.items[0]).segment("DeleteLinkByKind").toString();return this.dataRequestor.getData({url:r,parseResponse:function(a){var r=JSON.parse(a).d,o=[],s={};return s.url=r.DeleteLinkByKind?i._getSharingDataSourceHelper().encodeSharingLink(r.DeleteLinkByKind.sharingLinkInfo.Url):"",s.type=e.linkType,s.role=n,s.expiration=i._getSharingDataSourceHelper().getExpirationFromLink(s.url),s.isActive=!!s.url,t.setLink(s),r.DeleteLinkByKind&&o.push(s),o},qosName:"DeleteLinkByKind",additionalPostData:(a={linkKind:i._getSharingLinkKind(e.linkType,e.roleValue)},JSON.stringify(a))})},t.prototype._getSharingLink=function(e,t,n){var a=this,r=this._getSharingDataSourceHelper().getApiRoot(this._getApiUrlHelper(),e.items[0]).segment("ShareLink").toString();return this.dataRequestor.getData({url:r,parseResponse:function(i){var r=JSON.parse(i).d,o=[],s={};return s.url=r.ShareLink?a._getSharingDataSourceHelper().encodeSharingLink(r.ShareLink.sharingLinkInfo.Url):"",s.type=e.linkType,s.role=n,s.expiration=a._getSharingDataSourceHelper().getExpirationFromLink(s.url),s.isActive=!!s.url,t.setLink(s),r.ShareLink&&o.push(s),o},qosName:"GetLinkViaShareLink",additionalPostData:function(){var t=null;e.expiration&&(t=Object(i.e)(e.expiration));var n={request:{emailData:null,linkKind:a._getSharingLinkKind(e.linkType,e.roleValue),createLink:!0,expiration:t}};return JSON.stringify(n)}()})},t.prototype._getSharingLinkKind=function(e,t){var n=u.e.Direct;return e===f.e.Edit?n=u.e.AnonymousEdit:e===f.e.View?n=u.e.AnonymousView:e===f.e.Organization&&(n=t===p.e.Edit.toString()?u.e.OrganizationEdit:u.e.OrganizationView),n},t.prototype._getParentListId=function(e){var t=this.convertToIOneDriveItem(e);return this._getSharingDataSourceHelper().getParentListId(t)},t.prototype._askParentForAuthToken=function(e){return new l.n(function(t,n){var i=function(e){if(e.data&&"string"==typeof e.data){var a;try{a=JSON.parse(e.data)}catch(e){return}var r=!1;switch(a.name){case"share_newToken":r=!0;var o=a;if(o.error){n(o.error);break}if(!o.token){n("invalid_token");break}t(o.token)}r&&window.removeEventListener("message",i)}};window.addEventListener("message",i,!1);var r=Object(a.__assign)(Object(a.__assign)({},e),{name:"share_getToken"});window.parent.postMessage(JSON.stringify(r),"*")})},t}(o.e),S=n(2192),D=n(2714),I=n(3317),x=function(e){function t(t){var n=e.call(this,t)||this;return n._itemParentHelper=n.resources.consume(S.e),n._sharingDataSourceHelper=new(n.managed(I.e)),n}return Object(a.__extends)(t,e),t.prototype.convertToISPListItem=function(e){return Object(D.n)(e)},t.prototype._getRootItem=function(e,t){return this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,t))||null},t.prototype.convertToIOneDriveItem=function(e){return Object(D.t)(e)},t.prototype._getSharingDataSourceHelper=function(){return this._sharingDataSourceHelper},t}(y);t.default=x}],Array(56),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return m});var a=n(0),i=n(1203),r=n(142),o=n(383),s=n(40),c=n(153),d=n(44),l=n(118),u=n(200),f=n(840),p=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._rawDataSignal=new o.e,a._itemCacheStore=n.itemCacheStore,a._pageContext=n.pageContext;var i=a._itemCacheStore.dispatch(a._getFileHandlerDataFromItemsCacheStore());return i?a.setFileHandlerData(i):a.setFileHandlerData(void 0),a}return Object(a.__extends)(t,e),t.prototype.getFileHandlerData=function(e){return this._rawDataSignal.getPromise().then(function(t){if(t)return e&&e.includePromotedApp!==t.signature.includePromotedApp?void 0:t.data})},t.prototype.setFileHandlerData=function(e){this._rawDataSignal.complete(e)},t.prototype._getFileHandlerDataFromItemsCacheStore=function(){var e=this;return function(t){var n=e._pageContext.webAbsoluteUrl,a=new d.e(n).authority+"/_api/v2.0",i=u.t.serialize({endpoint:a});return t(Object(l.e)(function(e){return e.demandItemFacet(c.s,i)}))}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{itemCacheStore:f.e,pageContext:s.f}),t}(i.default);t.default=p;var m=Object(r.r)("FileHandlerCacheDataSource",p)},,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return d});var a=n(0),i=n("react-lib"),r=n(8),o=n(87),s=n(74),c=n(11).e.isActivated("B0D5C53D-588B-40AB-A922-1426AA4E0E0C","7/16/2021","Disable routing to the legacy Groove client"),d=new r.t({name:"SyncActionControlHandler",factory:{dependencies:{pageLoadMonitor:s.e},create:function(e){var t=e.pageLoadMonitor,r=Object(o.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,t.waitForPLT()];case 1:return e.sent(),[4,n.e(163).then(n.bind(null,5285))];case 2:return[2,e.sent().SyncAction]}})})});return{instance:function(e,t){var n=t.syncState;return c&&"syncGroove"===n?{isAvailable:!0,fallbackAction:i.createElement(r,null)}:{}}}}}})},function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return o});var a=n(8),i=n(223),r=n(1933),o=new a.t({name:"SwitchLayoutActionControlHandler",factory:{dependencies:{resources:a.r,isInfoPaneExpanded:r.resourceKey},create:function(e){return{instance:function(t,n){return{onSwitchLayout:function(t){return function(n){var a=e.isInfoPaneExpanded;t.layoutType===i.e&&a&&a.peek()&&a(!1)}}}}}}}})},,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return P});var a=n(0),i=n(142),r=n(5051),o=n(4219),s=n(2344),c=n(539),d=n(38),l=n(118),u=n(225),f=n(541),p=n(7),m=n(42),_=n(52),h=n(3165),b=n(101),g=n(557),v=n(757),y=n(40),S=n(2132),D=n(2839),I=n(178),x=n(5),C=n(15),O=n(835),w=n(4813),E=n(89),A=n(310),L=n(1),k=n(2142),M=function(){function e(e,t){this._listItemBuilder=t.listItemBuilder,this._listItemResultProcessor=t.listItemResultProcessor,this._itemTaskObserverType=t.itemTaskObserverType,this._urlDataSource=t.urlDataSource,this._microServiceDataSource=t.microServiceDataSource,this._microServiceDataSourceStore=t.microServiceDataSourceStore,this._listContext=t.listContext,this._onePageContext=t.onePageContext,this._pageContext=t.pageContext}return e.prototype.updateFromResponse=function(e){var t=this;return function(n){var i=new t._itemTaskObserverType,r=e.itemSetKey,o=e.serverData,s=e.isItemSetRequest,p=n(Object(l.e)(function(e){var t=e.demandItemFacet(E.e,r),n=t.webAbsoluteUrl,a=t.listFullUrl,i=A.e.serialize({webAbsoluteUrl:n,listFullUrl:a}),o=e.demandItemFacet(L.Sn,i);return{storeKey:e.demandItemFacet(f.t,r),pageContextKey:i,pageContext:o}})),_=p.storeKey,h=p.pageContext,b=p.pageContextKey;if(void 0!==_){var g=[_],v=_.key;s&&(o&&S.e.updateListContext(o,t._listContext),O.e&&t._onePageContext&&n(Object(w.e)(t._pageContext,h,b,t._listContext)));var y=t._listItemResultProcessor.processResponse({response:o,pageContext:h,requestKey:v,observer:i}).listRootItemKey;if(s){var M=t._processRootFolder({response:o,requestKey:v,observer:i,isItemSetRequest:s,pageContext:h});M&&g.push(M.item)}var P=o.ListData&&o.ListData.Row||[],T=t._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(y);if(T&&o.ListSchema){var U={data:o.ListSchema,allowCookies:!1};T.setBaseInfo(U),t._microServiceDataSource.setBaseInfo(U)}for(var F=o.ListSchema&&"TRUE"===o.ListSchema.Collapse,H=0,R=o.SpotlightInfo&&o.SpotlightInfo.Items&&o.SpotlightInfo.Items.Row||[];H<R.length;H++){var N=R[H],B=t._listItemBuilder.getItemResult({microServiceDataSource:T,itemFromServer:Object(a.__assign)({},N),requestKey:v,queryType:d.e.Files,supportsNestedGroups:!1,isItemDataOnly:!s,groupBy:[],observer:i}).item;g.push(B)}if(!F)for(var j=0,V=P;j<V.length;j++){var z=V[j];B=t._listItemBuilder.getItemResult({microServiceDataSource:T,itemFromServer:Object(a.__assign)({},z),requestKey:v,queryType:d.e.Files,supportsNestedGroups:!1,isItemDataOnly:!s,groupBy:[],observer:i,pageContext:h}).item,g.push(B)}i.flush();for(var G=new u.e,K=function(e){var t,r,o=i.getItem(e);if(o&&!o.isPlaceholder){var s=Object(m.f)(e.key),d=n(Object(l.e)(function(e){var t=e.demandItemFacet(c.e,C.c);return c.e.evaluate(t)(e,{viewParams:s,isNavigation:!1}).itemKey}));if(d){var u=D.n.serialize({itemKey:d});G.resolveItems({items:(t={},t[d]=Object(a.__assign)({},Object(I.e)().forFacet(x.f).thenInvalidate(u,D.e).pack()),t[u]=Object(a.__assign)({},D.e.pack(void 0)),t)});var f=n(Object(k.e)({itemKey:d}));if(f)for(var p=0,_=Object.keys(f);p<_.length;p++){var h=_[p];h!==d&&G.mapKeys({mappings:(r={},r[u]=D.n.serialize({itemKey:h}),r)})}}}},W=0,q=g;W<q.length;W++)K(q[W]);n(G.execute())}}},e.prototype._processRootFolder=function(e){var t=e.response,n=e.requestKey,a=e.observer,i=e.pageContext,r=e.isItemSetRequest,o=t.ListData,s=t.ListSchema,c=(void 0===s?{}:s).Collapse,d=void 0===c?"FALSE":c;if(o){var l=o&&o.Row,u="";o.NextHref&&(u=(u=o.NextHref).replace("&View=".concat(_.e.Empty),""));var f="TRUE"===d,m=!f&&l?l.slice(0):[],b=this._urlDataSource.getKeyParams(n),g={id:b[p.t.idParamKey],folder:{childCount:m.length,children:m},nextRequestToken:u,PermMask:o.FolderPermissions,groups:f?l:null,isRootFolder:!1};if(Object(h.n)()){var v=o&&o.CurrentFolderProgId;g.ProgId=v}return this._listItemBuilder.getItemResult({requestKey:n,queryType:this._urlDataSource.getQueryType(b),itemFromServer:g,supportsNestedGroups:!1,isItemDataOnly:!r,observer:a,groupBy:[],pageContext:i})}},e}();t.default=M;var P=Object(i.r)("LegacyItemCacheSPResponseHandler",M,{listItemBuilder:r.e,listItemResultProcessor:o.e,itemTaskObserverType:s.resourceKey,urlDataSource:b.ue,microServiceDataSource:g.resourceKey,microServiceDataSourceStore:v.e,listContext:y.o,pageContext:y.f,onePageContext:y.u.optional})},,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return _});var a=n(8),i=n(1647),r=n(1203),o=n(2693),s=n(2995),c=n(971),d=n(311),l=n(147),u=n(1412),f=n(985),p=n(5457),m=n(3),_=new a.t({name:"KnockoutResourceScope",factory:{dependencies:{resources:i.e.bypass,navigation:l.e},create:function(e){var t,n=e.resources,a=e.navigation;Object(m.Jr)(m.Fn)&&(t=new f.e,Object(p.loadTransitionResources)(n,t));var i=new(n.consume(r.observablesFactoryTypeResourceKey)),l=function(e){var t=new o.e,n=new s.e;return n.item=e.create(t),n}(i),_=l.item;_.equalityComparer=c.n,h(n,d.o,function(){return _});var b=i.create(l);b.equalityComparer=c.n,h(n,d.s,function(){return b});var g=i.create(void 0);h(n,d.l,function(){return g});var v=i.create(a.viewParams);return h(n,d.P,function(){return v}),n.consumeAsync(u.e),{instance:n,dispose:t}}}});function h(e,t,n){return e.isExposed(t)?e.consume(t):e.expose(t,n())}},,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"DefaultClickAction",function(){return r});var a=n(3085),i=n(311),r=Object(a.e)(function(e,t){var n=e.consume(i.e).DefaultClickAction;return new(e.injected(n,{injectChildResourceScope:!0}))({item:t.item,userInvokedItem:!0,sourceEngagement:"ItemRow.Click"})})},,,,function(e,t,n){"use strict";n.r(t),n.d(t,"flowAddon",function(){return l});var a=n(0),i=n(13),r=n(271),o=n(186),s=n(345),c=n(198),d=n(9),l=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(Object(o.t)({keyFacet:c.r,facets:[d.e]})),e(Object(o.t)({keyFacet:c.s,facets:[d.e]})),e(Object(r.a)(c.r,s.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(471)]).then(n.bind(null,5092))];case 1:return[2,e.sent().getFlowSetOperationHandler]}})})}))),e(Object(r.a)(c.s,s.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(471)]).then(n.bind(null,5092))];case 1:return[2,e.sent().getFlowTemplateSetOperationHandler]}})})}))),[2]})})}})}],Array(57),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return r});var a=n(8),i={pageContext:n(4898).e.optional},r=new a.t({name:"SimpleEngagementHandlers",factory:{dependencies:i,create:function(e){var t=[],n=e.pageContext;return n&&t.push(n),{instance:t}}}})},,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"LocalModelCreationWarningBanner",function(){return m});var a=n(0),i=n("react-lib"),r=n(5063),o=n(3333),s=n(5934),c=n(47),d=n(15),l=n(4852),u=n(4851),f=n(5241),p=function(e){function t(t){var n=e.call(this,t)||this;return n._dismissBanner=function(){n.props.showOrHideBanner(!1)},n.state={isBannerVisible:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t=this.props.bannerState;t!==e.bannerState&&this.setState({isBannerVisible:t})},t.prototype.render=function(){return this.state.isBannerVisible?i.createElement(r.e,{onDismiss:this._dismissBanner,messageBarType:o.e.warning,isMultiline:!1},i.createElement(s.e,null,f.e)):null},t}(i.Component);t.default=p;var m=Object(c.e)(function(e){var t=e.demandItemFacet(l.e,d.c);return{bannerState:null==t?void 0:t.bannerState}},function(e){return{showOrHideBanner:function(t){e(Object(u.e)({bannerState:t}))}}})(p)},function(e,t,n){"use strict";n.r(t),n.d(t,"TeamChannelHeaderHost",function(){return p});var a=n(0),i=n("react-lib"),r=n(47),o=n(12),s=n(1),c=n(87),d=n(733),l=n(3165),u=Object(c.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,5357))];case 1:return[2,e.sent().TeamChannelHeader]}})})}),f=Object(r.t)(function(e,t){var n=e.demandItemFacet(s.Pt,t.itemKey);return Object(l.e)(n)?i.createElement(d.e,null,i.createElement(u,null)):null}),p=Object(o.e)()(f)},,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"AddToOneDriveCommandCFT",function(){return r});var a=n(5067),i=n(977),r=Object(a.e)(i.ADD_TO_ONEDRIVE_COMMAND_CFT,function(){return!0})}],Array(19),[function(e,t,n){"use strict";n.r(t),n.d(t,"teamifyStrings",function(){return a});var a=n(5292)},function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return d});var a=n(851),i=n(40),r=n(5293),o=n(1297),s=n(142),c=n(4951),d=Object(s.r)("TeamsProvider",c.e,{pageContext:i.f,groupsProvider:a.e,graphUserInfoDataSource:r.resourceKey,userInfoDataSource:o.e})},,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return s});var a=n(142),i=n(1212),r=n(1714),o=n(1593),s=Object(a.r)("FileHandlerDataSource",r.e,{dataRequestor:i.e,localFileHandlerProvider:o.e})},,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(3100),r=n(2184),o=n(7),s=n(311),c=n(54),d=n(70),l=n(76),u=n(147),f=n(148),p=n(846),m=n(40),_=function(e){function t(t){var n=e.call(this,t)||this;return n.name="BackToclassic",n._params=t,n._viewParams=n.resources.consume(s.P),n._itemUrlHelper=n.resources.consume(f.c),n._pageContext=n.resources.consume(m.f),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=this,a=this._params.url,r=this.peekUnwrapObservable(a),s=this._viewParams.peek(),f=s&&s[o.n.idParamKey],m=!1;if(!r){var _=s[o.n.listUrlKey],h=this._itemUrlHelper.getUrlParts({path:f||_,listUrl:_});r=h.fullItemUrl,m=!0}if(r){if(r=p.e(r),f&&!m){r+=-1===r.indexOf("?")?"?":"&";var b=l.e.encodeURIComponent(f);r+="".concat(o.n.rootFolderParamKey,"=").concat(b)}return this.async.setTimeout(function(){n._params.cookieName&&("splnu"===n._params.cookieName&&n._params.cookieValue?i.set(n._params.cookieName,n._pageContext.listId):i.set(n._params.cookieName,"0")),n.resources.consume(u.e).navigateTo(r)},0),c.n.wrap({resultType:d.e.Success})}return c.n.wrap({resultType:d.e.Failure})},t}(r.e);t.default=_}],Array(134),[function(e,t,n){"use strict";n.r(t),n.d(t,"odspNextAppExtendedItemsCommandBarControlHandler",function(){return $t});var a=n(0),i=n("react-lib"),r=n(15),o=n(347),s=n(1284),c=n(1283),d=n(690),l=n(4728),u=n(2),f=n(80),p=n(40),m=n(62),_=Object(f.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(173).then(n.bind(null,5731))];case 1:return[2,e.sent().CancelEditAtion]}})})},function(e,t){var n=t.resources;if(n){var a=n.consume(p.i.optional);return!(!a||!a())}return!1}),h=n(969),b={key:new u.e("CancelEdit").id,name:h.cancelEdit,action:i.createElement(function(){var e=Object(m.n)();return i.createElement(_,{resources:e})},null),iconProps:{iconName:"CheckMark"}},g=n(5064),v=n(87),y=n(3273),S=n(101),D=n(4851),I=n(12),x=n(47),C=n(23),O=n(22),w=n(1),E=n(5),A=n(90),L=n(37),k=n(462),M=n(72),P=n(11),T=Object(x.t)(function(e,t){var o,s=e.demandItemFacet(r.u,r.c),c=t.itemKeys,d=t.resources.consume(p.f),l=!1,u=c.map(function(t){var n={itemId:e.demandItemFacet(w.Pn,t)||""},a=e.demandItem({fileName:E.m},t).fileName;n.extension=(null==a?void 0:a.extension)||"",n.name=(null==a?void 0:a.name)||"",n.displayName="".concat(n.name).concat(n.extension);var i=e.demandItemFacet(E.h,t);return n.isFolder=!!i,n.isFolder&&(l=!0),n}),f=u.filter(function(e){return!e.isFolder}).slice(0,50),m=e.dispatch,_=u.length>50||l,h=function(e,t){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e,i,r,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,Promise.resolve().then(n.bind(null,863))];case 1:return e=a.sent().getSessionToken,[4,m(e({scopes:["InformationProtection.Read.All"],endpoint:t}))];case 2:return[2,null==(i=a.sent())?void 0:i.accessToken];case 3:return r=a.sent(),A.e.logError(r,{eventName:"fetchGraphToken",feature:"CreateModelEverywhere",errorCode:null===(o=null==r?void 0:r.errorData)||void 0===o?void 0:o.code,correlationId:null===(s=null==r?void 0:r.errorData)||void 0===s?void 0:s.correlationId,status:null===(c=null==r?void 0:r.errorData)||void 0===c?void 0:c.status}),[2,""];case 4:return[2]}})})},b=Object(O.o)(function(e){var t,r=Object(v.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e("deferred.office-ui-fabric-react"),n.e("deferred.odsp-common"),n.e("deferred.odsp-datasources"),n.e(570)]).then(n.bind(null,5497))];case 1:return[2,e.sent().default]}})})});function o(){e&&e.resolve&&e.resolve(),s&&s.consumeAsync(S.k).then(function(e){e.invalidateCurrentItemSet()})}return t=_,m(Object(D.e)({bannerState:t})),_?null:i.createElement(r,{screenReaderAlert:y.e.alert,selectedItems:f,pageContext:d,onDismiss:o,onComplete:o,getAuthToken:h})}),g=f&&f.length>0,I=c&&c.length>0&&g&&((null==d?void 0:d.canUserUseSyntex)||(null==d?void 0:d.isSyntexPAYGEnabled));if(!P.e.isActivated("8A7EDAEE-58E3-4728-A8BC-80E244BC0A2B","03/02/2022","Check manageWeb permission")&&I&&!function(e){var t=null==e?void 0:e.featureInfo;if(!t)return!1;if(Number(e.webTemplate)===M.e.contentCenter)return!0;var n=new k.e(t);if(n){var a=n.get("ContentCenterEverywhereFeature");return!!a&&a.enabled}return!1}(d)&&s){var x=null===(o=s.consume(S.S))||void 0===o?void 0:o.getIdentity();x&&x.webPermMasks&&(I=L.e.hasPermission(x.webPermMasks,L.e.manageWeb))}return i.createElement(C.e,{engagement:{isIntentional:!0,name:"LaunchCreateModelEverywhereCommand.Clicked",webTemplateId:null==d?void 0:d.webTemplate,extraData:{showWarning:_,selectedItemsCount:u.length,hasFolderSelected:l}},isAvailable:I,onExecute:b})}),U=Object(I.r)()(T),F=n(1690),H=n(57),R=n(174),N={key:F.e,name:h.CreateModelEverywhereText,action:i.createElement(H.t,null,i.createElement(function(){var e=Object(m.n)();return i.createElement(U,{resources:e})},null)),iconProps:{iconName:"GenericScan"},facets:Object(a.__assign)({},w.Tt.pack(R.y))},B=n(55),j=n(89),V=n(121),z=n(310),G=n(337),K=n(31),W=n(1111),q=n(108),Q=n(9),Y=n(14),J=n(43),X=n(3717),Z=n(1475),$=n(38),ee=n(295),te=n(7),ne=n(117),ae=new q.e,ie=Object(f.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(187).then(n.bind(null,5732))];case 1:return[2,e.sent().LaunchQuickEditAction]}})})},function(e,t){if(J.isFeatureEnabled(J.UseItemsScopeInTeamSites))return!1;if(ae.isMobile)return!1;var n=t.itemKey;if(n){var a=e.demandItemFacet(j.e,n);if(a){var i=V.e.serialize({listFullUrl:a.listFullUrl,webAbsoluteUrl:a.webAbsoluteUrl}),r=e.demandItemFacet(w.We,i);if(function(e,t,n){if(n&&n.isDocumentLibrary){var a=e.demandItemFacet(Q.o,t),i=[];if(a&&a.columnKeys)for(var r=0,o=a.columnKeys;r<o.length;r++){var s=o[r],c=e.demandItemFacet(w.Ee,s);c&&i.push({internalName:c})}return Object(X.e)(i,!0)}return!1}(e,n,r))return!1;var o=z.e.serialize({listFullUrl:a.listFullUrl,webAbsoluteUrl:a.webAbsoluteUrl}),s=e.demandItemFacet(w.Sn,o);if(s&&s.isAnonymousGuestUser)return!1;if(r&&r.templateType===Y.n.mySiteDocumentLibrary)return!1;var c=void 0;if(!t.resources)return!1;if(!(c=t.resources.isExposed(p.i)?t.resources.consume(p.i):null))return!1;var d=e.demandItemFacet(j.e,n),l=void 0,u=void 0;if(d&&d.viewKey){var f=G.e.serialize(d.viewKey);(u=e.demandItemFacet(w.g,f))&&u.baseViewXml&&(l=(new DOMParser).parseFromString(u.baseViewXml,"text/xml").getElementsByTagName("ViewStyle"))}var m=Object(B.e)(e).itemsScopeItemKey,_=e.demandItemFacet(ee.e,m),h=e.demandItemFacet(w.St,K.e.serialize({listFullUrl:a.listFullUrl,webAbsoluteUrl:a.webAbsoluteUrl})),b=L.t.hasItemPermission({permissions:h},L.t.editListItems),g=Object(Z.e)(e,n),v=e.demandItemFacet(Q.e,n),y=!1;if(v&&v.itemKeys)for(var S=0,D=v.itemKeys;S<D.length;S++){var I=D[S];W.e.matches(I)&&(y=!0)}return g===$.e.Files&&!y&&!!r&&!!r.allowGridMode&&!!u&&!!u.id&&!!l&&0===l.length&&!(_&&_[te.n.needsAttentionViewKey])&&b&&(!c||!c())&&!function(e,t){if(e&&e.listBaseTemplate&&Object(Y.o)(e.listBaseTemplate))try{if(t&&t.baseViewXml){var n=Object(ne.u)(t.baseViewXml);if("1"===Object(ne.t)(n.childNodes[0],"BaseViewID"))return!0}}catch(e){}return!1}(s,u)}}return!1}),re=Object(I.n)()(ie),oe={key:new u.e("QuickEdit").id,name:h.EditAll,action:i.createElement(H.e,null,i.createElement(function(){var e=Object(m.n)();return i.createElement(re,{resources:e})},null)),iconProps:{iconName:"Edit"}},se=n(5065),ce=n(4241),de=n(4855),le=n(2229),ue=n(2236),fe=n(2507),pe=n(2693),me=n(972),_e=n(253),he=n(41),be=n(158),ge=n(28),ve=P.e.isActivated("30c7fb6b-a15b-4b1b-a7dc-4c8a7d591609","08/05/2021","KillSwitch for folder string change"),ye=Object(x.t)(function(e,t){var n,r,o,s=t.resources;if(!s)return null;var c=t.itemKeys,d=s&&s.consume(p.o)||{},l=d.listUrl,u=d.listTemplateType,f=Object(J.isFeatureEnabled)(J.RunModelFlatFileStructureSupport),m=Object(J.isFeatureEnabled)(J.RunModelFolderClassificationSupportEnabled)&&Object(J.isFeatureEnabled)(J.RunModelCustomizationSupportEnabled);m&&f||(c=c.filter(function(t){return!e.demandItemFacet(E.h,t)}));var _=Object(he.e)(e),h=e.demandItemFacet(j.e,_),b=h&&V.e.serialize(h),g=e.demandItemFacet(w.We,b),v="AE9D4F24-EE84-4C0C-A972-A74CFFE939A1",y="Microsoft.Office.Server.ContentCenter.SPMachineLearningWorkItemEntityData",S=s&&s.consume(ce.e),D=s&&s.consume(p.f),I=D&&(null===(n=D.siteId)||void 0===n?void 0:n.replace(/[\{\}']+/g,""))||"",x=D&&(null===(r=D.webId)||void 0===r?void 0:r.replace(/[\{\}']+/g,""))||"",O=D||{},L=O.webAbsoluteUrl,k=O.webServerRelativeUrl,M=c.map(function(t){var n=new pe.e(t),a=e.demandItemFacet(w.Pn,t)||"",i=e.demandItem({fileName:E.m,openUrl:E.L},t),r=i.fileName,o=i.openUrl;return n.name=(null==r?void 0:r.name)||"",n.extension=(null==r?void 0:r.extension)||"",n.displayName="".concat(n.name).concat(n.extension),n.openUrl=o||"",n.itemId=a,n.type=m&&e.demandItemFacet(E.h,t)?_e.e.Folder:_e.e.File,n}),P=function(e,t){var n,a=(null===(n=t.payloads().runModelOnItems)||void 0===n?void 0:n.itemId)||"";return m?f?!!a&&201===e[a]:201===e[t.name]:f?e.has(a):e.has(t.name)},T=((null==g?void 0:g.machineLearningCaptureEnabled)&&D.canUserUseSyntex||D.isSyntexPAYGEnabled)&&c&&c.length>0&&u!==Y.n.contentCenterSampleLibrary&&!!g&&!!g.flags2&&4096==(4096&g.flags2)&&!!(null===(o=null==g?void 0:g.permissions)||void 0===o?void 0:o.manageLists);return i.createElement(C.e,Object(a.__assign)({isAvailable:T,onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e,t,n,i;return Object(a.__generator)(this,function(r){switch(r.label){case 0:return[4,Object(a.__awaiter)(void 0,void 0,void 0,function(){var e,t,n,i,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e=new fe.e,[4,s.consumeAsync(de.e)];case 1:return t=a.sent(),n=0,i=0,r=M.map(function(n){var a=t.register({name:n.displayName||"",iconName:me.a({type:n.type,extension:n.extension}),type:le.e.runModelOnItems,payloads:{runModelOnItems:{item:n,itemId:n.itemId,isKillSwitchActive:ve}},batch:e,progress:{minimum:0,maximum:1,current:0}});return a.progress.maximum(1),a.progress.current(0),a}),ve||r.forEach(function(e){e.payloads().runModelOnItems.item.type===_e.e.File?n++:i++}),r.forEach(function(e){e.payloads().runModelOnItems.fileCount=n,e.payloads().runModelOnItems.folderCount=i,e.state(ue.e.started)}),[2,r]}})})];case 1:return e=r.sent(),t=function(){var e=[];return M.forEach(function(t){var n={__metadata:{type:y},Type:v,TargetSiteUrl:L,TargetWebServerRelativeUrl:k,TargetServerRelativeUrl:"".concat((null==h?void 0:h.rootFolder)||l,"/").concat(t.displayName)},a={__metadata:{type:y},Type:v,TargetSiteId:I,TargetWebId:x,TargetUniqueId:t.itemId||"",IsFolder:t.type===_e.e.Folder};e.push(f?a:n)}),e}(),n=0,i=0,[4,null==S?void 0:S.runModel(t).then(function(t){ve?function(e,t){e.forEach(function(e){var n;(null===(n=e.payloads().runModelOnItems)||void 0===n?void 0:n.itemId)&&P(t,e)?(e.progress.current(1),e.state(ue.e.completed)):e.state(ue.e.failed)})}(e,t):(e.forEach(function(e){var a;(null===(a=e.payloads().runModelOnItems)||void 0===a?void 0:a.itemId)&&P(t,e)&&(e.payloads().runModelOnItems.item.type===_e.e.File?n++:i++)}),be.e.logData({name:"ContentCenterUI.RunModel.FilesAndFoldersProcessed",component:"ContentCenterUI.RunModel",extraData:{fileCount:n,folderCount:i}}),e.forEach(function(e){var a;(null===(a=e.payloads().runModelOnItems)||void 0===a?void 0:a.itemId)&&P(t,e)?(e.payloads().runModelOnItems.fileCount=n,e.payloads().runModelOnItems.folderCount=i,e.progress.current(1),e.state(ue.e.completed)):e.state(ue.e.failed)}))}).catch(function(t){var n;A.e.log("[ccui] fetching content type failed "+(null===(n=null==t?void 0:t.message)||void 0===n?void 0:n.value)),e.forEach(function(e){e.state(ue.e.failed)})})];case 2:return r.sent(),[2]}})})}},Object(ge.t)(e,{itemKey:c[0],engagement:{name:"ContentCenter.RunModelOpen",isIntentional:!0}})))}),Se=Object(I.r)()(ye),De=n(58),Ie={key:Object(De.e)("runModel"),name:h.RunModelText,title:h.RunModelToolTip,action:i.createElement(H.t,null,i.createElement(function(){var e=Object(m.n)();return i.createElement(Se,{resources:e})},null)),iconProps:{iconName:"GenericScan"},facets:Object(a.__assign)({},w.Tt.pack(R.y))},xe=n(1056),Ce=n(1710),Oe=n(107),we=n(133),Ee=n(45),Ae=n(229);function Le(e){var t,n,a=null==e?void 0:e.siteId,i=null===(t=null==e?void 0:e.knowledgeHubSiteDetails)||void 0===t?void 0:t.SiteId;return!(!((null===(n=null==e?void 0:e.knowledgeHubSiteDetails)||void 0===n?void 0:n.Url)&&a&&i&&Object(Ae.normalizeLower)(a)===Object(Ae.normalizeLower)(i)&&(null==e?void 0:e.webPermMasks)&&L.e.hasAny(null==e?void 0:e.webPermMasks,[L.e.manageLists,L.e.manageWeb])&&function(e){return!!(null==e?void 0:e.HasCortexTopicExperiencesCapability)}(e))||!P.e.isActivated("e517fa26-3ff9-4d03-8787-96b5d816bd7c")&&function(e){var t=e.env,n=e.farmLabel;return"prodbubble"===t&&"MSIT_SPDF_1_Content"!==n}(e)&&!L.e.hasPermission(null==e?void 0:e.webPermMasks,L.e.manageWeb))}var ke=Object(x.t)(function(e){var t=Object(we.e)(e),r=Object(Oe.e)(e),o=Object(Ee.e)(e,r);if(!o)return null;var s=e.dispatch,c=Object(C.n)(e,Object(a.__assign)({onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,n.e(176).then(n.bind(null,5733))];case 1:return e=a.sent().createNewTopic,[4,s(e({itemKeys:t,pageContext:o}))];case 2:return a.sent(),[2]}})})}},Object(ge.t)(e,{itemKey:t[0],engagement:{name:"CreateNewTopic"}})));return i.createElement(O.e,{onExecute:c,isAvailable:Le(o)})}),Me={key:h.CreateNewTopicLabel,name:h.CreateNewTopicLabel,action:i.createElement(ke,null),iconProps:{iconName:"Page"}},Pe=n(281),Te=n(775),Ue=n(474),Fe=n(181),He=n(426),Re=n(242),Ne=n(555),Be=n(305),je=n(547),Ve=n(983),ze=n(1055),Ge=n(3),Ke=n(115),We=n(367),qe=n(697),Qe=n(329),Ye=n(2607),Je=n(1907),Xe=n(880),Ze=n(1701),$e=n(52),et=n(502),tt=n(1703),nt=n(1285),at=n(5495),it=n(5496),rt=n(692),ot=n(127),st=n(16),ct=n(785);function dt(e,t,n){var i;return st.t.isActivated("13328880-4673-4E08-A2CE-A7CCDFBD6665","3/14/2022","Clean Up and Update Export Menu Logic")?Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([Object(nt.e)(),Object(Xe.t)(e),l.a,at.e,it.e,Object(ot.e)(Re.n),Object(ot.e)(Re.t)],n?[l.t]:[],!0),[Object(ot.e)(Pe.t)],!1),Object(rt.e)(null==e?void 0:e.listBaseTemplate)?[]:[Object(ot.e)(o.a)],!0),[et.e],!1):(i=Object(ot.e)(Object(Pe.n)({showExportToPowerBI:Object(J.isFeatureEnabled)(J.ShowExportToPowerBI),forDoclib:!1})),Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([Object(nt.e)(),Object(Xe.t)(e),l.a,at.e,it.e,Object(ot.e)(Re.n),Object(ot.e)(Re.t)],n?[l.t]:[],!0),i?[i]:[],!0),Object(rt.e)(null==e?void 0:e.listBaseTemplate)?[]:[Object(ot.e)(o.a)],!0),[et.e],!1))}function lt(e){var t;return st.t.isActivated("13328880-4673-4E08-A2CE-A7CCDFBD6665","3/14/2022","Clean Up and Update Export Menu Logic")?[Object(Xe.t)(e),at.e,it.e,Re.n,Re.t,d.e,je.e,Pe.e,et.e,l.y]:(t=Object(Pe.n)({showExportToPowerBI:Object(J.isFeatureEnabled)(J.ShowExportToPowerBI),forDoclib:!0}),Object(a.__spreadArray)(Object(a.__spreadArray)([Object(Xe.t)(e),at.e,it.e,Re.n,Re.t,d.e,je.e],t?[t]:[],!0),[et.e,l.y],!1))}var ut=[Object(ot.e)(o.e),Object(ot.e)(o.n)],ft=[l.g,o.r,o.e,o.n],pt=[tt.e,l.C],mt=[tt.e,l.C],_t=n(1154),ht=n(1306),bt=n(1435),gt=n(214),vt=n(223),yt=n(279),St=n(1093),Dt=n(498),It=n(5184),xt=n(4857),Ct={key:new u.e("focusFloodgateShortcutCommand").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:h.FloodgateShortcutDescription},action:i.createElement(xt.e,{elementId:"obf-TPromptContainer"})},Ot=n(769),wt=n(770),Et=n(468),At=n(1576),Lt=n(4858),kt=n(1681),Mt=Object(v.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(339).then(n.bind(null,5734))];case 1:return[2,e.sent().AddSmartTemplateTeachingBubbleContent]}})})}),Pt={key:kt.e,automationId:"AddSmartTemplate",name:h.AddSmartTemplate,iconProps:{iconName:"FileTemplate"},action:i.createElement(H.e,null,i.createElement(Lt.e,null))};function Tt(e){var t=Pt;return e||(t=Object(a.__assign)(Object(a.__assign)({},t),{onRender:function(e){return i.createElement(Mt,{item:e,commandButtonId:t.automationId})}})),t}var Ut=n(977),Ft=n(840),Ht=n(143),Rt=n(157),Nt=n(3580),Bt=n(400),jt=n(763),Vt=Object(v.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(553)]).then(n.bind(null,5835))];case 1:return[2,e.sent().DocumentGenerator]}})})}),zt=Object(v.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(159)]).then(n.bind(null,5735))];case 1:return[2,e.sent().ListRecordSelectionPicker]}})})}),Gt=Object(v.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(158).then(n.bind(null,5736))];case 1:return[2,e.sent().ImageFilePicker]}})})});function Kt(e){var t=Object(m.n)(),n=t.consume(Ft.e.optional),a=window.require.toUrl("odsp-media/images/error/error-fileloading-light.svg");return i.createElement(Vt,{pageContext:e.pageContext,templateName:e.templateName,showFRE:e.showFRE,errorImagePath:a,loadWebDataSource:function(){return t.consumeAsync(S.ve)},loadSitesDataSource:function(){return t.consumeAsync(S.ie)},ListRecordSelectionPicker:zt,closeDocumentGeneratorLayer:e.closeDocumentGeneratorLayer,startTime:e.startTime,getOAuthToken:function(){var t=Object(Rt.c)(e.pageContext);return n.dispatch(Object(Ht.e)({url:t,disallowCookies:!0}))},ctId:e.ctId,rootFolderUrl:e.rootFolderUrl,parentFolders:e.parentFolders,itemSetKey:e.itemSetKey,ImageFilePicker:Gt,getUploadedFileData:e.getUploadedFileData,showNPSSurvey:function(){Object(Nt.t)(t)}})}var Wt=Object(x.t)(function(e,t){var n,r,o=Object(he.e)(e),s=e.demandItemFacet(j.e,o),c="",d="",l=e.dispatch,u=[];if(Object(J.isFeatureEnabled)(J.CreateDocumentNewDialog)){d=Object(Oe.e)(e);var f=e.demandItemFacet(E.f,d);u.push(f);for(var p=e.demandItemFacet(E.M,d);p;){var m=e.demandItemFacet(E.f,p.itemKey);u.push(m),p=e.demandItemFacet(E.M,p.itemKey)}}r=function(e,t){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e!==Nt.e.SPOFilePicker?[3,3]:(n=t[0],[4,l(Object(jt.e)(function(e){var t=e.demandItemFacet(E.m,n);c=t.name+t.extension;var a=e.demandItemFacet(Bt.e,n);return Bt.e.evaluate(a)(e,{itemKeys:[n]})}))]);case 1:return i=a.sent().getDownloadData,[4,l(i())];case 2:return[2,{downloadData:a.sent(),fileName:c}];case 3:return[2]}})})};var _=Object(Ee.e)(e,o);if(!_)return null;var h,b=Object(O.o)(function(e){var n=e.onExecuteProps.qos.startTime;return i.createElement(Kt,{pageContext:_,showFRE:t.showFRE||!1,templateName:t.ctName,closeDocumentGeneratorLayer:function(){window.location.reload()},startTime:n,ctId:t.ctId,rootFolderUrl:s.rootFolder,parentFolders:u,itemSetKey:d,getUploadedFileData:r})},{scope:"global"}),g=s&&V.e.serialize(s),v=e.demandItemFacet(w.We,g),y=s?s.webAbsoluteUrl:"",S=(null==s?void 0:s.listFullUrl)?s.listFullUrl:"",D=(null==v?void 0:v.id)?v.id.replace("{","").replace("}",""):"",I=_.canUserUseSyntex;return h=!!(S&&y&&D&&v&&v.isDocumentLibrary&&v.templateType===Y.t.documentLibrary&&(null===(n=null==v?void 0:v.permissions)||void 0===n?void 0:n.manageLists)&&v.newWOPIDocumentEnabled&&I),i.createElement(C.e,Object(a.__assign)({isAvailable:h,onExecute:b},Object(ge.t)(e,{itemKey:o,engagement:{name:"GenerateCAAEDocument"}})))}),qt=Object(v.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(340).then(n.bind(null,5337))];case 1:return[2,e.sent().SubmenuItemWithTeachingBubble]}})})}),Qt={onRender:function(e,t){return i.createElement(O.n,{action:i.createElement(Wt,{ctName:e.name,showFRE:!0,ctId:e.key.substr(16,e.key.length-16)})},function(n){n.isAvailable;var r=n.execute;return i.createElement(qt,{item:e,submenuItemId:"generate-caae-document-button",teachingBubbleCampaign:Ut.GENERATE_CAAE_DOCUMENT,onBubblePrimaryButtonClick:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return t(),[4,r()];case 1:return e.sent(),[2]}})})},onSubmenuButtonClicked:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(n){switch(n.label){case 0:return t(),[4,e.onClick()];case 1:return n.sent(),[2]}})})}})})}},Yt=n(1680),Jt=n(217),Xt=n(317),Zt=st.t.isActivated("72ad9c03-ac5e-4d5c-83b7-f5d0852daa15","04/13/2022","Add go to channel action into the command bar for items in the In channels section");function $t(e,t){var n=t.itemKey,i=t.commands,u=t.farCommands,f=t.overflowCommands,p=Object(Ke.n)(),m=Object(We.t)(),_=p||m&&!Object(Ge.Jr)(Ge.Vt),h=e.demandItemFacet(K.e,n);if(h){var v=e.demandItemFacet(w.Sn,z.e.serialize({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl})),y=v&&v.listBaseTemplate,S=Number(y)===Y.t.contentCenterModelLibrary,D=S&&Object(Ge.Jr)(Ge.V),I=Number(y)===Y.t.contentCenterModelUsageList,x=Object(Et.e)(e),C=x.isMachineLearningCaptureEnabled,O=x.isMachineLearningExperienceEnabled,E=x.isMachineTeachingModelApplied,A={webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl},L=V.e.serialize(A),k=e.demandItemFacet(w.We,L),P=!!k&&!!k.isDocumentLibrary,T=!!k&&k.allowCreateFolder,U=!!k&&k.permissions,F=Object(ze.e)(e,n);F&&(F=Object(ot.e)(F));var H=Object(St.e)(e,n,P);H&&(H=Object(ot.e)(H));var R=Object(gt.e)(e),B=R===vt.e,W=R===yt.e,q=!(null==k?void 0:k.disableCommenting)&&!(null==v?void 0:v.CommentsOnListItemsDisabled);if(B){var J=tn(_t.e);return Object(a.__assign)(Object(a.__assign)({},function(e,t){var n,i,r=t.itemKey,o=t.listKey,s=t.pageContext,c=t.isDocumentLibrary,d=t.extraCommands,u=t.isCommentCommandEnabled,f=Object(he.e)(e),p=e.demandItemFacet(K.e,r),m=e.demandItemFacet(j.e,f),_={webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl},h=Je.e.serialize(_),b=e.demandItemFacet(Q.e,h),g="";if(m&&m.viewKey&&(g=m.viewKey.viewId),!g&&s&&s.viewId&&(g=$e.e.normalizeLower(s.viewId,!1)),b&&p){var v=[];if((n=Object(Ze.e)(e,{viewKeys:b.itemKeys,webAbsoluteUrl:p.webAbsoluteUrl,listViewSetKey:_,itemSetKey:f,currentViewKey:G.e.serialize({viewId:g})}))&&n.subMenuProps&&n.subMenuProps.items){for(var y=n.subMenuProps.items,S=-1,D=0;D<y.length;D++){var I=y[D].automationId;if(I&&(0===I.indexOf("switchToFixedGridLayoutCommand")||0===I.indexOf("switchViewCommand_")||0===I.indexOf("saveCommand"))){S=D;break}}-1!==S&&(v=y.slice(S)),v.push(l.A),v.push(l.E),v.push.apply(v,Object(ct.e)())}n=Object(a.__assign)(Object(a.__assign)({},n),{subMenuProps:Object(a.__assign)(Object(a.__assign)({},n.subMenuProps),{items:v})})}return i=c?{commands:lt(s),overflowCommands:ft,farCommands:mt}:{commands:dt(s,0,u),overflowCommands:ut,farCommands:pt},d&&d.flowCommand&&(i.commands=Object(a.__spreadArray)(Object(a.__spreadArray)([],i.commands,!0),[d.flowCommand],!1)),d&&d.integrateCommand&&(i.commands=Object(a.__spreadArray)(Object(a.__spreadArray)([],i.commands,!0),[d.integrateCommand],!1)),d&&d.openCommand&&c&&(i.commands=Object(a.__spreadArray)([d.openCommand],i.commands,!0)),n&&(i.farCommands=Object(a.__spreadArray)([l.w,n],i.farCommands,!0)),d&&d.fullscreenCommand&&(i.farCommands=Object(a.__spreadArray)(Object(a.__spreadArray)([],i.farCommands,!0),[d.fullscreenCommand],!1)),i}(e,{itemKey:n,listKey:A,pageContext:v,isDocumentLibrary:P,extraCommands:{flowCommand:F,openCommand:J,fullscreenCommand:Object(Ke.i)(v)||Object(Ke.a)()?void 0:l.O,integrateCommand:Object(rt.e)(y)&&H?H:void 0},isCommentCommandEnabled:q})),an(0,t))}var X=!(!W||st.t.isActivated("9EE56BA6-F49A-4D6B-A983-E9FB4677D8E4","09/09/2020","Allowing command bar in case of error screen")||!Object(Dt.e)(e).error),Z=!st.t.isActivated("793446d6-336a-4617-b387-1011564015e8","10/04/2022","Use Syntex supported document libraries allow list"),$=v&&v.webTemplate,ee=Z?Object(Y.s)(Number(y))&&Number($)!==M.e.contentCenter&&!E:P&&Number($)!==M.e.contentCenter&&Number(y)!==Y.t.webPageLibrary&&Number(y)!==Y.t.mySiteDocumentLibrary&&!S&&!E,te=Z?Object(Ge.Jr)(Ge.Oi)&&Object(Y.s)(Number(y)):Object(Ge.Jr)(Ge.Oi)&&P&&Number(y)!==Y.t.webPageLibrary&&Number(y)!==Y.t.mySiteDocumentLibrary&&!S&&Number(y)!==Y.t.contentCenterSampleLibrary,ne=i?function(e,t,n){var i=[],r=t.isDocumentLibrary,s=t.isContentCenterModelLibrary,c=t.isContentCenterModelUsageList,u=t.isMachineLearningCaptureEnabled,f=t.isMachineLearningExperienceEnabled,p=t.hostedCrossOrigin,m=t.defaultCommands,_=t.hosted,h=t.hostedInTeamsDesktop,v=t.allowCreateFolder,y=t.listTemplate,S=t.isCommentCommandEnabled,D=t.flowCommand,I=t.integrateCommand,x=t.isCopyRenameModelActionEnabled,C=t.isContentCenterEverywhereEnabled,O=t.isSyntexViewModelsEnabled;if(t.isCalendarLayoutWithError)return[];r?p&&!Object(Ge.Jr)(Ge.Vt)||i.push(b):p&&!Object(Ge.Jr)(Ge.Vt)?i.push(l.a):i.push(b,l.a);for(var w=Object(Xt.e)(e),E=y!==Y.t.webPageLibrary&&(Object(Ge.Jr)(Ge.Xi)||w&&1===Object(Jt.t)(Ge.Zi,w).variantToDisplay),A=0,L=m;A<L.length;A++){var k=L[A];if(k.key===Fe.e.key){if(!s||u||f){var M=en(e,k,!!r,!!s,!!v);i.unshift(M)}}else if(k.key===Re.t.key)i.push(Object(ot.e)(Re.t)),S&&i.push(Object(ot.e)(l.t));else if(k.key===He.e.key)i.push(tn(k));else if(k.key===je.e.key&&Object(Ge.Jr)(Ge.Li))i.push(k),i.push(l.m),Zt||i.push(l._),i.push(Ie),C&&!O&&i.push(N),O&&i.push(xe.t);else if(k.key!==je.e.key||Object(Ge.Jr)(Ge.Li))if(k.key===Ve.e.key&&Object(bt.e)())i.push(k);else if(k.key===Pe.e.key)h||i.push(k);else if(k.key===Ne.e.key){var P=k;Object(Ge.Jr)(Ge.Ir)||(P=Object(a.__assign)(Object(a.__assign)({},P),{subMenuProps:Object(a.__assign)(Object(a.__assign)({},P.subMenuProps),{items:[l.h,l.b]})})),P.subMenuProps&&P.subMenuProps.items&&P.subMenuProps.items.length>0&&P.subMenuProps.items[P.subMenuProps.items.length-1].key!==qe.n.key&&r&&(P=Object(a.__assign)(Object(a.__assign)({},P),{subMenuProps:Object(a.__assign)(Object(a.__assign)({},P.subMenuProps),{items:Object(a.__spreadArray)(Object(a.__spreadArray)([],P.subMenuProps.items,!0),[qe.n],!1)})})),i.push(P)}else k.key===Ue.t.key?i.push(Object(ot.e)(k)):i.push(k);else i.push(Ie),C&&!O&&i.push(N),O&&i.push(xe.t)}return r?(p&&!Object(Ge.Jr)(Ge.Vt)||(i.push(oe),Ye.default.arePowerAppsFormsEnabled()&&(Object(rt.e)(y)||i.push(o.a))),E&&!x?i.push(Ot.e,wt.e):x?i.push(g.e,g.e,se.e):i.push(l.k,l.I),i.push(l.e),i.push(ht.e),i.push(l.y)):(i.push(oe),Object(rt.e)(y)||i.push(Object(ot.e)(o.a)),E&&!x?i.push(Ot.e):x?i.push(g.e,se.e):i.push(l.k),_&&i.push(l.l)),s?i=i.filter(function(e){return e.key!==d.e.key&&e.key!==oe.key&&e.name!==oe.name&&e.key!==o.a.key&&e.key!==Pe.e.key&&e.key!==o.t.key&&e.key!==o.o.key}):c&&(i=[Pe.e],D&&i.push(D),I&&i.push(I)),i}(e,{defaultCommands:i||[],isDocumentLibrary:P,isContentCenterModelLibrary:S,isContentCenterModelUsageList:I,isMachineLearningCaptureEnabled:C,isMachineLearningExperienceEnabled:O,allowCreateFolder:T,hosted:_,hostedCrossOrigin:m,hostedInTeamsDesktop:p,listTemplate:y,isCalendarLayoutWithError:X,isCommentCommandEnabled:q,integrateCommand:H,flowCommand:F,isCopyRenameModelActionEnabled:D,isContentCenterEverywhereEnabled:ee,isSyntexViewModelsEnabled:te}):[];X||(!F||S||I||ne.push(F),H&&Object(rt.e)(y)&&ne.push(Object(ot.e)(H)));var ae=function(e,t){var n=t.farCommands,i=void 0===n?[]:n,o=t.isCalendarLayout,d=t.isDocumentLibrary,u=t.canModifySchema,f=t.hosted,p=function(){return!o||Object(Ge.Jr)(Ge.Yt)?[Object(ot.e)(l.E),Object(ot.e)(l.A)]:[]},m=[];m.push(l.w);for(var _=0,h=i;_<h.length;_++){var b=h[_];if(b.key===Be.e.key){var g=b.subMenuProps?Object(a.__spreadArray)([],b.subMenuProps.items,!0):[];if(d&&b.subMenuProps&&b.subMenuProps.items)for(var v=0,y=0,S=g;y<S.length;y++){if("tilesListCommand"===S[y].automationId&&(!g[v+1]||g[v+1].key!==l.c.key)){g.splice(v+1,0,l.c);break}v++}m.push(Object(a.__assign)(Object(a.__assign)({},b),{subMenuProps:Object(a.__assign)(Object(a.__assign)({},b.subMenuProps),{items:b.subMenuProps&&(u?Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([],g,!0),p(),!0),Object(ct.e)(),!0):Object(a.__spreadArray)([],g,!0))||Object(a.__spreadArray)(Object(a.__spreadArray)([],p(),!0),Object(ct.e)(),!0)})}))}else m.push(b)}return m.push(s.e,c.e),!e.demandItemFacet(r.r,r.c)||f||Object(Ke.a)()||m.push(l.O),m}(e,{farCommands:u,isDocumentLibrary:P,isCalendarLayout:W,canModifySchema:!(!U||!U.manageLists&&!U.managePersonalViews),hosted:_||Object(Ke.i)(v)}),ie=function(e){var t=e.overflowCommands,n=e.isDocumentLibrary,i=e.hostedCrossOrigin,r=e.hostedInTeamsDesktop;if(!t||e.isCalendarLayoutWithError)return[];var s=[];return i&&r&&!Object(Ge.Jr)(Ge.Vt)?s=Object(a.__spreadArray)([Object(ot.e)(o.r)],t,!0):(s=!i||r||Object(Ge.Jr)(Ge.Vt)?!r||i&&!Object(Ge.Jr)(Ge.Vt)?[Object(ot.e)(o.r),Object(ot.e)(o.e),Object(ot.e)(o.n)]:[Object(ot.e)(o.r),Object(ot.e)(o.e)]:[Object(ot.e)(o.r),Object(ot.e)(o.n)],n&&s.push(l.L),s=s.concat(t)),n&&s.splice(0,0,l.g),s}({overflowCommands:f,isDocumentLibrary:P,hostedCrossOrigin:m,isCalendarLayoutWithError:X,hostedInTeamsDesktop:p});return Object(a.__assign)({commands:nn(ne),farCommands:nn(ae),overflowCommands:nn(ie)},an(0,t))}return Object(a.__assign)({},an(0,t))}function en(e,t,n,r,o){if(t.key!==Fe.e.key)return t;var s;if(n){if(r)return Ce.e;var c=st.t.isActivated("863972C3-5A05-49F8-9F14-15CAEF8AC092","4/23/2021","Skip check for New menu length");if(s=t,t.subMenuProps&&t.subMenuProps.items&&(!c||t.subMenuProps.items.length>0&&t.subMenuProps.items[t.subMenuProps.items.length-1].key!==qe.e.key)){var d=s.subMenuProps.items.filter(function(e){return Object(Yt.e)(e)}).length>0,u=Object(a.__spreadArray)(Object(a.__spreadArray)([],t.subMenuProps.items,!0),[l.f,{name:"-",key:"divider_2",itemType:Qe.e.Divider},l.p,qe.t,Tt(d)],!1);u.unshift(Me),s=Object(a.__assign)(Object(a.__assign)({},t),{subMenuProps:Object(a.__assign)(Object(a.__assign)({},t.subMenuProps),{items:u})})}if(s.subMenuProps&&s.subMenuProps.items&&s.subMenuProps.items.length>0)for(var f=0,p=!1,m=0,_=(g=Object(a.__assign)({},s.subMenuProps)).items;m<_.length;m++){var h=_[m];if(Object(Yt.e)(h)){var b=Object(a.__assign)(Object(a.__assign)({},h),{action:i.createElement(H.e,null,i.createElement(Wt,{ctName:h.name,ctId:h.key.substr(16,h.key.length-16)}))});p||(b=Object(a.__assign)(Object(a.__assign)({},b),Qt),p=!0),g.items[f]=b}f++}if(s.subMenuProps&&s.subMenuProps.items&&s.subMenuProps.items.length>0){var g=Object(a.__assign)({},s.subMenuProps),v=Object(he.e)(e),y=Object(Ee.e)(e,v);g.items=g.items.filter(function(e){return!Object(Yt.e)(e)||Object(Yt.e)(e)&&y.canUserUseSyntex}),s=Object(a.__assign)(Object(a.__assign)({},s),{subMenuProps:g})}return s}return t.subMenuProps&&t.subMenuProps.items&&t.subMenuProps.items.length>0&&t.subMenuProps.items[t.subMenuProps.items.length-1].key===Te.e.key&&t.subMenuProps.items.length<=2&&!o?s={key:t.key,action:Te.e.action,iconProps:t.iconProps,name:t.name}:t}function tn(e){return e.key!==He.e.key?e:e.subMenuProps&&e.subMenuProps.items&&e.subMenuProps.items.length>0&&e.subMenuProps.items[e.subMenuProps.items.length-1].key!==l.d.key&&Object(a.__assign)(Object(a.__assign)({},e),{subMenuProps:Object(a.__assign)(Object(a.__assign)({},e.subMenuProps),{items:Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([],e.subMenuProps.items,!0),[l.u],!1),Object(Ge.Jr)(Ge.Ze)&&[Object(a.__assign)(Object(a.__assign)({},At.e),{facets:Object(a.__assign)(Object(a.__assign)({},At.e.facets),w.Tt.pack(R.p))})]||[],!0),[l.d,l.s],!1)})})||e}function nn(e){if(!e||!e.length)return e;for(var t=[],n={},a=0,i=e;a<i.length;a++){var r=i[a];n[r.key]||(t.push(r),n[r.key]=!0)}return t}function an(e,t){var n=t.shortcutCommands,a=[];if(n)for(var i=0,r=n;i<r.length;i++){var o=r[i];o.key===It.e.key||a.push(o)}return a.push(Ct),{shortcutCommands:a}}}],Array(39),[function(e,t,n){"use strict";n.r(t),n.d(t,"ReactRightPane",function(){return q});var a=n(0),i=n(54),r=n(177),o=n(113),s=n("react-lib"),c=n(1556),d=n(1664),l=n(357),u=n(188),f="mousemove",p="mouseup",m=function(e){function t(t){var n=e.call(this,t)||this;return n._start=0,n._onMouseDown=function(e){n._start=e.clientX,n._events.on(window,f,n._onMouseMove,!0),n._events.on(window,p,n._onMouseUp,!0)},n._events=new u.t(n),n}return Object(a.__extends)(t,e),t.prototype.componentWillUnmount=function(){this._events.dispose()},t.prototype.render=function(){return s.createElement("div",{className:"od-Resize",onMouseDown:this._onMouseDown},s.createElement("div",{className:"od-Resize-hitTarget"}))},t.prototype._onMouseUp=function(e){this._events.off(window,f,this._onMouseMove,!0),this._events.off(window,p,this._onMouseUp,!0),this._reportNewWidth(this._start,e.clientX,this.props.onDragEnd)},t.prototype._onMouseMove=function(e){e.stopPropagation(),e.preventDefault(),this._reportNewWidth(this._start,e.clientX,this.props.onDrag)},t.prototype._reportNewWidth=function(e,t,n){var a=(t-e)*(l.t.isRightToLeft?-1:1);a&&n&&n(a)},t}(s.PureComponent);function _(e){var t=e.isBeforeEdgeDraggable,n=void 0!==t&&t,i=e.isAfterEdgeDraggable,r=void 0!==i&&i,o=e.children,c=e.initialWidth,d=e.minWidth,l=void 0===d?0:d,f=e.maxWidth,p=void 0===f?Number.MAX_SAFE_INTEGER:f,_=e.onDrag,g=e.onDragEnd,v=e.className,y=e.setContainerStyle,S=s.useState(c),D=S[0],I=S[1],x=s.useState(c),C=x[0],O=x[1],w=function(e){e=Math.min(Math.max(e,l),p),D!==e&&I(e),_&&_(e)},E=function(e){e=Math.min(Math.max(e,l),p),C!==e&&O(e),u.t.raise(document.body,"resize",void 0,!0),g&&g(e)},A={onDrag:h(C,w),onDragEnd:h(C,E)},L={onDrag:b(C,w),onDragEnd:b(C,E)},k=y?y(D):{width:"".concat(D,"px")};return s.createElement("div",{className:v,style:k},n?s.createElement(m,Object(a.__assign)({},A)):null,o,r?s.createElement(m,Object(a.__assign)({},L)):null)}function h(e,t){return function(n){return t(e-n)}}function b(e,t){return function(n){return t(e+n)}}var g=n(985),v=n(4900),y=n(311),S=n(856),D=n(323),I=n(1665),x=n(62),C=n(8),O=n(142),w=new C.t({name:"ReactColumnCustomizationPane.key",loader:new O.t(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e("deferred.office-ui-fabric-react"),n.e("deferred.odsp-datasources"),n.e("deferred.odsp-common"),n.e("deferred.odsp-shared-react"),n.e(611)]).then(n.bind(null,5999)).then(function(e){return e.reactResourceKey})})}),E=new C.t({name:"DetailsPaneWrapper.key",loader:new O.t(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(770)]).then(n.bind(null,5038)).then(function(e){return e.typeResourceKey})})}),A=new C.t({name:"ReactFiltersPane.key",loader:new O.t(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(783)]).then(n.bind(null,3310)).then(function(e){return e.typeResourceKey})})}),L=n(488),k=n(235),M=n(909);function P(e,t){var n=s.useMemo(function(){return{barrier:e.consumeAsync(k.e)}},[e]);return Object(M.e)(e,t,n)}var T=n(4428),U=n(4771),F=n(761),H=n(224);function R(e){var t=Object(x.n)(),n=e.paneControls,i=n.isRightPaneExpanded,r=n.isInfoPaneExpanded,o=n.isFiltersPaneExpanded,c=n.isColumnCustomizationPaneExpanded,d=Object(H.i)(function(e){return!Object(F.e)(e)},[]),l=Object(T.e)(t,d,!0).childResource,f=P(l,E),p=P(l,A),m=P(l,w),_=s.useMemo(function(){var e=function(){return s.createElement(s.Fragment,null)},t={};return i&&(r?e=f:o?e=p:c&&(e=m,t={onDismiss:function(){u.t.raise(document.body,"resize",void 0,!0);var e=l.consume(L.e.columnCustomizationPane.isColumnCustomizationPaneExpanded);e(!0),e(!1)},viewTypeLayoutMapping:U.n})),s.createElement("div",{className:"Files-rightPaneContent"},s.createElement(x.e,{resources:l},s.createElement(e,Object(a.__assign)({},t))))},[i,r,o,c]);return s.createElement(s.Fragment,null,_)}var N=n(115),B=n(231),j=n(733),V="isFiltersPaneExpanded",z="isInfoPaneExpanded",G="rightPaneWidth",K=320,W=function(e){function t(t){var n=e.call(this,t)||this;n._onDragEnd=function(e){n._userSettingsStore.setValue(G,e)},n._resources=t.resources,n._scope=new g.e,n._userSettingsStore=n._resources.consume(S.n);var a=n._userSettingsStore.getValue(G);return n._initialWidth=Math.max(a,K)||K,n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(a.__generator)(this,function(t){return this._scope.trackPromise(i.n.resolve(this._resources.consumeAsync(I.e))).then(function(t){e._observables=e._scope.attach(new t({owner:e})),Object(N.n)()||(e._initializeShowPropertiesPaneForDocumentSetItems(),e._resources.consume(r.e).isIE||e._initializeAndSubscribeRightPaneVisibility())}),[2]})})},t.prototype.componentWillUnmount=function(){this._scope.dispose()},t.prototype.render=function(){var e=this.props,t=(e.responsiveUIMetrics,Object(a.__rest)(e,["responsiveUIMetrics"])),n=t.paneControls.isColumnCustomizationPaneExpanded?K:0,i=document.getElementsByClassName("Files-rightPaneInteractionContainer"),r=i&&i.length>0?i[0].getBoundingClientRect().width:window.innerWidth,o={className:"Files-rightPane",isBeforeEdgeDraggable:!0,initialWidth:this._initialWidth,minWidth:n,maxWidth:r,setContainerStyle:this._getRightPaneStyle.bind(this),onDragEnd:this._onDragEnd.bind(this)};return s.createElement(_,Object(a.__assign)({},o),s.createElement(R,Object(a.__assign)({},t)))},t.prototype._getRightPaneStyle=function(e,t){void 0===t&&(t=this.props);var n=t.responsiveUIMetrics.formFactorSize,a=t.paneControls,i=a.isRightPaneExpanded,r=a.isColumnCustomizationPaneExpanded,o="";if(i)if("Small"===n)o="100%";else{var s=r?K:0;e=Math.max(e,s),o="".concat(e,"px")}return{width:o,display:i?"block":"none"}},t.prototype._initializeShowPropertiesPaneForDocumentSetItems=function(){var e=this,t=this._resources.consume(y.o),a=this._observables.pureCompute(function(){return!!t&&!!t().isDocSet}),i=this._resources.consume(y.e);Promise.resolve().then(n.bind(null,977)).then(function(t){var n;e._observables.backgroundCompute(function(){e._teachingBubbleCampaign=t;var r=e._teachingBubbleCampaign.DOCSET_PROPERTIES_PANE;a()?(n||(n=new(e._resources.injected(i.ShowPropertiesAction))({useToggleBehavior:!1})),n.isAvailable.peek()?(n.execute(null),e._resources.consumeAsync(v.e.optional).then(function(t){e._coachmarkProvider=t,n.execute(null).then(function(){t&&t.currentCampaign.peek()!==r&&t.setCampaign(r)})})):n.isAvailable()):e._coachmarkProvider&&e._coachmarkProvider.currentCampaign.peek()===r&&e._coachmarkProvider.hideCampaign()})})},t.prototype._initializeAndSubscribeRightPaneVisibility=function(){var e=this._observables,t=this._resources,n=this._scope,a=this._userSettingsStore;i.n.all({isDetailsPaneExpanded:t.consumeAsync(c.e),isFiltersPaneExpanded:t.consumeAsync(d.e)}).then(function(t){var i=t.isDetailsPaneExpanded,r=t.isFiltersPaneExpanded;n.isDisposed||(a.getValue(V)&&r(!0),e.subscribe(r,function(e){a.setValue(V,e)})),!a.getValue("NoAutoInfoPane",o.e.session)&&i&&(a.getValue(z)&&i(!0),e.subscribe(i,function(e){a.setValue(z,e)}))})},t}(s.PureComponent),q=Object(D.n)([D.e.paneControls,D.e.responsiveUIMetrics])(Object(x.i)()(Object(B.n)(j.e)(W)));t.default=q}],Array(38),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return I});var a=n(177),i=n(8),r=(n(2830),n(1303)),o=n(892),s=n(14),c=n(40),d=n(1963),l=n(147),u=n(188),f=n(158),p=n(142),m=n(4895),_=new i.t({name:"FloodgateDataSource.key",loader:new p.t(function(){return Promise.resolve().then(n.bind(null,5946)).then(function(e){return e.resourceKey})})}),h=n(2607),b=n(101),g=n(4538),v=n(842),y=n(5235),S=n(93),D=n(115),I=new i.t({name:"BaseDeferredSetupTasks",factory:new i.e({loadDeferredResources:function(e){!function(e){var t=e.consume(h.resourceKey);t.ensureListContextUpdateSignal().getPromise().then(function(){t.hasPowerAppsForm(!1).then(function(e){e&&t.ensurePowerAppSdkPreloaded()})})}(e),function(e){if(!Object(S.c)()&&!Object(S.s)()){var t=2144,n=e.consume(c.f);Object(D.i)(n)&&(t=2454),e.expose(g.e,t),e.exposeFactory(b._,new p.e(_)),e.consumeAsync(b._).then(function(t){var n=e.consume(l.e);t.processViewParams(n.viewParams)})}}(e)},setupDeferredComponents:function(e,t){if(function(e,t){var n=new u.e({});t.attach(n),n.on(document.body,"keyup",function(t){m.e.isOpenDebugWindowEvent(t)?m.e.init(e):m.e.isOpenSimplePerfDashboardEvent(t)&&m.e.initSimplePerfDashboard(e)}),m.e.enableAutoOpen(e)}(e,t),function(e){var t=e.consume(c.f),n=Object(s.i)(t.listBaseTemplate),a=Object(s.r)(t.listBaseTemplate);return n||a}(e)){var n=e.consume(a.e);Object(r.e)(n)}!function(e){e.consume(c.f).isSiteAdmin&&e.consume(y.resourceKey).autoOpenPanelBaseOnQueryParams()}(e),function(e){var t="shareddeviceuid",n=e.consume(b.S).getIdentity();if("localStorage"in window&&n.id&&n.type!==d.e.anonymous){var a=localStorage.getItem(t),i=Object(v.e)(n.id).toString();localStorage.setItem(t,i),a&&i!==a&&f.e.logData({name:"SharedDevice.UserChanged",isIntentional:!0})}}(e),Object(o.e)(e)}})})},function(e,t,n){"use strict";n.r(t),n.d(t,"ListStateButton",function(){return P});var a,i=n(0),r=n("react-lib"),o=n(161),s=n(504),c=n(47),d=n(14),l=n(3172),u=n(115),f=n(45),p=n(12),m=n(4850),_=n(3617),h=n(428),b=n(5248),g=n(11),v=g.e.isActivated("a1e27a11-c66b-4075-8a25-97a3cf4c98eb","09/21/2021"),y=g.e.isActivated("551a010b-a9f6-4ade-b579-ce0acf4a7040","07/01/2022"),S=v?void 0:Object(p.n)()(Object(c.t)(function(e,t){var n=e.demandItemFacet(m.e,t.itemKey);return m.e.evaluate(n)(e,{itemKey:t.itemKey}).action})),D=((a={})[l.e.InSync]={iconProps:{toolTip:b.i,icon:"Completed"}},a[l.e.ChangesSaved]={iconProps:{toolTip:b.t,icon:"SavedOffline"}},a[l.e.Syncing]={iconProps:{toolTip:b.s,icon:"SyncStatus"}},a[l.e.Attention]={iconProps:{toolTip:b.e,icon:"Error"}},a[l.e.SyncConflict]={iconProps:{toolTip:b.o,icon:"CriticalErrorSolid",alertMessage:b.n},action:v?void 0:S},a[l.e.SettingUp]={iconProps:{toolTip:b.r,icon:"SyncStatus"}},a[l.e.Unsupported]={iconProps:{toolTip:b.c,icon:"UnavailableOffline"}},a),I=n(184),x=n(1),C=n(183),O=g.e.isActivated("aef6aeca-7688-47e7-abdc-e62a9db1c764","10/28/2021");function w(e){var t=e.getDataSyncClient,n=e.listId,a=e.siteId,i=e.locale,o=Object(r.useState)(),s=o[0],c=o[1];return Object(r.useEffect)(function(){var e=!1,r=t.then(function(t){if(t){var r=function(){var r=t.addListStatusCallbackAsync(function(t){if(!e&&t&&t.length>0){var n={syncStatus:t[0],locale:i};c(n)}},{listId:n,siteId:a});return function(){return r.then(function(e){return t.removeListStatusCallback(e)})}};return O?t.isListDataSyncEnabledAsync({listId:n,siteId:a}).then(function(e){if(e)return r()}):r()}});return function(){e=!0,r.then(function(e){e&&e()})}},[t,e,n,a]),Object(C.t)(e.children,s)}var E=Object(p.n)()(Object(c.t)(function(e,t){var n,a=Object(f.e)(e,t.itemKey);if(!a||a.listBaseType!==d.e.GenericList||!a.listId||!a.siteId)return null;var i=null===(n=e.demandItemFacet(x.en,I.e))||void 0===n?void 0:n.dataSyncClient;return i?r.createElement(w,{getDataSyncClient:i,listId:a.listId,siteId:a.siteId,itemKey:t.itemKey,locale:null==a?void 0:a.currentCultureName},t.children):null})),A=n(22),L=n(2145),k=n(16);function M(e){var t,n;(null===(t=e.statusAndLocale)||void 0===t?void 0:t.syncStatus)&&(n=e.statusAndLocale.syncStatus.state);var a=Object(L.e)(n);if(!e.statusAndLocale||!e.statusAndLocale.syncStatus)return null;var i=function(e,t,n){if(e){var a=D[e.state];if(!y&&e.state===l.e.InSync&&t&&n){var i=new Date(1e3*t),r=Object(h.n)(i,n);a.iconProps.toolTip=_.e.format(b.a,r)}return a}}(e.statusAndLocale.syncStatus,e.statusAndLocale.syncStatus.lastSyncTime,e.statusAndLocale.locale);if(!i)return null;var c=!k.t.isActivated("1306a639-3a80-4073-859c-728214fa6c55","12/15/2021")&&a&&a!==e.statusAndLocale.syncStatus.state&&e.statusAndLocale.syncStatus.state===l.e.SyncConflict,d=i.iconProps,u=function(t){return r.createElement("div",{className:Object(o.e)("od-ListState-button",{insideBreadcrumb:!!e.insideBreadcrumb,isSPList:!e.isWebViewHostedList,isErrorStatus:!!t})},r.createElement(s.e,{id:"LIST_STATE_BUTTON",className:Object(o.e)("od-ListState-icon",{isListHome:e.isWebViewHostedList,hasAction:!!t}),iconName:d.icon,"data-automationid":"od-ListState-icon",onClick:t?function(){return t()}:void 0,title:i.iconProps.toolTip}),c&&r.createElement("div",{role:"alert","aria-live":"assertive","aria-label":d.alertMessage}))};return i.action?r.createElement(A.n,{action:i.action},function(e){var t=e.execute;return u(t)}):u()}var P=Object(c.t)(function(e,t){var n=Object(f.e)(e,t.itemKey);return(null==n?void 0:n.listBaseType)===d.e.GenericList?r.createElement(E,null,function(e){return r.createElement(M,Object(i.__assign)({},t,{statusAndLocale:e,isWebViewHostedList:Object(u.i)(n)}))}):null})},function(e,t,n){"use strict";n.r(t),n.d(t,"LegacyHosts",function(){return G}),n.d(t,"typeResourceKey",function(){return K});var a=n(0),i=(n(3371),n(8)),r=n(161),o=n("react-lib"),s=n(4844),c=n(87),d=n(62),l=Object(c.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(613).then(n.bind(null,5745))];case 1:return[2,e.sent().PowerAppHostLoaderAsyncHost]}})})}),u=Object(d.i)()(function(e){var t=e.resources,n=o.useMemo(function(){return t.consume(s.t)},[t]),a=o.useState(!1),i=a[0],r=a[1];return o.useEffect(function(){if(n.isPowerAppsSupportedScenario()){if(!n.mayHavePowerAppsForm())return;n.ensurePowerAppSdkPreloaded(),r(!0)}},[]),i?o.createElement(l,null):o.createElement(o.Fragment,null)}),f=n(1675),p=n(323),m=n(1203),_=n(20),h=n(257),b=n(3849),g=n(2869),v=n(3803),y=n(147),S=n(358),D=n(4227),I=n(5098),x=n(7),C=n(38),O=n(535),w={resources:i.r,navigation:y.e,observablesFactoryType:m.observablesFactoryTypeResourceKey},E=new i.t({name:"SPListSearchSettings",factory:{dependencies:w,create:function(e){var t=e.resources,n=e.navigation,a=e.observablesFactoryType,i=new S.e,r=i.attach(new a);return{instance:{submitAction:function(e){var a,i=e.searchText.peek();if(i){t.consume(O.e).logData({name:"InPage.Search.Click",isIntentional:!0}),n.updateViewParams(((a={})[x.n.queryTypeParamKey]=C.e.Search,a[x.n.queryParamKey]=i,a)),e.hideResultsUntilChange(!0);var r="alertInPageSearchResults",o=document.getElementById(r);o&&o.parentElement&&o.parentElement.removeChild(o),(o=document.createElement("div")).id=r,o.className="ms-accessible",o.innerText=D.a,o.setAttribute("role","alert"),document.body.appendChild(o)}else Object(I.e)(n)},searchText:r.create(n.viewParams[x.n.queryParamKey]||""),submitPlaceholder:r.create(D.r)},disposable:i}}}}),A=n(1945),L=n(40),k=n(2191),M=n(4202),P=n(231),T=n(733),U=function(e){function t(t){var n=e.call(this,t)||this,a=t.resources,i=t.responsiveUIMetrics,r=a.consume(k.t),o=a.consume(L.f);n._searchParams=a.consume(E),n._scope=new h.e;var s=a.consume(m.observablesFactoryTypeResourceKey),c=n._scope.attach(new s);return n._hasBack=c.create(r.compareSize(i.formFactorSize,"Small")<=0),!n._searchParams.placeholder&&Object(M.e)(o)&&(n._placeholder=c.create(_.format(A.e,o.listTitle))),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=Object(b.e)(v.resourceKey,Object(a.__assign)(Object(a.__assign)({},this._searchParams),{hasBack:this._hasBack,placeholder:this._placeholder}));return o.createElement(g.e,{specification:e,resources:this.props.resources})},t.prototype.componentWillUnmount=function(){this._scope.dispose()},t}(o.PureComponent),F=Object(P.n)(T.e)(Object(d.i)()(Object(p.n)([p.e.responsiveUIMetrics])(U))),H=n(4901),R=n(16),N=n(224),B=n(761),j=R.e.isActivated("7838eae8-70a5-4187-a899-128dce836ba7","2022/2/17","apply noSuiteNav style to panel overlay"),V=R.e.isActivated("E75FD3EC-1ECF-444B-87FB-B81B02F4E416","02/03/2022","Start the PowerApps host loader via React"),z=Object(c.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(605)]).then(n.bind(null,5913))];case 1:return[2,e.sent().KnockoutOverlayContent]}})})}),G=Object(p.n)([p.e.paneControls])(Object(d.i)()(function(e){var t=e.paneControls,n=t.isO365FlexPaneVisible,a=t.isTipsNTricksPaneVisible,i=t.needsOverlayContent,s=e.resources,c=e.onAddOverlay,d=e.onRemoveOverlay,l=!Object(N.i)(function(e){return!Object(B.e)(e)},[]);return o.createElement(o.Fragment,null,l?V?o.createElement(T.e,null,o.createElement(g.e,{specification:Object(b.e)(H.e,{}),resources:s})):o.createElement(u,null):null,o.createElement("div",{className:Object(r.e)("Files-hostContainer",{"od--hasFlexPane":n||a,"od-BasePage--noSuiteNav":e.isSuiteNavHidden&&!j})},i?o.createElement(z,{onAddOverlay:c,onRemoveOverlay:d}):null),f.t(f.e.LEGACY_SEARCH_BOX,F))})),K=new i.t({name:"LegacyHosts",factory:new i.e(G)})}],Array(35),[function(e,t,n){"use strict";n.r(t),n.d(t,"FloodgateDataSource",function(){return W}),n.d(t,"resourceKey",function(){return q});var a={};n.r(a),n.d(a,"NPSCampaignProd",function(){return h}),n.d(a,"NPSCampaignDogfood",function(){return b}),n.d(a,"NPSCampaignForceNomination",function(){return g}),n.d(a,"NPSCampaignDebugForSPO",function(){return v}),n.d(a,"NPSCampaignForSPO",function(){return y}),n.d(a,"NPSCampaignForLists",function(){return D}),n.d(a,"NPSCampaignForListsDebug",function(){return I}),n.d(a,"NPSSuiteSurvey",function(){return x}),n.d(a,"AllPhotosFPSSurvey",function(){return C}),n.d(a,"ODBMoveFPSSurvey",function(){return O}),n.d(a,"ODBCopyFPSSurvey",function(){return w}),n.d(a,"ODCMoveFPSSurvey",function(){return E}),n.d(a,"CreateListFromTemplateFPS",function(){return A}),n.d(a,"ODCCopyFPSSurvey",function(){return L}),n.d(a,"NlqsSurveyForBigLangs",function(){return k}),n.d(a,"NlqsSurveyForMediumLangs",function(){return M}),n.d(a,"SearchNPSCampaigns",function(){return P}),n.d(a,"NlqsSurveyForSmallLangs",function(){return T});var i=n(0),r=n(138),o=n(70),s=n(535),c=n(421),d=n(177),l=n(4538),u=n(1333),f=n(5355),p=n(1550),m={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MeaningfulNpsAction",Count:1,IsAggregate:!0},{Type:0,Activity:"NewNpsSession",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.h,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.H,RatingValuesAscending:[f.j,"2","3","4",f.V]},Question:{Question:f.r}}},_={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SPListAction",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.h,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.N,RatingValuesAscending:[f.j,"2","3","4",f.V]},Question:{Question:f.o}}},h={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:m},b={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:432e3}},SurveyTemplate:m},g={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:432e3}},SurveyTemplate:m},v={CampaignId:"a546f732-aac7-49d2-9da5-9a55220505a0",StartTimeUtc:"2019-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:_},y={CampaignId:"a546f732-aac7-49d2-9da5-9a55220505a0",StartTimeUtc:"2019-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:6,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:_},S={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:p.e,Count:2,IsAggregate:!0}]},Content:{Prompt:{Title:f.b,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.R,RatingValuesAscending:[f.j,"2","3","4",f.V]},Question:{Question:f.s}}},D={CampaignId:"d443d624-9997-4028-98d0-a990cd23631f",StartTimeUtc:"2020-09-17T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:6,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:S},I={CampaignId:"d443d624-9997-4028-98d0-a990cd23631f",StartTimeUtc:"2020-09-17T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:S},x={CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",StartTimeUtc:"2019-03-21T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MeaningfulNpsAction",Count:1,IsAggregate:!0},{Type:0,Activity:"NewNpsSession",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.h,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.S,RatingValuesAscending:[f.j,"2","3","4",f.V]},Question:{Question:f.y}}}},C={CampaignId:"f603ed6a-6f11-4e88-8f4d-7050fda6a676",StartTimeUtc:"2019-10-10T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"EnteredAllPhotosView",Count:2,IsAggregate:!0}]},Content:{Prompt:{Title:f.e,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.t,RatingValuesAscending:[f.n,"2","3","4",f.a]},Question:{Question:f.i}}}},O={CampaignId:"e9808919-b9be-44a7-85fa-2a11dbf35d41",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODBMoveActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.x,Question:f.C,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.I,RatingValuesAscending:[f.n,"2","3","4",f.a]},Question:{Question:f.D}}}},w={CampaignId:"bf829135-ea3a-43e7-8592-6d62259a0a92",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODBCopyActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.l,Question:f.u,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.d,RatingValuesAscending:[f.n,"2","3","4",f.a]},Question:{Question:f.c}}}},E={CampaignId:"54eeb279-6ab7-4f26-880c-0643d3d60e53",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODCMoveActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.x,Question:f.C,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.I,RatingValuesAscending:[f.n,"2","3","4",f.a]},Question:{Question:f.D}}}},A={CampaignId:"20e51938-5a9e-4760-b14f-cd6491d1864e",StartTimeUtc:"2021-08-06T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1},CooldownPeriod:{Type:0,IntervalSeconds:1}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CreateListFromTemplate",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f._,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.f,RatingValuesAscending:[f.p,"2","3","4",f.m]},Question:{Question:f.o}}}},L={CampaignId:"ffd1b867-3ee8-4ca9-a04c-2467930dfc54",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODCCopyActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.l,Question:f.u,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.d,RatingValuesAscending:[f.n,"2","3","4",f.a]},Question:{Question:f.c}}}},k={CampaignId:"a0be9dbb-0be9-429c-a632-c8de3a4d08b8",StartTimeUtc:"2021-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Languages:[{Type:0,Value:"de"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-MX"},{Type:0,Value:"fr"},{Type:0,Value:"ja"},{Type:0,Value:"nl"},{Type:0,Value:"pt-BR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageTime",Count:300,IsAggregate:!0},{Type:0,Activity:"AppResume",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.E,Question:f.w,YesLabel:f.A,NoLabel:f.O},Rating:{Question:f.k,RatingValuesAscending:[f.M,f.P,f.T,f.U,f.F]},Question:{Question:f.L}}}},M={CampaignId:"a0be9dbb-0be9-429c-a632-c8de3a4d08b8",StartTimeUtc:"2021-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Languages:[{Type:0,Value:"ar"},{Type:0,Value:"es"},{Type:0,Value:"fil-PH"},{Type:0,Value:"id"},{Type:0,Value:"it"},{Type:0,Value:"ko"},{Type:0,Value:"ms"},{Type:0,Value:"pl"},{Type:0,Value:"pt-PT"},{Type:0,Value:"ru"},{Type:0,Value:"sv"},{Type:0,Value:"th"},{Type:0,Value:"tr"},{Type:0,Value:"vi"},{Type:0,Value:"zh-TW"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageTime",Count:300,IsAggregate:!0},{Type:0,Activity:"AppResume",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.E,Question:f.w,YesLabel:f.A,NoLabel:f.O},Rating:{Question:f.k,RatingValuesAscending:[f.M,f.P,f.T,f.U,f.F]},Question:{Question:f.L}}}},P={CampaignId:"78e6a7ce-b772-40d2-9d08-39a9f5703919",StartTimeUtc:"2022-03-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:10368e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SyntexModelsGeneralFeedback",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.g,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.r,RatingValuesAscending:[f.j,"2","3","4",f.V]},Question:{Question:f.r}}}},T={CampaignId:"a0be9dbb-0be9-429c-a632-c8de3a4d08b8",StartTimeUtc:"2021-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Languages:[{Type:0,Value:"af"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be"},{Type:0,Value:"bg"},{Type:0,Value:"bn-BD"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"cs"},{Type:0,Value:"da"},{Type:0,Value:"el"},{Type:0,Value:"et"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fi"},{Type:0,Value:"fr-CA"},{Type:0,Value:"he"},{Type:0,Value:"hi"},{Type:0,Value:"hr"},{Type:0,Value:"hu"},{Type:0,Value:"ka"},{Type:0,Value:"kk"},{Type:0,Value:"km-KH"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lv"},{Type:0,Value:"mt-MT"},{Type:0,Value:"nb-NO"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"pa-Arab-PK"},{Type:0,Value:"quz-PE"},{Type:0,Value:"ro"},{Type:0,Value:"sk"},{Type:0,Value:"sl"},{Type:0,Value:"sq"},{Type:0,Value:"uk"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"yo-NG"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageTime",Count:300,IsAggregate:!0},{Type:0,Activity:"AppResume",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.E,Question:f.w,YesLabel:f.A,NoLabel:f.O},Rating:{Question:f.k,RatingValuesAscending:[f.M,f.P,f.T,f.U,f.F]},Question:{Question:f.L}}}},U=n(1557),F=n(3),H=n(357),R=n(142),N=n(40),B=n(52),j=n(3565),V=n(14),z=n(16),G=n(188),K=z.t.isActivated("560845a6-74b3-47bd-99f6-f8657c1fe45d","10/18/22","Skip setSurveyStatus SPO"),W=function(){function e(e,t){void 0===e&&(e={});var n=this;if(this._eventGroup=new G.t(this),this._engagement=t.engagement,this._userInfoProvider=t.userInfoProvider,this._platformDetection=t.platformDetection,this._sessionId=B.e.generate(),this._appId=t.appId,this._pageContext=t.pageContext,this._isItemsScopeEnabledInAllPhotosPivotResource=t.isItemsScopeEnabledInAllPhotosPivotResource,this._onSurveyActivated=function(e){var t=e.survey.surveyInfo.data.backEndIdentifier,a=n._pageContext&&n._pageContext.isSPO;n._userInfoProvider.getSurveyStatusUserFact(t,a,!0).then(function(i){if(i.activated){for(var r=!1,o=0,s=n._campaignDefinitions;o<s.length;o++){var c=s[o];if(c.CampaignId===t){var d=1e3*c.NominationScheme.CooldownPeriod.IntervalSeconds;r=(new Date).getTime()>i.dateLastModified.getTime()+d}}if(!r)return void n._engagement.logData({name:"Floodgate.SurveyBlockedByUserFact",extraData:{id:t},isIntentional:!0})}n._ratingComponent=e.survey&&e.survey.getRatingComponent&&e.survey.getRatingComponent(),e.launch();var l={activated:!0,dateLastModified:new Date};!z.t.isActivated("069E3BF0-5DF9-4305-A165-C4280E18F2DE","10/26/20","Skip setSurveyStatus SPO")&&a?n._engagement.logData({name:"Floodgate.SurveyShown",extraData:{id:t},isIntentional:!0}):n._userInfoProvider.setSurveyStatusUserFact(t,l).then(function(e){n._engagement.logData({name:"Floodgate.SurveyShown",extraData:{id:t,userFactUpdated:e},isIntentional:!0})})})},this._onSurveyDismissed=function(e,t){var a=new r.e({name:"Floodgate.SurveyCompleted"});if(t){var i=n._getEngine();if(i){var s=i.launchedSurveys,c=-1;for(var d in s)s[d].surveyInfo.data.backEndIdentifier===e&&(c=s[d].rating.selectedIndex+1);a.end({extraMetrics:{surveyResponse:c,sessionId:n._sessionId},resultType:o.e.Success}),n._engagement.logData({name:"Floodgate.SurveySubmitted",extraData:{id:e,response:c,sessionId:n._sessionId},isIntentional:!0})}if(n._pageContext&&n._pageContext.isSPO&&n._ratingComponent&&n._ratingComponent.getSelectedRating){var l=n._ratingComponent.getSelectedRating();-1!==l.indexOf("5")?n._engagement.logData({name:"SharePointNPSPromoter",extraData:{rating:l}}):-1===l.indexOf("1")&&-1===l.indexOf("2")&&-1===l.indexOf("3")||n._engagement.logData({name:"SharePointNPSDetractor",extraData:{rating:l}})}}else a.end({resultCode:"SurveyClosed",resultType:o.e.ExpectedFailure}),n._engagement.logData({name:"Floodgate.SurveyClosed",isIntentional:!0})},this._campaignDefinitions=[],e.customCampaignDefinitions)this._campaignDefinitions=e.customCampaignDefinitions;else{this._campaignDefinitions=[];var a=this._getActiveOneDriveNpsCampaign();a&&this._campaignDefinitions.push(a),this._pageContext&&this._pageContext.isSPO&&(this._pageContext.farmName&&this._pageContext.farmName.indexOf("MSIT_SPDF")>-1?(this._campaignDefinitions.push(v),this._campaignDefinitions.push(I)):(this._campaignDefinitions.push(y),this._campaignDefinitions.push(D)),Object(F.Jr)(F.Q)&&this._campaignDefinitions.push(A)),Object(F.Jr)(F.l)&&this._campaignDefinitions.push(C),Object(F.Jr)(F.kt)&&(this._campaignDefinitions.push(O),this._campaignDefinitions.push(w),this._campaignDefinitions.push(E),this._campaignDefinitions.push(L)),Object(F.Jr)(F.Hn)&&(this._campaignDefinitions.push(k),this._campaignDefinitions.push(M),this._campaignDefinitions.push(T)),Object(F.Jr)(F.I)&&this._campaignDefinitions.push(P),this._userInfoProvider.getIsPremium(!1).then(function(e){n._isPremium=e,e&&Object(F.Jr)(F.jn)&&n._campaignDefinitions.push(x)})}}return e.prototype.dispose=function(){this._eventGroup.dispose()},e.prototype.recordUserAction=function(e,t){var n,a=this;"true"===(null===(n=window.sessionStorage)||void 0===n?void 0:n.getItem("_isRunningTABTest"))&&!K||this.waitForFloodgateInit().then(function(){var t=a._getEngine();t&&t.getActivityListener().logActivity(e)})},e.prototype.waitForFloodgateInit=function(){var e;return"true"!==(null===(e=window.sessionStorage)||void 0===e?void 0:e.getItem("_isRunningTABTest"))||K?this._initPromise||(this._initPromise=this._initFloodgate()):this._initPromise=Promise.resolve(),this._initPromise},e.prototype.processViewParams=function(e){e[p.t]&&this._resetAllSurveyStatuses();var t=e[p.n];t&&this._resetSurveyStatusByCampaignId(t);var n=e.origin;"createList"===n?this.recordUserAction(p.e):Object(F.Jr)(F.Q)&&"createListFromTemplate"===n&&this.recordUserAction("CreateListFromTemplate")},e.prototype._initFloodgate=function(){var e=this;return n.e(5).then(n.t.bind(null,5796,7)).then(function(){var t=new r.e({name:"Floodgate.Initialized"});if(!window.OfficeBrowserFeedback||!window.OfficeBrowserFeedback.floodgate)return t.end({resultCode:"FloodgateNotLoaded",resultType:o.e.ExpectedFailure,extraData:{error:"Floodgate SDK not loaded."}}),e._engagement.logData({name:"Floodgate.SdkNotLoaded",extraData:{error:"Floodgate SDK not loaded."}}),Promise.resolve();try{localStorage.setItem("test","test"),localStorage.removeItem("test")}catch(n){return t.end({resultCode:"LocalStorageDisabled",resultType:o.e.ExpectedFailure,extraData:{error:"Local storage not enabled."}}),e._engagement.logData({name:"Floodgate.LocalStorageNotEnabled",extraData:{error:"Local storage not enabled."}}),Promise.resolve()}window.OfficeBrowserFeedback.initOptions={appId:e._appId,stylesUrl:window.require.toUrl("@ms-ofb/officebrowserfeedback/styles/officebrowserfeedback.css"),intlUrl:window.require.toUrl("@ms-ofb/officebrowserfeedback/intl")+"/",environment:e._computeCurrentEnvironment(),sessionId:e._sessionId,locale:H.t.language,primaryColour:j.themeOffice.themePrimary,secondaryColour:j.themeOffice.themeSecondary,build:e._computeBuildVersion()};var n={newAllPhotosExperience:e._isItemsScopeEnabledInAllPhotosPivotResource,isPremium:e._isPremium},a=Object(U.t)();a&&(n=Object(i.__assign)(Object(i.__assign)({},n),{lastActionBeforeNPSSurvey:Object(U.e)(a.actionName),extension:a.extension,objectType:a.objectType,currentPage:a.currentPage})),window.OfficeBrowserFeedback.initOptions.applicationGroup={appData:JSON.stringify(n)};var s=window.FilesConfig&&window.FilesConfig.df;return e._pageContext&&e._pageContext.isSPO&&(s=e._pageContext.farmName.indexOf("MSIT_SPDF")>-1),window.OfficeBrowserFeedback.initOptions.telemetryGroup={audienceGroup:s?"Dogfood":"Production",officeUILang:e._computeLanguage(),loggableUserId:e._getUserId()},e._pageContext&&e._pageContext.isSPO&&e._pageContext.aadTenantId?window.OfficeBrowserFeedback.initOptions.telemetryGroup.tenantId=e._pageContext.aadTenantId:window.OfficeBrowserFeedback.initOptions.telemetryGroup.tenantId="00000000-0000-0000-0000-000000000000",e._pageContext&&e._pageContext.isSPO&&void 0!==e._pageContext.listBaseType&&(Object(V.a)(e._pageContext.listBaseType)?window.OfficeBrowserFeedback.initOptions.telemetryGroup.featureArea="Libraries":window.OfficeBrowserFeedback.initOptions.telemetryGroup.featureArea="List"),e._platformDetection&&(window.OfficeBrowserFeedback.initOptions.telemetryGroup.platform=e._platformDetection.osName,window.OfficeBrowserFeedback.initOptions.webGroup={browser:e._platformDetection.browserName}),window.OfficeBrowserFeedback.initOptions.telemetryGroup.channel="CC",window.OfficeBrowserFeedback.floodgate.initOptions={campaignDefinitions:e._campaignDefinitions,onDismiss:e._onSurveyDismissed,onSurveyActivatedCallback:{onSurveyActivated:e._onSurveyActivated}},window.OfficeBrowserFeedback.floodgate.initialize().then(function(){return window.OfficeBrowserFeedback.floodgate.start().then(function(){var n=e._getEngine();if(!n)throw"Floodgate engine initialization failed silently.";var a=n.getActivityListener();a.logActivityStartTime("AppUsageTime"),a.logActivity("AppResume"),e._setupEventListeners(),t.end({resultType:o.e.Success}),e._engagement.logData({name:"Floodgate.Initialized"})})}).catch(function(n){t.end({resultCode:"FloodgateInitializationFailure",resultType:o.e.Failure}),e._engagement.logData({name:"Floodgate.FailedToInitialize",extraData:{error:n}})})})},e.prototype._getActiveOneDriveNpsCampaign=function(){return Object(F.Jr)(F.Nn)?g:Object(F.Jr)(F.Rn)?b:h},e.prototype._getEngine=function(){if(window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate)return window.OfficeBrowserFeedback.floodgate.getEngine()},e.prototype._computeCurrentEnvironment=function(){return 0},e.prototype._computeBuildVersion=function(){var e=z.t.isActivated("92557910-4C5C-4204-8F39-A11BF1AD085E","10/26/20","STS regex"),t=window._spModuleLink&&window._spModuleLink.buildNumber||window.Flight&&window.Flight.version;if(t){var n=e?t.match(/\d{4}-\d{2}-\d{2}(-sts)?_\d{8}\.\d{3}/):t.match(/\d{4}-\d{2}-\d{2}_\d{8}\.\d{3}/);if(n)return n[0].replace(/-/g,"").replace("_",".")}},e.prototype._computeLanguage=function(){if(this._pageContext){if(this._pageContext.currentCultureLCID)return this._pageContext.currentCultureLCID;if(this._pageContext.currentLanguage)return this._pageContext.currentLanguage}else if($Config&&$Config.langPref)return $Config.langPref},e.prototype._getUserId=function(){if(!z.t.isActivated("FAB40378-F3AE-4D14-88B8-E7EE827CCA3B","03/15/2022","Return userId"))return this._pageContext&&this._pageContext.aadUserId?this._pageContext.aadUserId:$Config&&$Config.hcid?$Config.hcid:B.e.Empty},e.prototype._setupEventListeners=function(){var e=this,t=this._getEngine();this._eventGroup.on(window,"blur",function(){t&&(t.getActivityListener().logActivityStopTime("AppUsageTime"),window.OfficeBrowserFeedback.floodgate.stop())}),this._eventGroup.on(window,"unload",function(){t&&(t.getActivityListener().logActivityStopTime("AppUsageTime"),window.OfficeBrowserFeedback.floodgate.stop())}),this._eventGroup.on(window,"focus",function(){window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate&&window.OfficeBrowserFeedback.floodgate.start().then(function(){var e=window.OfficeBrowserFeedback.floodgate.getEngine().getActivityListener();e.logActivityStartTime("AppUsageTime"),e.logActivity("AppResume")}).catch(function(t){e._engagement.logData({name:"Floodgate.FailedToReinitialize",extraData:{error:t}})})})},e.prototype._resetSurveyStatusByCampaignId=function(e){this._userInfoProvider.setSurveyStatusUserFact(e,{activated:!1,dateLastModified:new Date}).then(function(t){t&&console.log("UserFact successfully reset: "+e)})},e.prototype._resetAllSurveyStatuses=function(){var e=new Set;for(var t in a){var n=a[t];e.has(n.CampaignId)||(e.add(n.CampaignId),this._resetSurveyStatusByCampaignId(n.CampaignId))}},e.dependencies={engagement:s.e,userInfoProvider:c.x,platformDetection:d.e,appId:l.e,pageContext:N.f.optional,isItemsScopeEnabledInAllPhotosPivotResource:u.n},e}(),q=Object(R.r)("FloodgateDataSource",W)}],Array(23),[function(e,t,n){"use strict";n.r(t),n.d(t,"ProcessingMessage",function(){return A});var a=n(0),i=n("react-lib"),r=n(216),o=n(90),s=n(5063),c=n(3333),d=n(1919),l=n(2793),u=n(62),f=n(5239),p=n(47),m=n(358),_=n(3338),h=n(261),b=n(5),g=n(118),v=n(3568),y=n(14),S=n(253),D=n(468),I=n(72),x=n(40),C=n(231),O=n(733),w=n(3),E=function(e){function t(t){var n=e.call(this,t)||this,a=n.props,i=a.listId,o=a.webAbsoluteUrl,s=a.resources;return n._listId=i,n._webAbsoluteUrl=o,n._resources=s,n._scope=new m.e,n._async=new r.e,n._isMounted=!1,n._listAIModelDataSource=n._resources.consume(l.t),n._uploadedItem=n._resources.consume(_.e),n._itemCacheStore=n._resources.consume(h.e),n._pageContext=n._resources.consume(x.f),n.state={showMachineTeachingModelMessage:!1,showFormProcessingModelMessage:!1,showNoSynctexLicenseMessage:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this._isMounted=!0,this._scope.attach(this._uploadedItem.subscribe(function(t){var n=e.props,a=n.listId,i=n.webAbsoluteUrl,r=n.listTemplateType,s=n.isMachineTeachingModelApplied,c=n.isPredictionModelApplied,d=n.isMachineLearningCaptureEnabled,l=n.isAIBuilderEnabled,u=n.isSyntexPAYGEnabled;if(a&&i&&(s||c&&l))if(d||u){if(void 0!==t.progressItemKey){var f=e._itemCacheStore.dispatch(Object(g.e)(function(e){return e.demandItemFacet(v.t,t.progressItemKey)}));if(f){var p=e._itemCacheStore.dispatch(Object(g.e)(function(e){return e.demandItemFacet(b.m,f.sourceEntryKey)}));if(!p||!p.extension)return}}else{var m=t;if(!m||m.type!==S.e.File)return;if(m&&m.eTag)return}!s||c?e.getListAIModelState(i,a).then(function(t){if(e._isMounted){var n=(d||u)&&t.machineTeachingModelPublished&&r!==y.n.contentCenterSampleLibrary,a=l&&t.formProcessingModelPublished;(a||n)&&e.setState({showMachineTeachingModelMessage:n,showFormProcessingModelMessage:a,showNoSynctexLicenseMessage:!1})}}).catch(function(e){o.e.log("Failed to fetching list AI model state"+e.message.value)}):e.setState({showMachineTeachingModelMessage:!0,showFormProcessingModelMessage:!1,showNoSynctexLicenseMessage:!1})}else e.setState({showMachineTeachingModelMessage:!1,showFormProcessingModelMessage:!1,showNoSynctexLicenseMessage:Number(e._pageContext.webTemplate)!==I.t.contentCenter})}))},t.prototype.componentDidUpdate=function(){var e=this;(this.state.showFormProcessingModelMessage||this.state.showMachineTeachingModelMessage||this.state.showNoSynctexLicenseMessage)&&(this._autoDismissTimer&&this._async.clearTimeout(this._autoDismissTimer),this._autoDismissTimer=this._async.setTimeout(function(){e._isMounted&&e.setState({showMachineTeachingModelMessage:!1,showFormProcessingModelMessage:!1,showNoSynctexLicenseMessage:!1})},t.AutoDismissTimeOut))},t.prototype.componentWillUnmount=function(){this._isMounted=!1,this._scope.dispose(),this._autoDismissTimer&&this._async.clearTimeout(this._autoDismissTimer)},t.prototype.render=function(){var e=this,t=this.state,n=t.showMachineTeachingModelMessage,a=t.showFormProcessingModelMessage,r=t.showNoSynctexLicenseMessage,o=this.props,l=o.listId,u=o.webAbsoluteUrl;l===this._listId&&u===this._webAbsoluteUrl||(this._listId=l,this._webAbsoluteUrl=u,n=!1,a=!1,r=!1);var p="",m="";return n&&a?(p=f.n,m="https://go.microsoft.com/fwlink/?linkid=2127686"):!n&&a?(p=f.e,m="https://go.microsoft.com/fwlink/?linkid=2128021"):n&&!a?(p=f.a,m="https://go.microsoft.com/fwlink/?linkid=2128023"):r&&(p=Object(w.Jr)(w.wi)?f.r:f.i,m=""),p?i.createElement("div",{className:"messageBarContainer"},i.createElement(s.e,{messageBarType:r?c.e.warning:c.e.info,onDismiss:function(){return e.setState({showFormProcessingModelMessage:!1,showMachineTeachingModelMessage:!1,showNoSynctexLicenseMessage:!1})},dismissButtonAriaLabel:"Close"},p,!!m&&i.createElement(d.e,{href:m,target:"_blank"},f.t))):i.createElement("div",null)},t.prototype.getListAIModelState=function(e,n){var a=t.AIModelStateCache[n],i=new Date;return a&&a.expirationTime.getTime()>i.getTime()?Promise.resolve(a.modelState):this._listAIModelDataSource.getListAIModel(e,n).then(function(e){var a={formProcessingModelPublished:!(!e.predictionModel||!e.predictionModel.id||e.predictionModel.state&&e.predictionModel.state!==l.e.Online),machineTeachingModelPublished:!!e.machineTeachingModel&&!!e.machineTeachingModel.driveId},i=new Date;return i.setSeconds(i.getSeconds()+5),t.AIModelStateCache[n]={modelState:a,expirationTime:i},a}).catch(function(e){return Promise.reject(e)})},t.AIModelStateCache={},t.AutoDismissTimeOut=4e4,t}(i.PureComponent),A=Object(C.n)(O.e)(Object(p.e)(D.e)(Object(u.i)()(E)))},function(e,t,n){"use strict";n.r(t),n.d(t,"ModelPublishedBanner",function(){return h});var a=n(0),i=n("react-lib"),r=n(5063),o=n(3333),s=n(5934),c=n(47),d=n(15),l=n(4866),u=n(216),f=n(4865),p=n(5240),m="Text_fb8593ab",_=function(e){function t(t){var n=e.call(this,t)||this;return n._dismissBanner=function(){n.setState({isBannerVisible:!1}),n.props.showModelPublishBanner("")},n._async=new u.e,n._isMounted=!1,n.state={isBannerVisible:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._isMounted=!0},t.prototype.componentDidUpdate=function(e){var n=this,a=this.props.modelName;e.modelName!==a&&a&&this.setState({isBannerVisible:!0},function(){a&&(n._autoDismissTimer&&n._async.clearTimeout(n._autoDismissTimer),n._autoDismissTimer=n._async.setTimeout(function(){n._isMounted&&n._dismissBanner()},t.AutoDismissTimeOut))})},t.prototype.componentWillUnmount=function(){this._isMounted=!1,this._autoDismissTimer&&this._async.clearTimeout(this._autoDismissTimer)},t.prototype.render=function(){var e=this.props,t=e.modelName,n=e.isModelPublished;return this.state.isBannerVisible?n?i.createElement(r.e,{onDismiss:this._dismissBanner,messageBarType:o.e.success,isMultiline:!1},p.e," ",i.createElement(s.e,{className:m},t),"",p.t," ",p.n," ",i.createElement(s.e,{className:m},p.a),""):i.createElement(r.e,{onDismiss:this._dismissBanner,messageBarType:o.e.success,isMultiline:!1},i.createElement(s.e,{className:m},t),"",p.i):null},t.AutoDismissTimeOut=2e4,t}(i.Component);t.default=_;var h=Object(c.e)(function(e){var t=e.demandItemFacet(l.e,d.c);return{modelName:null==t?void 0:t.modelName,isModelPublished:null==t?void 0:t.isPublished}},function(e){return{showModelPublishBanner:function(t){e(Object(f.e)({modelPublishDetails:{modelName:t,isPublished:!1}}))}}})(_)},,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return q});var a=n(0),i=n(142),r=n(1203),o=n(311),s=n(101),c=n(4219),d=n(2344),l=n(40),u=n(2132),f=n(990),p=n(757),m=n(4843),_=n(3167),h=n(43),b=n(1),g=n(89),v=n(121),y=n(310),S=n(337),D=n(41),I=n(505),x=n(133),C=n(390),O=n(2632),w=n(2607),E=n(52),A=n(88),L=n(364),k=n(153),M=n(200),P=n(44),T=n(2477),U=n(4233),F=n(107),H=n(2839),R=n(2996),N=n(14),B=n(971),j=n(541),V=n(372),z=n(4813),G=[],K=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._computeShouldUpdateKnockoutData=function(e){var t=a._useItemsScope(),n=Object(F.e)(e,{itemsScopeItemKey:a._itemsScopeItemKey}),i=H.n.serialize({itemKey:n});return t&&e.isItemFacetResolved(H.e,i)},a._computeFileHandlerData=function(e){var t=Object(D.e)(e,a._itemsScopeItemKey),n=e.demandItemFacet(g.e,t);if(n){var i=n.webAbsoluteUrl,r=new P.e(i).authority+"/_api/v2.0",o=M.t.serialize({endpoint:r});return e.demandItemFacet(k.s,o)}},a._computeSelectedKOItemKeys=function(e){var t=a._itemsScopeItemKey;return Object(x.e)(e,{itemsScopeItemKey:t}).map(function(t){var n=e.demandItemFacet(H.t,t);return n&&n.key})},a._computeContentTypes=function(e){var t=Object(D.e)(e,a._itemsScopeItemKey),n=e.demandItemFacet(g.e,t)||{},i=n.webAbsoluteUrl,r=void 0===i?void 0:i,o=n.listFullUrl,s=void 0===o?void 0:o,c=r&&s&&v.e.serialize({webAbsoluteUrl:r,listFullUrl:s});return(e.demandItemFacet(b.b,c)||G).map(function(t){return e.demandItemFacet(b.vn,t)})},a._computeFolderContentTypes=function(e){var t=Object(F.e)(e,{itemsScopeItemKey:a._itemsScopeItemKey});return(e.demandItemFacet(b.b,t)||G).map(function(t){return e.demandItemFacet(b.sn,t)})},a._computeCurrentItemData=function(e){var t=Object(I.e)(e,{itemsScopeItemKey:a._itemsScopeItemKey}),n=t.currentItemSetKey,i=t.currentItemKey,r=e.demandItemFacet(g.e,n);if(r){var o=r.webAbsoluteUrl,s=r.listFullUrl,c=e.demandItemFacet(j.t,i),d=v.e.serialize({webAbsoluteUrl:o,listFullUrl:s}),l=y.e.serialize({webAbsoluteUrl:o,listFullUrl:s}),u=e.demandItemFacet(b.Sn,l),f=e.demandItemFacet(b.ge,n),p=e.demandItemFacet(A.l,d),m=a._getCurrentViewKey(e,n),_=e.demandItemFacet(b.g,m);return{pageContextKey:l,pageContext:u,getItemResponse:f,spClientSideFrameworkContext:p,storeKey:c&&c.key,listKey:d,currentDerivedView:_,dispatch:e.dispatch}}},a._computeOnUpdateCurrentItemData=function(){if(a._shouldUpdateKnockoutData()){var e=a._currentItemData();if(e){var t=e.pageContextKey,n=e.pageContext,i=e.getItemResponse,r=e.spClientSideFrameworkContext,o=e.storeKey,s=e.listKey,c=e.currentDerivedView,d=e.dispatch;i&&u.e.updateListContext(i,a._listContext);var l=a.resources.consume(w.resourceKey);l&&l.ensureListContextUpdateSignal().complete();var f=a._onePageContext;if(f){d(Object(z.e)(a._pageContext,n,t,a._listContext));var p=a.resources.consume(_.e.optional);p&&(p.clearCachedPromise(),p.updateWorkloadSettingsLinks&&p.updateWorkloadSettingsLinks()),r&&a._updateSpfxContext(s,r),f.onePageNavigationDataFetch(!0),f.onePageNavigationDataFetch(!1),a._bootOptions.onEUPL&&a._bootOptions.onEUPL()}if(c&&a._currentView&&a._currentView(c.clone()),i){var b=new a._itemTaskObserverType,g=i.ListSchema,v=a._listItemResultProcessor.processResponse({response:i,pageContext:n,requestKey:o,observer:b}).listRootItemKey;if(g&&!Object(h.isFeatureEnabled)(h.SkipSettingMicroserviceBaseInfo)){var y={data:g,allowCookies:!1};a._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(v).setBaseInfo(y),a._microServiceDataSource.setBaseInfo(y)}if(a.resources.consumeAsync(m.e).then(function(e){e.trackListToken(o)}),i&&i.ListSchema){var S={},D=Object(R.t)({listSchema:i.ListSchema,resources:a._resources,groupSchema:S,hasFixedSchema:a._listContext.listTemplateType===N.t.mySiteDocumentLibrary,listContext:a._listContext,getItemContext:void 0,sortFallback:{sortField:i.ListData.SortField,sortDirection:i.ListData.SortDir}});i.ListSchema.group1&&(a._listContext.groupSchema=S),a.koItemSet().schema(D)}b.flush()}}}},a._listItemResultProcessor=n.listItemResultProcessor,a._itemTaskObserverType=n.itemTaskObserverType,a._fileHandlerCacheDataSource=n.fileHandlerCacheDataSource,a._resources=n.resources,a._listContext=n.listContext,a._pageContext=n.pageContext,a._microServiceDataSource=n.microServiceDataSource,a._microServiceDataSourceStore=n.microServiceDataSourceStore,a._onePageContext=n.onePageContext,a._useItemsScope=n.useItemsScope,a._clientSideExtensionHelper=n.clientSideExtensionHelper,a._itemCacheDataManager=n.itemCacheDataManager,a._itemsScopeItemKey=n.itemsScopeItemKey,a._bootOptions=n.bootOptions;var i=n.itemCacheObservablesFactory;a._currentKOItem=n.currentKOItem,a._currentKOItemSet=n.currentKOItemSet,a.koItem=a._itemCacheDataManager.currentItem,a.koItemSet=a._itemCacheDataManager.currentItemSet,a._shouldUpdateKnockoutData=a.addDisposable(i.pureCompute(a._computeShouldUpdateKnockoutData)),a._shouldUpdateKnockoutData.equalityComparer=B.n,a.selectedKOItemKeys=a.addDisposable(i.pureCompute(a._computeSelectedKOItemKeys)),a.observables.backgroundCompute(function(){if(a._shouldUpdateKnockoutData()){var e=a.koItem();try{a._currentKOItem(e)}catch(e){}}}),a.observables.backgroundCompute(function(){if(a._shouldUpdateKnockoutData()){var e=a.koItemSet();try{a._currentKOItemSet(e)}catch(e){}}}),a._currentView=a.resources.consume(o.l.optional),a._contentTypes=a.addDisposable(i.pureCompute(a._computeContentTypes)),a._contentTypes.equalityComparer=B.e,a._folderContentTypes=a.addDisposable(i.pureCompute(a._computeFolderContentTypes)),a._folderContentTypes.equalityComparer=B.e;var r=a.resources.consume(l.n.optional);return r&&a.observables.backgroundCompute(function(){if(a._shouldUpdateKnockoutData()){var e=a._contentTypes();r(e)}}),a.observables.backgroundCompute(function(){if(a._shouldUpdateKnockoutData()){var e=a.koItemSet();if(e.contentTypes){var t=a._folderContentTypes();e.contentTypes(t)}}}),a._fileHandlerCacheDataSource&&(a._fileHandlerData=a.addDisposable(i.pureCompute(a._computeFileHandlerData)),a._fileHandlerData.equalityComparer=B.n,a.observables.backgroundCompute(function(){if(a._shouldUpdateKnockoutData()){var e=a._fileHandlerData();a._fileHandlerCacheDataSource.setFileHandlerData(e)}})),a._currentItemData=a.addDisposable(i.pureCompute(a._computeCurrentItemData)),a._currentItemData.equalityComparer=B.t,a.observables.backgroundCompute(a._computeOnUpdateCurrentItemData),a}return Object(a.__extends)(t,e),t.prototype._updateSpfxContext=function(e,t){var n,a,i;if(this._listContext&&e&&this._clientSideExtensionHelper)try{var r=this._clientSideExtensionHelper.getApplication();if(r&&"function"==typeof r.navigateToPreloadedData&&t){var o=null===(i=null===(a=null===(n=null==r?void 0:r.context)||void 0===n?void 0:n.pageContext)||void 0===a?void 0:a.list)||void 0===i?void 0:i.id.toString();E.e.normalizeLower(o)!==E.e.normalizeLower(this._listContext.listId)&&r.navigateToPreloadedData(JSON.parse(t))}}catch(e){console.log("Error updating SpfxContext, error "+e)}},t.prototype._getCurrentViewKey=function(e,t){var n=this._itemsScopeItemKey,a=t||Object(D.e)(e,n),i=e.demandItemFacet(g.e,a);return i&&i.viewKey&&S.e.serialize(i.viewKey)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.default.dependencies),{listItemResultProcessor:c.e,currentKOItem:o.o,currentKOItemSet:o.s,itemTaskObserverType:d.resourceKey,listContext:l.o,microServiceDataSource:f.e,microServiceDataSourceStore:p.e,pageContext:l.f,onePageContext:l.u.optional,itemsScopeItemKey:C.e,useItemsScope:O.e,clientSideExtensionHelper:L.e.optional,fileHandlerCacheDataSource:s.m.optional,itemCacheObservablesFactory:T.e,itemCacheDataManager:U.t,bootOptions:V.e}),t}(r.default),W=K,q=Object(i.r)("ItemCacheToKOStoreDataSource.new",K);t.default=W}],Array(29),[function(e,t,n){"use strict";n.r(t);var a=n(0),i=n("knockout-lib"),r=n(1203),o=n(101),s=n(2238),c=n(5053),d=n(1945),l=n(311),u=n(3070),f=n(3122),p=n(2202),m=n(8),_=n(142),h=new m.t({name:"ItemUpdator.key",loader:new _.t(function(){return n.e(460).then(n.bind(null,5782)).then(function(e){return e.resourceKey})})}),b=n(1333),g="new",v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.key="PostUpload",t}return Object(a.__extends)(t,e),t.prototype.projectItemSet=function(e,t,n){var a=this;if(e){var r=t.content.peek().items,c=t.content.peek().groupings,m=[],_=n.group;if(c&&c.length&&c[0].itemGroups&&c[0].itemGroups.length&&!_){var v=c[0].itemGroups[0];v.groupingId===g?_=v:(_={groupingType:v.groupingType,groupingId:g,name:d.b,fieldSchema:v.fieldSchema,startIndex:0,count:0,state:i.observable({isCollapsed:!1}),level:0},c[0].itemGroups=[_].concat(c[0].itemGroups))}var y=[],S=this.resources.consume(s.t);n.uploadedItems.forEach(function(e){if(4!==e.peek().state.upload.status&&3!==e.peek().state.upload.status){var t=S.getItem(e.peek().key);if(t&&t.peek().state.removing&&(e.peek().state.removing=!0),(e=S.setItem(e.peek())).peek().isPlaceholder?m.push(e):e().state.upload.status=2,_&&_.groupingId!==g){var n=r[_.startIndex];if(n&&n.peek())for(var a=_;a&&a.fieldSchema;){var i=a.fieldSchema.Name;e.peek().properties[i]=n.peek().properties[i],a=Object(f.e)(u.default.getParent(a,c[0].itemGroups))}}y.push(e)}});var D=this._calculateNewChildren(r,c,y,_);e.sortField=t.sortField,e.isAscending=t.isAscending,e.schema=t.schema,e.contentTypes=t.contentTypes,e.content({items:D,groupings:c}),e.isPlaceholder=t.isPlaceholder,e.isExpired=t.isExpired,e.version=t.version;var I=this.resources.consume(p.resourceKey),x=this.resources.consume(o.ue);if(m.length>0){var C=m.map(function(e){var t=e.peek();return t.properties.ID||t.properties.uniqueId}),O=x.getCurrentItemKey();I.getSpecifiedItems({parentKey:O,itemKeys:C,recurseInFolders:!1,needToClearParentSmartFiltersInfo:!0}).then(function(e){var t;if(e.children.forEach(function(e){for(var n=0;n<m.length;n++){var a=m[n];if(e.properties.ID===a.peek().properties.ID){e.state.upload.status=2,a(e),e.hasMissingMetadata&&(t||(t=[]),t.push(a));break}}}),t){var n=a.resources.consume(l.e);new(a.managed(n.SelectAction))({showProperties:!0,selectItems:t}).execute(null),a.resources.consume(b.f)&&a.resources.consumeAsync(h).then(function(e){var n=t.map(function(e){return a.observables.peekUnwrap(e)});e.selectItems(n.map(function(e){return e.properties.ID}))})}})}}},t.prototype._calculateNewChildren=function(e,t,n,a){var r=[],o=null,s=t&&t.length&&t[0].itemGroups&&t[0].itemGroups.length,l={},f=s&&t[0].itemGroups;if((!a||a.groupingId===g&&0===a.count)&&(r=n),a){var p=n.length;l[a.groupingId]=p;for(var m=u.default.getParent(a,f);m;)l[m.groupingId]=p,m=u.default.getParent(m,f);if(a.children&&a.children.length>0){var _={groupingType:a.groupingType,groupingId:a.groupingId+"-"+g,name:d.b,fieldSchema:a.children[0].fieldSchema,startIndex:a.startIndex,count:p,state:i.observable({isCollapsed:!1}),level:a.level+1,parentKey:a.groupingId};a.children.unshift(_),a=_}}for(var h=0;h<e.length;h++){var b=e[h],v=c.e.getGroup(t,h);if(a&&v&&v!==o&&(v===a&&(r=r.concat(n)),o=v),b&&b.peek().state.removing&&v){l[v.groupingId]||(l[v.groupingId]=0),l[v.groupingId]-=1;for(var y=u.default.getParent(v,f);y;)l[y.groupingId]||(l[y.groupingId]=0),l[y.groupingId]-=1,y=u.default.getParent(y,f);b.peek().state.removing=!1}else r.push(b)}return s&&(t[0].itemGroups=this._calculateNewGroups(f,l)),r},t.prototype._calculateNewGroups=function(e,t,n){for(var a=[],i=0,r=0;r<e.length;r++){var o=e[r];if(t&&t[o.groupingId]){var s=t[o.groupingId];o.count+=s,s>0&&o.state.peek().isCollapsed&&o.state({isCollapsed:!1})}if(o.count>0){if(0===i)o.startIndex=n?n.startIndex:0;else{var c=a[i-1];o.startIndex=c.startIndex+c.count}o.children&&(o.children=this._calculateNewGroups(o.children,t,o)),a[i++]=o}}return a},t}(r.default);t.default=v}])]);