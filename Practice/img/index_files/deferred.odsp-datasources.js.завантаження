(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-datasources"],{2233:function(e,t,n){"use strict";var a;!function(e){e[e.none=0]="none",e[e.user=1]="user",e[e.distributionList=2]="distributionList",e[e.securityGroup=4]="securityGroup",e[e.sharePointGroup=8]="sharePointGroup",e[e.all=15]="all"}(a||(a={})),t.e=a},2315:function(e,t,n){"use strict";var a,i,r;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),function(e){e[e.regularUser=0]="regularUser",e[e.externalUser=1]="externalUser",e[e.group=2]="group",e[e.application=3]="application",e[e.linkedinUser=4]="linkedinUser"}(a||(a={})),function(e){e.graph="graph",e.sharepointSearch="sharepointSearch",e.substrate="substrate"}(i||(i={})),function(e){e.unified="unifiedGroup",e.securityGroup="securityGroup",e.SPGroup="SPGroup",e.PublicDistributionList="PublicDistributionList",e.family="family"}(r||(r={}))},2372:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(52),i=n(423),r=n(126),o=function(){function e(){}return e.getBatchOperationUrl=function(e,t){return new i.t({webAbsoluteUrl:!e&&t?new r.e(t).authority:e}).build().segment("$batch").toString()},e.processErrorResponse=function(e,t){var n={id:t};if((e=e.error?e.error:e)&&e.code){var a=e.code?e.code.split(","):e.error.code.split(","),i=Number(a[0]),r=e.message.value;n.error={code:i,message:r}}return{items:[n]}},e.getBatchResponseText=function(e){var t,n,a,i=[];if(e.split("\n").length>0&&(t=e.split("\n")[0]),t){n=(e=e.replace(t.trim()+"--","")).split(t);for(var r=1;r<n.length;r++)(a=n[r].split("\n\r")).length>2&&i.push(a[2])}return i},e.processBatchResponse=function(e,t,n){var a,i,r,o,s=[],c=!1;if(e&&e.split("\n").length>0&&(a=e.split("\n")[0]),a){i=(e=e.replace(a.trim()+"--","")).split(a);for(var d=1;d<i.length;d++)if((r=i[d].split("\n\r")).length>2){try{o=JSON.parse(r[2])}catch(e){o=r[2]}var l=t&&t[d-1],u=l?{key:l.key,id:l.id,newId:n?n+"/"+l.name:null}:{};if((o=o.error?o.error:o)&&o.code){var f=o.code?o.code.split(","):o.error.code.split(","),p=Number(f[0]),m=o.message.value;u.error={code:p,message:m},c=!0}s.push(u)}}return{items:s,hasError:c}},e.getBatchContent=function(e,t,n,i){for(var r=[],o=0;o<t.length;o++){for(var s=t[o],c=a.e.generate(),d=[],l=0;l<s.length;l++){var u=s[l];d.push("--changeset_"+c),d.push("Content-Type: application/http"),d.push("Content-Transfer-Encoding: binary"),d.push(""),d.push(n+" "+u+" HTTP/1.1"),d.push(i),d.push("")}d.push("--changeset_"+c+"--");var f=d.join("\r\n");r.push("--batch_"+e),r.push('Content-Type: multipart/mixed; boundary="changeset_'+c+'"'),r.push("Content-Length: "+f.length),r.push("Content-Transfer-Encoding: binary"),r.push(""),r.push(f),r.push("")}return r.push("--batch_"+e+"--"),r.join("\r\n")},e.getBatchContentExtended=function(e,t,n,i,r,o,s){var c=a.e.generate(),d=[];r&&r.length!==t.length&&(r=null);for(var l=0;l<t.length;l++){var u=t[l];d.push("--changeset_"+c),d.push("Content-Type: application/http"),d.push("Content-Transfer-Encoding: binary"),d.push(""),s?d.push(s[l]+" "+u+" HTTP/1.1"):d.push(n+" "+u+" HTTP/1.1"),d.push(i),o&&d.push(o),r&&(d.push(""),d.push(r[l])),d.push("")}d.push("--changeset_"+c+"--");var f=d.join("\r\n");return(d=[]).push("--batch_"+e),d.push('Content-Type: multipart/mixed; boundary="changeset_'+c+'"'),d.push("Content-Length: "+f.length),d.push("Content-Transfer-Encoding: binary"),d.push(""),d.push(f),d.push(""),d.push("--batch_"+e+"--"),d.join("\r\n")},e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose",e.defaultBatchAcceptData="accept: application/json;odata=verbose",e}();t.t=o},2390:function(e,t,n){"use strict";n.d(t,"e",function(){return x});var a=n(0),i=n(2315),r=n(157),o=n(134),s=n(52),c=n(968),d=n(2233),l=n(54),u=n(3342),f=n(729),p=n(387),m=n(3716),_=n(1213),h=n(652),b=n(16),g=n(2765),v=n(79),y=n(379),S={ODB:60307},D=!b.t.isActivated("9e533ba5-9804-4d07-b199-3c62f8065367","04/05/2022","enable substrate search for spo search")&&!o.n.isFeatureEnabled({ECS:1009981}),I=!b.t.isActivated("b7426b02-fdf6-4c5e-9809-e0c21db41db7","07/10/2022","remove hard code graph endpoint and read from spPageContextInfo")&&!o.n.isFeatureEnabled({ECS:1026572}),x=function(e){function t(t,n){var a=this,i=C(t)?t:n.pageContext;a=e.call(this,{dataSourceName:"PeoplePickerDataSource"},{pageContext:i})||this;var r=C(t)?t.apiUrlHelper:n.apiUrlHelper;return a._apiUrlHelper=r||new f.e({},{itemUrlHelper:new p.e({},{pageContext:i}),pageContext:i}),a._capabilities={supportsMruCaching:!0},n&&(a._dataRequestor=n.dataRequestor,a._graphPeoplePickerHelper=n.graphPeoplePickerHelper,a._substratePeoplePickerHelper=n.substratePeoplePickerHelper,a._livePeoplePickerHelper=n.livePeoplePickerHelper,a._getAuthToken=n.getAuthToken),a._webAbsoluteUrl=i.webAbsoluteUrl,a}return Object(a.__extends)(t,e),t.prototype.getCapabilities=function(){return this._capabilities},t.prototype.getPersonaDetails=function(e){var t=this;return l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},a=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,i={personDetails:n(a.Primary),managerChain:a.ManagerChain.results.map(n),directReports:a.DirectReports.results.map(n)};return i.personDetails.profilePage=Object(r.c)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(i.personDetails.sip)+"&origin=ProfileODBCard",i}})})},t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===d.e.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var a=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:a,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})},t.prototype.resolve=function(e,t){var n=this;return l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var r=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:a,additionalHeaders:r,parseResponse:function(e){var a=JSON.parse(e),r=JSON.parse(a.d.ClientPeoplePickerResolveUser),o=[];o[0]=r,r.IsResolved||r.EntityData.IsBlockedOnODB&&"true"===r.EntityData.IsBlockedOnODB.toLowerCase()||(o[0].DisplayText=r.Key);var s=(o=n._transformData(o,t.filterExternalUsers))[0];return t.filterExternalUsers&&s&&s.entityType===i.e.externalUser?(s.isResolved=!1,s.entityType=i.e.regularUser):t.blockViaPolicy&&!t.filterExternalUsers&&s&&!s.isResolved&&0===s.multipleMatches.length&&(s.isResolved=!0,s.isExternal=!0,s.entityType=i.e.externalUser),t.isGraphDistributionList&&t.useGraph&&s.isExternal&&(s.entityType=i.e.group,s.principalType=d.e.distributionList),s}})})},t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();return t&&!this._dataRequestor&&(this._dataRequestor=new _.t({},{})),t},t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();return t&&!this._dataRequestor&&(this._dataRequestor=new _.t({},{})),t},t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper},t.prototype.search=function(e,t){return this.canUseSubstrate(t)||t.useNew3Ssearch?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):(D&&0===t.groupID&&(t.useSubstrateSearch=!0),this.sharePointSearch(e,t))},t.prototype.sharePointSearch=function(e,t){var n=this;return t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1),l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var r=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"ClientPeoplePickerSearchUser",additionalHeaders:r,authToken:a,parseResponse:function(a){var r=t.allowSharePointGroups,o=void 0===r||r,s=t.filterExternalUsers,c=JSON.parse(a),l=JSON.parse(c.d.ClientPeoplePickerSearchUser),u=n._transformData(l,s);return s&&(u=u.filter(function(e){return e.entityType!==i.e.externalUser})),u=u.filter(function(e){return e.principalType===d.e.sharePointGroup?o:e.principalType===d.e.securityGroup?o||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)}),n._handleZeroSearchResult(u,e,t,i.t.sharepointSearch)}})})},t.prototype.subscribePresence=function(e,t){var n=this;try{if(this._ensureSkypePresence(),!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var a=function(e){try{switch(e){default:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7)}}catch(e){}};return this._skypeIntegration.TrackPresence(e,a),{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,a)}catch(e){}}}}catch(e){}return null},t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)},t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}},t.prototype._graphSearch=function(e,n){var a=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(r){var o;if(!r)return a.sharePointSearch(e,n);var s=I&&a._pageContext&&a._pageContext.msGraphEndpointUrl?null===(o=a._pageContext)||void 0===o?void 0:o.msGraphEndpointUrl:"https://graph.microsoft.com",c=new v.t("".concat(s,"/v1.0/me/people"));if(e)if(c.setQueryFromObject({$search:'"'.concat(e,'"'),$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"}),b.t.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&c.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var l=t._getPersonTypeFilter(n);l&&c.setQueryParameter("$filter",l)}return a._dataRequestor.send({apiName:"Graph.PeopleSearch",path:c.toString(),headers:{Authorization:"Bearer "+r,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){if(n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0),!t||!t.value||0===t.value.length){if(O())return a.sharePointSearch(e,n);if(e)return a.sharePointSearch(e,n)}var r=t.value,o=[];return r.forEach(function(e){if(!e.personType.subclass||!a._isIgnorablePeopleSubType(e.personType.subclass)){var t,r=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",s=e.userPrincipalName&&a._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:r,c={Key:s,IsResolved:!1},l="ImplicitContact"===e.personType.subclass,u="OrganizationUser"===e.personType.subclass,f="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,p="PublicDistributionList"===e.personType.subclass,_=Object(m.n)(a._webAbsoluteUrl,r);p&&(t=i.n.PublicDistributionList),f&&(t=i.n.unified);var h={department:e.department,email:r,image:l?void 0:_,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||r,name:e.displayName,providerName:u?"Provider":void 0,userId:s,rawData:c,rawPersonData:c,isExternal:!u,aadObjectId:e.id,fromDataSource:i.t.graph,detailedGroupInfo:t};u?(h.entityType=i.e.regularUser,h.principalType=d.e.user,h.isResolved=!0):f?(h.entityType=i.e.group,h.principalType=d.e.securityGroup,h.isResolved=!1,h.userId=e.id):(h.principalType=p?d.e.distributionList:d.e.none,h.entityType="Group"===e.personType.class?i.e.group:i.e.externalUser,h.isResolved=!1,h.providerName=void 0),h.userId&&o.push(h)}}),a._handleZeroSearchResult(o,e,n,i.t.graph)},function(t){if(Object(h.r)(t))switch(t.status){case 400:case 401:case 403:case 404:return a._graphPeoplePickerHelper.disableGraphCallsForPicker(),a.sharePointSearch(e,n);default:return a.sharePointSearch(e,n)}else"Canceled"!==t.name&&a._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:a.sharePointSearch(e,n)})})},t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(a){if(!a)return n.sharePointSearch(e,t);var r=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(r=t.siteIBSegmentIDs);var c=t.useNew3Ssearch?["Mailbox","Directory","SecurityGroups"]:["Mailbox","Directory"],l={Authorization:"Bearer "+a},f="";if(o.n.isFeatureEnabled(S)){var p=t.useNew3Ssearch?["OrganizationUser","Guest","UniversalSecurityGroup","UnifiedGroup","MailUniversalSecurityGroup","ExchangeSecurityGroup"]:["OrganizationUser","Guest","PublicDistributionList","UnifiedGroup"],_=s.e.isValidGuid(e),h={Or:p.map(function(e){return{Term:{PeopleSubtype:e}}})},g=r?{Or:r.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null,v=_?{Or:{Term:{ExternalDirectoryObjectId:e}}}:null,y=r||_?_?r?{And:[h,g,v]}:{And:[h,v]}:{And:[h,g]}:h;f=JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:c,Query:{QueryString:_?null:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:y}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}})}else f=o.n.isFeatureEnabled(S)&&!b.t.isActivated("0576d3d3-42b4-4c60-a920-0e10e34a19a0","05/13/2021","Pass SiteIBMode to 3S.")?JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:c,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:r?{Or:r.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}}):JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:c,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:r?{Or:r.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}});return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:u.e+"/api/v1/suggestions",headers:l,needsAuthorization:!1,requestType:"POST",postData:f}).then(function(a){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var r=a.Groups[0]?a.Groups[0].Suggestions:[],o=[];return r.forEach(function(e){if(!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var a,r=e.EmailAddresses[0]||e.QueryText||"",s=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:r,c={Key:s,IsResolved:!1},l="ImplicitContact"===e.PeopleSubtype,u="OrganizationUser"===e.PeopleSubtype,f="LinkedIn"===e.PeopleSubtype,p="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,_="PublicDistributionList"===e.PeopleSubtype,h=Object(m.n)(n._webAbsoluteUrl,r);_&&(a=i.n.PublicDistributionList),p&&(a=i.n.unified);var b={department:e.Department,office:e.OfficeLocation,email:r,image:l?void 0:h,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||r,name:e.DisplayName,providerName:"Provider",userId:s,rawData:c,rawPersonData:c,isExternal:!u,detailedGroupInfo:a};u?(b.entityType=i.e.regularUser,b.principalType=d.e.user,b.isResolved=!0):p?(b.entityType=i.e.group,b.principalType=d.e.securityGroup,b.isResolved=!1,b.providerName=void 0):f?b.entityType=i.e.linkedinUser:(b.principalType=_?d.e.distributionList:d.e.none,b.entityType="Group"===e.PeopleType?i.e.group:i.e.externalUser,b.isResolved=!1,b.providerName=void 0),b.userId&&o.push(b)}}),n._handleZeroSearchResult(o,e,t,i.t.substrate)},function(a){return"Canceled"!==a.name&&(n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t)),null})})},t.prototype._handleZeroSearchResult=function(e,t,n,a){if(!O()&&!t)return e;if(!1!==n.resolveEmailIfNoResults&&0===e.length&&this._isValidEmail(t,!1)){var r={Key:t,IsResolved:!1};e.push({email:t,entityType:i.e.externalUser,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:t,name:t,userId:t,rawData:r,rawPersonData:r,isExternal:!0,fromDataSource:a})}return e},t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&g.e.isValidEmailSyntax(e,!1):!t},t._getPersonTypeFilter=function(e){var t="";return e.principalType&d.e.user&&(t+="personType/subclass eq 'OrganizationUser' or personType/subclass eq 'Guest'"),e.principalType&d.e.securityGroup&&(t&&(t+=" or "),t+="personType/subclass eq 'UnifiedGroup'"),e.principalType&d.e.distributionList&&null!==e.filterPublicDistributionList&&e.filterPublicDistributionList!==!b.t.isActivated("18c99317-6e4f-4859-85bf-b127709b6eff","01/28/2022","Include public distribuition list in filter by default")&&(t&&(t+=" or "),t+="personType/subclass eq 'PublicDistributionList'"),t},t.prototype._isIgnorablePeopleSubType=function(e){return!!e&&["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})},t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var a=e.EntityData,r={name:e.DisplayText,email:a.Email,userId:e.Key,job:a.Title,department:a.Department,phone:a.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};r.multipleMatches.length>0&&(r.multipleMatches=n._transformData(r.multipleMatches,t),t&&(r.multipleMatches=r.multipleMatches.filter(function(e){return e.entityType!==i.e.externalUser})));var o=r.email;r.isResolved&&(r.image=o?Object(m.n)(n._webAbsoluteUrl,o):null);var s=a.PrincipalType||e.EntityType;switch(s){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":r.entityType=i.e.externalUser,r.principalType=d.e.user,r.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":case"SecurityGroup":if(!b.t.isActivated("5bcee89c-f8f5-4973-82d2-ab06c37b03e0","1/25/2025","Fix bug: SharePointSearch result principleType of SecurityGroup was treated as user type")||"SecurityGroup"!==s){r.entityType=i.e.group,r.principalType="SharePointGroup"===s?d.e.sharePointGroup:d.e.securityGroup,r.detailedGroupInfo="SharePointGroup"===s?i.n.SPGroup:i.n.securityGroup;break}default:r.entityType=i.e.regularUser,r.principalType=d.e.user}return r})},t}(c.t);function C(e){return!!e.webAbsoluteUrl}function O(){return b.t.isActivated("5e0c0525-2e19-46f6-bac2-a12a29ca4953","04/29/2022","Fix bug: Should correctly handle PrincipalType in Graph query filter.")||y.e.isFeatureEnabled({ECS:1014201})}},2424:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"e",function(){return a});var a,i={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged",canvasFilterChanged:"filtersPane-canvasFilterChanged"};function r(e){return e}!function(e){e[e.none=0]="none",e[e.last3Months=1]="last3Months",e[e.last30Days=2]="last30Days",e[e.last7Days=3]="last7Days",e[e.yesterday=4]="yesterday",e[e.today=5]="today",e[e.tomorrow=6]="tomorrow",e[e.next7Days=7]="next7Days",e[e.next30Days=8]="next30Days",e[e.next3Months=9]="next3Months",e[e.nextYear=10]="nextYear"}(a||(a={}))},2604:function(e,t,n){"use strict";n.r(t),n.d(t,"SiteDataSource",function(){return u});var a=n(0),i=n(1332),r=n(157),o=n(54),s=n(79),c=n(1047),d=n(454);n.d(t,"SiteReadOnlyState",function(){return c.e});var l="SiteDataSource",u=function(e){function t(t,n){var a=e.call(this,{dataSourceName:l,id:"".concat(l,"(").concat(t?t.siteId:"",")")},{pageContext:t})||this;return a.getOAuthToken=n,a}return Object(a.__extends)(t,e),t.prototype.getReadOnlyState=function(){var e=this,t=this.getFullSiteReadOnlyState();return t===c.e.unknown?this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(Object(r.s)(e._pageContext),"/_api/Site/ReadOnly")},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.ReadOnly},qosName:"SiteReadOnly",method:"GET",noRedirect:!0}):o.n.resolve(t!==c.e.notReadOnly)},t.prototype.getFullSiteReadOnlyState=function(){return void 0===this._pageContext.readOnlyState?c.e.unknown:null===this._pageContext.readOnlyState?c.e.notReadOnly:this._pageContext.readOnlyState},t.prototype.getStatusBarInfo=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(Object(r.s)(e._pageContext),"/_api/Site?$select=StatusBarLink,StatusBarText")},parseResponse:function(e){var t=JSON.parse(e);if(!t||!t.d)return{StatusBarText:void 0,StatusBarLinkText:void 0,StatusBarLinkTarget:void 0};var n=t.d.StatusBarLink,a=void 0,i=void 0;if(n){var r=n.split("|");a=r[0];var o=1===r.length?r[0]:r[1];if(0===o.lastIndexOf("http",0)){var c=new s.t(o);i=encodeURI(c.toString())}}return{StatusBarText:t.d.StatusBarText,StatusBarLinkText:a,StatusBarLinkTarget:i}},qosName:"SiteStatusBar",method:"GET",noRedirect:!0})},t.prototype.setClassificationProperty=function(e){var t="".concat(Object(r.s)(this._pageContext),"/_api/Site"),n=JSON.stringify({__metadata:{type:"SP.Site"},Classification:e});return this.dataRequestor.getData({url:t,qosName:"SetClassificationProperty",additionalPostData:n,method:"PATCH"})},t.prototype.setClassificationPropertyAndId=function(e,t){var n="".concat(Object(r.s)(this._pageContext),"/_api/Site"),a=JSON.stringify({__metadata:{type:"SP.Site"},Classification:e,SensitivityLabelId:t});return this.dataRequestor.getData({url:n,qosName:"SetClassificationProperty",additionalPostData:a,method:"PATCH"})},t.prototype.getCanSyncHubSitePermissionsProperty=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(Object(r.s)(t._pageContext),"/_api/Site/CanSyncHubSitePermissions")},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.CanSyncHubSitePermissions},qosName:"GetCanSyncHubSitePermissionsProperty",method:"GET",cachingStrategy:e?d.e.bypassCache:d.e.useCacheAndUpdateInTheBackground,noRedirect:!0})},t.prototype.SyncTeamSiteSettings=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e._pageContext.webAbsoluteUrl,"/_api/sp.TeamChannelManager.SyncTeamSiteSettings")},qosName:"SyncTeamSiteSettings",method:"POST",noRedirect:!0,cachingStrategy:d.e.bypassCache})},t.prototype.GetTeamSiteData=function(){return this.getDataUtilizingPersistentCache({url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/sp.TeamChannelManager.GetTeamSiteData"),qosName:"GetTeamSiteData",parseResponse:function(e){var t=JSON.parse(e);return null==t?void 0:t.d},cachingStrategy:d.e.useCacheAndUpdateInTheBackground,cacheRequestKey:"".concat(this._pageContext.relatedGroupId),method:"POST",noRedirect:!0})},t.prototype.setCanSyncHubSitePermissionsProperty=function(e){var t="".concat(Object(r.s)(this._pageContext),"/_api/Site"),n=JSON.stringify({__metadata:{type:"SP.Site"},CanSyncHubSitePermissions:e});return this.dataRequestor.getData({url:t,qosName:"SetCanSyncHubSitePermissionsProperty",additionalPostData:n,method:"PATCH",noRedirect:!0})},t.prototype.isSiteFeatureEnabled=function(e,t){var n=this,a=t||Object(r.s)(this._pageContext),i="".concat(a,"/_api/site/Features/GetById('").concat(e.toString(),"')");return this.getOAuthToken(a).then(function(e){return n.dataRequestor.getData({url:i,qosName:"GetSPSiteFeatureEnabled",method:"GET",authToken:null!=e?e:void 0,parseResponse:function(e){try{var t=JSON.parse(e);if(t&&t.d&&t.d.DefinitionId)return!0}catch(e){return!1}return!1}})})},t}(i.t);t.default=u},2648:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return b}),n.d(t,"i",function(){return v}),n.d(t,"a",function(){return y});var a,i=n(0),r=n(54),o=n(16),s=n(1332),c=n(3707),d=n(134),l=n(79),u=n(2738),f=n(158),p=n(138),m=n(70),_=n(454),h={links:void 0,name:"",startingNodeKey:"",isAudienceEnabled:!1,isAudienceTargeted:!1,isAudienceAffected:!1};!function(e){e[e.None=0]="None",e[e.TopOrHub=1]="TopOrHub",e[e.QuickLaunch=2]="QuickLaunch"}(a||(a={}));var b=function(e){function t(t,n){var a=e.call(this,{id:"ViewNavDataSource"},{pageContext:t})||this;return a._mapProviderName=n,a._audiencesDataSource=u.e.getInstance(t),a._viewNavCacheKey="viewNavDataSource"+"_".concat(t.aadUserId),a}return Object(i.__extends)(t,e),t.isRelativeUrl=function(e){return!!e&&!/^[a-z0-9+-.]+:\/\//i.test(e)&&-1===e.indexOf("/_layouts/15/groupstatus.aspx?")},t.shouldLinkOpenInSameWindow=function(e){if(!e)return!1;var t=new l.t(e),n=t.getScheme()+"://"+t.getAuthority();return(""===t.getScheme()&&""===t.getAuthority()||n===window.location.origin)&&-1===e.indexOf("/_layouts/15/groupstatus.aspx?")},t.transformNodesToLinks=function(e,n,a){var i=function(e,r){a&&(e=e.filter(function(e){return a(e,r)}));var o=y();return e.map(function(e){var a;return{name:e.Title,key:e.Id.toString(),url:e.Url,onClick:n,isDocLib:e.IsDocLib,links:e.Children&&e.Children.length?i(e.Children,r+1):void 0,audiences:e.AudienceIds||void 0,currentLCID:e.CurrentLCID,openInNewWindow:e.OpenInNewWindow,target:d.n.isFeatureEnabled({ODB:60322})?(null!==(a=e.OpenInNewWindow)&&void 0!==a?a:!t.shouldLinkOpenInSameWindow(e.Url))?"_blank":"_self":o?"":t.shouldLinkOpenInSameWindow(e.Url)?"_self":"_blank"}})};return i(e=e||[],0)},t.getAreaNavigationSettingsUrl=function(e){return"".concat(e.webAbsoluteUrl,"/_layouts/15/AreaNavigationSettings.aspx")},t.prototype.setGlobalNavEnabled=function(e){var t="".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/SetGlobalNavEnabled?isEnabled=").concat(e);return this.dataRequestor.getData({url:t,qosName:"SetGlobalNavEnabled",method:"POST",noRedirect:!0})},t.prototype.getGlobalNavEnabled=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e._pageContext.webAbsoluteUrl,"/_api/navigation/GlobalNavEnabled")},parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.GlobalNavEnabled},qosName:"getGlobalNavEnabled",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._viewNavCacheKey,"_getGlobalNavEnabled")})},t.prototype.setHomeSiteNavEnabled=function(e){var t="".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/homesitesettings"),n={__metadata:{type:"Microsoft.SharePoint.Navigation.REST.HomeSiteNavigationSettings"},IsEnabled:e};return this.dataRequestor.getData({url:t,qosName:"setHomeSiteNavEnabled",method:"PATCH",additionalPostData:JSON.stringify(n),noRedirect:!0})},t.prototype.getHomeSiteNavEnabled=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e._pageContext.webAbsoluteUrl,"/_api/navigation/homesitesettings/isenabled")},parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.IsEnabled},qosName:"getHomeSiteNavEnabled",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._viewNavCacheKey,"_getHomeSiteNavEnabled")})},t.prototype.getGlobalNav=function(e,t,n){var a=this,i=new p.e({name:"GlobalNavigation"}),r="".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/GlobalNav");t&&(r+="?source='".concat(t,"'"));var o={url:r,qosName:"GetGlobalNavigation",parseResponse:function(e){var t=JSON.parse(e);return a._transformToNavLinkGroup(t,!1,i,!0)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1,crossSiteCollectionCall:!0,cachingStrategy:e?_.e.bypassCache:_.e.useCacheIfNotExpired,noRedirect:!0,cacheRequestKey:"".concat(this._viewNavCacheKey,"_getGlobalNav")};return this.getDataUtilizingPersistentCache(o).then(function(e){return a._processGlobalNavNodes(e,n)})},t.prototype.processGlobalNavLKG=function(e,t){var n=new p.e({name:"GlobalNavigationFromLKG"});return this._processGlobalNavNodes(this._transformToNavLinkGroup(e,!1,n,!0),t)},t.prototype.getHomeSiteNav=function(e,n,a,i){var r=this,s=d.n.isFeatureEnabled({ODB:1420}),c=!o.t.isActivated("759873da-625e-430b-a1f4-fb8f101c48db","10/11/2022","Utilize the getCurrentResourcesNav endpoint instead of the getHomeSiteNav endpoint")&&s,l=c?new p.e({name:"GetCurrentResourcesNav"}):new p.e({name:"GetHomeSiteNav"}),u="".concat(this._pageContext.webAbsoluteUrl,c?"/_api/navigation/CurrentResourcesNav":"/_api/navigation/HomeSiteNavigation");e&&(u+="?source='".concat(e,"'")),i&&c&&(u+="".concat(e?"&":"?","includeVivaResources=true"));var f={url:u,qosName:c?"GetCurrentResourcesNav":"GetHomeSiteNav",parseResponse:function(e){var t=JSON.parse(e);return r._transformToNavLinkGroup(t,!1,l,!0)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1,cachingStrategy:a&&c?_.e.bypassCache:_.e.useCacheIfNotExpired,noRedirect:!0,cacheRequestKey:"".concat(this._viewNavCacheKey,"_getCurrentResourcesNav")};return this.dataRequestor.getData(f).then(function(e){return n||v()&&!e||!e.isAudienceEnabled||!e.isAudienceTargeted?e:r._audiencesDataSource.filter("HomeSiteNav",e.links,"links").then(function(n){var a=t.checkIfLinksAffected(e.links,n);return e.links=n||[],e.isAudienceAffected=a,e})})},t.prototype.isNavAudienceTargetedEnabled=function(){var e;return Boolean(0===this._pageContext.webPropertyFlags2||this._pageContext.webPropertyFlags2?this._pageContext.webPropertyFlags2&t.NAV_AUDIENCE_TARGET_FLAG:null===(e=this._pageContext.navigationInfo)||void 0===e?void 0:e.isAudienceTargeted)},t.prototype.getMenuState=function(e){var n=this;void 0===e&&(e={});var a=new p.e({name:"TransformMenuStateToLinkGroup"}),i=e.providerName,r=void 0===i?this._mapProviderName:i,o=e.isGlobalNav,s=e.useCache,d=e.forceRefresh,l=e.menuNodeKey,u=e.maxRetries,m=void 0===u?1:u,b=e.depth,g=void 0===b?3:b,y=e.skipAudienceFiltering,S=e.audienceFilterNodeKey,D=s?"getMenuStateUsingCache":"NavigationGetMenuState",I="";r=r||this._mapProviderName,l?(I+="?menuNodeKey='".concat(l,"'"),r&&(I+="&mapProviderName='".concat(r,"'"))):(o||r)&&(I+="?menuNodeKey=".concat(o?c.t.globalNavParent:""),r&&(I+="&mapProviderName='".concat(r,"'"))),I&&I.length>0&&(I+="&depth='".concat(g,"'"));var x,C={url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/MenuState").concat(I),qosName:D,qosExtraData:{NavProviderName:r},parseResponse:function(e){var t=JSON.parse(e);return n._transformToNavLinkGroup(t,Boolean(y),a)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:m,crossSiteCollectionCall:!0,cachingStrategy:d?_.e.bypassCache:_.e.useCacheAndUpdateInTheBackground,noRedirect:!0};return x=s?this.getDataUtilizingPersistentCache(C).then(function(e){return v()?e:e||h}):this.dataRequestor.getData(C),v()?!y&&this.isNavAudienceTargetedEnabled()?x.then(function(e){return e&&n._isGroupAudienceTargeted(e)?(e.name===c.t.footerNavParent&&e.links&&S&&n._audiencesDataSource.containsAudiences(e.links.filter(function(e){return e.name===S}),"links")&&f.e.logData({name:"FooterNav.AudienceTargeting"}),n._audiencesDataSource.filter("SiteNav",e.links,"links").then(function(t){return e.links=t||[],e})):e}):x:x.then(function(e){return e.isAudienceEnabled&&e.isAudienceTargeted?n._audiencesDataSource.filter("SiteNav",e.links,"links").then(function(n){var a=t.checkIfLinksAffected(e.links,n);return e.links=n||[],e.isAudienceAffected=a,e}):e})},t.checkIfLinksAffected=function(e,t){return g(e)!==g(t)},t.prototype.clearCache=function(){this.flushCache()},t.prototype._transformToNavLinkGroup=function(e,t,n,a){if(!e||!e.Nodes||0===e.Nodes.length)return n.end({resultType:m.e.ExpectedFailure,error:"getMenuState empty MenuState"}),v()?void 0:h;try{var i=this._getLinksFromNodes(e.Nodes,e.FriendlyUrlPrefix),r={isAudienceEnabled:!v()&&!t&&(a?e.IsAudienceTargetEnabledForGlobalNav:this.isNavAudienceTargetedEnabled()),isAudienceTargeted:(v()||!t)&&this._audiencesDataSource.containsAudiences(i,"links"),isAudienceAffected:!1,name:e.StartingNodeTitle||"",links:i,startingNodeKey:e.StartingNodeKey};return n.end({resultType:m.e.Success}),r}catch(e){return n.end({resultType:m.e.Failure,error:e?e.toString():"getMenuState failed"}),v()?void 0:h}},t.prototype._processGlobalNavNodes=function(e,n){return n||v()&&!e||!e.isAudienceEnabled||!e.isAudienceTargeted?r.n.resolve(e):this._audiencesDataSource.filter("GlobalNav",e.links,"links").then(function(n){var a=t.checkIfLinksAffected(e.links,n);return e.links=n||[],e.isAudienceAffected=a,e})},t.prototype._getLinksFromNodes=function(e,n){var a=this,i=function(e,r,o){e=e.filter(function(e){return e.Key!==c.t.quickLaunchRecent&&-1===e.Key.indexOf("SPNavigationNodeId=".concat(c.t.quickLaunchRecent))&&!e.IsDeleted&&!e.IsHidden});var s=o?o+"/":"";return e.map(function(e){var o,c,l=r&&s+r.FriendlyUrlSegment,u=a._getUrl(e,!!r,n,l),f=e.CustomProperties?a._getCustomPropertyValue(e.CustomProperties,"Target"):void 0,p="_blank"===f||null!==f&&void 0,m=d.n.isFeatureEnabled({ODB:60322}),_=m?(null!==(c=null!==(o=e.OpenInNewWindow)&&void 0!==o?o:p)&&void 0!==c?c:!t.shouldLinkOpenInSameWindow(u))?"_blank":"_self":(null!=p?p:!t.shouldLinkOpenInSameWindow(u))?"_blank":"_self";return{name:e.Title,url:u,key:e.Key,ariaLabel:e.Title,isExpanded:!1,hasChildLinks:e.CustomProperties?"True"===a._getCustomPropertyValue(e.CustomProperties,"HasChildNodes"):void 0,target:_,links:e.Nodes&&e.Nodes.length?i(e.Nodes,e,l):void 0,audiences:e.AudienceIds&&e.AudienceIds.length>0?e.AudienceIds:void 0,currentLCID:e.CurrentLCID,openInNewWindow:m?e.OpenInNewWindow:void 0}})};return i(e||[])},t.prototype._getCustomPropertyValue=function(e,t){for(var n=e.length-1;n>0;n--)if(e[n].Key===t)return e[n].Value;return""},t.prototype._getUrl=function(e,t,n,a){return e.SimpleUrl?e.SimpleUrl:(e.NodeType===c.e.FriendlyUrl&&e.FriendlyUrlSegment&&(i=(i=t?n+((a?"/".concat(a):"")+"/".concat(e.FriendlyUrlSegment)):n+e.FriendlyUrlSegment).replace("//","/")),i);var i},t.prototype._isGroupAudienceTargeted=function(e){return!!e.isAudienceTargeted||!(e.name!==c.t.footerNavParent||!e.links)&&this._audiencesDataSource.containsAudiences(e.links,"links")},t.NAV_AUDIENCE_TARGET_FLAG=8388608,t}(s.e);function g(e){if(!e)return 0;for(var t=e.length,n=0,a=e;n<a.length;n++)t+=g(a[n].links);return t}function v(){return o.t.isActivated("1cd2d1c9-fdc8-4110-a71e-e8125063dd90","2020-09-01","Refine the audience targeting logging")}function y(){return o.t.isActivated("7487a3f0-e21c-4b2f-9383-9337f1b30e6f","08/23/2022","Open all same-origin urls in the current tab and all external urls in a new tab unless OpenInNewWindow is set")}t.n=b},2664:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a="role:1073741827",i="role:1073741826",r="role:1073741829",o="role:1073741830"},2738:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(5491),r=n(54),o=n(52),s=n(16),c=n(138),d=n(227),l=function(){function e(e){var t=this;this._getDataFromAPI=function(e,n){var a={url:e,qosName:n?"getUserMembershipsForAudienceTargeting.".concat(n):"getUserMembershipsForAudienceTargeting",cacheRequestKey:t._cacheRequestKey,parseResponse:function(e){return e&&JSON.parse(e).value||[]},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1};return t._dataRequestor.getData(a)},this._logCacheQoS=function(e,t,n){return new c.e({name:e}).end({name:e,resultType:t,extraData:n})},this._pageContext=e,this._dataRequestor=new d.e({qosName:"AudiencesDataSource"},{pageContext:e}),this._cacheRequestKey=e.aadUserId||e.userLoginName,this._audienceTargetComponent=i.e.getInstance(this._getDataFromAPI,this._logCacheQoS)}return e.getInstance=function(t){var n=t.aadUserId||t.userLoginName;return e._instances[n]||(e._instances[n]=new e(t)),e._instances[n]},e.prototype.containsAudiences=function(e,t){if(!e)return!1;if(e.filter(u).length>0)return!0;if(t)for(var n=0,a=e;n<a.length;n++){var i=a[n];if(this.containsAudiences(i[t],t))return!0}return!1},e.containsAudienceTargetedNode=function(e){var t=this;return!!e&&(e.filter(u).length>0||e.filter(function(e){return t.containsAudienceTargetedNode(e.links)}).length>0)},e.prototype.filter=function(e,t,n){var a=s.t.isActivated("845880ed-07f0-4103-bef6-d3d7779183b5");return r.n.resolve(this._audienceTargetComponent.filter(f(),this._cacheRequestKey,this._pageContext.webAbsoluteUrl,e,t,n,!a))},e.prototype.filterWithMembership=function(e,t,n){return this._audienceTargetComponent.filterWithMembership(e,t,n)},e.filterLinksWithMemberships=function(t,n){return e._filterRecursively(new Set(n),t,function(e){return e.links},function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{links:t})})},e.getGroupObjectId=function(e){return e.userId&&e.userId.length>=36?e.userId.substr(e.userId.length-36):void 0},e.prototype.getCurrentUserMemberships=function(e){var t=this._pageContext.webAbsoluteUrl;return window&&window.location&&window.location.origin&&-1===t.indexOf(window.location.origin)&&(t=window.location.origin),r.n.resolve(this._audienceTargetComponent.getCurrentUserMemberships(f(),this._cacheRequestKey,t,e))},e._filterRecursively=function(t,n,a,i){if(!n)return n;var r=n.filter(function(e){var n;return!u(e)||(null===(n=e.audiences)||void 0===n?void 0:n.some(function(e){return t.has(e)}))});return a&&i&&(r=r.map(function(n){var r=a(n),o=e._filterRecursively(t,r,a,i);return i(n,o)})),r},e._instances={},e}();function u(e){return!!(e.audiences&&e.audiences.length>0&&e.audiences[0]!==o.e.Empty)}function f(){return s.t.isActivated("c3d89da1-4105-4818-9cd3-f4a8b4ad9016")}},2863:function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n(686),i=void 0;function r(e){if(void 0===i)for(var t in i={},a.e){var n=parseInt(t);if(!isNaN(n)){var r=a.e[n].toLowerCase();i[r]=n}}var o=e?e.toLowerCase():"";return i[o]||a.e.unknown}t.e=a.e},3070:function(e,t,n){"use strict";var a;n.r(t),function(e){function t(e){var t,n="";switch(e.fieldSchema.Type){case"User":case"Lookup":n=e.name;break;case"DateTime":var a=decodeURIComponent(e.groupString).split(";#"),i=a[0];a.length>0&&(a=a.slice(1,a.length-1))[e.level]&&(i=a[e.level]),n=(t=i)?[t.substring(0,4),"-",t.substring(4,6),"-",t.substring(6,8)].join(""):t;break;default:n=e.fieldValue}return n}e.getParent=function(e,t){if(e.level&&e.parentKey&&0!==e.level)return t.filter(function(t){return t.groupingId===e.parentKey})[0]},e.getFilterDetails=function(n,a){for(var i=n,r=[],o=[];i&&i.fieldSchema;){r.unshift(i.fieldSchema.Name);var s=t(i);o.unshift(s),i=e.getParent(i,a)}return{fields:r,values:o}}}(a||(a={})),t.default=a},3265:function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"t",function(){return m});var a=n(54),i=n(134),r=n(70),o=n(138),s=n(226),c=n(113),d=n(16),l={ODB:387},u="https://graph.microsoft.com",f="DisableGraph",p=!d.t.isActivated("f70d9a82-9e0b-4ab4-8337-221f328b5181","10/19/2022","enable crossdomain fetch graph token")&&!i.n.isFeatureEnabled({ECS:1047773}),m=function(){function e(e,t){var n=this;this._getOauthProviderGetTokenPromise=function(){return n._oAuthTokenProvider?n._oAuthTokenProvider.getToken(u):null},this._getTokenReturnPromise=function(e,t,i,o){return e.then(function(e){return i.end({resultType:r.e.Success}),e},function(e){var s=o?o():null;return s?n._getTokenReturnPromise(s,"oAuthTokenProvider.getToken",i):a.n.isCanceled(e)?(i.end({resultType:r.e.ExpectedFailure,resultCode:"Canceled"}),a.n.reject(e)):(i.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:r.e.Failure,extraData:{serverErrorCode:e._serverErrorCode,message:e.message,providerName:t}}),n.disableGraphCallsForPicker(),null)})},this._pageContext=t.pageContext,this._sharingContextInformation=t.sharingContextInformation,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken),this.initializeDataStore()}return e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&(!p||!this._pageContext.getAuthToken)&&this._pageContext.authToken)return!1;var e=this._pageContext&&(this._oAuthTokenProvider||p&&this._pageContext.getAuthToken)&&i.n.isFeatureEnabled(l);return this._dataStore&&(e=e&&!this._dataStore.getValue(f,c.e.session)),e},e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue(f,!0,c.e.session)},e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return a.n.resolve(this._graphToken);if(p){var t=new o.e({name:"PeoplePicker.GetGraphToken"});if(this._pageContext&&this._pageContext.getAuthToken)return this._getTokenReturnPromise(this._pageContext.getAuthToken("ms-graph",this._pageContext.msGraphEndpointUrl?this._pageContext.msGraphEndpointUrl:"https://graph.microsoft.com"),"pageContext.getAuthToken",t,this._getOauthProviderGetTokenPromise);if(this._oAuthTokenProvider)return this._getTokenReturnPromise(this._oAuthTokenProvider.getToken(u),"oAuthTokenProvider.getToken",t)}else if(this._oAuthTokenProvider){var n=new o.e({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken(u).then(function(e){return n.end({resultType:r.e.Success}),e},function(t){return a.n.isCanceled(t)?(n.end({resultType:r.e.ExpectedFailure,resultCode:"Canceled"}),a.n.reject(t)):(n.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:r.e.Failure,extraData:{serverErrorCode:t._serverErrorCode,message:t.message}}),e.disableGraphCallsForPicker(),null)})}return null},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new s.e("PeoplePicker",c.e.session))},e}()},3268:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return a}),n.d(t,"i",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"a",function(){return c});var a,i=n(4452),r="metadatasearchfield";!function(e){e[e.Text=0]="Text",e[e.DateRange=1]="DateRange",e[e.Date=2]="Date",e[e.PeoplePicker=3]="PeoplePicker",e[e.ContentType=4]="ContentType",e[e.Boolean=5]="Boolean",e[e.Currency=6]="Currency",e[e.Number=7]="Number",e[e.TextMultiple=8]="TextMultiple",e[e.Dropdown=9]="Dropdown",e[e.Percentage=10]="Percentage",e[e.ManagedMetadata=11]="ManagedMetadata"}(a||(a={}));var o=[{key:"inclusion",text:i.n,selected:!0},{key:"exclusion",text:i.a}];function s(e){var t=[{displayName:i.o,fieldType:a.Text,isSystemField:!0},{displayName:i.i,fieldType:a.Text,isSystemField:!0,kqlProperty:"Filename"},{displayName:i.u,fieldType:a.PeoplePicker,isSystemField:!0,kqlProperty:"People"},{displayName:i.s,fieldType:a.DateRange,isSystemField:!0,kqlProperty:"LastModifiedTime"},{displayName:i.r,fieldType:a.Dropdown,isSystemField:!0,kqlProperty:"FileType",choices:[{key:"powerpoint",text:i.p,data:{iconName:"pptx"}},{key:"word",text:i._,data:{iconName:"docx"}},{key:"excel",text:i.t,data:{iconName:"xlsx"}},{key:"pdf",text:i.l,data:{iconName:"pdf"}},{key:"photo",text:i.f,data:{iconName:"photo"}},{key:"video",text:i.m,data:{iconName:"video"}},{key:"other",text:i.d,data:{iconName:"genericfile"}}]},{displayName:i.e,fieldType:a.ContentType,isSystemField:!0,kqlProperty:"ContentTypeId"}],n=t;return e&&(n=t.filter(function(e){return"Filename"!==e.kqlProperty&&"FileType"!==e.kqlProperty})),n.forEach(function(e,t){e.fieldId=t}),n}function c(e,t){return t||/^0x012000.{32}$/i.test(e)||/^0x010100.{32}$/i.test(e)||/^0x01010400.{32}$/i.test(e)}},3318:function(e,t,n){"use strict";n.d(t,"e",function(){return P}),n.d(t,"t",function(){return T});var a,i=n(0),r=n(5568),o=n(387),s=n(729),c=n(968),d=n(4216);!function(e){e[e.unknown=0]="unknown",e[e.prefetch=1]="prefetch",e[e.hostapp=2]="hostapp",e[e.api=3]="api"}(a||(a={}));var l=n(5565),u=n(5566),f=n(5567),p=n(2863),m=n(5173),_=n(5174),h=n(5569),b=n(5570),g=n(5559),v=n(157),y=n(189),S=n(4818),D=n(85),I=n(72),x=n(3716),C=n(16),O=n(1211),w=n(2664),E=n(1354),A=n(379),L=n(134),k=!C.t.isActivated("48d0bf6b-2e41-42a8-a3a3-e8d2ef405dbb","7/14/2022","better error handling"),M=!C.t.isActivated("4d79eceb-84fd-45bc-af6c-c5946827a170","10/12/2022","ask shareLink to return nav in copy link instead of adding it on the client side")&&!A.e.isFeatureEnabled({ECS:1046652})&&L.n.isFeatureEnabled({ODB:17494}),P=function(e){function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var a=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;a._getParentListId=t.getParentListId,a._itemUrlHelper=t.itemUrlHelper||new o.e({},{pageContext:t.pageContext}),a._apiUrlHelper=t.apiUrlHelper||new s.e({},{pageContext:t.pageContext,itemUrlHelper:a._itemUrlHelper}),a._sharingContextInformation=t.sharingContextInformation||void 0,a._sharingDataSourceHelper=new S.e({itemUrlHelper:a._itemUrlHelper,sharingContextInformation:a._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=Object(v.s)(a._pageContext);return a._shareUrl=i+"/_api/SP.Web.ShareObject",a}return Object(i.__extends)(t,e),t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})},t.parseSharingRole=function(e){switch(e){case 0:return d.e.None;default:return d.e.View;case 2:return d.e.Edit;case 6:return d.e.Review}},t.prototype.getSharingInformation=function(e,t,n,i,r,o){var s,c=this,d=(i=i||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),l="pickerSettings";return t&&(l+=",permissionsInformation"),n&&(l+=",sharingLinkTemplates"),r&&(l+=",addressBarLinkSettings"),s=d.oDataParameter("$Expand",l).toString(),this.getData(function(){return s},function(t){var n=JSON.parse(t),i=c._parseGetSharingInformationResponse(n,e);return i.getSharingInformationSources=a.api,i},"GetSharingInformation",null,"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&N(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":"WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))}:null,null,null,!0,void 0,void 0,this._getExtraData(),o)},t.prototype.emailWithoutPermissioning=function(e,n,a,i){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return r},function(e){var a=JSON.parse(e).d,i=[];a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n&&n.id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,r=e;n<r.length;n++){var o=r[n];t.push(o.rawPersonData)}var s={peoplePickerInput:JSON.stringify(t),emailBody:a,emailSubject:i};return JSON.stringify(s)})},t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);return t.d?t.d.CheckPermissions.results:null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})},t.prototype.share=function(e,n){var a,i=this,r=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(n.linkType===l.e.Organization||n.linkType===l.e.Edit||n.linkType===l.e.View)return this._shareLink(e,n);if(r){var o=n.items[0],s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,o,this._getParentListId(o));a=s.segment("ShareObject").toString()}else a=this._shareUrl;return this.getData(function(){return a},function(e){var a=JSON.parse(e).d,i=[];Object(E.e)()&&window.sessionStorage.setItem("Share_Response",JSON.stringify(a)),a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n.items[0]&&n.items[0].id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"Share",function(){for(var t=[],a=0;a<e.length;a++){var o=e[a];t.push(o.rawPersonData)}n.roleValue===d.e.Edit.toString()?n.roleValue=w.e:n.roleValue===d.e.View.toString()&&(n.roleValue=w.a);var s={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};return r||(s.url=i._sharingDataSourceHelper.getFileUrl(n.items[0])),Object(E.e)()&&window.sessionStorage.setItem("Share_Payload",JSON.stringify(s)),JSON.stringify(s)})},t.prototype.updatePermissions2=function(e,t,n){var a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case u.e.none:case u.e.view:case u.e.review:case u.e.edit:case u.e.owner:t=n;break;default:t=u.e.view}var a={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(a)})},t.prototype.updatePermissionsMultiple=function(e,t,n,a,i){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case u.e.none:t=0;break;case u.e.view:t=1;break;case u.e.review:t=6;break;case u.e.edit:t=2;break;default:t=1}var r={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:a,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})},t.prototype.parseRawSharingInformation=function(e,t){return this._parseGetSharingInformationResponse(e,t)},t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})},t.prototype.shareLink=function(e){var t=this,n=e.settings,a=e.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(a)).segment("ShareLink").toString(),o={};return this._sharingContextInformation&&(this._sharingContextInformation.listId&&N(this._sharingContextInformation.listId.slice(1,-1))&&(o["X-SP-REQUESTRESOURCES"]="WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))),this._sharingContextInformation&&this._sharingContextInformation.enableFallbackShareLink&&(o.Prefer="DirectUrlWithShareToken")),this.getData(function(){return i},function(e){var t=JSON.parse(e);return t.d?(Object(E.e)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(t.d)),T(t)):t.error?{error:f.t.generic,errorMessage:t.error.message}:void 0},"ShareLink",function(){var a=null;n.expiration&&(a=Object(r.e)(n.expiration.toString()));var i=null;if(e.recipients&&e.recipients.length>0){i=[];for(var o=0,s=e.recipients;o<s.length;o++){var c=s[o];c.rawPersonData&&i.push(c.rawPersonData)}}var d=null;if(n.inviteesToRemove&&n.inviteesToRemove.length>0){d=[];for(var l=0,u=n.inviteesToRemove;l<u.length;l++){var f=u[l];d.push({id:f.id,loginName:f.loginName,name:f.primaryText,isExternal:f.isExternal,principalType:f.type,email:f.email})}}var p={request:{createLink:!!n.createLink,settings:{allowAnonymousAccess:n.allowAnonymousAccess,trackLinkUsers:n.trackLinkUsers,linkKind:n.sharingLinkKind,expiration:a,role:n.role,restrictShareMembership:n.restrictShareMembership,updatePassword:n.updatePassword,password:n.password,shareId:n.shareId,description:n.description,scope:n.scope}}};if(t._sharingContextInformation&&t._sharingContextInformation.navId&&t._sharingContextInformation.optInSendNavIdInShareLink&&M&&(p.request.settings.nav=t._sharingContextInformation.navId),d&&(p.request.settings.inviteesToRemove={results:d}),i&&i.length>0){p.request.peoplePickerInput=JSON.stringify(i);var m=e.emailData,_=e.emailSubject;void 0!==m&&void 0===_&&(p.request.emailData={body:e.emailData,subject:""}),void 0===m&&void 0!==_&&(p.request.emailData={body:"",subject:e.emailSubject}),void 0!==m&&void 0!==_&&(p.request.emailData={body:e.emailData,subject:e.emailSubject})}var h=e.settings.shareId;h&&(p.request.settings.shareId=h,p.request.emailData={body:""});var b=JSON.stringify(p);return Object(E.e)()&&window.sessionStorage.setItem("ShareLink_Payload",b),b},"POST",0!==Object.keys(o).length?o:null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(k)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:f.t.generic,debugErrorMessage:t}})},t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})},t.prototype.shareLinkExpress=function(e,t,n){var a=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e);return t.d?U(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:f.t.generic,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(k)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:f.t.generic,debugErrorMessage:t}})},t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(Object(O.e)(this._pageContext))return p.e.sharePoint;switch(e){case I.t.teamSite:case I.t.group:case I.t.subgroup:case I.t.sitePagePublishing:return p.e.sharePoint;case I.t.mySite:return p.e.odb;default:return p.e.sharePoint}},t.prototype._shareLink=function(e,t){var n=this,a=t.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a)).segment("ShareLink").toString();return this.getData(function(){return i},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var a=[],i=0,o=e;i<o.length;i++){var s=o[i];a.push(s.rawPersonData)}var c=null;t.expiration&&(c=Object(r.e)(t.expiration));var d={request:{peoplePickerInput:JSON.stringify(a),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:c}};return JSON.stringify(d)})},t.prototype._getSharingLinkKind=function(e,t){var n=m.e.direct;return e===l.e.Edit?n=m.e.anonymousEdit:e===l.e.View?n=m.e.anonymousView:e===l.e.Organization&&(n=t===d.e.Edit.toString()?m.e.organizationEdit:m.e.organizationView),n},t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:f.t.generic,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0,userPhotoCdnBaseUrl:void 0,permissionsInformation:void 0,sensitivityLabelInformation:void 0};var n=e.d,a=n.userPhotoCdnBaseUrl,r=n.permissionsInformation,o=!!r,s=!!n.sharingLinkTemplates,c=o,d=!!n.addressBarLinkSettings,l=o?this._parseSharingLinks(r.links.results,n.directUrl,a):[],u=s?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results,a):[],p=d?n.addressBarLinkSettings:null,b=[];if(o){var g=r.siteAdmins.results,v=r.principals.results,S=this._parseSharingPrincipals(g,void 0,a);S.forEach(function(e){return e.isSiteAdmin=!0});var I=this._parseSharingPrincipals(v,void 0,a);b=S.concat(I)}var x=this._getDefaultSharingLink(n.defaultLinkKind,n.defaultShareLinkScope,l,n.sharingAbilities),C={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var O=t.properties,w=O.ItemChildCount?parseInt(O.ItemChildCount,10):0,A=O.FolderChildCount?parseInt(O.FolderChildCount,10):0,L=t.type===y.t.OneNote?0:w+A,k=this._isPolicyTipFlagSet(t.policyTip,D.a.blockSharing);C={name:t.name,childCount:L,hasDlpPolicy:k,extension:t.extension,appmap:t.appMap,itemType:t.type}}var M=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||l.length>1,P={anonymousLinkExpirationRestrictionDays:0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:n.anyoneLinkTrackUsers,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:M,defaultSharingLink:x,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!c&&n.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(l,b),item:C,sharingLinks:l,sharingPrincipals:b,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,defaultShareLinkScope:n.defaultShareLinkScope,directLink:{allowsAnonymousAccess:!1,audience:_.e.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:m.e.direct,sharingScope:h.e.existing,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:u,addressBarLinkSettings:p,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,siteIBMode:n.siteIBMode,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering,enforceSPOSearch:!!n.enforceSPOSearch,outlookEndpointHostUrl:n.outlookEndpointHostUrl?n.outlookEndpointHostUrl:null,webUrl:n.webUrl?n.webUrl:null,isStubFile:!!n.isStubFile&&n.isStubFile,userPhotoCdnBaseUrl:n.userPhotoCdnBaseUrl,permissionsInformation:n.permissionsInformation,sensitivityLabelInformation:n.sensitivityLabelInformation},T=window.sessionStorage.getItem("Get_Sharing_Information");if(Object(E.e)()&&T&&Object.keys(T).length>0){var U=JSON.parse(T);return Object(i.__assign)(Object(i.__assign)({},P),U)}return P},t.prototype._computeIsShared=function(e,t){for(var n=!1,a=0,i=e;a<i.length;a++){var r=i[a];r.isActive&&r.sharingLinkKind!==m.e.direct&&(n=!0)}return n||(n=t.length>0),n},t.prototype._parseSharingLinks=function(e,t,n){var a=this,i=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t,i=e.linkDetails;return t=void 0!==i.Scope&&i.Scope!==h.e.uninitialized?H(i.LinkKind,i.Scope):F(i.LinkKind,i.AllowsAnonymousAccess,i.RestrictedShareMembership),{allowsAnonymousAccess:i.AllowsAnonymousAccess,hasPassword:i.RequiresPassword,blockDownload:i.BlocksDownload,description:i.Description,audience:t,expiration:i.Expiration?new Date(i.Expiration):null,isActive:i.IsActive,isEdit:R(i.LinkKind)||i.IsEditLink,isReview:i.IsReviewLink,isManageList:i.IsManageListLink,principals:a._parseSharingPrincipals(e.linkMembers.results,i.LinkKind,n),invitees:a._parseLinkInvitees(i,n),shareId:i.ShareId,sharingLinkKind:i.LinkKind,sharingScope:i.Scope,url:i.Url,updatePassword:i.UpdatePassword,password:i.Password,passwordLastModifiedBy:a._parseSharingPrincipal(i.PasswordLastModifiedBy,n),isCreateOnlyLink:i.IsCreateOnlyLink,isAddressBarLink:i.IsAddressBarLink,isUnhealthy:i.IsUnhealthy,status:i.SharingLinkStatus,created:i.Created,trackLinkUsers:i.TrackLinkUsers}});return(i=i.sort(function(e,t){return a._getLinkRanking(t)-a._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:_.e.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:m.e.direct,sharingScope:h.e.specificPeople,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null}),i},t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case _.e.anyone:t+=30;break;case _.e.organization:t+=20;break;case _.e.specificPeopleFlex:t+=10}return e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1),t},t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case b.e.anyone:t+=30;break;case b.e.organization:t+=20;break;case b.e.specificPeople:t+=10}switch(e.role){case u.e.edit:t+=3;break;case u.e.review:t+=2;break;case u.e.view:t+=1}}return t},t.prototype._parseSharingLinkTemplates=function(e,t){var n=this;return e.map(function(e){var a,i,r=e.linkDetails;null!==r&&(i=void 0!==r.Scope&&r.Scope!==h.e.uninitialized?H(r.LinkKind,r.Scope):F(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership),a={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:i,expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:R(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:n._parseLinkInvitees(r,t),shareId:r.ShareId,sharingLinkKind:r.LinkKind,sharingScope:r.Scope,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:n._parseSharingPrincipal(r.PasswordLastModifiedBy,t)});return{linkDetails:a,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}}).sort(function(e,t){return n._getSharingLinkTemplateRanking(t)-n._getSharingLinkTemplateRanking(e)})},t.prototype._parseLinkInvitees=function(e,t){var n=this,a=e.Invitations;if(!a)return[];for(var i=[],r=0,o=a.results;r<o.length;r++){var s=o[r];s&&s.invitee&&i.push(s.invitee)}return i.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:Object(x.n)(n._pageContext.webAbsoluteUrl,e.email,t)}})},t.prototype._parseSharingPrincipals=function(e,t,n){var a=this,i=e.map(function(e){var i=e.principal;i||(i=e);var r={id:i.id,isExternal:i.isExternal,loginName:i.loginName,primaryText:i.name,role:e.role,secondaryText:i.jobTitle,type:i.principalType,imageUrl:Object(x.n)(a._pageContext.webAbsoluteUrl,i.email,n),email:i.email};return t&&(r.sharingLinkKind=t),r});return S.e.getUniqueSharingPrincipals(i)},t.prototype._getExtraData=function(){var e;return this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:g.e[this._sharingContextInformation.mode]}),e},t.prototype._parseSharingPrincipal=function(e,t){if(e){var n=e.principal;return n||(n=e),{id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:Object(x.n)(this._pageContext.webAbsoluteUrl,n.email,t),email:n.email}}return null},t.prototype._getDefaultSharingLink=function(e,t,n,a){a.peopleSharingLinkAbilities&&(a.peopleSharingLinkAbilities.canManageEditLink.enabled||a.peopleSharingLinkAbilities.canManageReadLink.enabled)&&e===m.e.direct&&(e=m.e.flexible);var i=e,r=t;a.anyoneLinkAbilities?(i!==m.e.anonymousEdit||a.anyoneLinkAbilities.canManageEditLink.enabled||(i=m.e.anonymousView),i!==m.e.anonymousView||a.anyoneLinkAbilities.canManageReadLink.enabled||(i=m.e.organizationEdit),r!==h.e.anyone||a.anyoneLinkAbilities.canManageReadLink.enabled||a.anyoneLinkAbilities.canManageReadLink.enabled||(r=h.e.organization)):(i!==m.e.anonymousEdit||a.anonymousLinkAbilities.canManageEditLink.enabled||(i=m.e.anonymousView),i!==m.e.anonymousView||a.anonymousLinkAbilities.canManageReadLink.enabled||(i=m.e.organizationEdit),r!==h.e.anyone||a.anonymousLinkAbilities.canManageReadLink.enabled||a.anonymousLinkAbilities.canManageReadLink.enabled||(r=h.e.organization)),a.organizationLinkAbilities&&(i!==m.e.organizationEdit||a.organizationLinkAbilities.canManageEditLink.enabled||(i=m.e.organizationView),i!==m.e.organizationView||a.organizationLinkAbilities.canManageReadLink.enabled||(i=m.e.direct),r!==h.e.organization||a.organizationLinkAbilities.canManageReadLink.enabled||a.organizationLinkAbilities.canManageEditLink.enabled||(r=h.e.specificPeople)),a.peopleSharingLinkAbilities&&(r!==h.e.specificPeople||a.peopleSharingLinkAbilities.canManageReadLink.enabled||a.peopleSharingLinkAbilities.canManageEditLink.enabled||(r=h.e.existing));var o=void 0;return e===m.e.anonymousEdit||e===m.e.anonymousView?o=_.e.anyone:e===m.e.organizationEdit||e===m.e.organizationView?o=_.e.organization:e===m.e.direct?o=_.e.specificPeople:e===m.e.flexible&&(o=_.e.specificPeopleFlex),{allowsAnonymousAccess:void 0,audience:o,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:i,sharingScope:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}},t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t},t}(c.t);function T(e){if(e.d)return U(e.d.ShareLink.sharingLinkInfo)}function U(e){var t;t=void 0!==e.Scope&&e.Scope!==h.e.uninitialized?H(e.LinkKind,e.Scope):F(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:R(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,sharingScope:e.Scope,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function F(e,t,n){return e===m.e.anonymousEdit||e===m.e.anonymousView?_.e.anyone:e===m.e.organizationEdit||e===m.e.organizationView?_.e.organization:e===m.e.direct?_.e.specificPeople:e===m.e.flexible?t?_.e.anyone:!1===n?_.e.organization:_.e.specificPeopleFlex:void 0}function H(e,t){return e===m.e.anonymousEdit||e===m.e.anonymousView?_.e.anyone:e===m.e.organizationEdit||e===m.e.organizationView?_.e.organization:e===m.e.direct?_.e.specificPeople:e===m.e.flexible?t==h.e.anyone?_.e.anyone:t===h.e.organization?_.e.organization:_.e.specificPeopleFlex:void 0}function R(e){return e===m.e.anonymousEdit||e===m.e.organizationEdit||e!==m.e.anonymousView&&e!==m.e.organizationView&&null}function N(e){return"{"===e[0]&&(e=e.substring(1,e.length-1)),/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(e)&&"00000000-0000-0000-0000-000000000000"!=e}},3342:function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"t",function(){return p});var a=n(54),i=n(138),r=n(70),o=n(1213),s=n(226),c=n(113),d=n(134),l="DisableSubstrateSearch",u="https://outlook.office.com/search",f={ODB:1286},p=function(){function e(e,t){this._dataRequestor=new o.e({},{}),this._pageContext=t.pageContext,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken),this.initializeDataStore()}return e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;return this._pageContext&&!this._pageContext.isSPO||this._pageContext&&this._pageContext.authToken||(this._pageContext&&this._oAuthTokenProvider&&d.n.isFeatureEnabled(f)&&(e=!0),this._dataStore&&(e=e&&!this._dataStore.getValue(l,c.e.session))),e},e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue(l,!0,c.e.session)},e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return a.n.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new i.e({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(u).then(function(e){return t.end({resultType:r.e.Success}),e},function(n){return a.n.isCanceled(n)?(t.end({resultType:r.e.ExpectedFailure,resultCode:"Canceled"}),a.n.reject(n)):(t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:r.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableSubstrateCallsForPicker(),null)})}return null},e.prototype.init=function(e){var t="".concat(u,"/api/v1/init?scenario=").concat("documentshare");this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:t,headers:{Authorization:"Bearer "+e},needsAuthorization:!1})},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new s.e("PeoplePicker",c.e.session))},e}()},3446:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(8).t)("metadataSearchDataSource")},3707:function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r});var a={globalNavParent:"1002",quickLaunchParent:"1025",globalNavHome:"2003",subsites:"1026",quickLaunchHome:"1031",quickLaunchRecent:"1033",siteContents:"1034",footerNavParent:"13b7c916-4fea-4bb2-8994-5cf274aeb530",footerNavLogo:"2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100",footerNavName:"7376cd83-67ac-4753-b156-6a7b3fa0fc1f",footerNavLinks:"3a94b35f-030b-468e-80e3-b75ee84ae0ad",footerNavSections:"47a59018-dcc3-4e98-a14e-146bc4001628",clientRecycleBin:"-1000",clientEdit:"-999",clientSharedWithUs:"-998",clientToggleLeftNav:"-997",clientAllFiles:"-996"},i={publishingGlobalNav:"GlobalNavigationSwitchableProvider",publishingQuickLaunch:"CurrentNavigationSwitchableProvider"},r={SimpleLink:0,FriendlyUrl:1}},3709:function(e,t,n){"use strict";var a,i=n(54),r=n(138),o=n(70);!function(e){e[e.InteractionRequired=10013]="InteractionRequired"}(a||(a={}));var s=function(){function e(e,t){void 0===e&&(e={}),this._dataSource=t.oAuthTokenDataSource}return e.prototype.getToken=function(e,t){var n=new r.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){return n.end({resultType:o.e.Success}),e},function(e){return n.end({resultType:o.e.Failure}),i.n.reject(e)})},e.prototype.getInstrumentedToken=function(e,t){var n=new r.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){return n.end({resultType:o.e.Success}),e},function(e){return n.end({resultType:o.e.Failure}),i.n.reject(e)})},e}();t.e=s},3716:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return o}),n.d(t,"n",function(){return s});var a,i=n(126),r=n(1336);function o(e,t){var n;switch(e.size){case a.Large:n=r.UserPhotoSize.Large;break;case a.Medium:n=r.UserPhotoSize.Medium;break;default:n=r.UserPhotoSize.Small}return Object(r.getUserPhotoUrl)(e.userLoginName,n,t)}function s(e,t,n){var a=Object(r.getUserPhotoUrl)(t,void 0,n);if(!e||!a||0===a.indexOf("http"))return a;try{return new i.e(e).authority+a}catch(e){return a}}!function(e){e.Small="S",e.Medium="M",e.Large="L"}(a||(a={}))},4203:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Cache=0]="Cache",e[e.Server=1]="Server",e[e.None=2]="None",e[e.Error=3]="Error"}(a||(a={}))},4216:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Owner:0,View:1,Edit:2,Submitter:3,CoOwner:4,None:5,Review:6,Custom:7}},4414:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(3707);function i(e){if(e&&e.length>0){var t=e[e.length-1],n=e[e.length-2];if(r(t.key||"")||n&&r(n.key||""))return!0}return!1}function r(e){return e===a.t.clientRecycleBin||"-1"===e}},4810:function(e,t,n){"use strict";var a=function(){function e(){this.members=new Array}return e.prototype.addUserToList=function(e){this.members.unshift(e)},e.prototype.removeUserFromList=function(e){for(var t=-1,n=0;n<this.members.length;n++)this.members[n].userId===e.userId&&(t=n);t>=0&&this.members.splice(t,1)},e.prototype.containsUserByPrincipalName=function(e){if(e)for(var t=e.toLowerCase(),n=0;n<this.members.length;n++)if(this.members[n].principalName&&this.members[n].principalName.toLowerCase()===t)return!0;return!1},e}();t.e=a},4818:function(e,t,n){"use strict";var a=n(846),i=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._sharingContextInformation=e.sharingContextInformation}return e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var i=this._sharingContextInformation,r=i.isFolder,o=i.isListSharing,s=i.itemUrl,c=i.listId,d=i.listItemId,l=i.listUrl,u=i.resourceId,f=i.serverRelativeItemUrl,p=i.uniqueId,m=i.webAbsoluteUrl;if(o)return e.build().webByUrl({webUrl:m}).method("Lists",c);if(p){if(c)return e.build().webByUrl({webUrl:m}).segment("lists").method("getbyid",c).method("GetItemByUniqueId",p);var _=r?"GetFolderById":"GetFileById",h={guid:p};return e.build().webByUrl({webUrl:m}).method(_,h).segment("ListItemAllFields")}return l?e.build().webByUrl({listUrl:l}).method("GetListItem",f):s?e.build().webByUrl({webUrl:m}).method("GetFileByUrl",a.t(s)).segment("ListItemAllFields"):c&&d?e.build().webByUrl({webUrl:m}).method("Lists",c).method("GetItemById",d):e.build().webByUrl({webUrl:m}).method("GetListItemByResourceId",u)}var b;b=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var g=e.build().webByItemUrl(b).method("Lists",n);return t.isRootFolder||(g=t.properties.ID?g.method("GetItemById",t.properties.ID):g.method("GetItemByUniqueId",t.properties.uniqueId)),g},e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl},e.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){return!t.has(e.loginName)&&(t.add(e.loginName),!0)})}},e}();t.e=i},4854:function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){return e.call(this,{dataSourceName:"MicroServiceEndPointDataSource"},{pageContext:t})||this}return Object(a.__extends)(t,e),t.prototype.getMicroServiceEndPoints=function(e){var t="".concat(this._pageContext.webAbsoluteUrl,"/_api/microservicemanager/getserviceurls?service='").concat(e,"'");return this.dataRequestor.getData({url:t,method:"GET",qosName:"GetServiceUrls"}).then(function(e){return e&&e.d&&e.d.GetServiceUrls&&e.d.GetServiceUrls.results&&e.d.GetServiceUrls.results[0]})},t.prototype.getAllMicroServiceEndPoints=function(e){var t="".concat(this._pageContext.webAbsoluteUrl,"/_api/microservicemanager/getserviceurls?service='").concat(e,"'");return this.dataRequestor.getData({url:t,method:"GET",qosName:"GetAllServiceUrls"}).then(function(e){return e&&e.d&&e.d.GetServiceUrls&&e.d.GetServiceUrls.results})},t}(n(968).t);t.e=i},4951:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(54),i=n(157),r=n(1652),o=n(79),s=function(){function e(e,t){var n=this._pageContext=t.pageContext;this._groupsProvider=t.groupsProvider,this._graphUserInfoDataSource=t.graphUserInfoDataSource,this._userInfoDataSource=t.userInfoDataSource,this._isTeamsRelevant=Object(i.l)(n)}return e.prototype.getTeamsUrl=function(){return this._isTeamsRelevant?this._groupsProvider.getGroup().then(function(e){return e&&e.teamsUrl}):a.n.resolve()},e.prototype.canTeamify=function(){var e=this,t=this._pageContext;return this._isTeamsRelevant&&t.isSiteAdmin?t.isTeamsConnectedSite?a.n.resolve(!1):this._groupsProvider.getTeamifyBannerHidden().then(function(t){return!t&&e._groupsProvider.getGroup().then(function(t){return!t.teamsUrl&&!t.yammerResources&&e._graphUserInfoDataSource.canUseTeams().then(function(e){return e})}).catch(function(){return!1})}):a.n.resolve(!1)},e.prototype.shouldShowTeamsCoachmark=function(){var e=this;return(-1!==(window.location.search||"").indexOf("resetbubble=1")?this._userInfoDataSource.setUserFlagValue(r.t.teamsTeachingBubble,!1).then(function(){return!1}):this._userInfoDataSource.getUserFlagValue(r.t.teamsTeachingBubble)).then(function(t){if(!1===t)return e._graphUserInfoDataSource.canUseTeams()})},e.prototype.findTeamsLink=function(e,t){if(e&&e.length){var n=new o.t(t.toLowerCase());t=decodeURIComponent(n.getStringWithoutQueryAndFragment());for(var a=0,i=e;a<i.length;a++){var r=i[a],s=decodeURIComponent((r.url||"").toLowerCase());if(s.substring(0,t.length)===t||-1!==s.indexOf("/_layouts/15/groupstatus.aspx?target=team"))return r}}},e.prototype.setTeamsBubbleFlag=function(e){return this._userInfoDataSource.setUserFlagValue(r.t.teamsTeachingBubble,e)},e}()},5160:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={public:"Public",private:"Private"};t.t=a},5173:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible",e[e.requestAccess=7]="requestAccess"}(a||(a={}))},5174:function(e,t,n){"use strict";var a;!function(e){e[e.specificPeople=0]="specificPeople",e[e.organization=1]="organization",e[e.anyone=2]="anyone",e[e.existing=3]="existing",e[e.specificPeopleFlex=4]="specificPeopleFlex",e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"}(a||(a={})),t.e=a},5478:function(e,t,n){"use strict";n.d(t,"e",function(){return R});var a=n(0),i=n(5494),r=n(4203),o=n(4810),s=n(1332),c=n(54),d=n(20),l=n(76),u=n(52),f=n(2372),p=n(1336),m=n(454),_="Group('{0}')",h="Group('{0}')/{1}?$skip={2}&$top={3}&$inlinecount=allpages&$select=PrincipalName,Id,DisplayName,PictureUrl,UserType,Mail",b="Group('{0}')/Members/Add(objectId='{1}', principalName='{2}')",g="Group('{0}')/Owners/Add(objectId='{1}', principalName='{2}')",v="Group('{0}')/Members/Remove('{1}')",y="Group('{0}')/Owners/Remove('{1}')",S="/_layouts/15/groupstatus.aspx?id={0}&target={1}",D="isTeamifyPromptHidden",I=function(e){function t(t){var n=e.call(this,{dataSourceName:"GroupsDataSource",id:"GroupsDataSource"},{pageContext:t})||this;return n._isTeamifyPromptHiddenCacheKey=t?D+"_".concat(t.siteId+t.groupId):D,n}return Object(a.__extends)(t,e),t._copyMember=function(e){return{sip:e.alias,userId:e.id,email:e.mail,principalName:e.principalName,name:e.displayName,job:e.title,image:e.sharePointPictureUrl,profilePage:e.profilePage,entityType:e&&e.userType&&"guest"===e.userType?1:void 0}},t._parseUser=function(e){var n=JSON.parse(e);return t._copyMember(n.d)},t._copyMembers=function(e){var n=new o.e;return n.members=e.map(function(e){return t._copyMember(e)}),n},t._parseGroup=function(e){var n=JSON.parse(e);return t._copyGroup(n.d)},t._parseMembership=function(e){var n=JSON.parse(e);return t._copyMembership(n.d)},t._copyGroup=function(e){return{description:e.description,alias:e.alias,name:e.displayName,principalName:e.principalName,creationTime:e.creationTime,pictureUrl:e.pictureUrl,inboxUrl:e.inboxUrl,calendarUrl:e.calendarUrl,filesUrl:e.documentsUrl,sharePointUrl:e.siteUrl,editUrl:e.editGroupUrl,membersUrl:e.peopleUrl,notebookUrl:e.notebookUrl,teamsUrl:e.teamsUrl,isPublic:e.isPublic,mail:e.mail,classification:e.classification,yammerResources:e.yammerResources,teamsResources:e.teamsResources,allowToAddGuests:e.allowToAddGuests,isDynamic:e.isDynamic,assignedLabels:e.assignedLabels,membership:t._copyMembership(e)}},t._copyMembership=function(e){return{totalNumberOfMembers:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,membersList:e&&e.results?t._copyMembers(e.results):void 0}},t._parseOwnership=function(e){var n=JSON.parse(e);return t._copyOwnership(n.d)},t._copyOwnership=function(e){return{totalNumberOfOwners:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,ownersList:e&&e.results?t._copyMembers(e.results):void 0}},t.prototype.getGroupBasicProperties=function(e){var n=this;return this.getData(function(){return n._getUrl(d.format("Group('{0}')?$select=PrincipalName,Id,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime,Classification,yammerResources,teamsResources,allowToAddGuests,isDynamic,assignedLabels",e),"SP.Directory.DirectorySession")},function(a){var i=t._parseGroup(a);return i.id||(i.id=e),n._calculateMissingGroupProperties(i,e),i},"GetBasicProperties",void 0,"GET",void 0,void 0,3)},t.prototype.setGroupBasicProperties=function(e){var t=this;return e?this.getData(function(){return t._getUrl(d.format(_,e.id),"SP.Directory.DirectorySession")},void 0,"SetBasicProperties",function(){var t={__metadata:{type:"SP.Directory.Group"}};return e.name&&(t.displayName=e.name),e.description&&(t.description=e.description),e.assignedLabels?(null!=e.isPublic&&(t.isPublic=e.isPublic),e.assignedLabels===u.e.Empty?t.assignedLabels="":t.assignedLabels=e.assignedLabels):(null!=e.isPublic&&(t.isPublic=e.isPublic),e.classification&&(t.classification=e.classification)),JSON.stringify(t)},"PATCH",void 0,void 0,3):c.n.reject("Group parameter is null or undefined")},t.prototype.getGroupByAlias=function(e){var n=this;return this.getData(function(){return n._getUrl(d.format("Group(alias='{0}')",e),"SP.Directory.DirectorySession")},function(e){return t._parseGroup(e)},"GetGroupByAlias",void 0,"GET",void 0,void 0,0)},t.prototype.getGroupMembership=function(e,n,a,i){var r=this;void 0===a&&(a=!1),void 0===i&&(i=!1);var o=a?"100":"3";return this.getData(function(){return r._getUrl(d.format(h,e,"members","0",o),"SP.Directory.DirectorySession")},function(e){var a=t._parseMembership(e);return r._calculateMissingMembershipProperties(a,n),a},"GetMembership",void 0,"GET",void 0,void 0,3).then(function(t){return i?r._addOwnerInformation(e,n,t):c.n.resolve(t)})},t.prototype.getGroupMembershipPage=function(e,n,a,i){var r=this;return this.getData(function(){return r._getUrl(d.format(h,e,"members",a,i),"SP.Directory.DirectorySession")},function(e){var a=t._parseMembership(e);return r._calculateMissingMembershipProperties(a,n),a},"GetMembershipPage",void 0,"GET",void 0,void 0,3)},t.prototype.getGroupOwnership=function(e,n){var a=this,i=n||"100";return this.getData(function(){return a._getUrl(d.format(h,e,"owners","0",i),"SP.Directory.DirectorySession")},function(e){var n=t._parseOwnership(e);return a._calculateMissingOwnershipProperties(n),n},"GetOwnership",void 0,"GET",void 0,void 0,3)},t.prototype.getUserGroupsFromAAD=function(e){var t=this;return this.getData(function(){return t._getCsomUrl("ProcessQuery")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroupsFromAAD",function(){return d.format('<Request xmlns="http://schemas.microsoft.com/sharepoint/clientquery/2009" SchemaVersion="15.0.0.0" LibraryVersion="16.0.0.0" ApplicationName="Javascript Library"><Actions><ObjectPath Id="4" ObjectPathId="3" /><Query Id="5" ObjectPathId="3"><Query SelectAllProperties="true"><Properties /></Query></Query></Actions><ObjectPaths><StaticMethod Id="3" Name="GetMyGroups" TypeId="{1e54feb9-52a0-49f7-b464-6b722cf86f94}"><Parameters><Parameter Type="String">{0}</Parameter><Parameter Type="Number">0</Parameter><Parameter Type="Number">100</Parameter></Parameters></StaticMethod></ObjectPaths></Request>',e.email)},"POST")},t.prototype.getUserGroups=function(e){var t=this,n=function(){return t.getUserGroupsFromAAD(e)};return this.getData(function(){return t._getUrl(d.format("User('{0}')/RankedMembership?$top=100&$select=DisplayName,DocumentsUrl,SharePointPictureUrl,PictureUrl,Id,IsFavorite",e.userId),"SP.Directory.DirectorySession")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroups",void 0,"GET",void 0,void 0,0).then(function(e){return e&&e.length?e:n()},n)},t.prototype.addGroupMember=function(e,t,n,a){var i=this;return t=t||u.e.Empty,n=n||"",this.getData(function(){return i._getUrl(d.format(b,e,t,n),"SP.Directory.DirectorySession")},void 0,a||"AddMember",void 0,"POST",void 0,void 0,3)},t.prototype.addGroupOwner=function(e,t,n,a){var i=this;return t=t||u.e.Empty,n=n||"",this.getData(function(){return i._getUrl(d.format(g,e,t,n),"SP.Directory.DirectorySession")},void 0,a||"AddOwner",void 0,"POST",void 0,void 0,3)},t.prototype.removeGroupMember=function(e,t,n){var a=this;return this.getData(function(){return a._getUrl(d.format(v,e,t),"SP.Directory.DirectorySession")},void 0,n||"RemoveMember",void 0,"POST",void 0,void 0,3)},t.prototype.removeGroupOwner=function(e,t,n){var a=this;return this.getData(function(){return a._getUrl(d.format(y,e,t),"SP.Directory.DirectorySession")},void 0,n||"RemoveOwner",void 0,"POST",void 0,void 0,3)},t.prototype.addUsersToGroup=function(e,t,n,i,r){var o=this,s=u.e.generate(),l="multipart/mixed; boundary=batch_"+s,p=[],m=[],_=0,h=0,v=function(t,n,a){for(var i=n?g:b,r=0;r<t.length;r++){var s=void 0,c=void 0;if(a?c=t[r]:s=t[r],s||c){s=s||u.e.Empty,c=c||"";var l=o._getUrl(d.format(i,e,s,c),"SP.Directory.DirectorySession");n?m.push(l):p.push(l)}}};if(t?(v(t,!0,!1),_=t.length):i&&(v(i,!0,!0),_=i.length),n?(v(n,!1,!1),h=n.length):r&&(v(r,!1,!0),h=r.length),!(m.length<1&&p.length<1)){var y=this.getData(function(){return f.e.getBatchOperationUrl(o._pageContext.webAbsoluteUrl)},function(e){return e},"AddUsersToGroup",function(){return f.e.getBatchContent(s,[m,p],"POST",f.e.defaultBatchRequestPostData)},"POST",void 0,l,void 0,void 0,void 0,function(e){var t=e.errorData,n=e.eventData;return t?(t.extraData={OwnersNumber:_,MembersNumber:h},{eventData:Object(a.__assign)(Object(a.__assign)({},n),{resultCode:t.status.toString()})}):{eventData:n}},void 0);return new c.n(function(e,t){y.then(function(n){var a=f.e.processBatchResponse(n);a.hasError?t(a):e(a)},function(e){t(e)})})}},t.prototype.addRemoveGroupUsers=function(e,t,n,i,r){var o=this,s=u.e.generate(),l="multipart/mixed; boundary=batch_"+s,p=[],m=[],_=[],h=[],S=function(t,n,a){var i="SP.Directory.DirectorySession";if(void 0!==t)for(var r=0;r<t.length;r++)if(n)if(a){var s=o._getUrl(d.format(g,e,t[r],""),i);p.push(s)}else s=o._getUrl(d.format(y,e,t[r]),i),_.push(s);else a?(s=o._getUrl(d.format(b,e,t[r],""),i),m.push(s)):(s=o._getUrl(d.format(v,e,t[r]),i),h.push(s))};if(S(t,!0,!0),S(i,!0,!1),S(n,!1,!0),S(r,!1,!1),0!==p.length||0!==m.length||0!==_.length||0!==h.length){var D=this.getData(function(){return f.e.getBatchOperationUrl(o._pageContext.webAbsoluteUrl)},function(e){return e},"AddRemoveGroupOwners",function(){return f.e.getBatchContent(s,[p,m,_,h],"POST",f.e.defaultBatchRequestPostData)},"POST",void 0,l,void 0,void 0,void 0,function(e){var t=e.errorData,n=e.eventData;return t?(t.extraData={OwnersToAdd:p.length,MembersToAdd:m.length,OwnersToRemove:_.length,MembersToRemove:h.length},{eventData:Object(a.__assign)(Object(a.__assign)({},n),{resultCode:t.status.toString()})}):{eventData:n}},void 0);return new c.n(function(e,t){D.then(function(n){var a=f.e.processBatchResponse(n);a.hasError?t(a):e(a)},function(e){t(e)})})}},t.prototype.getUserInfo=function(e){var n=this;return this.getData(function(){return n._getUrl(d.format("User(principalName='{0}')",l.e.encodeRestUriStringToken(e)),"SP.Directory.DirectorySession")},function(n){var a=t._parseUser(n);return a.email=e,a},"GetGraphUser",void 0,"GET",void 0,void 0,3)},t.prototype.deleteGroup=function(e){var t=this;return e?this.getData(function(){return t._getUrl(d.format(_,e.id),"SP.Directory.DirectorySession")},void 0,"DeleteGroup",void 0,"DELETE",void 0,void 0,3):c.n.reject("Group parameter is null or undefined")},t.prototype.deleteSite=function(e){var t=this;return this.getData(function(){return t._pageContext.siteAbsoluteUrl+d.format("/_api/GroupSiteManager/Delete?siteUrl='{0}'",e)},void 0,"DeleteSite",void 0,"POST",void 0,void 0,3)},t.prototype.teamify=function(){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroup"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroup}},"Groupify",function(){return""},"POST",void 0,void 0,0)},t.prototype.teamifyV2=function(e,t){var n=this;return this.getData(function(){return n._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroupEx"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroupEx}},"TeamifyV2",function(){return""},"POST",void 0,void 0,0).then(function(a){return t(a),a&&a.teamsId?n._pinToTeam(a,e):void 0})},t.prototype.dismissTeamifyBanner=function(){var e=this;return this.getData(function(){return e._pageContext.siteAbsoluteUrl+d.format("/_api/GroupSiteManager/HideTeamifyPrompt?siteUrl='{0}'",e._pageContext.siteAbsoluteUrl)},function(e){return null},"DismissTeamifyBanner",function(){return""},"POST").then(function(){e.flushCache(e._isTeamifyPromptHiddenCacheKey),e.getTeamifyBannerHidden(!0)})},t.prototype.getTeamifyBannerHidden=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return t._pageContext.siteAbsoluteUrl+d.format("/_api/GroupSiteManager/IsTeamifyPromptHidden?siteUrl='{0}'",t._pageContext.siteAbsoluteUrl)},qosName:"TeamifyBannerHidden",parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.IsTeamifyPromptHidden},additionalPostData:"",method:"Get",cachingStrategy:e?m.e.bypassCache:m.e.useCacheAndUpdateInTheBackground,cacheRequestKey:this._isTeamifyPromptHiddenCacheKey})},t.prototype._getUrl=function(e,t){return"".concat(this._pageContext.webAbsoluteUrl,"/_api/").concat(t,"/").concat(e)},t.prototype._getCsomUrl=function(e){return"".concat(this._pageContext.webAbsoluteUrl,"/_vti_bin/client.svc/").concat(e)},t.prototype._getGroupStatusNotebookUrl=function(e){return this._pageContext.webAbsoluteUrl+d.format(S,e,"notebook")},t.prototype._getGroupStatusFilesUrl=function(e){return this._pageContext.webAbsoluteUrl+d.format(S,e,"documents")},t.prototype._addOwnerInformation=function(e,t,n){return this.getGroupOwnership(e,"100").then(function(e){var a=e.ownersList.members,i=n.membersList.members,r=[],o={};a.forEach(function(e){o[e.userId]=!0,e.principalName.toLowerCase()===t.toLowerCase()&&(n.isOwner=!0)});var s=0,d={};return i.forEach(function(e){o[e.userId]?(e.isOwnerOfCurrentGroup=!0,r.push(e),s++,d[e.userId]=!0):r.push(e),e.principalName===t&&(n.isMember=!0)}),s<a.length&&a.forEach(function(e){d[e.userId]||(e.isOwnerOfCurrentGroup=!0,r.push(e))}),n.membersList.members=r,n.totalNumberOfMembers<r.length&&(n.totalNumberOfMembers=r.length),n.totalNumberOfOwners=e.totalNumberOfOwners,c.n.resolve(n)})},t.prototype._fixUserImages=function(e){!e.image&&e.email&&(e.image=Object(p.getUserPhotoUrl)(e.email)),!e.profilePage&&e.email&&(e.profilePage=d.format("/_layouts/15/me.aspx?p={0}&v=profile&origin=ProfileODB",e.email))},t.prototype._calculateMissingMembershipProperties=function(e,t){var n=this;e.membersList.members.forEach(function(e){n._fixUserImages(e)})},t.prototype._calculateMissingOwnershipProperties=function(e){var t=this;e.ownersList.members.forEach(function(e){t._fixUserImages(e)})},t.prototype._calculateMissingGroupProperties=function(e,t){e.creationTime||(e.creationTime=Date.now()),e.pictureUrl&&(e.pictureUrl=e.pictureUrl.replace("EWS/Exchange.asmx/s/GetUserPhoto","OWA/service.svc/s/GetPersonaPhoto")),!e.notebookUrl&&t&&(e.notebookUrl=this._getGroupStatusNotebookUrl(t)),!e.filesUrl&&t&&(e.filesUrl=this._getGroupStatusFilesUrl(t))},t.prototype._parseResponseForGetUserGroups=function(e){var t=this,n=JSON.parse(e);if(n.constructor===Array)return n[4].GroupsList.map(function(e){return{filesUrl:e.DocumentsUrl,name:e.DisplayName,id:e.Id}});var a=n.d.results.map(function(e){var n={filesUrl:e.documentsUrl,name:e.displayName,id:e.id,pictureUrl:e.pictureUrl,isFavorite:e.isFavorite};return t._calculateMissingGroupProperties(n,n.id),n}),i=a.filter(function(e){return e.isFavorite});return i.push.apply(i,a.filter(function(e){return!e.isFavorite})),i},t.prototype._pinToTeam=function(e,t){var n=this;return t=t.map(function(e){return{displayName:e.displayName,isDefault:e.isDefault,url:e.url,itemType:e.itemType}}),this.getData(function(){return n._pageContext.siteAbsoluteUrl+"/_api/GroupSiteManager/PinToTeam"},function(t){if(t){var n=JSON.parse(t);if(n&&n.d)return{pinToTeam:n.d.PinToTeam,teamsInfo:e}}},"PinToTeam",function(){if(n._pageContext&&n._pageContext.navigationInfo&&n._pageContext.navigationInfo.quickLaunch){var a={requestParams:{__metadata:{type:"Microsoft.SharePoint.Portal.PinToTeamParams"},teamsId:e.teamsId,tabs:{__metadata:{type:"Collection(Microsoft.SharePoint.Portal.M365TabItem)"},results:t}}};return JSON.stringify(a)}},"POST",void 0,void 0,0)},t}(s.t),x=n(5160),C=function(){function e(e,t,n,a,i){this._groupsProvider=e,this._parentGroup=t,this._loadPageFromServerDelegate=n,this._pageSize=a&&"number"==typeof a.pageSize?a.pageSize:20,this._shouldAddOwnershipInformation=!a||(a.ownershipInformation,!1)||a.ownershipInformation,this._userLoginName=i,this._foundOwnersDictionary={},this._numberOfOwnersFound=0}return e.prototype.loadPage=function(e){var t=this,n=e||0;return this._groupsProvider&&this._parentGroup.id?this._loadPageFromServerDelegate(this._parentGroup.id,n,this._pageSize).then(function(e){return t._processPage(e,n)},function(e){return t.error=e,c.n.reject(e)}):c.n.reject(void 0)},e.prototype._processPage=function(e,t){var n=this;this.totalNumberOfMembers=e.totalNumberOfMembers;var a=t+this._pageSize>=this.totalNumberOfMembers,i=a?void 0:this._computeGetNextPagePromise(t+this._pageSize);return this._shouldAddOwnershipInformation?this._ownersDictionary?(this._addOwnershipInformationToPage(e,a),c.n.resolve({page:e.membersList.members,getNextPagePromise:i})):this._groupsProvider.loadOwnershipContainerFromServer(this._parentGroup.id).then(function(t){return n._addOwnershipInformationToPage(e,a,t),c.n.resolve({page:e.membersList.members,getNextPagePromise:i})}):c.n.resolve({page:e.membersList.members,getNextPagePromise:i})},e.prototype._addOwnershipInformationToPage=function(e,t,n){var a=this;if(n&&(this.totalNumberOfOwners=n.totalNumberOfOwners,this._ownersDictionary={},n.ownersList.members.forEach(function(e){e.userId&&(a._ownersDictionary[e.userId]=e)}),this.isOwner=n.ownersList.containsUserByPrincipalName(this._userLoginName)),e.membersList.members.forEach(function(e){e.isOwnerOfCurrentGroup=a._ownersDictionary&&!!a._ownersDictionary[e.userId],e.isOwnerOfCurrentGroup&&(a._numberOfOwnersFound++,a._foundOwnersDictionary[e.userId]=!0)}),t&&this._ownersDictionary&&this._numberOfOwnersFound<this.totalNumberOfOwners)for(var i in this._ownersDictionary){var r=this._ownersDictionary[i];this._foundOwnersDictionary[r.userId]||(r.isOwnerOfCurrentGroup=!0,e.membersList.members.push(r),this.totalNumberOfMembers++)}},e.prototype._computeGetNextPagePromise=function(e){var t=this;return function(){return t.loadPage(e)}},e}(),O=n(157),w=n(188),E=n(227),A=n(1868),L=n(348),k=n(158),M=n(138),P=n(134),T="Yammer.FeedURL",U="MicrosoftTeams.TeamHomeURL",F="Missing group id.",H="CurrentUser",R=function(){function e(e){this._missingLoginNameError="Missing user login name information.",this._partnerUser="PartnerUser",this._pageContext=e.pageContext,this._dataRequestor=new E.t({qosName:"GroupsProvider"},{pageContext:e.pageContext}),this._dataSource=e.dataSource||new I(e.pageContext);var t=function(e){return e.name?Object(a.__assign)(Object(a.__assign)({},e),{name:"GroupsProvider.PersistentCache.".concat(e.name)}):e};this._persistentCache=new A.e({secret:void 0,cacheType:L.e.indexedDB,telemetry:{engagement:k.e.withData(t),qos:M.e.withData(t)}}),this._userLoginName=e.pageContext&&e.pageContext.userLoginName,this._groups=[],this._eventGroup=new w.t(this),this.switchCurrentGroup(e.groupId||e.pageContext&&e.pageContext.groupId)}return e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.getSPPageContext=function(){return this._pageContext},e.prototype.getMembershipPager=function(e){var t=this;return new C(this,this.group,function(e,n,a){return e?t._userLoginName?t._dataSource.getGroupMembershipPage(e,t._userLoginName,n,a):c.n.reject(t._missingLoginNameError):c.n.reject(F)},e,this._userLoginName)},e.prototype.loadGroupInfoFromCache=function(e){return e?c.n.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data})):c.n.resolve(void 0)},e.prototype.saveGroupToCache=function(e){if(e)return c.n.resolve(this._persistentCache.update({key:e.id},e))},e.prototype.saveMembershipToCache=function(e,t){var n=this;return this.loadGroupInfoFromCache(e).then(function(e){if(e)return e.membership={isMember:t.isMember,totalNumberOfMembers:t.totalNumberOfMembers,totalNumberOfOwners:t.totalNumberOfOwners,membersList:t.membersList,isOwner:t.isOwner,isJoinPending:t.isJoinPending,lastLoadTimeStampFromServer:t.lastLoadTimeStampFromServer},n.saveGroupToCache(e)})},e.prototype.loadGroupInfoContainerFromServer=function(e){var t=this;return e?this._dataSource.getGroupBasicProperties(e).then(function(e){return t._performBasicPropertiesPostProcessing(e),Object(O.l)(t._pageContext)&&t.doesCachedGroupPropertiesDiffer(e)&&t.syncGroupProperties(),e}):c.n.reject(F)},e.prototype.loadMembershipContainerFromServer=function(e,t,n,a){return void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===a&&(a=this._userLoginName),e?a?this._dataSource.getGroupMembership(e,a,t,n):c.n.reject(this._missingLoginNameError):c.n.reject(F)},e.prototype.loadOwnershipContainerFromServer=function(e,t){return e?this._dataSource.getGroupOwnership(e,t):c.n.reject(F)},e.prototype.loadUserGroups=function(e){var t=this;return this.loadUserGroupsFromCache(e).then(function(n){return n&&0!==n.length?c.n.resolve(n):t.getCurrentUser().then(function(n){return e?t._dataSource.getUserGroupsFromAAD(n).then(function(e){return t._persistentCache.update({key:"UserGroupsFromAAD"+n.userId},e),e}):t._dataSource.getUserGroups(n).then(function(e){return t._persistentCache.update({key:"UserGroups"+n.userId},e),t._setUsersGroups(e,r.e.Server),e})})})},e.prototype.loadUserGroupsFromCache=function(e){var t=this;return this.getCurrentUser().then(function(n){return(e?c.n.resolve(t._persistentCache.read({key:"UserGroupsFromAAD"+n.userId}).then(function(e){return e.data})):c.n.resolve(t._persistentCache.read({key:"UserGroups"+n.userId}).then(function(e){return e.data}))).then(function(n){return n&&!e&&t._setUsersGroups(n,r.e.Cache),n})})},e.prototype.isUserInGroup=function(e){return this.loadUserGroups(!0).then(function(t){for(var n=0,a=t.length;n<a;n++)if(t[n].id===e)return!0;return!1})},e.prototype.getGroup=function(e,t){var n=this;if(void 0===t&&(t=!1),e)throw new Error("NotImplemented: Calling getGroup() on groupsProvider supplying a groupId is not yet implemented.");return t||e&&0!==e.length&&(!this.group||e!==this.group.id)?(e&&0!==e.length||(e=this.group.id),this.loadGroupInfoContainerFromServer(e)):new c.n(function(e,t){var a=n.group;n.group?a.source===r.e.None?n._eventGroup.on(a,i.t.onSourceChange,function(i){i!==r.e.Error?i===r.e.None||e(a):t(n.group.error)}):e(a):t("There is no group currently being managed by GroupsProvider.")})},e.prototype.getCurrentUser=function(){var e=this;return this._userLoginName?this.currentUser?c.n.resolve(this.currentUser):this._getUserFromCache(H).then(function(t){return e.currentUser=t,t||e._dataSource.getUserInfo(e._userLoginName).then(function(t){return e._saveUserToCache(t,H),e.currentUser=t,t})}):c.n.reject(this._missingLoginNameError)},e.prototype.addUserToGroupMembership=function(e,t,n,a){var i,r=this;return e?this._getUserIdForCacheClear(t,n).then(function(o){return i=o,r._dataSource.addGroupMember(e,t,n,a)}).then(function(){r._clearUserGroupsCache(i)}):c.n.reject(F)},e.prototype.addUserToGroupOwnership=function(e,t,n,a){var i,r=this;return e?this._getUserIdForCacheClear(t,n).then(function(o){return i=o,r._dataSource.addGroupOwner(e,t,n,a)}).then(function(){r._clearUserGroupsCache(i)}):c.n.reject(F)},e.prototype.removeUserFromGroupMembership=function(e,t,n){var a,i=this;return e?this._getUserIdForCacheClear(t).then(function(r){return a=r,i._dataSource.removeGroupMember(e,t,n)}).then(function(){i._clearUserGroupsCache(a)}):c.n.reject(F)},e.prototype.removeUserFromGroupOwnership=function(e,t,n){var a,i=this;return e?this._getUserIdForCacheClear(t).then(function(r){return a=r,i._dataSource.removeGroupOwner(e,t,n)}).then(function(){i._clearUserGroupsCache(a)}):c.n.reject(F)},e.prototype.addUsersToGroup=function(e,t,n,a,i){var r,o=this;return e?P.n.isFeatureEnabled({ODB:60358})&&this._isPartnerUser()?this._dataSource.addUsersToGroup(e,t,n,a,i):this.currentUser?(r=this.currentUser.userId,this._dataSource.addUsersToGroup(e,t,n,a,i).then(function(e){return o._clearUserGroupsCache(r),e})):this.getCurrentUser().then(function(e){r=e.userId}).then(function(){return o._dataSource.addUsersToGroup(e,t,n,a,i)}).then(function(e){return o._clearUserGroupsCache(r),e}):c.n.reject(F)},e.prototype.saveGroupProperties=function(e){return this._dataSource.setGroupBasicProperties(e)},e.prototype.switchCurrentGroup=function(e){var t=this.group?this.group.id:void 0;if(e&&e!==t){var n=this.getCachedGroup(e);n.load(),this.group=n}},e.prototype.getCachedGroup=function(e,t){var n=this._groups[e];return n||(n=new i.t(t,this,e,this._pageContext),this._groups[e]=n),n},e.prototype.syncGroupProperties=function(){var e=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SyncGroupProperties";return this._dataRequestor.getData({url:e,qosName:"SyncGroupProperties",method:"POST",noRedirect:!0})},e.prototype.setGroupImage=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SetGroupImage";return this._dataRequestor.getData({url:t,qosName:"SetGroupImage",method:"POST",noRedirect:!0,additionalPostData:e,contentType:e?e.type:"image/jpeg"})},e.prototype.doesCachedGroupPropertiesDiffer=function(e){var t,n,a=this._pageContext;return a.groupId===e.id&&(a.webTitle!==e.name||(a.siteClassification||e.classification)&&a.siteClassification!==e.classification||(a.sensitivityLabel||e.assignedLabels)&&(null===(t=a.sensitivityLabel)||void 0===t?void 0:t.toLocaleLowerCase())!==(null===(n=e.assignedLabels)||void 0===n?void 0:n.toLocaleLowerCase())||null===a.groupType||void 0===a.groupType||a.groupType===x.t.public!==e.isPublic||!a.isTeamsConnectedSite&&!!e.teamsUrl&&e.teamsUrl.length>0)},e.prototype.teamify=function(){return this._dataSource.teamify()},e.prototype.teamifyV2=function(e,t){return this._dataSource.teamifyV2(e,t)},e.prototype.hideTeamifyBanner=function(){var e=this._makeHideTeamifyKey();return c.n.resolve(this._persistentCache.update({key:e},{}))},e.prototype.dismissTeamifyBanner=function(){return this._dataSource.dismissTeamifyBanner()},e.prototype.getTeamifyBannerHidden=function(e){var t=this;return c.n.resolve(this._persistentCache.read({key:this._makeHideTeamifyKey()}).then(function(n){return!!n.data||t._dataSource.getTeamifyBannerHidden(e).catch(function(){return!1})}))},e.prototype.deleteGroup=function(e){return this._dataSource.deleteGroup(e)},e.prototype.deleteSite=function(e){return this._dataSource.deleteSite(e)},e.prototype._makeHideTeamifyKey=function(e){var t=e||this._pageContext.siteId;return"".concat("HideTeamify",":").concat(t)},e.prototype._setUsersGroups=function(t,n){var a=this;this.userGroups=t.map(function(e){var t=a.getCachedGroup(e.id,e);return n!==r.e.Server&&t.source===r.e.Server||t.extend(e),t.pictureUrl||t.load(),t}),this._eventGroup.raise(e.onUserGroupsChange,this.userGroups)},e.prototype._performBasicPropertiesPostProcessing=function(e){this._pageContext&&(e.hasPictureUrl=!!e.pictureUrl,e.pictureUrl="".concat(this._pageContext.webAbsoluteUrl).concat("/_api/GroupService/GetGroupImage"),e.inboxUrl=this._getWorkloadUrl(e,"inboxUrl","conversations",T),e.calendarUrl=this._getWorkloadUrl(e,"calendarUrl","CALENDAR",null),e.membersUrl=this._getWorkloadUrl(e,"membersUrl","members",null),e.teamsUrl=this._getWorkloadUrl(e,"teamsUrl",null,U))},e.prototype._getWorkloadUrl=function(e,t,n,a){var i=null,r=e.yammerResources,o=e.teamsResources,s=function(e){var t=e.filter(function(e){return e.Key===a});return t&&t[0]?t[0].Value:null};return a===U?o&&o.results&&o.results.length>0&&(i=s(o.results)):r&&r.results&&r.results.length>0?a===T&&(i=s(r.results)):i=e[t]?e[t]:"".concat(this._pageContext.webAbsoluteUrl,"/_layouts/15/groupstatus.aspx?id=").concat(e.id,"&target=").concat(n),i},e.prototype._saveUserToCache=function(e,t){if(e)return this._persistentCache.update({key:t},e)},e.prototype._getUserFromCache=function(e){return c.n.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data}).catch(function(){}))},e.prototype._clearUserGroupsCache=function(e){if(e)return c.n.all([this._persistentCache.remove({key:"UserGroupsFromAAD"+e}),this._persistentCache.remove({key:"UserGroups"+e})]).then(function(e){})},e.prototype._getUserIdForCacheClear=function(e,t){var n;return this.currentUser&&e?(n=e===this.currentUser.userId?e:null,c.n.resolve(n)):this.getCurrentUser().then(function(a){return n=e?e===a.userId?a.userId:null:t===a.principalName?a.userId:null})},e.prototype._isPartnerUser=function(){var e,t;try{var n=window.parent;return!!n&&(null===(t=null===(e=n.window)||void 0===e?void 0:e.adminPageContext)||void 0===t?void 0:t.userType)===this._partnerUser}catch(e){return!1}},e.onUserGroupsChange="userGroups",e}();t.t=R},5494:function(e,t,n){"use strict";n.d(t,"n",function(){return u}),n.d(t,"e",function(){return f});var a,i=n(4810),r=n(4203),o=n(54),s=n(188);!function(e){e[e.none=0]="none",e[e.allMembers=1]="allMembers",e[e.ownershipInformation=2]="ownershipInformation",e[e.forceSkipCache=4]="forceSkipCache"}(a||(a={}));var c=function(){function e(e,t,n){this._eventGroup=new s.t(this),this.source=r.e.None,this.lastLoadTimeStampFromServer=-1,this._groupsProvider=t,this._parent=n,e&&this.extend(e,r.e.None),this.membersList||(this.membersList=new i.e)}return e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0),this._parent=void 0},e.prototype.load=function(e,t){var n=this;if(void 0===e&&(e=!1),void 0===t&&(t=!1),this._groupsProvider&&this._parent.id){var i=0;e&&(i|=a.allMembers),t&&(i|=a.ownershipInformation);var s=o.n.resolve();return u()||this.source!==r.e.None||i||(s=this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&n.extend(e.membership,r.e.Cache)})),s.then(function(){if(n._shouldLoadNewData(i))return n._startLoadingFromServer(i),n._groupsProvider.loadMembershipContainerFromServer(n._parent.id,e,t).then(function(e){n.extend(e,r.e.Server),n._finishLoadingFromServer(),i||(e.lastLoadTimeStampFromServer=n.lastLoadTimeStampFromServer,n._groupsProvider.saveMembershipToCache(n._parent.id,e))},function(e){n._errorLoading(e)})})}return o.n.resolve()},e.prototype.loadWithOptions=function(e){var t=this;return this._groupsProvider&&this._parent.id&&(this.source!==r.e.None||e||this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&t.extend(e.membership,r.e.Cache)}),this._shouldLoadNewData(e))?(this._startLoadingFromServer(e),this._groupsProvider.loadMembershipContainerFromServer(this._parent.id,e&&(e&a.allMembers)===a.allMembers,e&&(e&a.ownershipInformation)===a.ownershipInformation).then(function(n){t.extend(n,r.e.Server),t._finishLoadingFromServer(),e&&e!==a.forceSkipCache||(n.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer,t._groupsProvider.saveMembershipToCache(t._parent.id,n))},function(e){t._errorLoading(e)})):o.n.resolve(void 0)},e.prototype.extend=function(t,n){this.isMember=t.isMember,this.isOwner=t.isOwner,this.isJoinPending=t.isJoinPending,this.membersList=t.membersList,this.totalNumberOfMembers=t.totalNumberOfMembers,this.totalNumberOfOwners=t.totalNumberOfOwners,this.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer,this._parent.membership=this,this.source=n,this._eventGroup.raise(e.onSourceChange,this.source)},e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&this.source!==r.e.Server&&(this.lastLoadTimeStampFromServer<0||Date.now()-this.lastLoadTimeStampFromServer>864e5)||e&&(e&a.forceSkipCache)===a.forceSkipCache||e&&(e&a.allMembers)===a.allMembers&&!(this._currentLoadOptions&&(this._currentLoadOptions&a.allMembers)===a.allMembers)||e&&(e&a.ownershipInformation)===a.ownershipInformation&&!(this._currentLoadOptions&&(this._currentLoadOptions&a.ownershipInformation)===a.ownershipInformation)},e.prototype._startLoadingFromServer=function(e){this.isLoadingFromServer=!0,this._currentLoadOptions=e},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this._currentLoadOptions=void 0,this.lastLoadTimeStampFromServer=Date.now()},e.prototype._errorLoading=function(e){this.isLoadingFromServer=!1,this._currentLoadOptions=void 0,this.error=e},e.onSourceChange="source",e}(),d=n(20),l=n(108);function u(){var e,t=new l.e,n=!1;if(window.indexedDB&&t.isFirefox)try{var a=window.indexedDB.open("FF_INPRIVATE");a.onerror=function(){return n=!0},"InvalidStateError"===(null===(e=null==a?void 0:a.error)||void 0===e?void 0:e.name)&&(n=!0)}catch(e){n=!0}return n}var f=function(){function e(t,n,a,i){this._eventGroup=new s.t(this),this.source=r.e.None,this.lastLoadTimeStampFromServer=-1,this._groupsProvider=n,this.id=a,t?this.extend(t):this.load(),this.membership=new c(void 0,this._groupsProvider,this),!i&&n&&(i=n.getSPPageContext()),this.plannerUrl=e._getPlannerUrl(i,a)}return e._getPlannerUrl=function(e,t){if(e)return t||(t=e.groupId),e.webAbsoluteUrl+d.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",t,"planner")},e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.load=function(t){var n=this;if(this._groupsProvider&&this.id){var a=o.n.resolve();return this.source!==r.e.None||u()||(a=this._groupsProvider.loadGroupInfoFromCache(this.id).then(function(t){t&&t.lastLoadTimeStampFromServer>0&&(n.extend(t),n.source=r.e.Cache,n._eventGroup.raise(e.onSourceChange,n.source))})),a.then(function(){if(n._shouldLoadNewData(t))return n._startLoadingFromServer(),n._groupsProvider.loadGroupInfoContainerFromServer(n.id).then(function(e){e.lastLoadTimeStampFromServer=Date.now(),n.extend(e),n._finishLoadingFromServer(),n._groupsProvider.saveGroupToCache(e)},function(e){n._errorLoading(e)})})}return o.n.resolve()},e.prototype.extend=function(e){this.name=e.name,this.principalName=e.principalName,this.alias=e.alias,this.mail=e.mail,this.description=e.description,this.creationTime=e.creationTime,this.profileUrl=e.profileUrl,this.inboxUrl=e.inboxUrl,this.calendarUrl=e.calendarUrl,this.filesUrl=e.filesUrl,this.notebookUrl=e.notebookUrl,this.pictureUrl=e.pictureUrl,this.hasPictureUrl=e.hasPictureUrl,this.sharePointUrl=e.sharePointUrl,this.editUrl=e.editUrl,this.membersUrl=e.membersUrl,this.teamsUrl=e.teamsUrl,this.isPublic=e.isPublic,this.classification=e.classification,this.assignedLabels=e.assignedLabels,this.allowToAddGuests=e.allowToAddGuests,this.isDynamic=e.isDynamic,this.yammerResources=e.yammerResources,this.teamsResources=e.teamsResources,this.lastLoadTimeStampFromServer=e.lastLoadTimeStampFromServer},e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&(e||this.source!==r.e.Server&&(!this.lastLoadTimeStampFromServer||Date.now()-this.lastLoadTimeStampFromServer>864e5))},e.prototype._startLoadingFromServer=function(){this.isLoadingFromServer=!0},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this.source=r.e.Server,this._eventGroup.raise(e.onSourceChange,this.source)},e.prototype._errorLoading=function(t){this.isLoadingFromServer=!1,this.error=t,this._eventGroup.raise(e.onSourceChange,r.e.Error)},e.onSourceChange="source",e}();t.t=f},5559:function(e,t,n){"use strict";var a;!function(e){e[e.share=1]="share",e[e.copy=2]="copy",e[e.atMention=3]="atMention",e[e.linkSettings=4]="linkSettings",e[e.manageAccess=5]="manageAccess",e[e.notify=6]="notify",e[e.addPeople=7]="addPeople"}(a||(a={})),t.e=a},5565:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Network:1,Embed:3,App:4,View:5,Edit:6,Form:7,Direct:8,Organization:9,AppAccess:10,RequestAccess:11,None:100}},5566:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit",e[e.manageList=9]="manageList"}(a||(a={}))},5567:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={generic:0,getSharingInformation:1,shareLink:2,shareObject:3,permissions:4,item:5,me:6,drive:7,invite:8,createLink:9};t.t={authFailure:1,serverFailure:2,invalidItem:3,invalidWebAbsoluteUrl:4,generic:5,objectNotSupported:6,invalidEmail:7,linkNoLongerAvailable:8}},5569:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={uninitialized:-1,anyone:0,organization:1,specificPeople:2,existing:3}},5570:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={anyone:0,organization:1,specificPeople:2}},5571:function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a={none:0,allow:1,allowWithJustification:2},i={none:0,falsePositiveReported:1,overridden:2,falsePositiveReportedAndOverridden:3},r={override:0,reportFalsePositive:1}},5673:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(54),r=n(366),o=n(1345),s=n(968),c=n(454),d={method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"}},l=function(e){function t(t,n){var a=e.call(this,{dataSourceName:"GraphUserInfo"},n)||this;return a._oAuthTokenProvider=n.oAuthTokenProvider,a._canUseGraph=a._pageContext.isSPO,a._persistentRequestCache=new o.e({id:"GraphUserInfo"},{pageContext:a._pageContext}),a}return Object(a.__extends)(t,e),t.prototype.canUseTeams=function(){var e=this;return this._canUseGraph?this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:c.e.useCacheIfNotExpired,cacheTimeoutTime:r.i,cacheRequestKey:"CanUseTeams",getData:function(){return e._oAuthTokenProvider.getToken(e._pageContext.msGraphEndpointUrl).then(function(t){return e._canUseTeams(t)})}}).catch(function(){return null}):i.n.resolve(null)},t.prototype._canUseTeams=function(e){return this.dataRequestor.getData(Object(a.__assign)(Object(a.__assign)({url:this._pageContext.msGraphEndpointUrl+"/beta/me/licenseDetails",authToken:e,qosName:"CanUseTeams"},d),{parseResponse:function(e){return JSON.parse(e).value.some(function(e){for(var t=e.servicePlans||[],n=0;n<t.length;n++)if("57ff2da0-773e-42df-b2af-ffb7a2317929"===t[n].servicePlanId)return"Success"===t[n].provisioningStatus;return!1})}}))},t}(s.e)}}]);