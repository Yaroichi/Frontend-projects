(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.items-view"],{1876:function(e,t,n){"use strict";n.r(t),n.d(t,"DropTargetHook",function(){return m}),n.d(t,"DragSourceHook",function(){return _}),n.d(t,"DragDropHook",function(){return v});var a=n(0),i=n("react-lib"),r=n(1547),o=n(1426),s=n(1021),c=n(1722),d=n(5225),l=n(715),u=n(69),f=n(125),p=n(1645),m=function(e){return i.createElement(r.e,null,i.createElement(o.e,Object(a.__assign)({},e)))},_=function(e){var t=e.dragSourceKey,n=e.type,o=i.useState(),c=o[0],d=o[1],l=Object(f.e)(function(t){var n;e.hookCallback(t),d(null===(n=t.collectedProps)||void 0===n?void 0:n.isDragging)});return i.createElement(r.e,null,i.createElement(s.t,Object(a.__assign)({},e,{hookCallback:l})),e.showDefaultDragPreview||!c?null:i.createElement(s.e,{dragSourceKey:t,type:n},function(e){return i.createElement(g,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))};function h(e){var t=e.resolve,n=Object(a.__rest)(e,["resolve"]);return i.useEffect(function(){return function(){t()}},[]),i.createElement(c.e,Object(a.__assign)({},n))}function b(e){var t=e.draggedItem,n=e.resolve;return i.createElement(r.e,null,i.createElement(s.e,{dragSourceKey:null==t?void 0:t.dragSourceKey,type:null==t?void 0:t.type,as:p.e,getItemStyles:p.n},function(e){return i.createElement(h,{draggedItem:e.draggedItem,dropEffect:e.dropEffect,resolve:n})}))}function g(e){var t=Object(l.i)({scope:"global"});return i.useEffect(function(){if(e.draggedItem&&t){var n=new u.e,a=n.reject,r=n.resolve,o=n.promise,s=i.createElement(b,{draggedItem:e.draggedItem,reject:a,resolve:r});t.enqueue({content:s,promise:o,scope:"global"})}},[e.draggedItem]),null}var v=i.memo(function(e){var t=e.dragDropKey,n=e.dragType,o=i.useState(),c=o[0],l=o[1],u=Object(f.e)(function(t){var n;e.hookCallback(t),l(null===(n=t.collectedDragProps)||void 0===n?void 0:n.isDragging)});return i.createElement(r.e,null,i.createElement(d.e,Object(a.__assign)({},e,{hookCallback:u})),e.showDefaultDragPreview||!c?null:i.createElement(s.e,{dragSourceKey:t,type:n},function(e){return i.createElement(g,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))})},3451:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(267),i=Object(a.e)(function(e){return{}})},3568:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(24),i=n(18),r=new a.e("uploadProgress",{sourceEntryKey:i.e});function o(e){return r.serialize({sourceEntryKey:e})}},4220:function(e,t,n){"use strict";n.d(t,"t",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"n",function(){return d}),n.d(t,"a",function(){return l});var a=n(16),i=!a.e.isActivated("921101b5-51e4-495d-a1a2-ea550afabfce","09/23/2022","Check parent link in getFixedUrl"),r=a.e.isActivated("891196BA-98FA-4623-ABD1-371612730330","10/10/2022","fix oneNote results and suggestions url"),o=a.e.isActivated("7afcff20-1e17-485f-b4c3-cd152373050a","10/31/2022","Use regex to replace forms view link from parent url");function s(e){var t=e.path,n=e.parentLink,a=e.filename,o=e.isContainer,s=e.fileExtension;if(!n||!a)return t;var d=t,l=c(n),u=o&&!(!r&&"one"===s)&&a&&t&&(t.indexOf(a)<0||i&&t.indexOf(l)<0)&&-1===t.toLowerCase().indexOf("docsethome.aspx");return(!t||t.indexOf("/Forms/DispForm.aspx?ID=")>=0||u)&&(d="".concat(l,"/").concat(a)),d}function c(e){return e?o?e.replace("/Forms/All.aspx","").replace("/Forms/AllItems.aspx",""):e.replace(/\/Forms\/[^\/]*\.aspx$/i,""):e}function d(e){var t=e.lastModifiedTime,n=e.modifierDates,a=e.lastModifiedTimeForRetention,i=t;return n?i=n.split(";")[0]:a&&(i=new Date(t).valueOf()-new Date(a).valueOf()>0?t:a),i}function l(e,t){return e&&t&&"".concat(e,"/_layouts/15/viewer.aspx?sourcedoc={").concat(t,"}")||""}},4235:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s});var a=n(429),i=n(9),r=n(499),o=new(n(130).e)("childItemKeys",function(e,t){var n=t.itemKey,r=e.demandItemFacet(a.e,n),o=e.demandItemFacet(i.e,n),s=o&&o.itemKeys;return a.e.evaluate(r)(e,{itemKey:n,itemKeys:s}).itemKeys});function s(e,t){return Object(r.t)(e.demandItemFacet(o,t.itemSetKey))}},4455:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(66),i=n(9),r=n(499),o=n(4235);function s(e,t){var n=t.maxLevels,s=[],c=function(t,r){for(var d=0,l=t;d<l.length;d++){var u=l[d];if(("number"!=typeof n||r<n)&&e.demandItemFacet(a.r,u,{suppressGetItems:!0})){var f=e.isItemFacetResolved(i.e,u),p=e.demandItemFacet(a.e,u,{suppressGetItems:!0}),m="number"==typeof p?p:1,_=e.demandItemFacet(o.e,u,{suppressGetItems:!f});if(_)c(_,r+1);else for(var h=0;h<m;h++)s.push(u)}else s.push(u)}};return c(t.itemKeys,0),Object(r.t)(s)}},4771:function(e,t,n){"use strict";n.d(t,"t",function(){return m}),n.d(t,"n",function(){return _}),n.d(t,"e",function(){return h});var a,i,r,o=n(0),s=n(25),c=n(279),d=n(476),l=n(182),u=n(259),f={details:"details",compactDetails:"compactDetails",tiles:"tiles"},p=((a={})[f.details]=l.t,a[f.compactDetails]=l.e,a[f.tiles]=u.e,a),m=Object(o.__assign)(Object(o.__assign)({},f),{kanban:"kanban",calendarMonth:"calendarMonth",calendarWeek:"calendarWeek",playlistPlayback:"playlistPlayback"}),_=((i={})[s.n.standard]=[m.details,m.tiles],i[s.n.tiles]=[m.details,m.tiles],i[s.n.compactList]=[m.compactDetails,m.tiles],i[s.n.kanban]=[m.kanban],i[s.n.modernCalendar]=[m.calendarMonth,m.calendarWeek],i[s.n.playlistPlayback]=[m.playlistPlayback],i),h=Object(o.__assign)(Object(o.__assign)({},p),((r={})[m.kanban]=d.e,r[m.calendarWeek]=c.t,r[m.calendarMonth]=c.e,r))},4850:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(6),i=new a.e("openSyncIssuesAction",{action:a.t,isAvailable:a.t})},4856:function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(0),i=n("react-lib"),r=n(47),o=n(28),s=n(23),c=n(12),d=n(214),l=n(223),u=n(3451),f=n(191),p=n(3452),m=function(e){var t=e.undoRedoActionType,n=e.dispatch,r=e.isAvailable,o=i.useState(0),c=o[0],d=o[1],l=i.useState(0),m=l[0],_=l[1],h=i.useRef(new f.e({})),b=r&&("undo"===t&&c>0||"redo"===t&&m>0);return i.useEffect(function(){var e=n(u.e);return h.current.on(e,p.e.undoRealCmdCountChangeEventName,function(e){d(e.undoRealCmdCount)}),h.current.on(e,p.e.redoRealCmdCountChangeEventName,function(e){_(e.redoRealCmdCount)}),function(){h.current.dispose()}},[]),i.createElement(s.e,Object(a.__assign)({},e,{isAvailable:b}))},_=Object(r.t)(function(e,t){var n=t.itemKey,r=t.undoRedoActionType,s="undo"===r,c=Object(d.e)(e)===l.e,_=e.dispatch;return i.createElement(m,Object(a.__assign)({undoRedoActionType:r,dispatch:_,isAvailable:c,onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){return e=_(u.e),f.e.raise(e,s?p.e.undoChangeEventName:p.e.redoChangeEventName),[2]})})}},Object(o.t)(e,{itemKey:n,engagement:{name:s?"QuickEditUndoAction":"QuickEditRedoAction",isIntentional:!0}})))}),h=Object(c.n)()(_)},4857:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n("react-lib"),r=n(23),o=n(47),s=Object(o.t)(function(e,t){return i.createElement(r.e,{onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(n){return e=null,t.selector?e=document.querySelector(t.selector):t.elementId&&(e=document.getElementById(t.elementId)),e&&(e.focus(),t.shouldClick&&e.click&&e.click()),[2]})})},engagement:{name:"SetFocus",isIntentional:!0}})})},5091:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n("react-lib"),r=n(2144),o=n(2159),s=n(724),c=n(2164),d=n(534),l=function(e){function t(t){var n=e.call(this,t)||this;return n._onClose=function(){n.setState({isOpen:!1})},n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e),n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0}),n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)},n.state={isOpen:!0,isIFrameLoaded:!1},n}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})},t.prototype.render=function(){var e=this,t=this.props,n=t.url,l=(t.heightOffset,Object(a.__rest)(t,["url","heightOffset"])),u=this.state.isIFrameLoaded;return i.createElement(o.e,Object(a.__assign)({className:"IFrameDialog_15529515",hidden:!this.state.isOpen,type:s.e.close},l),i.createElement(r.e,null,!u&&i.createElement(c.e,{size:d.e.large}),i.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:n,style:{display:u?"block":"none"},onLoad:this._iframeOnLoad})))},t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose,t.commitPopup=this._onClose}this._iframeElement=e},t}(i.Component)},5099:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(13),i=n(717),r=n(31),o=n(0),s=n("react-lib"),c=n(87),d=Object(c.e)(function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.odsp-datasources"),n.e("deferred.office-ui-fabric-react"),n.e(54)]).then(n.bind(null,4330))];case 1:return[2,e.sent().PropertiesForm]}})})});function l(e,t){return{getPropertiesForm:function(e){return s.createElement(d,Object(o.__assign)({},e))}}}var u=n(1264),f=Object(a.t)(function(){return function(e){e(Object(i.e)(r.e,u.e)(l))}})},5182:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(80),r=n(12),o=n(168),s=Object(r.r)()(Object(r.a)()(Object(i.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(44).then(n.bind(null,4461))];case 1:return[2,e.sent().GoToChannelAction]}})})},function(e,t){var n=t.itemKey;return!!e.demandItemFacet(o.e,n)})))},5184:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("react-lib"),i=n(322),r=n(2),o=n(4857),s={key:new r.e("GetNPSSurveyFocusShortcut").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:i.o},action:a.createElement(o.e,{elementId:"obf-TPromptContainer"})}},5495:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("react-lib"),i=n(4856),r=n(51),o=n(58),s={key:Object(o.e)("quickEditUndo"),automationId:"quickEditUndoCommand",name:r.he,iconProps:{iconName:"Undo"},isPermanent:!0,action:a.createElement(i.e,{undoRedoActionType:"undo"})}},5496:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n("react-lib"),i=n(51),r=n(58),o=Object(r.e)("quickEditRedo"),s=n(4856),c={key:o,automationId:"quickEditRedoCommand",name:i._e,iconProps:{iconName:"Redo"},action:a.createElement(s.e,{undoRedoActionType:"redo"})}},5639:function(e,t,n){"use strict";n.r(t),n.d(t,"ItemAutoRefresh",function(){return o}),n.d(t,"CurrentItemAutoRefresh",function(){return s});var a=n(12),i=n(47),r=n(1566),o=Object(i.t)(function(e,t){var n=t.itemKey,a=e.demandItemFacet(r.e,n),i=r.e.evaluate(a)(e,{itemKey:n,itemSubscriber:null,isAvailable:!0}),o=i.isAvailable,s=i.itemSubscriber;return o&&(void 0===s?null:s)||null}),s=Object(a.n)()(o)},5647:function(e,t,n){"use strict";n.r(t),n.d(t,"ItemPromoteChannelFolderAction",function(){return p}),n.d(t,"PromoteChannelFolderAction",function(){return m});var a=n(0),i=n("react-lib"),r=n(47),o=n(12),s=n(1),c=n(31),d=n(168),l=n(1696),u=n(23),f=n(28),p=Object(r.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(c.e,n),o=e.demandItemFacet(d.e,n);if(!n||!r||!o)return null;if(!e.isItemFacetResolved(s.Pt,n))return null;if(e.demandItemFacet(s.Pt,n))return null;var p=e.dispatch;return i.createElement(u.e,Object(a.__assign)({},Object(f.t)(e,{itemKey:n,engagement:{name:"PromoteChannelFolder"}}),{onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,p(Object(l.e)({items:(e={},e[n]={},e)}))];case 1:return t.sent(),[2]}})})}}))}),m=Object(o.e)()(p)},5860:function(e,t,n){"use strict";n.r(t),n.d(t,"sharePointAddonAutoRefresh",function(){return Ae});var a,i=n(13),r=n(717),o=n(89),s=n(1566),c=n(0),d=n("react-lib"),l=n(394),u=n(26),f=n(9),p=n(5),m=n(225),_=n(216),h=n(379),b=n(16),g=n(1522),v=n(4859),y=n(652),S=n(138),D=n(70);!function(e){e[e.New=0]="New",e[e.Update=1]="Update",e[e.Delete=2]="Delete"}(a||(a={}));var I=12e4,x={ODB:459},C=function(){function e(e){var t=this;this.subscribe=function(){if(t._log("Subscribe"),0===t._subscribers){t._async=new _.e,b.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")||(t._syncToken="latest");var e=t._async.debounce(function(){return t._onNotification()},1e4,{leading:!0,maxWait:1e4});t._pushChannelService.setupNotificationHandler({source:v.t.WebhookSubscription},function(){t._log("PushChannelMessageSource",v.t.WebhookSubscription),e()}),t._pushChannelService.setupNotificationHandler({source:v.t.EventHub},function(){t._log("PushChannelMessageSource",v.t.EventHub),e()}),t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}return t._subscribers++,t._pushChannelService.isConnected()||t._pushChannelService.connect(t._getNotification(),{methodInvoker:"ItemAutoRefreshHelper.subscribe"}),t._unsubscribe.bind(t)},this._id=e.id,this._driveUrlParts=e.driveUrl?Object(g.e)(e.driveUrl):void 0,this._dispatch=e.dispatch,this._template=e.template,this._itemScopeItemKey=e.itemsScopeItemKey||"",this._pushChannelService=e.pushChannelService,this._onUnsubscribe=e.onUnsubscribe,this._isTestMode=e.isTestMode,this._onPushChannelConnected=e.onPushChannelConnected,this._onNotificationReceived=e.onNotificationReceived,this._subscribers=0,this._syncToken="latest",this._getChangesAttempts=0}return e.prototype._unsubscribe=function(){return this._log("Unsubscribe"),this._subscribers--,this._template.onUnsubscribe(this._subscribers),0===this._subscribers&&(this._async&&(this._async.dispose(),this._async=void 0,this._refreshSubscriptionTimeoutId=void 0),this._pushChannelService.setupNotificationHandler({source:v.t.WebhookSubscription},function(){}),this._pushChannelService.removeConnectionHandler(this._id),this._pushChannelService.disconnect()),this._onUnsubscribe(this._subscribers),this._subscribers},e.prototype._onPushChannelConnection=function(e){return Object(c.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(c.__generator)(this,function(a){switch(a.label){case 0:if(!e)return this._log("Disconnected"),this._clearRefreshSubscriptionTimeout(),[2];if(this._log("Connected"),this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected(),b.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug"))return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._resolveChangeMessages()];case 2:return a.sent(),[3,4];case 3:return t=a.sent(),this._handleError(t),[2];case 4:return[3,9];case 5:if("latest"!==this._syncToken)return[3,9];a.label=6;case 6:return a.trys.push([6,8,,9]),[4,this._getChangeMessages()];case 7:return a.sent(),[3,9];case 8:return n=a.sent(),this._handleError(n),[2];case 9:return this._refreshSubscriptionHandler(),[2]}})})},e.prototype._handleError=function(e){var t=this;if(this._getChangesAttempts++,!(this._getChangesAttempts>10)){var n=!1;if(Object(y.r)(e))switch(e.status){case 404:case 410:n=!0,this._syncToken="latest"}n&&this._async&&this._async.setTimeout(function(){return t._onPushChannelConnection(t._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts))}},e.prototype._getNotification=function(){return this._template.getSubscription&&this._template.getSubscription(this._dispatch)},e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var n=105001*Math.random()+15e3,a=Date.parse(t.expirationDateTime),i=Date.now(),r=a-i-n;if(r<I){if(h.e.isFeatureEnabled(x)){var o={refreshDelay:r,expirationDateTime:t.expirationDateTime,expirationDateTimeinMS:a,dateTimeNow:i,recreateBufferRandom:n};new S.e({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:o}).end({resultType:D.e.Failure,extraData:o})}r=I}this._clearRefreshSubscriptionTimeout(),this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return Object(c.__awaiter)(e,void 0,void 0,function(){return Object(c.__generator)(this,function(e){switch(e.label){case 0:return this._log("Refreshing subscription"),this._refreshSubscriptionTimeoutId=void 0,[4,this._pushChannelService.refreshSubscription()];case 1:return!0===e.sent()&&this._refreshSubscriptionHandler(),[2]}})})},r)}}},e.prototype._clearRefreshSubscriptionTimeout=function(){this._async&&void 0!==this._refreshSubscriptionTimeoutId&&(this._async.clearTimeout(this._refreshSubscriptionTimeoutId),this._refreshSubscriptionTimeoutId=void 0)},e.prototype._getChangeMessages=function(){return Object(c.__awaiter)(this,void 0,void 0,function(){var e;return Object(c.__generator)(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:return e=t.sent(),this._syncToken=e.syncToken?e.syncToken:"latest",this._getChangesAttempts=0,[2,e]}})})},e.prototype._onNotification=function(){return Object(c.__awaiter)(this,void 0,void 0,function(){var e;return Object(c.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),this._template.hasPendingRequest()?[2]:(this._isTestMode&&this._onNotificationReceived&&this._onNotificationReceived(),[4,this._resolveChangeMessages()]);case 1:return t.sent(),[3,3];case 2:return e=t.sent(),this._log("onNotification error",e),[3,3];case 3:return[2]}})})},e.prototype._resolveChangeMessages=function(){return Object(c.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,o,s,d,l,u;return Object(c.__generator)(this,function(c){switch(c.label){case 0:return t=new m.e({publisher:e}),[4,this._getChangeMessages()];case 1:for(n=c.sent(),this._log("Change messages",n),i=this._processMessages(n.messages),this._log("Changes",i),t.merge(n.itemResolver),r=0,o=i;r<o.length;r++)switch((s=o[r]).type){case a.New:t.invalidateItems({items:(d={},d[s.invalidateKey]=[f.t],d)});break;case a.Update:s.hasSelection&&this._itemScopeItemKey?this._updateItems(s.invalidateKey):t.invalidateItems({items:(l={},l[s.invalidateKey]=[s.invalidateFacet],l)});break;case a.Delete:t.invalidateItems({items:(u={},u[s.invalidateKey]=[p.l],u)})}return this._dispatch(t.execute()),[2]}})})},e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var a=e[n],i=this._template.processMessage(this._dispatch,a,this._itemScopeItemKey);if(void 0!==i)this._log("Change",i.invalidateKey,i.reason),t.push(i);else if(a.parentItemKey)for(var r=n+1;r<e.length;r++)if(e[r].itemKey===a.parentItemKey){e.splice(r,1);break}}return t},e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)},e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e}(),O=C,w=n(844),E=n(863),A=n(86),L=n(5189),k=n(5185),M=n(14),P=n(246),T=n(64),U=n(1),F=n(31),H=n(310),R=n(121),N=n(132),B=n(118),j=n(202),V=n(106),z=n(1064),G=n(676),K=n(846),W=n(1239),q=n(29),Q=function(){function e(e){this._dataRequestor=e.dataRequestor,this._rootItemKey=e.rootItemKey,this._pendingRequest=!1}return e.prototype.onUnsubscribe=function(e){},e.prototype.getSubscription=function(e){var t=this,n=e(Object(B.e)(function(e){return{spItem:e.demandItemFacet(F.e,t._rootItemKey)}})).spItem;if((null==n?void 0:n.webAbsoluteUrl)&&n.listFullUrl){var a=R.e.serialize({webAbsoluteUrl:null==n?void 0:n.webAbsoluteUrl,listFullUrl:null==n?void 0:n.listFullUrl}),i=e(Object(B.e)(function(e){return e.demandItemFacet(U.Ze,a)}));if((null==i?void 0:i.notificationUrl)&&(null==i?void 0:i.expirationDateTime)&&(null==i?void 0:i.subscribeID))return{notificationUrl:null==i?void 0:i.notificationUrl,expirationDateTime:null==i?void 0:i.expirationDateTime,id:null==i?void 0:i.subscribeID}}},e.prototype.hasPendingRequest=function(){return this._pendingRequest},e.prototype.getChangeMessages=function(e,t,n){return Object(c.__awaiter)(this,void 0,void 0,function(){var a,i,r,o,s,d,l,u,f,p,_,h,g,v,y,S,D,I,x,C,O,w,L,k,M,P,T,H,Q,Y,J,X,Z,$=this;return Object(c.__generator)(this,function(ee){switch(ee.label){case 0:if(void 0===n||void 0===n.endpoint||void 0===n.driveId)throw"Invalid drive url parts";return a="".concat(n.endpoint,"/drives/").concat(n.driveId),i=e(Object(j.e)({isTAB:A.A})).isTAB,r=e(Object(B.e)(function(e){return{spItem:e.demandItemFacet(F.e,$._rootItemKey)}})).spItem,o=new m.e,"latest"===t&&r&&(s=R.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}),d=e(Object(B.e)(function(e){return e.demandItemFacet(U.We,s)})),l=null==d?void 0:d.tick)?(u=l-621355968e9,u/=1e4,f=new Date(u),!b.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")&&(t="".concat(f.toISOString()),((new Date).getTime()-f.getTime())/1e3<30)?[2,{syncToken:t,messages:[],itemResolver:o}]:[2,{syncToken:"".concat(f.toISOString()),messages:[],itemResolver:o}]):(_=e(Object(j.e)({dataSyncClientConfiguration:z.e})).dataSyncClientConfiguration,h=!1,_?[4,_.dataSyncClient]:[3,3]);case 1:return(g=ee.sent())?[4,g.isListDataSyncEnabledAsync({driveId:n.driveId})]:[3,3];case 2:h=ee.sent(),ee.label=3;case 3:return h?(p="",[3,7]):[3,4];case 4:return(y=n.endpoint)?[4,e(Object(E.getSessionToken)({endpoint:n.endpoint,driveUrl:a}))]:[3,6];case 5:y=ee.sent(),ee.label=6;case 6:if(void 0===(p=(v=y)&&v.accessToken))throw new q.e({code:"authFailure"});ee.label=7;case 7:return this._pendingRequest=!0,S="".concat(a,"/root/view.delta?token=").concat(encodeURIComponent(t)),[4,this._dataRequestor.send({apiName:"viewDelta",path:S,accessToken:{accessToken:p,tokenUrl:a},useAuthorizationHeaders:!0,headers:Object(c.__assign)({"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"},i?{}:{ScenarioType:"BGO"})})];case 8:if(D=ee.sent(),I=[],D&&D.value)for(x=0,C=D.value;x<C.length;x++){if(O=C[x],w=void 0,L={endpoint:n.endpoint,driveId:n.driveId,itemId:O.id},O.root)for(H=Object(G.t)(L),k=0,M=H;k<M.length;k++)J=M[k],o.mapKeys({mappings:(X={},X[J]=this._rootItemKey,X)});else if(O.webUrl&&(P=Object(K.n)(O.webUrl))&&(T=W.e.serialize({itemFullUrl:P}),e(Object(N.e)({spItemKey:F.e},T)).spItemKey))for(H=Object(G.t)(L),Q=0,Y=H;Q<Y.length;Q++)J=Y[Q],o.mapKeys({mappings:(Z={},Z[J]=T,Z)});O.root||(O.parentReference&&(w=O.parentReference.id),I.push({itemKey:V.e.serialize(L),parentItemKey:w&&V.e.serialize({endpoint:n.endpoint,driveId:n.driveId,itemId:w}),isDeleted:!!O.deleted,isShared:!!O.shared,name:O.name,dateModified:O.lastModifiedDateTime,eTag:O.eTag}))}return this._pendingRequest=!1,[2,{syncToken:D["@delta.token"],messages:I,itemResolver:o}]}})})},e.prototype.updateItems=function(e,t,n){},e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(Object(N.e)({deleted:p.l},t.itemKey)).deleted)return;return{type:a.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(Object(N.e)({spItemKey:F.e,mediaTransformSchema:P.e,displayName:p.f},t.itemKey)),r=i.spItemKey,o=i.mediaTransformSchema,s=i.displayName;if(void 0===r){if(!t.parentItemKey)return;return{type:a.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(o&&t.eTag){var c=o[".etag"];if(c&&t.eTag&&t.eTag!==c)return{type:a.Update,invalidateKey:t.itemKey,invalidateFacet:P.e,reason:"eTag changed from ".concat(c," to ").concat(t.eTag)}}if(void 0!==t.name&&s!==t.name)return{type:a.Update,invalidateKey:t.itemKey,invalidateFacet:p.f,reason:"Name changed from ".concat(s," to ").concat(t.name)}},e}(),Y=n(314),J=n(46),X=n(68),Z=n(975),$=n(52),ee=n(143),te=n(522),ne=function(){function e(e){this._dispatch=e.dispatch,this._webAbsoluteUrl=e.webAbsoluteUrl,this._listFullUrl=e.listFullUrl,this._listId=e.listId}return e.prototype.getSocketIoSubscription=function(e){return Object(c.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o,s,d,u,f,p,m,_,h,b;return Object(c.__generator)(this,function(c){switch(c.label){case 0:return e.existingSubscription?[3,5]:(n=Object(te.n)({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push"),[4,this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:n.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){})]);case 1:if(a=c.sent(),i=this._dispatch(Object(j.e)({isTest:A.A})).isTest,!(r=a&&a.d&&a.d.GetServiceUrls&&a.d.GetServiceUrls.results&&a.d.GetServiceUrls.results[0])&&!i)throw new Error("Unable to retrieve PushChannel base url");i&&(r="https://northcentralus0-pushs.svc.ms"),o="".concat(r,"/notifications/register"),s=$.e.generate(),d=this._dispatch(Object(l.e)({name:"SubscriptionServiceGenericList.Register"})),u={correlationId:s},c.label=2;case 2:return c.trys.push([2,4,,5]),[4,Z.e.start({url:o,method:"GET",headers:{"X-Correlation-Id":s},requestTimeoutInMS:1e4})];case 3:if((f=c.sent())&&f.responseText&&f.responseText.length>0&&(p=JSON.parse(f.responseText))&&p.serverUrl&&p.webhookUrl&&(t=p.webhookUrl),void 0===t)throw new Error("Unable to retireve PushChannel notification url");return this._dispatch(d({resultType:X.e.success,extraData:u})),[3,5];case 4:throw m=c.sent(),this._dispatch(d({resultType:X.e.failure,extraData:u})),m;case 5:return _=Object(te.a)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId),e.existingSubscription?(_=_.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update"),t=e.existingSubscription.notificationUrl):_=_.segments("Subscriptions","Add"),h={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}},[4,this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:_.toString(),body:JSON.stringify(h),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((b=c.sent())&&b.d)return delete b.d.__metadata,e.existingSubscription&&(b.d.id=e.existingSubscription.id,b.d.notificationUrl=e.existingSubscription.notificationUrl,b.d.expirationDateTime=h.parameters.expirationDateTime),[2,b.d];throw new Error("Invalid subscription object")}})})},e.prototype.deleteSocketIoSubscription=function(e){var t=Object(te.a)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))},e}(),ae=n(369),ie=n(45),re=n(133),oe=n(370),se=n(243),ce="SPO_LIST,",de=function(){function e(e){this._pushChannelService=e.pushChannelService,this._subscriptionService=e.subscriptionService,this._webAbsoluteUrl=e.webAbsoluteUrl,this._listFullUrl=e.listFullUrl,this._itemSetKey=e.itemSetKey,this._serverResponse=void 0,this._pendingRequest=!1}return e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof ne){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService&&this._subscriptionService.deleteSocketIoSubscription(t)}},e.prototype.getSubscription=function(e){if(this._webAbsoluteUrl&&this._listFullUrl){var t=R.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),n=e(Object(B.e)(function(e){return e.demandItemFacet(U.Ze,t)}));if((null==n?void 0:n.notificationUrl)&&(null==n?void 0:n.expirationDateTime)&&(null==n?void 0:n.subscribeID))return{notificationUrl:null==n?void 0:n.notificationUrl,expirationDateTime:null==n?void 0:n.expirationDateTime,id:null==n?void 0:n.subscribeID}}},e.prototype.getChangeMessages=function(e,t,n){return Object(c.__awaiter)(this,void 0,void 0,function(){var n,a,i,r,o,s,d,l,u,f,p,_,h,g,v,y,S,D,I,x,C,O,w,E,L,k,M,P,T,H,N,V,z,G=this;return Object(c.__generator)(this,function(K){switch(K.label){case 0:if("latest"===t&&(n=R.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),a=e(Object(B.e)(function(e){return e.demandItemFacet(U.We,n)})),i=null==a?void 0:a.lastItemModifiedTime))return r=new m.e,[2,{syncToken:"".concat(ce).concat(i),messages:[],itemResolver:r}];if(this._pendingRequest=!0,d=!!t&&t.substr(0,9)===ce)for(l=t.split(","),u=l[1],f='<Gt><FieldRef Name="Modified" />',f+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'.concat(u,"</Value>"),o=f+="</Gt>",s=["ID","FileRef","Modified","Title"],p=this._getListColumns(e),_=0,h=p;_<h.length;_++)"ID"!==(g=h[_]).internalName&&"FileRef"!==g.internalName&&"Modified"!==g.internalName&&"Title"!==g.internalName&&s.push(g.internalName);else{if(!b.t.isActivated("9e144a63-594c-45c9-8189-a4b0eb40e708","10/26/2021","Return empty messages and current time as sync token for initial sync"))return this._pendingRequest=!1,[2,{syncToken:"SPO_LIST,".concat((new Date).toISOString()),messages:[],itemResolver:new m.e}];s=["ID","FileRef","Modified"]}return v=d,y=d?200:1,S=new Y.e("<View></View>"),o&&S.addFilters([o]),s&&S.replaceFields(s),S.updateSort({fieldName:"ID",isAscending:v}),S.updateRowLimit({rowLimit:y,isPerPage:!1}),D=e(Object(B.e)(function(e){return Object(ie.e)(e,F.e.serialize({webAbsoluteUrl:G._webAbsoluteUrl,listFullUrl:G._listFullUrl}))})),[4,e(Object(j.e)({isTAB:A.A}))];case 1:return I=K.sent().isTAB,this._requestDatesInUtc=!D,[4,e(Object(ae.e)({getItemContext:Object(c.__assign)(Object(c.__assign)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:S.getEffectiveViewXml()},I?{}:{isBackground:!0}),{postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:D})}))];case 2:for(x=K.sent(),this._serverResponse=x,C=x.ListData,O=C&&C.Row||[],w=[],E=d?this._getLastModifiedTimeInList(O,D):(new Date).toISOString(),L=0,k=O;L<k.length;L++)if(void 0!==(M=k[L]).FileRef){for(P={},T=Object.keys(M),H=0,N=T;H<N.length;H++)V=N[H],z=0===V.indexOf("OData_")?V.substr(6):V,P[z]=M[V];w.push(Object(c.__assign)(Object(c.__assign)({itemKey:F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:M.ID}),parentItemKey:F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:M.Title||""},M.Modified?{dateModified:"".concat(M.Modified)}:{}),{fields:P}))}return 0===w.length&&w.push({itemKey:F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1}),this._pendingRequest=!1,[2,{syncToken:"SPO_LIST,".concat(E),messages:w,itemResolver:new m.e}]}})})},e.prototype.hasPendingRequest=function(){return this._pendingRequest},e.prototype.updateItems=function(e,t){if(t&&o.e.matches(this._itemSetKey)&&this._serverResponse){var n=o.e.deserialize(this._itemSetKey),a={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(Object(se.n)({itemSetKey:a})),r=e(Object(se.e)(n,i,"getSPItem")),s=e(Object(oe.t)({serverData:this._serverResponse,itemSetKey:a,contentTypes:i,currentPageContext:r.currentPageContext,isItemSetRequest:!1})).itemResolver;e(s.execute())}this._serverResponse=void 0},e.prototype.processMessage=function(e,t,n){var i=e(Object(B.e)(function(e){var a=Object(re.e)(e,{itemsScopeItemKey:n});return e.isItemFacetResolved(F.e,t.itemKey)?{rowData:e.demandItemFacet(U.Bt,t.itemKey),spItemKey:e.demandItemFacet(F.e,t.itemKey),title:e.demandItemFacet(U.Ln,t.itemKey),selectedItemKeys:a}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:a}})),r=i.rowData,o=i.spItemKey,s=i.title,c=i.selectedItemKeys,d=c&&c.length>0;if(void 0===t.parentItemKey){if(d)return;return{type:a.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"}}if(t.isDeleted){if(e(Object(N.e)({deleted:p.l},t.itemKey)).deleted||d)return;return{type:a.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}if(void 0===o||void 0===r){if(!t.parentItemKey)return;if(void 0===e(Object(N.e)({spParentItemKey:F.e},t.parentItemKey)).spParentItemKey)return;return d?void 0:{type:a.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==s&&void 0!==t.name&&s!==t.name)return{type:a.Update,invalidateKey:t.itemKey,invalidateFacet:U.Ln,hasSelection:d,reason:'Item title changed from "'.concat(s,'" to ').concat(t.name,")")};if(t.fields){d||(this._serverResponse=void 0);for(var l=this._getListColumns(e),u=function(e){for(var n=e.internalName,i=0,o=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});i<o.length;i++){var s=o[i],c=r&&r[s],l=t.fields[s];try{if("object"==typeof c&&(c=JSON.stringify(c)),"object"==typeof l&&(l=JSON.stringify(l)),f._requestDatesInUtc&&"DateTime"===e.fieldType){var u=Date.parse(c),p=Date.parse(l);isNaN(u)||isNaN(p)||(c=u,l=p)}}catch(e){continue}if(c!==l)return{value:{type:a.Update,invalidateKey:t.itemKey,invalidateFacet:U.Bt,hasSelection:d,reason:'Item field "'.concat(n,'" changed from "').concat(c,'" (').concat(typeof c,")")+' to "'.concat(l,'" (').concat(typeof l,")")}}}},f=this,m=0,_=l;m<_.length;m++){var h=u(_[m]);if("object"==typeof h)return h.value}}},e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var a=void 0,i=0,r=e;i<r.length;i++){var o=r[i];if(this._requestDatesInUtc){var s=o.Modified;s&&(d=new Date(s),(void 0===a||a<d)&&(a=d,n="".concat(s)))}else{var c=o["Modified."];if(c){var d=new Date(c),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-d.getTimezoneOffset():0;l&&d.setTime(d.getTime()+6e4*l),(void 0===a||a<d)&&(a=d,n=d.toISOString())}}}return n},e.prototype._getListColumns=function(e){var t=[],n=e(Object(N.e)({schema:f.o},this._itemSetKey)).schema,a=n&&n.columnKeys;if(a)for(var i=0,r=a;i<r.length;i++){var o=r[i],s=e(Object(N.e)({internalName:U.Ee,fieldType:U.me,mappedFieldType:U.$e},o)),c=s.internalName,d=s.fieldType,l=s.mappedFieldType;void 0!==c&&void 0!==d&&void 0!==l&&l!==J.t.Title&&t.push({internalName:c,fieldType:d,mappedFieldType:l})}return t},e}(),le=n(224),ue=n(267),fe=n(55),pe=n(24),me=n(18),_e=n(214),he=n(223),be=n(184),ge=n(3172),ve=function(){function e(e){this._connectionCallbacks={},this._notificationCallback=void 0,this._notificationId=void 0,this._siteId=e.siteId,this._listId=e.listId,this._isConnected=!1,this._client=e.dataSyncClient}return e.prototype.isConnected=function(){return this._isConnected},e.prototype.getSocketIoSubscription=function(){},e.prototype.addConnectionHandler=function(e,t){this._connectionCallbacks[e]=t},e.prototype.removeConnectionHandler=function(e){this._connectionCallbacks[e]&&delete this._connectionCallbacks[e]},e.prototype.setupNotificationHandler=function(e,t){return this._notificationCallback=t,!0},e.prototype.disconnect=function(){this._notificationCallback=void 0,this._connectionCallbacks={},this._notificationId&&this._client&&this._client.removeListStatusCallback(this._notificationId),this._isConnected=!1},e.prototype.refreshSubscription=function(){return Object(c.__awaiter)(this,void 0,void 0,function(){return Object(c.__generator)(this,function(e){return[2,!0]})})},e.prototype.connect=function(e,t){return Object(c.__awaiter)(this,void 0,void 0,function(){var e,t,n,a,i,r;return Object(c.__generator)(this,function(o){switch(o.label){case 0:return t=(e=this)._client,n=e._siteId,a=e._listId,i={siteId:n,listId:a},[4,t.isListDataSyncEnabledAsync(i)];case 1:return o.sent()?(r=this,[4,t.addListStatusCallbackAsync(this._onNotification.bind(this),i,{sendConnectionNotifications:!0})]):[3,3];case 2:return r._notificationId=o.sent(),[2,!0];case 3:return[2,!1]}})})},e.prototype._onNotification=function(e){if(1===e.length){var t=e[0];t.dataRefreshNeeded?this._notificationCallback&&this._notificationCallback(void 0):t.state===ge.e.ListStatusConnected?this._notifyConnectionHandlers(!0):t.state===ge.e.ListStatusConnectionLost&&this._notifyConnectionHandlers(!1)}},e.prototype._notifyConnectionHandlers=function(e){for(var t in this._isConnected=e,this._connectionCallbacks)this._connectionCallbacks.hasOwnProperty(t)&&this._connectionCallbacks[t](e)},e}(),ye=n(232),Se={ODB:860},De={ODB:818},Ie=new pe.e("itemAutoRefreshHelper",{itemsScopeItemKey:me.e,spPageContextKey:me.e}),xe=Object(ue.e)(function(e){return{}});function Ce(e){var t=e.spPageContextKey,n=e.pageContext,a=e.listId,i=e.webAbsoluteUrl,r=e.listFullUrl,o=e.isTAB,s=e.itemKey,c=e.driveUrl,d=e.itemsScopeItemKey,u=e.getDataSyncClient;return function(f){var p=f(xe),m=Ie.serialize({itemsScopeItemKey:d,spPageContextKey:t}),_=p[m];if(!_){var h,g=void 0,v=void 0,y=!n||!Object(b.a)(n).isActivated("f3c67c53-3465-4927-924d-963e1011836b","09/29/2020","Skip checking the subscription service");if(u&&e.pushChannelService&&(y||e.subscriptionService))g=e.pushChannelService,v=e.subscriptionService;else{if(n){var S=f(w.e).dataRequestor;v=new L.e({listId:a,webAbsoluteUrl:i},{dataRequestor:S})}else v=new ne({dispatch:f,webAbsoluteUrl:i,listFullUrl:r,listId:a});g=new k.e({disableWebSockets:!0},{subscriptionService:v})}h=new de({pushChannelService:g,subscriptionService:v,webAbsoluteUrl:i,listFullUrl:r,itemSetKey:s}),_=p[m]=new O({id:m,isTestMode:o,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:c,dispatch:f,template:h,itemsScopeItemKey:d,pushChannelService:g,logQoS:function(e){var t=f(Object(l.e)(e));return function(e){return f(t(e))}},onUnsubscribe:function(e){0===e&&delete p[m]}})}return _}}function Oe(e){var t=Object(le.t)();return d.useLayoutEffect(function(){if(e.getDataSyncClient){var n=new Promise(function(n){(function(e){var t=this,n=e.pageContext,a=e.listId,i=e.getDataSyncClient;return i?i.then(function(i){return Object(c.__awaiter)(t,void 0,void 0,function(){var t,r,o;return Object(c.__generator)(this,function(s){switch(s.label){case 0:return t=void 0,r=void 0,(o=i&&n&&a&&n.siteId)?[4,i.isListDataSyncEnabledAsync({listId:a,siteId:n.siteId})]:[3,2];case 1:o=s.sent(),s.label=2;case 2:return o?(t=new ve({listId:a,siteId:n.siteId,dataSyncClient:i}),r=void 0,[2,Ce(Object(c.__assign)(Object(c.__assign)({},e),{subscriptionService:r,pushChannelService:t}))]):[2,Ce(e)]}})})}):Promise.resolve(Ce(e))})(e).then(function(e){var a=t(e);n(a.subscribe())})});return function(){n.then(function(e){return e()})}}return t(Ce(e)).subscribe()},[]),null}function we(e){var t=Object(le.t)(),n=e.pageContext&&!Object(b.a)(e.pageContext).isActivated("ef32179a-abf3-45a4-83c0-aea05f141dff","10/06/2022","Checking if data sync enabled");return d.useLayoutEffect(function(){if(n){var a=t(function(e){var t=this,n=e.spPageContextKey,a=e.webAbsoluteUrl,i=e.listFullUrl,r=e.listId,o=e.isTAB,s=e.driveUrl,d=e.endpoint,u=e.itemsScopeItemKey,f=e.pageContext,p=e.getDataSyncClient;return function(e){var m=!1,_=Object(c.__awaiter)(t,void 0,void 0,function(){var t,_,h,b,g,v,y,S=this;return Object(c.__generator)(this,function(D){switch(D.label){case 0:return t=e(xe),_=Ie.serialize({itemsScopeItemKey:u,spPageContextKey:n}),(h=t[_])?[3,4]:(b=void 0,g=void 0,v=e(w.e).dataRequestor,g=new Q({dataRequestor:v,rootItemKey:F.e.serialize({webAbsoluteUrl:a,listFullUrl:i,rootFolder:""})}),p?[4,p]:[3,3]);case 1:return(y=D.sent())&&r&&f&&f.siteId?[4,y.isListDataSyncEnabledAsync({listId:r,siteId:f.siteId})]:[3,3];case 2:D.sent()&&!m&&(b=new ve({listId:r,siteId:f.siteId,dataSyncClient:y})),D.label=3;case 3:b||(b=new k.e({disableWebSockets:!0},{subscriptionService:new L.e({},{dataRequestor:v}),sessionTokenFetcher:function(){return Object(c.__awaiter)(S,void 0,void 0,function(){var t,n,a;return Object(c.__generator)(this,function(i){switch(i.label){case 0:return(n=d)?[4,e(Object(E.getSessionToken)({endpoint:d,driveUrl:s}))]:[3,2];case 1:n=i.sent(),i.label=2;case 2:if(!(a=(t=n)&&t.accessToken))throw new q.e({code:"authFailure"});return[2,{accessToken:a,tokenUrl:s}]}})})}})),h=t[_]=new O({id:_,isTestMode:o,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:s,dispatch:e,itemsScopeItemKey:u,template:g,pushChannelService:b,logQoS:function(t){var n=e(Object(l.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){m=!0,0===e&&delete t[_]}}),D.label=4;case 4:return[2,h.subscribe()]}})});return function(){_.then(function(e){return e()})}}}(e));return function(){a()}}var i=t(function(e){var t=this,n=e.spPageContextKey,a=e.webAbsoluteUrl,i=e.listFullUrl,r=e.isTAB,o=e.driveUrl,s=e.endpoint,d=e.itemsScopeItemKey;return function(e){var u=e(xe),f=Ie.serialize({itemsScopeItemKey:d,spPageContextKey:n}),p=u[f];if(!p){var m,_,h=e(w.e).dataRequestor;_=new Q({dataRequestor:h,rootItemKey:F.e.serialize({webAbsoluteUrl:a,listFullUrl:i,rootFolder:""})}),m=new k.e({disableWebSockets:!0},{subscriptionService:new L.e({},{dataRequestor:h}),sessionTokenFetcher:function(){return Object(c.__awaiter)(t,void 0,void 0,function(){var t,n,a;return Object(c.__generator)(this,function(i){switch(i.label){case 0:return(n=s)?[4,e(Object(E.getSessionToken)({endpoint:s,driveUrl:o}))]:[3,2];case 1:n=i.sent(),i.label=2;case 2:if(!(a=(t=n)&&t.accessToken))throw new q.e({code:"authFailure"});return[2,{accessToken:a,tokenUrl:o}]}})})}}),p=u[f]=new O({id:f,isTestMode:r,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:o,dispatch:e,itemsScopeItemKey:d,template:_,pushChannelService:m,logQoS:function(t){var n=e(Object(l.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete u[f]}})}return p}}(e));return i.subscribe()},[]),null}function Ee(e,t){var n,a=t.itemKey,i=t.itemSubscriber;if(!a)return{};var r=e.demandItem({key:o.e},a).key;if(!r||!r.webAbsoluteUrl||!r.listFullUrl)return{};var s=r.webAbsoluteUrl,c=r.listFullUrl,l=H.e.serialize({webAbsoluteUrl:s,listFullUrl:c}),f=e.demandItemFacet(U.Sn,l);if(!Object(T.e)(e,{feature:Se,pageContext:f})||!Object(T.e)(e,{feature:De,pageContext:f}))return{};var p=R.e.serialize({webAbsoluteUrl:s,listFullUrl:c}),m=e.demandItem({listFacets:U.We,listMediaTransformSchema:P.n},p),_=m.listFacets,h=m.listMediaTransformSchema;if(!_||void 0===_.id||void 0===_.templateType)return{};var b=_.isDocumentLibrary,v=M.r(_.templateType);if(!b&&!v)return{};var y,S=Object(u.e)(e,{isTAB:A.A}).isTAB,D=h&&h[".driveUrl"],I=D&&Object(g.e)(D),x=I&&I.endpoint,C=Object(fe.e)(e).itemsScopeItemKey||"itemsSCopeItemKey";if(b&&!D)return{};var O=Object(ye.p)(function(t){return Object(T.e)(e,{feature:t})},ye.e.SharePointList)?null===(n=e.demandItemFacet(U.en,be.e))||void 0===n?void 0:n.dataSyncClient:void 0,w=Object(_e.e)(e,{itemsScopeItemKey:C});if(w&&w.id===he.e.id)return{};if(b){if(!h)return{};if(!D)return{};if(S){var E=h[".driveAccessToken"];y=E&&E.replace("access_token=","")}if(!I)return{};var L=I.driveId;return x&&L?{itemSubscriber:d.createElement(d.Fragment,null,d.createElement(we,{spPageContextKey:l,driveUrl:D,isTAB:S,listFullUrl:c,listId:_.id,endpoint:x,driveAccessToken:y,webAbsoluteUrl:s,pageContext:f,itemsScopeItemKey:C,getDataSyncClient:O}),i)}:{}}return{itemSubscriber:d.createElement(d.Fragment,null,d.createElement(Oe,{spPageContextKey:l,isTAB:S,itemKey:a,listFullUrl:c,webAbsoluteUrl:s,listId:_.id,pageContext:f,driveUrl:D,itemsScopeItemKey:C,getDataSyncClient:O}),i)}}var Ae=Object(i.t)(function(){return function(e){e(Object(r.e)(o.e,s.e)(Ee))}})},5976:function(e,t,n){"use strict";n.r(t),n.d(t,"graphDriveFollowedAddon",function(){return S});var a=n(0),i=n(13),r=n(271),o=n(632),s=n(186),c=n(345),d=n(5),l=n(763),u=n(118),f=n(225),p=n(742),m=n(1232),_=n(9),h=n(35),b=n(184),g=n(178),v=n(106),y=Object(i.n)()(function e(t){var n=this,i=(t.keyType,t.items);return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,o,s,c,y,S,D,I,x,C,O,w,E,A,L,k,M;return Object(a.__generator)(this,function(P){switch(P.label){case 0:return[4,t(Object(u.e)(function(e){return e.demandItemFacet(h.p,b.e)}))];case 1:if(!P.sent())return[2];if(n=Object.keys(i),r=n[0],o=m.e.deserialize(r),!(s=o.driveItem.endpoint))throw new Error("No endpoint to determine followed items.");return c=p.e.serialize({driveItemKey:{endpoint:s},sortBy:"",isAscending:!0}),[4,t(Object(l.e)(function(e){return e.demandItemFacet(_.e,c)}))];case 2:for(y=P.sent(),S=y&&y.itemKeys||[],D=new f.e({publisher:e}),I={},x=0,C=S;x<C.length;x++)O=C[x],I[O]=!0;for(w=0,E=n;w<E.length;w++)A=E[w],L=m.e.deserialize(A).driveItem,k=!!I[v.e.serialize(L)],D.resolveItems({items:(M={},M[A]=Object(a.__assign)(Object(a.__assign)({},d.S.pack(k||void 0)),Object(g.e)().forFacet(d.S).thenInvalidate(c,_.e).pack()),M)});return t(D.execute()),[2]}})})}}),S=Object(i.t)(function(){return function(e){e(Object(s.t)({keyFacet:m.e,facets:[d.S]})),e(Object(r.a)(m.e,c.e)(y)),e(Object(r.a)(m.e,o.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(20).then(n.bind(null,5758))];case 1:return[2,e.sent().driveItemFollowItemOperationHandler]}})})})))}})},5979:function(e,t,n){"use strict";n.r(t),n.d(t,"IS_CONSTRAIN_LIBRARIES_DROPDOWN_SIZE_KILLSWITCH_ACTIVATED",function(){return A}),n.d(t,"IS_FIX_FOCUS_KILLSWITCH_ACTIVATED",function(){return L}),n.d(t,"ItemLibrariesDropdown",function(){return U}),n.d(t,"LibrariesDropdown",function(){return F});var a=n(0),i=n("react-lib"),r=n(166),o=n(5212),s=n(179),c=n(89),d=n(121),l=n(734),u=n(161),f=n(9),p=n(5),m=n(31),_=n(1),h=n(504),b=n(125),g=n(14),v=n(256),y=n(26),S=n(687),D=n(12),I=n(1646),x=n(150),C=n(158),O=n(231),w=n(87),E=n(16),A=E.t.isActivated("511cf8c4-478d-4428-be23-88fdb3dc803a","03/28/2022",'Constrain the size of the libraries dropdown so that very very long library names don"t break it'),L=E.t.isActivated("32E14D10-7F57-4A91-BF35-B6FB88FAD6F1","05/12/2022","Fix the focus style of the dropdown in all endpoints."),k=Object(w.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.items-view"),n.e(714)]).then(n.bind(null,2072))];case 1:return[2,e.sent().ActionContextMenu]}})})}),M="LibrariesDropdown;",P={component:M},T=Object(x.t)({withContext:P}),U=Object(O.n)(T)(function(e){var t,n=i.useRef(null),a=i.useState(!1),D=a[0],O=a[1],w=Object(b.e)(function(){return O(!1)}),E=Object(u.e)("librariesDropdown_bddb0aff",e.className,D?"librariesDropdownOpen_bddb0aff":"librariesDropdownNotOpen_bddb0aff",((t={}).librariesDropdownWithFocus_bddb0aff=!L,t));return i.createElement(s.e,null,function(t){var a,s=t.itemCache,b=(t.dispatch,null===(a=Object(x.n)(s))||void 0===a?void 0:a.telemetry),L=e.itemKey,P=s.demandItemFacet(m.e,L),T=s.demandItemFacet(c.e,L),U=Object(S.e)(s);if(P||T){var F=Object(y.e)(s,{enableLibrariesDropdown:_.B}).enableLibrariesDropdown,H=void 0,R=void 0,N=void 0;if(P)H=P.webAbsoluteUrl,R=P.rootFolder,N=d.e.serialize(P);else{if(!T)return null;H=T.webAbsoluteUrl,R=T.rootFolder,N=d.e.serialize(T)}var B=s.demandItemFacet(_.We,N),j=!(U||!F||!B||B.templateType!==g.n.documentLibrary||""!==R),V=s.demandItemFacet(I.e,L);if(!I.e.evaluate(V)(s,{itemKey:L,isAvailable:j}).isAvailable)return null;var z=[],G=null;if(D){var K=s.demandItemFacet(f.e,l.e.serialize({webAbsoluteUrl:H}));K&&K.itemKeys&&K.itemKeys.length&&(G=function(){b&&b(C.e).logData({name:"LibrariesDropdown.Load",component:M,objectType:"Libraries",extraData:{numberOfLibraries:K.itemKeys.length},isIntentional:!0})},z=K.itemKeys.map(function(e){return{key:e,name:s.demandItemFacet(p.f,e)||"",action:i.createElement(v.e,{itemKey:e})}}))}return i.createElement(i.Fragment,null,i.createElement("button",{className:E,onClick:D?w:function(){b&&b(C.e).logData({name:"LibrariesDropdown.OpenDropdown",component:M,isIntentional:!0}),O(!0)},ref:n,"aria-label":o.e,"aria-haspopup":"menu","aria-expanded":D?"true":"false",title:o.e},i.createElement(h.e,{iconName:"Library",className:Object(u.e)("librariesDropdownIcon_bddb0aff")}),i.createElement(h.e,{iconName:"ChevronDown",className:Object(u.e)("librariesDropdownChevron_bddb0aff")})),D?i.createElement(k,{commands:z,target:n.current,directionalHint:r.e.bottomLeftEdge,alignTargetEdge:!0,onDismiss:w,isOpen:!0,onMenuOpened:G||void 0,calloutProps:A?{}:{calloutMaxHeight:500,calloutMaxWidth:300}}):null)}return null})}),F=Object(D.e)()(U)}}]);